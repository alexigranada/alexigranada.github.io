function ab(i,s){for(var l=0;l<s.length;l++){const f=s[l];if(typeof f!="string"&&!Array.isArray(f)){for(const _ in f)if(_!=="default"&&!(_ in i)){const T=Object.getOwnPropertyDescriptor(f,_);T&&Object.defineProperty(i,_,T.get?T:{enumerable:!0,get:()=>f[_]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))f(_);new MutationObserver(_=>{for(const T of _)if(T.type==="childList")for(const w of T.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&f(w)}).observe(document,{childList:!0,subtree:!0});function l(_){const T={};return _.integrity&&(T.integrity=_.integrity),_.referrerPolicy&&(T.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?T.credentials="include":_.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function f(_){if(_.ep)return;_.ep=!0;const T=l(_);fetch(_.href,T)}})();var lb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function j0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var U0={exports:{}},op={},$0={exports:{}},At={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nc=Symbol.for("react.element"),ub=Symbol.for("react.portal"),cb=Symbol.for("react.fragment"),hb=Symbol.for("react.strict_mode"),db=Symbol.for("react.profiler"),pb=Symbol.for("react.provider"),fb=Symbol.for("react.context"),mb=Symbol.for("react.forward_ref"),gb=Symbol.for("react.suspense"),yb=Symbol.for("react.memo"),_b=Symbol.for("react.lazy"),S_=Symbol.iterator;function vb(i){return i===null||typeof i!="object"?null:(i=S_&&i[S_]||i["@@iterator"],typeof i=="function"?i:null)}var Z0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q0=Object.assign,G0={};function Nl(i,s,l){this.props=i,this.context=s,this.refs=G0,this.updater=l||Z0}Nl.prototype.isReactComponent={};Nl.prototype.setState=function(i,s){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,s,"setState")};Nl.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function H0(){}H0.prototype=Nl.prototype;function eg(i,s,l){this.props=i,this.context=s,this.refs=G0,this.updater=l||Z0}var tg=eg.prototype=new H0;tg.constructor=eg;q0(tg,Nl.prototype);tg.isPureReactComponent=!0;var T_=Array.isArray,W0=Object.prototype.hasOwnProperty,ig={current:null},K0={key:!0,ref:!0,__self:!0,__source:!0};function X0(i,s,l){var f,_={},T=null,w=null;if(s!=null)for(f in s.ref!==void 0&&(w=s.ref),s.key!==void 0&&(T=""+s.key),s)W0.call(s,f)&&!K0.hasOwnProperty(f)&&(_[f]=s[f]);var d=arguments.length-2;if(d===1)_.children=l;else if(1<d){for(var N=Array(d),J=0;J<d;J++)N[J]=arguments[J+2];_.children=N}if(i&&i.defaultProps)for(f in d=i.defaultProps,d)_[f]===void 0&&(_[f]=d[f]);return{$$typeof:Nc,type:i,key:T,ref:w,props:_,_owner:ig.current}}function xb(i,s){return{$$typeof:Nc,type:i.type,key:s,ref:i.ref,props:i.props,_owner:i._owner}}function rg(i){return typeof i=="object"&&i!==null&&i.$$typeof===Nc}function wb(i){var s={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(l){return s[l]})}var I_=/\/+/g;function Pf(i,s){return typeof i=="object"&&i!==null&&i.key!=null?wb(""+i.key):s.toString(36)}function vd(i,s,l,f,_){var T=typeof i;(T==="undefined"||T==="boolean")&&(i=null);var w=!1;if(i===null)w=!0;else switch(T){case"string":case"number":w=!0;break;case"object":switch(i.$$typeof){case Nc:case ub:w=!0}}if(w)return w=i,_=_(w),i=f===""?"."+Pf(w,0):f,T_(_)?(l="",i!=null&&(l=i.replace(I_,"$&/")+"/"),vd(_,s,l,"",function(J){return J})):_!=null&&(rg(_)&&(_=xb(_,l+(!_.key||w&&w.key===_.key?"":(""+_.key).replace(I_,"$&/")+"/")+i)),s.push(_)),1;if(w=0,f=f===""?".":f+":",T_(i))for(var d=0;d<i.length;d++){T=i[d];var N=f+Pf(T,d);w+=vd(T,s,l,N,_)}else if(N=vb(i),typeof N=="function")for(i=N.call(i),d=0;!(T=i.next()).done;)T=T.value,N=f+Pf(T,d++),w+=vd(T,s,l,N,_);else if(T==="object")throw s=String(i),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return w}function ed(i,s,l){if(i==null)return i;var f=[],_=0;return vd(i,f,"","",function(T){return s.call(l,T,_++)}),f}function bb(i){if(i._status===-1){var s=i._result;s=s(),s.then(function(l){(i._status===0||i._status===-1)&&(i._status=1,i._result=l)},function(l){(i._status===0||i._status===-1)&&(i._status=2,i._result=l)}),i._status===-1&&(i._status=0,i._result=s)}if(i._status===1)return i._result.default;throw i._result}var Lr={current:null},xd={transition:null},Sb={ReactCurrentDispatcher:Lr,ReactCurrentBatchConfig:xd,ReactCurrentOwner:ig};At.Children={map:ed,forEach:function(i,s,l){ed(i,function(){s.apply(this,arguments)},l)},count:function(i){var s=0;return ed(i,function(){s++}),s},toArray:function(i){return ed(i,function(s){return s})||[]},only:function(i){if(!rg(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};At.Component=Nl;At.Fragment=cb;At.Profiler=db;At.PureComponent=eg;At.StrictMode=hb;At.Suspense=gb;At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sb;At.cloneElement=function(i,s,l){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var f=q0({},i.props),_=i.key,T=i.ref,w=i._owner;if(s!=null){if(s.ref!==void 0&&(T=s.ref,w=ig.current),s.key!==void 0&&(_=""+s.key),i.type&&i.type.defaultProps)var d=i.type.defaultProps;for(N in s)W0.call(s,N)&&!K0.hasOwnProperty(N)&&(f[N]=s[N]===void 0&&d!==void 0?d[N]:s[N])}var N=arguments.length-2;if(N===1)f.children=l;else if(1<N){d=Array(N);for(var J=0;J<N;J++)d[J]=arguments[J+2];f.children=d}return{$$typeof:Nc,type:i.type,key:_,ref:T,props:f,_owner:w}};At.createContext=function(i){return i={$$typeof:fb,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:pb,_context:i},i.Consumer=i};At.createElement=X0;At.createFactory=function(i){var s=X0.bind(null,i);return s.type=i,s};At.createRef=function(){return{current:null}};At.forwardRef=function(i){return{$$typeof:mb,render:i}};At.isValidElement=rg;At.lazy=function(i){return{$$typeof:_b,_payload:{_status:-1,_result:i},_init:bb}};At.memo=function(i,s){return{$$typeof:yb,type:i,compare:s===void 0?null:s}};At.startTransition=function(i){var s=xd.transition;xd.transition={};try{i()}finally{xd.transition=s}};At.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};At.useCallback=function(i,s){return Lr.current.useCallback(i,s)};At.useContext=function(i){return Lr.current.useContext(i)};At.useDebugValue=function(){};At.useDeferredValue=function(i){return Lr.current.useDeferredValue(i)};At.useEffect=function(i,s){return Lr.current.useEffect(i,s)};At.useId=function(){return Lr.current.useId()};At.useImperativeHandle=function(i,s,l){return Lr.current.useImperativeHandle(i,s,l)};At.useInsertionEffect=function(i,s){return Lr.current.useInsertionEffect(i,s)};At.useLayoutEffect=function(i,s){return Lr.current.useLayoutEffect(i,s)};At.useMemo=function(i,s){return Lr.current.useMemo(i,s)};At.useReducer=function(i,s,l){return Lr.current.useReducer(i,s,l)};At.useRef=function(i){return Lr.current.useRef(i)};At.useState=function(i){return Lr.current.useState(i)};At.useSyncExternalStore=function(i,s,l){return Lr.current.useSyncExternalStore(i,s,l)};At.useTransition=function(){return Lr.current.useTransition()};At.version="18.2.0";$0.exports=At;var He=$0.exports;const Ds=j0(He),Tb=ab({__proto__:null,default:Ds},[He]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ib=He,Cb=Symbol.for("react.element"),kb=Symbol.for("react.fragment"),Eb=Object.prototype.hasOwnProperty,Pb=Ib.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zb={key:!0,ref:!0,__self:!0,__source:!0};function Y0(i,s,l){var f,_={},T=null,w=null;l!==void 0&&(T=""+l),s.key!==void 0&&(T=""+s.key),s.ref!==void 0&&(w=s.ref);for(f in s)Eb.call(s,f)&&!zb.hasOwnProperty(f)&&(_[f]=s[f]);if(i&&i.defaultProps)for(f in s=i.defaultProps,s)_[f]===void 0&&(_[f]=s[f]);return{$$typeof:Cb,type:i,key:T,ref:w,props:_,_owner:Pb.current}}op.Fragment=kb;op.jsx=Y0;op.jsxs=Y0;U0.exports=op;var Ae=U0.exports,rm={},J0={exports:{}},un={},Q0={exports:{}},ev={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function s(Ge,ht){var dt=Ge.length;Ge.push(ht);e:for(;0<dt;){var Et=dt-1>>>1,Mt=Ge[Et];if(0<_(Mt,ht))Ge[Et]=ht,Ge[dt]=Mt,dt=Et;else break e}}function l(Ge){return Ge.length===0?null:Ge[0]}function f(Ge){if(Ge.length===0)return null;var ht=Ge[0],dt=Ge.pop();if(dt!==ht){Ge[0]=dt;e:for(var Et=0,Mt=Ge.length,Fr=Mt>>>1;Et<Fr;){var zi=2*(Et+1)-1,Hr=Ge[zi],Ri=zi+1,ji=Ge[Ri];if(0>_(Hr,dt))Ri<Mt&&0>_(ji,Hr)?(Ge[Et]=ji,Ge[Ri]=dt,Et=Ri):(Ge[Et]=Hr,Ge[zi]=dt,Et=zi);else if(Ri<Mt&&0>_(ji,dt))Ge[Et]=ji,Ge[Ri]=dt,Et=Ri;else break e}}return ht}function _(Ge,ht){var dt=Ge.sortIndex-ht.sortIndex;return dt!==0?dt:Ge.id-ht.id}if(typeof performance=="object"&&typeof performance.now=="function"){var T=performance;i.unstable_now=function(){return T.now()}}else{var w=Date,d=w.now();i.unstable_now=function(){return w.now()-d}}var N=[],J=[],he=1,X=null,U=3,ze=!1,ke=!1,Ee=!1,Ue=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function oe(Ge){for(var ht=l(J);ht!==null;){if(ht.callback===null)f(J);else if(ht.startTime<=Ge)f(J),ht.sortIndex=ht.expirationTime,s(N,ht);else break;ht=l(J)}}function ve(Ge){if(Ee=!1,oe(Ge),!ke)if(l(N)!==null)ke=!0,xr(Ne);else{var ht=l(J);ht!==null&&hn(ve,ht.startTime-Ge)}}function Ne(Ge,ht){ke=!1,Ee&&(Ee=!1,se(tt),tt=-1),ze=!0;var dt=U;try{for(oe(ht),X=l(N);X!==null&&(!(X.expirationTime>ht)||Ge&&!Ot());){var Et=X.callback;if(typeof Et=="function"){X.callback=null,U=X.priorityLevel;var Mt=Et(X.expirationTime<=ht);ht=i.unstable_now(),typeof Mt=="function"?X.callback=Mt:X===l(N)&&f(N),oe(ht)}else f(N);X=l(N)}if(X!==null)var Fr=!0;else{var zi=l(J);zi!==null&&hn(ve,zi.startTime-ht),Fr=!1}return Fr}finally{X=null,U=dt,ze=!1}}var Xe=!1,Ke=null,tt=-1,Dt=5,xt=-1;function Ot(){return!(i.unstable_now()-xt<Dt)}function Nt(){if(Ke!==null){var Ge=i.unstable_now();xt=Ge;var ht=!0;try{ht=Ke(!0,Ge)}finally{ht?si():(Xe=!1,Ke=null)}}else Xe=!1}var si;if(typeof Q=="function")si=function(){Q(Nt)};else if(typeof MessageChannel<"u"){var sr=new MessageChannel,kn=sr.port2;sr.port1.onmessage=Nt,si=function(){kn.postMessage(null)}}else si=function(){Ue(Nt,0)};function xr(Ge){Ke=Ge,Xe||(Xe=!0,si())}function hn(Ge,ht){tt=Ue(function(){Ge(i.unstable_now())},ht)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ge){Ge.callback=null},i.unstable_continueExecution=function(){ke||ze||(ke=!0,xr(Ne))},i.unstable_forceFrameRate=function(Ge){0>Ge||125<Ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Dt=0<Ge?Math.floor(1e3/Ge):5},i.unstable_getCurrentPriorityLevel=function(){return U},i.unstable_getFirstCallbackNode=function(){return l(N)},i.unstable_next=function(Ge){switch(U){case 1:case 2:case 3:var ht=3;break;default:ht=U}var dt=U;U=ht;try{return Ge()}finally{U=dt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Ge,ht){switch(Ge){case 1:case 2:case 3:case 4:case 5:break;default:Ge=3}var dt=U;U=Ge;try{return ht()}finally{U=dt}},i.unstable_scheduleCallback=function(Ge,ht,dt){var Et=i.unstable_now();switch(typeof dt=="object"&&dt!==null?(dt=dt.delay,dt=typeof dt=="number"&&0<dt?Et+dt:Et):dt=Et,Ge){case 1:var Mt=-1;break;case 2:Mt=250;break;case 5:Mt=1073741823;break;case 4:Mt=1e4;break;default:Mt=5e3}return Mt=dt+Mt,Ge={id:he++,callback:ht,priorityLevel:Ge,startTime:dt,expirationTime:Mt,sortIndex:-1},dt>Et?(Ge.sortIndex=dt,s(J,Ge),l(N)===null&&Ge===l(J)&&(Ee?(se(tt),tt=-1):Ee=!0,hn(ve,dt-Et))):(Ge.sortIndex=Mt,s(N,Ge),ke||ze||(ke=!0,xr(Ne))),Ge},i.unstable_shouldYield=Ot,i.unstable_wrapCallback=function(Ge){var ht=U;return function(){var dt=U;U=ht;try{return Ge.apply(this,arguments)}finally{U=dt}}}})(ev);Q0.exports=ev;var Ab=Q0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tv=He,ln=Ab;function Re(i){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+i,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iv=new Set,xc={};function Ta(i,s){Al(i,s),Al(i+"Capture",s)}function Al(i,s){for(xc[i]=s,i=0;i<s.length;i++)iv.add(s[i])}var Rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nm=Object.prototype.hasOwnProperty,Mb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C_={},k_={};function Db(i){return nm.call(k_,i)?!0:nm.call(C_,i)?!1:Mb.test(i)?k_[i]=!0:(C_[i]=!0,!1)}function Lb(i,s,l,f){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function Rb(i,s,l,f){if(s===null||typeof s>"u"||Lb(i,s,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Rr(i,s,l,f,_,T,w){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=f,this.attributeNamespace=_,this.mustUseProperty=l,this.propertyName=i,this.type=s,this.sanitizeURL=T,this.removeEmptyString=w}var nr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){nr[i]=new Rr(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var s=i[0];nr[s]=new Rr(s,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){nr[i]=new Rr(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){nr[i]=new Rr(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){nr[i]=new Rr(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){nr[i]=new Rr(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){nr[i]=new Rr(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){nr[i]=new Rr(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){nr[i]=new Rr(i,5,!1,i.toLowerCase(),null,!1,!1)});var ng=/[\-:]([a-z])/g;function sg(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var s=i.replace(ng,sg);nr[s]=new Rr(s,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var s=i.replace(ng,sg);nr[s]=new Rr(s,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var s=i.replace(ng,sg);nr[s]=new Rr(s,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){nr[i]=new Rr(i,1,!1,i.toLowerCase(),null,!1,!1)});nr.xlinkHref=new Rr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){nr[i]=new Rr(i,1,!1,i.toLowerCase(),null,!0,!0)});function og(i,s,l,f){var _=nr.hasOwnProperty(s)?nr[s]:null;(_!==null?_.type!==0:f||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Rb(s,l,_,f)&&(l=null),f||_===null?Db(s)&&(l===null?i.removeAttribute(s):i.setAttribute(s,""+l)):_.mustUseProperty?i[_.propertyName]=l===null?_.type===3?!1:"":l:(s=_.attributeName,f=_.attributeNamespace,l===null?i.removeAttribute(s):(_=_.type,l=_===3||_===4&&l===!0?"":""+l,f?i.setAttributeNS(f,s,l):i.setAttribute(s,l))))}var Ns=tv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,td=Symbol.for("react.element"),pl=Symbol.for("react.portal"),fl=Symbol.for("react.fragment"),ag=Symbol.for("react.strict_mode"),sm=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),nv=Symbol.for("react.context"),lg=Symbol.for("react.forward_ref"),om=Symbol.for("react.suspense"),am=Symbol.for("react.suspense_list"),ug=Symbol.for("react.memo"),vo=Symbol.for("react.lazy"),sv=Symbol.for("react.offscreen"),E_=Symbol.iterator;function Ju(i){return i===null||typeof i!="object"?null:(i=E_&&i[E_]||i["@@iterator"],typeof i=="function"?i:null)}var gi=Object.assign,zf;function oc(i){if(zf===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);zf=s&&s[1]||""}return`
`+zf+i}var Af=!1;function Mf(i,s){if(!i||Af)return"";Af=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(J){var f=J}Reflect.construct(i,[],s)}else{try{s.call()}catch(J){f=J}i.call(s.prototype)}else{try{throw Error()}catch(J){f=J}i()}}catch(J){if(J&&f&&typeof J.stack=="string"){for(var _=J.stack.split(`
`),T=f.stack.split(`
`),w=_.length-1,d=T.length-1;1<=w&&0<=d&&_[w]!==T[d];)d--;for(;1<=w&&0<=d;w--,d--)if(_[w]!==T[d]){if(w!==1||d!==1)do if(w--,d--,0>d||_[w]!==T[d]){var N=`
`+_[w].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=w&&0<=d);break}}}finally{Af=!1,Error.prepareStackTrace=l}return(i=i?i.displayName||i.name:"")?oc(i):""}function Fb(i){switch(i.tag){case 5:return oc(i.type);case 16:return oc("Lazy");case 13:return oc("Suspense");case 19:return oc("SuspenseList");case 0:case 2:case 15:return i=Mf(i.type,!1),i;case 11:return i=Mf(i.type.render,!1),i;case 1:return i=Mf(i.type,!0),i;default:return""}}function lm(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case fl:return"Fragment";case pl:return"Portal";case sm:return"Profiler";case ag:return"StrictMode";case om:return"Suspense";case am:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case nv:return(i.displayName||"Context")+".Consumer";case rv:return(i._context.displayName||"Context")+".Provider";case lg:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ug:return s=i.displayName||null,s!==null?s:lm(i.type)||"Memo";case vo:s=i._payload,i=i._init;try{return lm(i(s))}catch{}}return null}function Bb(i){var s=i.type;switch(i.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=s.render,i=i.displayName||i.name||"",s.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lm(s);case 8:return s===ag?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ro(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ov(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ob(i){var s=ov(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var _=l.get,T=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return _.call(this)},set:function(w){f=""+w,T.call(this,w)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(w){f=""+w},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function id(i){i._valueTracker||(i._valueTracker=Ob(i))}function av(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return i&&(f=ov(i)?i.checked?"true":"false":i.value),i=f,i!==l?(s.setValue(i),!0):!1}function Ad(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function um(i,s){var l=s.checked;return gi({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??i._wrapperState.initialChecked})}function P_(i,s){var l=s.defaultValue==null?"":s.defaultValue,f=s.checked!=null?s.checked:s.defaultChecked;l=Ro(s.value!=null?s.value:l),i._wrapperState={initialChecked:f,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function lv(i,s){s=s.checked,s!=null&&og(i,"checked",s,!1)}function cm(i,s){lv(i,s);var l=Ro(s.value),f=s.type;if(l!=null)f==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+l):i.value!==""+l&&(i.value=""+l);else if(f==="submit"||f==="reset"){i.removeAttribute("value");return}s.hasOwnProperty("value")?hm(i,s.type,l):s.hasOwnProperty("defaultValue")&&hm(i,s.type,Ro(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(i.defaultChecked=!!s.defaultChecked)}function z_(i,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var f=s.type;if(!(f!=="submit"&&f!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+i._wrapperState.initialValue,l||s===i.value||(i.value=s),i.defaultValue=s}l=i.name,l!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,l!==""&&(i.name=l)}function hm(i,s,l){(s!=="number"||Ad(i.ownerDocument)!==i)&&(l==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+l&&(i.defaultValue=""+l))}var ac=Array.isArray;function Il(i,s,l,f){if(i=i.options,s){s={};for(var _=0;_<l.length;_++)s["$"+l[_]]=!0;for(l=0;l<i.length;l++)_=s.hasOwnProperty("$"+i[l].value),i[l].selected!==_&&(i[l].selected=_),_&&f&&(i[l].defaultSelected=!0)}else{for(l=""+Ro(l),s=null,_=0;_<i.length;_++){if(i[_].value===l){i[_].selected=!0,f&&(i[_].defaultSelected=!0);return}s!==null||i[_].disabled||(s=i[_])}s!==null&&(s.selected=!0)}}function dm(i,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Re(91));return gi({},s,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function A_(i,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(Re(92));if(ac(l)){if(1<l.length)throw Error(Re(93));l=l[0]}s=l}s==null&&(s=""),l=s}i._wrapperState={initialValue:Ro(l)}}function uv(i,s){var l=Ro(s.value),f=Ro(s.defaultValue);l!=null&&(l=""+l,l!==i.value&&(i.value=l),s.defaultValue==null&&i.defaultValue!==l&&(i.defaultValue=l)),f!=null&&(i.defaultValue=""+f)}function M_(i){var s=i.textContent;s===i._wrapperState.initialValue&&s!==""&&s!==null&&(i.value=s)}function cv(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pm(i,s){return i==null||i==="http://www.w3.org/1999/xhtml"?cv(s):i==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var rd,hv=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,f,_){MSApp.execUnsafeLocalFunction(function(){return i(s,l,f,_)})}:i}(function(i,s){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=s;else{for(rd=rd||document.createElement("div"),rd.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=rd.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;s.firstChild;)i.appendChild(s.firstChild)}});function wc(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var hc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nb=["Webkit","ms","Moz","O"];Object.keys(hc).forEach(function(i){Nb.forEach(function(s){s=s+i.charAt(0).toUpperCase()+i.substring(1),hc[s]=hc[i]})});function dv(i,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||hc.hasOwnProperty(i)&&hc[i]?(""+s).trim():s+"px"}function pv(i,s){i=i.style;for(var l in s)if(s.hasOwnProperty(l)){var f=l.indexOf("--")===0,_=dv(l,s[l],f);l==="float"&&(l="cssFloat"),f?i.setProperty(l,_):i[l]=_}}var Vb=gi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fm(i,s){if(s){if(Vb[i]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Re(137,i));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Re(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Re(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Re(62))}}function mm(i,s){if(i.indexOf("-")===-1)return typeof s.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gm=null;function cg(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ym=null,Cl=null,kl=null;function D_(i){if(i=Uc(i)){if(typeof ym!="function")throw Error(Re(280));var s=i.stateNode;s&&(s=hp(s),ym(i.stateNode,i.type,s))}}function fv(i){Cl?kl?kl.push(i):kl=[i]:Cl=i}function mv(){if(Cl){var i=Cl,s=kl;if(kl=Cl=null,D_(i),s)for(i=0;i<s.length;i++)D_(s[i])}}function gv(i,s){return i(s)}function yv(){}var Df=!1;function _v(i,s,l){if(Df)return i(s,l);Df=!0;try{return gv(i,s,l)}finally{Df=!1,(Cl!==null||kl!==null)&&(yv(),mv())}}function bc(i,s){var l=i.stateNode;if(l===null)return null;var f=hp(l);if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(Re(231,s,typeof l));return l}var _m=!1;if(Rs)try{var Qu={};Object.defineProperty(Qu,"passive",{get:function(){_m=!0}}),window.addEventListener("test",Qu,Qu),window.removeEventListener("test",Qu,Qu)}catch{_m=!1}function jb(i,s,l,f,_,T,w,d,N){var J=Array.prototype.slice.call(arguments,3);try{s.apply(l,J)}catch(he){this.onError(he)}}var dc=!1,Md=null,Dd=!1,vm=null,Ub={onError:function(i){dc=!0,Md=i}};function $b(i,s,l,f,_,T,w,d,N){dc=!1,Md=null,jb.apply(Ub,arguments)}function Zb(i,s,l,f,_,T,w,d,N){if($b.apply(this,arguments),dc){if(dc){var J=Md;dc=!1,Md=null}else throw Error(Re(198));Dd||(Dd=!0,vm=J)}}function Ia(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,s.flags&4098&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function vv(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function L_(i){if(Ia(i)!==i)throw Error(Re(188))}function qb(i){var s=i.alternate;if(!s){if(s=Ia(i),s===null)throw Error(Re(188));return s!==i?null:i}for(var l=i,f=s;;){var _=l.return;if(_===null)break;var T=_.alternate;if(T===null){if(f=_.return,f!==null){l=f;continue}break}if(_.child===T.child){for(T=_.child;T;){if(T===l)return L_(_),i;if(T===f)return L_(_),s;T=T.sibling}throw Error(Re(188))}if(l.return!==f.return)l=_,f=T;else{for(var w=!1,d=_.child;d;){if(d===l){w=!0,l=_,f=T;break}if(d===f){w=!0,f=_,l=T;break}d=d.sibling}if(!w){for(d=T.child;d;){if(d===l){w=!0,l=T,f=_;break}if(d===f){w=!0,f=T,l=_;break}d=d.sibling}if(!w)throw Error(Re(189))}}if(l.alternate!==f)throw Error(Re(190))}if(l.tag!==3)throw Error(Re(188));return l.stateNode.current===l?i:s}function xv(i){return i=qb(i),i!==null?wv(i):null}function wv(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var s=wv(i);if(s!==null)return s;i=i.sibling}return null}var bv=ln.unstable_scheduleCallback,R_=ln.unstable_cancelCallback,Gb=ln.unstable_shouldYield,Hb=ln.unstable_requestPaint,Pi=ln.unstable_now,Wb=ln.unstable_getCurrentPriorityLevel,hg=ln.unstable_ImmediatePriority,Sv=ln.unstable_UserBlockingPriority,Ld=ln.unstable_NormalPriority,Kb=ln.unstable_LowPriority,Tv=ln.unstable_IdlePriority,ap=null,ns=null;function Xb(i){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(ap,i,void 0,(i.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:Qb,Yb=Math.log,Jb=Math.LN2;function Qb(i){return i>>>=0,i===0?32:31-(Yb(i)/Jb|0)|0}var nd=64,sd=4194304;function lc(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Rd(i,s){var l=i.pendingLanes;if(l===0)return 0;var f=0,_=i.suspendedLanes,T=i.pingedLanes,w=l&268435455;if(w!==0){var d=w&~_;d!==0?f=lc(d):(T&=w,T!==0&&(f=lc(T)))}else w=l&~_,w!==0?f=lc(w):T!==0&&(f=lc(T));if(f===0)return 0;if(s!==0&&s!==f&&!(s&_)&&(_=f&-f,T=s&-s,_>=T||_===16&&(T&4194240)!==0))return s;if(f&4&&(f|=l&16),s=i.entangledLanes,s!==0)for(i=i.entanglements,s&=f;0<s;)l=31-Nn(s),_=1<<l,f|=i[l],s&=~_;return f}function e2(i,s){switch(i){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function t2(i,s){for(var l=i.suspendedLanes,f=i.pingedLanes,_=i.expirationTimes,T=i.pendingLanes;0<T;){var w=31-Nn(T),d=1<<w,N=_[w];N===-1?(!(d&l)||d&f)&&(_[w]=e2(d,s)):N<=s&&(i.expiredLanes|=d),T&=~d}}function xm(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Iv(){var i=nd;return nd<<=1,!(nd&4194240)&&(nd=64),i}function Lf(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function Vc(i,s,l){i.pendingLanes|=s,s!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,s=31-Nn(s),i[s]=l}function i2(i,s){var l=i.pendingLanes&~s;i.pendingLanes=s,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=s,i.mutableReadLanes&=s,i.entangledLanes&=s,s=i.entanglements;var f=i.eventTimes;for(i=i.expirationTimes;0<l;){var _=31-Nn(l),T=1<<_;s[_]=0,f[_]=-1,i[_]=-1,l&=~T}}function dg(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var f=31-Nn(l),_=1<<f;_&s|i[f]&s&&(i[f]|=s),l&=~_}}var qt=0;function Cv(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var kv,pg,Ev,Pv,zv,wm=!1,od=[],Co=null,ko=null,Eo=null,Sc=new Map,Tc=new Map,wo=[],r2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function F_(i,s){switch(i){case"focusin":case"focusout":Co=null;break;case"dragenter":case"dragleave":ko=null;break;case"mouseover":case"mouseout":Eo=null;break;case"pointerover":case"pointerout":Sc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tc.delete(s.pointerId)}}function ec(i,s,l,f,_,T){return i===null||i.nativeEvent!==T?(i={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:T,targetContainers:[_]},s!==null&&(s=Uc(s),s!==null&&pg(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),i)}function n2(i,s,l,f,_){switch(s){case"focusin":return Co=ec(Co,i,s,l,f,_),!0;case"dragenter":return ko=ec(ko,i,s,l,f,_),!0;case"mouseover":return Eo=ec(Eo,i,s,l,f,_),!0;case"pointerover":var T=_.pointerId;return Sc.set(T,ec(Sc.get(T)||null,i,s,l,f,_)),!0;case"gotpointercapture":return T=_.pointerId,Tc.set(T,ec(Tc.get(T)||null,i,s,l,f,_)),!0}return!1}function Av(i){var s=fa(i.target);if(s!==null){var l=Ia(s);if(l!==null){if(s=l.tag,s===13){if(s=vv(l),s!==null){i.blockedOn=s,zv(i.priority,function(){Ev(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function wd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=bm(i.domEventName,i.eventSystemFlags,s[0],i.nativeEvent);if(l===null){l=i.nativeEvent;var f=new l.constructor(l.type,l);gm=f,l.target.dispatchEvent(f),gm=null}else return s=Uc(l),s!==null&&pg(s),i.blockedOn=l,!1;s.shift()}return!0}function B_(i,s,l){wd(i)&&l.delete(s)}function s2(){wm=!1,Co!==null&&wd(Co)&&(Co=null),ko!==null&&wd(ko)&&(ko=null),Eo!==null&&wd(Eo)&&(Eo=null),Sc.forEach(B_),Tc.forEach(B_)}function tc(i,s){i.blockedOn===s&&(i.blockedOn=null,wm||(wm=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,s2)))}function Ic(i){function s(_){return tc(_,i)}if(0<od.length){tc(od[0],i);for(var l=1;l<od.length;l++){var f=od[l];f.blockedOn===i&&(f.blockedOn=null)}}for(Co!==null&&tc(Co,i),ko!==null&&tc(ko,i),Eo!==null&&tc(Eo,i),Sc.forEach(s),Tc.forEach(s),l=0;l<wo.length;l++)f=wo[l],f.blockedOn===i&&(f.blockedOn=null);for(;0<wo.length&&(l=wo[0],l.blockedOn===null);)Av(l),l.blockedOn===null&&wo.shift()}var El=Ns.ReactCurrentBatchConfig,Fd=!0;function o2(i,s,l,f){var _=qt,T=El.transition;El.transition=null;try{qt=1,fg(i,s,l,f)}finally{qt=_,El.transition=T}}function a2(i,s,l,f){var _=qt,T=El.transition;El.transition=null;try{qt=4,fg(i,s,l,f)}finally{qt=_,El.transition=T}}function fg(i,s,l,f){if(Fd){var _=bm(i,s,l,f);if(_===null)Zf(i,s,f,Bd,l),F_(i,f);else if(n2(_,i,s,l,f))f.stopPropagation();else if(F_(i,f),s&4&&-1<r2.indexOf(i)){for(;_!==null;){var T=Uc(_);if(T!==null&&kv(T),T=bm(i,s,l,f),T===null&&Zf(i,s,f,Bd,l),T===_)break;_=T}_!==null&&f.stopPropagation()}else Zf(i,s,f,null,l)}}var Bd=null;function bm(i,s,l,f){if(Bd=null,i=cg(f),i=fa(i),i!==null)if(s=Ia(i),s===null)i=null;else if(l=s.tag,l===13){if(i=vv(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null);return Bd=i,null}function Mv(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wb()){case hg:return 1;case Sv:return 4;case Ld:case Kb:return 16;case Tv:return 536870912;default:return 16}default:return 16}}var So=null,mg=null,bd=null;function Dv(){if(bd)return bd;var i,s=mg,l=s.length,f,_="value"in So?So.value:So.textContent,T=_.length;for(i=0;i<l&&s[i]===_[i];i++);var w=l-i;for(f=1;f<=w&&s[l-f]===_[T-f];f++);return bd=_.slice(i,1<f?1-f:void 0)}function Sd(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function ad(){return!0}function O_(){return!1}function cn(i){function s(l,f,_,T,w){this._reactName=l,this._targetInst=_,this.type=f,this.nativeEvent=T,this.target=w,this.currentTarget=null;for(var d in i)i.hasOwnProperty(d)&&(l=i[d],this[d]=l?l(T):T[d]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?ad:O_,this.isPropagationStopped=O_,this}return gi(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ad)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ad)},persist:function(){},isPersistent:ad}),s}var Vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=cn(Vl),jc=gi({},Vl,{view:0,detail:0}),l2=cn(jc),Rf,Ff,ic,lp=gi({},jc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ic&&(ic&&i.type==="mousemove"?(Rf=i.screenX-ic.screenX,Ff=i.screenY-ic.screenY):Ff=Rf=0,ic=i),Rf)},movementY:function(i){return"movementY"in i?i.movementY:Ff}}),N_=cn(lp),u2=gi({},lp,{dataTransfer:0}),c2=cn(u2),h2=gi({},jc,{relatedTarget:0}),Bf=cn(h2),d2=gi({},Vl,{animationName:0,elapsedTime:0,pseudoElement:0}),p2=cn(d2),f2=gi({},Vl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),m2=cn(f2),g2=gi({},Vl,{data:0}),V_=cn(g2),y2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x2(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=v2[i])?!!s[i]:!1}function yg(){return x2}var w2=gi({},jc,{key:function(i){if(i.key){var s=y2[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Sd(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?_2[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yg,charCode:function(i){return i.type==="keypress"?Sd(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Sd(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),b2=cn(w2),S2=gi({},lp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j_=cn(S2),T2=gi({},jc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yg}),I2=cn(T2),C2=gi({},Vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),k2=cn(C2),E2=gi({},lp,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),P2=cn(E2),z2=[9,13,27,32],_g=Rs&&"CompositionEvent"in window,pc=null;Rs&&"documentMode"in document&&(pc=document.documentMode);var A2=Rs&&"TextEvent"in window&&!pc,Lv=Rs&&(!_g||pc&&8<pc&&11>=pc),U_=" ",$_=!1;function Rv(i,s){switch(i){case"keyup":return z2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fv(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ml=!1;function M2(i,s){switch(i){case"compositionend":return Fv(s);case"keypress":return s.which!==32?null:($_=!0,U_);case"textInput":return i=s.data,i===U_&&$_?null:i;default:return null}}function D2(i,s){if(ml)return i==="compositionend"||!_g&&Rv(i,s)?(i=Dv(),bd=mg=So=null,ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Lv&&s.locale!=="ko"?null:s.data;default:return null}}var L2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Z_(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!L2[i.type]:s==="textarea"}function Bv(i,s,l,f){fv(f),s=Od(s,"onChange"),0<s.length&&(l=new gg("onChange","change",null,l,f),i.push({event:l,listeners:s}))}var fc=null,Cc=null;function R2(i){Wv(i,0)}function up(i){var s=_l(i);if(av(s))return i}function F2(i,s){if(i==="change")return s}var Ov=!1;if(Rs){var Of;if(Rs){var Nf="oninput"in document;if(!Nf){var q_=document.createElement("div");q_.setAttribute("oninput","return;"),Nf=typeof q_.oninput=="function"}Of=Nf}else Of=!1;Ov=Of&&(!document.documentMode||9<document.documentMode)}function G_(){fc&&(fc.detachEvent("onpropertychange",Nv),Cc=fc=null)}function Nv(i){if(i.propertyName==="value"&&up(Cc)){var s=[];Bv(s,Cc,i,cg(i)),_v(R2,s)}}function B2(i,s,l){i==="focusin"?(G_(),fc=s,Cc=l,fc.attachEvent("onpropertychange",Nv)):i==="focusout"&&G_()}function O2(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return up(Cc)}function N2(i,s){if(i==="click")return up(s)}function V2(i,s){if(i==="input"||i==="change")return up(s)}function j2(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var jn=typeof Object.is=="function"?Object.is:j2;function kc(i,s){if(jn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var _=l[f];if(!nm.call(s,_)||!jn(i[_],s[_]))return!1}return!0}function H_(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function W_(i,s){var l=H_(i);i=0;for(var f;l;){if(l.nodeType===3){if(f=i+l.textContent.length,i<=s&&f>=s)return{node:l,offset:s-i};i=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=H_(l)}}function Vv(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Vv(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function jv(){for(var i=window,s=Ad();s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=Ad(i.document)}return s}function vg(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function U2(i){var s=jv(),l=i.focusedElem,f=i.selectionRange;if(s!==l&&l&&l.ownerDocument&&Vv(l.ownerDocument.documentElement,l)){if(f!==null&&vg(l)){if(s=f.start,i=f.end,i===void 0&&(i=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(i,l.value.length);else if(i=(s=l.ownerDocument||document)&&s.defaultView||window,i.getSelection){i=i.getSelection();var _=l.textContent.length,T=Math.min(f.start,_);f=f.end===void 0?T:Math.min(f.end,_),!i.extend&&T>f&&(_=f,f=T,T=_),_=W_(l,T);var w=W_(l,f);_&&w&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==w.node||i.focusOffset!==w.offset)&&(s=s.createRange(),s.setStart(_.node,_.offset),i.removeAllRanges(),T>f?(i.addRange(s),i.extend(w.node,w.offset)):(s.setEnd(w.node,w.offset),i.addRange(s)))}}for(s=[],i=l;i=i.parentNode;)i.nodeType===1&&s.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)i=s[l],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var $2=Rs&&"documentMode"in document&&11>=document.documentMode,gl=null,Sm=null,mc=null,Tm=!1;function K_(i,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Tm||gl==null||gl!==Ad(f)||(f=gl,"selectionStart"in f&&vg(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),mc&&kc(mc,f)||(mc=f,f=Od(Sm,"onSelect"),0<f.length&&(s=new gg("onSelect","select",null,s,l),i.push({event:s,listeners:f}),s.target=gl)))}function ld(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var yl={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},Vf={},Uv={};Rs&&(Uv=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function cp(i){if(Vf[i])return Vf[i];if(!yl[i])return i;var s=yl[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in Uv)return Vf[i]=s[l];return i}var $v=cp("animationend"),Zv=cp("animationiteration"),qv=cp("animationstart"),Gv=cp("transitionend"),Hv=new Map,X_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bo(i,s){Hv.set(i,s),Ta(s,[i])}for(var jf=0;jf<X_.length;jf++){var Uf=X_[jf],Z2=Uf.toLowerCase(),q2=Uf[0].toUpperCase()+Uf.slice(1);Bo(Z2,"on"+q2)}Bo($v,"onAnimationEnd");Bo(Zv,"onAnimationIteration");Bo(qv,"onAnimationStart");Bo("dblclick","onDoubleClick");Bo("focusin","onFocus");Bo("focusout","onBlur");Bo(Gv,"onTransitionEnd");Al("onMouseEnter",["mouseout","mouseover"]);Al("onMouseLeave",["mouseout","mouseover"]);Al("onPointerEnter",["pointerout","pointerover"]);Al("onPointerLeave",["pointerout","pointerover"]);Ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ta("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G2=new Set("cancel close invalid load scroll toggle".split(" ").concat(uc));function Y_(i,s,l){var f=i.type||"unknown-event";i.currentTarget=l,Zb(f,s,void 0,i),i.currentTarget=null}function Wv(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var f=i[l],_=f.event;f=f.listeners;e:{var T=void 0;if(s)for(var w=f.length-1;0<=w;w--){var d=f[w],N=d.instance,J=d.currentTarget;if(d=d.listener,N!==T&&_.isPropagationStopped())break e;Y_(_,d,J),T=N}else for(w=0;w<f.length;w++){if(d=f[w],N=d.instance,J=d.currentTarget,d=d.listener,N!==T&&_.isPropagationStopped())break e;Y_(_,d,J),T=N}}}if(Dd)throw i=vm,Dd=!1,vm=null,i}function ri(i,s){var l=s[Pm];l===void 0&&(l=s[Pm]=new Set);var f=i+"__bubble";l.has(f)||(Kv(s,i,2,!1),l.add(f))}function $f(i,s,l){var f=0;s&&(f|=4),Kv(l,i,f,s)}var ud="_reactListening"+Math.random().toString(36).slice(2);function Ec(i){if(!i[ud]){i[ud]=!0,iv.forEach(function(l){l!=="selectionchange"&&(G2.has(l)||$f(l,!1,i),$f(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[ud]||(s[ud]=!0,$f("selectionchange",!1,s))}}function Kv(i,s,l,f){switch(Mv(s)){case 1:var _=o2;break;case 4:_=a2;break;default:_=fg}l=_.bind(null,s,l,i),_=void 0,!_m||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),f?_!==void 0?i.addEventListener(s,l,{capture:!0,passive:_}):i.addEventListener(s,l,!0):_!==void 0?i.addEventListener(s,l,{passive:_}):i.addEventListener(s,l,!1)}function Zf(i,s,l,f,_){var T=f;if(!(s&1)&&!(s&2)&&f!==null)e:for(;;){if(f===null)return;var w=f.tag;if(w===3||w===4){var d=f.stateNode.containerInfo;if(d===_||d.nodeType===8&&d.parentNode===_)break;if(w===4)for(w=f.return;w!==null;){var N=w.tag;if((N===3||N===4)&&(N=w.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;w=w.return}for(;d!==null;){if(w=fa(d),w===null)return;if(N=w.tag,N===5||N===6){f=T=w;continue e}d=d.parentNode}}f=f.return}_v(function(){var J=T,he=cg(l),X=[];e:{var U=Hv.get(i);if(U!==void 0){var ze=gg,ke=i;switch(i){case"keypress":if(Sd(l)===0)break e;case"keydown":case"keyup":ze=b2;break;case"focusin":ke="focus",ze=Bf;break;case"focusout":ke="blur",ze=Bf;break;case"beforeblur":case"afterblur":ze=Bf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=N_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=c2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=I2;break;case $v:case Zv:case qv:ze=p2;break;case Gv:ze=k2;break;case"scroll":ze=l2;break;case"wheel":ze=P2;break;case"copy":case"cut":case"paste":ze=m2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=j_}var Ee=(s&4)!==0,Ue=!Ee&&i==="scroll",se=Ee?U!==null?U+"Capture":null:U;Ee=[];for(var Q=J,oe;Q!==null;){oe=Q;var ve=oe.stateNode;if(oe.tag===5&&ve!==null&&(oe=ve,se!==null&&(ve=bc(Q,se),ve!=null&&Ee.push(Pc(Q,ve,oe)))),Ue)break;Q=Q.return}0<Ee.length&&(U=new ze(U,ke,null,l,he),X.push({event:U,listeners:Ee}))}}if(!(s&7)){e:{if(U=i==="mouseover"||i==="pointerover",ze=i==="mouseout"||i==="pointerout",U&&l!==gm&&(ke=l.relatedTarget||l.fromElement)&&(fa(ke)||ke[Fs]))break e;if((ze||U)&&(U=he.window===he?he:(U=he.ownerDocument)?U.defaultView||U.parentWindow:window,ze?(ke=l.relatedTarget||l.toElement,ze=J,ke=ke?fa(ke):null,ke!==null&&(Ue=Ia(ke),ke!==Ue||ke.tag!==5&&ke.tag!==6)&&(ke=null)):(ze=null,ke=J),ze!==ke)){if(Ee=N_,ve="onMouseLeave",se="onMouseEnter",Q="mouse",(i==="pointerout"||i==="pointerover")&&(Ee=j_,ve="onPointerLeave",se="onPointerEnter",Q="pointer"),Ue=ze==null?U:_l(ze),oe=ke==null?U:_l(ke),U=new Ee(ve,Q+"leave",ze,l,he),U.target=Ue,U.relatedTarget=oe,ve=null,fa(he)===J&&(Ee=new Ee(se,Q+"enter",ke,l,he),Ee.target=oe,Ee.relatedTarget=Ue,ve=Ee),Ue=ve,ze&&ke)t:{for(Ee=ze,se=ke,Q=0,oe=Ee;oe;oe=dl(oe))Q++;for(oe=0,ve=se;ve;ve=dl(ve))oe++;for(;0<Q-oe;)Ee=dl(Ee),Q--;for(;0<oe-Q;)se=dl(se),oe--;for(;Q--;){if(Ee===se||se!==null&&Ee===se.alternate)break t;Ee=dl(Ee),se=dl(se)}Ee=null}else Ee=null;ze!==null&&J_(X,U,ze,Ee,!1),ke!==null&&Ue!==null&&J_(X,Ue,ke,Ee,!0)}}e:{if(U=J?_l(J):window,ze=U.nodeName&&U.nodeName.toLowerCase(),ze==="select"||ze==="input"&&U.type==="file")var Ne=F2;else if(Z_(U))if(Ov)Ne=V2;else{Ne=O2;var Xe=B2}else(ze=U.nodeName)&&ze.toLowerCase()==="input"&&(U.type==="checkbox"||U.type==="radio")&&(Ne=N2);if(Ne&&(Ne=Ne(i,J))){Bv(X,Ne,l,he);break e}Xe&&Xe(i,U,J),i==="focusout"&&(Xe=U._wrapperState)&&Xe.controlled&&U.type==="number"&&hm(U,"number",U.value)}switch(Xe=J?_l(J):window,i){case"focusin":(Z_(Xe)||Xe.contentEditable==="true")&&(gl=Xe,Sm=J,mc=null);break;case"focusout":mc=Sm=gl=null;break;case"mousedown":Tm=!0;break;case"contextmenu":case"mouseup":case"dragend":Tm=!1,K_(X,l,he);break;case"selectionchange":if($2)break;case"keydown":case"keyup":K_(X,l,he)}var Ke;if(_g)e:{switch(i){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else ml?Rv(i,l)&&(tt="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(tt="onCompositionStart");tt&&(Lv&&l.locale!=="ko"&&(ml||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&ml&&(Ke=Dv()):(So=he,mg="value"in So?So.value:So.textContent,ml=!0)),Xe=Od(J,tt),0<Xe.length&&(tt=new V_(tt,i,null,l,he),X.push({event:tt,listeners:Xe}),Ke?tt.data=Ke:(Ke=Fv(l),Ke!==null&&(tt.data=Ke)))),(Ke=A2?M2(i,l):D2(i,l))&&(J=Od(J,"onBeforeInput"),0<J.length&&(he=new V_("onBeforeInput","beforeinput",null,l,he),X.push({event:he,listeners:J}),he.data=Ke))}Wv(X,s)})}function Pc(i,s,l){return{instance:i,listener:s,currentTarget:l}}function Od(i,s){for(var l=s+"Capture",f=[];i!==null;){var _=i,T=_.stateNode;_.tag===5&&T!==null&&(_=T,T=bc(i,l),T!=null&&f.unshift(Pc(i,T,_)),T=bc(i,s),T!=null&&f.push(Pc(i,T,_))),i=i.return}return f}function dl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function J_(i,s,l,f,_){for(var T=s._reactName,w=[];l!==null&&l!==f;){var d=l,N=d.alternate,J=d.stateNode;if(N!==null&&N===f)break;d.tag===5&&J!==null&&(d=J,_?(N=bc(l,T),N!=null&&w.unshift(Pc(l,N,d))):_||(N=bc(l,T),N!=null&&w.push(Pc(l,N,d)))),l=l.return}w.length!==0&&i.push({event:s,listeners:w})}var H2=/\r\n?/g,W2=/\u0000|\uFFFD/g;function Q_(i){return(typeof i=="string"?i:""+i).replace(H2,`
`).replace(W2,"")}function cd(i,s,l){if(s=Q_(s),Q_(i)!==s&&l)throw Error(Re(425))}function Nd(){}var Im=null,Cm=null;function km(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Em=typeof setTimeout=="function"?setTimeout:void 0,K2=typeof clearTimeout=="function"?clearTimeout:void 0,e0=typeof Promise=="function"?Promise:void 0,X2=typeof queueMicrotask=="function"?queueMicrotask:typeof e0<"u"?function(i){return e0.resolve(null).then(i).catch(Y2)}:Em;function Y2(i){setTimeout(function(){throw i})}function qf(i,s){var l=s,f=0;do{var _=l.nextSibling;if(i.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(f===0){i.removeChild(_),Ic(s);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=_}while(l);Ic(s)}function Po(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return i}function t0(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}var jl=Math.random().toString(36).slice(2),rs="__reactFiber$"+jl,zc="__reactProps$"+jl,Fs="__reactContainer$"+jl,Pm="__reactEvents$"+jl,J2="__reactListeners$"+jl,Q2="__reactHandles$"+jl;function fa(i){var s=i[rs];if(s)return s;for(var l=i.parentNode;l;){if(s=l[Fs]||l[rs]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=t0(i);i!==null;){if(l=i[rs])return l;i=t0(i)}return s}i=l,l=i.parentNode}return null}function Uc(i){return i=i[rs]||i[Fs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function _l(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Re(33))}function hp(i){return i[zc]||null}var zm=[],vl=-1;function Oo(i){return{current:i}}function ni(i){0>vl||(i.current=zm[vl],zm[vl]=null,vl--)}function Qt(i,s){vl++,zm[vl]=i.current,i.current=s}var Fo={},vr=Oo(Fo),Zr=Oo(!1),va=Fo;function Ml(i,s){var l=i.type.contextTypes;if(!l)return Fo;var f=i.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===s)return f.__reactInternalMemoizedMaskedChildContext;var _={},T;for(T in l)_[T]=s[T];return f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=_),_}function qr(i){return i=i.childContextTypes,i!=null}function Vd(){ni(Zr),ni(vr)}function i0(i,s,l){if(vr.current!==Fo)throw Error(Re(168));Qt(vr,s),Qt(Zr,l)}function Xv(i,s,l){var f=i.stateNode;if(s=s.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var _ in f)if(!(_ in s))throw Error(Re(108,Bb(i)||"Unknown",_));return gi({},l,f)}function jd(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Fo,va=vr.current,Qt(vr,i),Qt(Zr,Zr.current),!0}function r0(i,s,l){var f=i.stateNode;if(!f)throw Error(Re(169));l?(i=Xv(i,s,va),f.__reactInternalMemoizedMergedChildContext=i,ni(Zr),ni(vr),Qt(vr,i)):ni(Zr),Qt(Zr,l)}var zs=null,dp=!1,Gf=!1;function Yv(i){zs===null?zs=[i]:zs.push(i)}function eS(i){dp=!0,Yv(i)}function No(){if(!Gf&&zs!==null){Gf=!0;var i=0,s=qt;try{var l=zs;for(qt=1;i<l.length;i++){var f=l[i];do f=f(!0);while(f!==null)}zs=null,dp=!1}catch(_){throw zs!==null&&(zs=zs.slice(i+1)),bv(hg,No),_}finally{qt=s,Gf=!1}}return null}var xl=[],wl=0,Ud=null,$d=0,wn=[],bn=0,xa=null,As=1,Ms="";function da(i,s){xl[wl++]=$d,xl[wl++]=Ud,Ud=i,$d=s}function Jv(i,s,l){wn[bn++]=As,wn[bn++]=Ms,wn[bn++]=xa,xa=i;var f=As;i=Ms;var _=32-Nn(f)-1;f&=~(1<<_),l+=1;var T=32-Nn(s)+_;if(30<T){var w=_-_%5;T=(f&(1<<w)-1).toString(32),f>>=w,_-=w,As=1<<32-Nn(s)+_|l<<_|f,Ms=T+i}else As=1<<T|l<<_|f,Ms=i}function xg(i){i.return!==null&&(da(i,1),Jv(i,1,0))}function wg(i){for(;i===Ud;)Ud=xl[--wl],xl[wl]=null,$d=xl[--wl],xl[wl]=null;for(;i===xa;)xa=wn[--bn],wn[bn]=null,Ms=wn[--bn],wn[bn]=null,As=wn[--bn],wn[bn]=null}var an=null,on=null,ui=!1,On=null;function Qv(i,s){var l=Sn(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=i,s=i.deletions,s===null?(i.deletions=[l],i.flags|=16):s.push(l)}function n0(i,s){switch(i.tag){case 5:var l=i.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(i.stateNode=s,an=i,on=Po(s.firstChild),!0):!1;case 6:return s=i.pendingProps===""||s.nodeType!==3?null:s,s!==null?(i.stateNode=s,an=i,on=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=xa!==null?{id:As,overflow:Ms}:null,i.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=Sn(18,null,null,0),l.stateNode=s,l.return=i,i.child=l,an=i,on=null,!0):!1;default:return!1}}function Am(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Mm(i){if(ui){var s=on;if(s){var l=s;if(!n0(i,s)){if(Am(i))throw Error(Re(418));s=Po(l.nextSibling);var f=an;s&&n0(i,s)?Qv(f,l):(i.flags=i.flags&-4097|2,ui=!1,an=i)}}else{if(Am(i))throw Error(Re(418));i.flags=i.flags&-4097|2,ui=!1,an=i}}}function s0(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;an=i}function hd(i){if(i!==an)return!1;if(!ui)return s0(i),ui=!0,!1;var s;if((s=i.tag!==3)&&!(s=i.tag!==5)&&(s=i.type,s=s!=="head"&&s!=="body"&&!km(i.type,i.memoizedProps)),s&&(s=on)){if(Am(i))throw ex(),Error(Re(418));for(;s;)Qv(i,s),s=Po(s.nextSibling)}if(s0(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Re(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"){if(s===0){on=Po(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}i=i.nextSibling}on=null}}else on=an?Po(i.stateNode.nextSibling):null;return!0}function ex(){for(var i=on;i;)i=Po(i.nextSibling)}function Dl(){on=an=null,ui=!1}function bg(i){On===null?On=[i]:On.push(i)}var tS=Ns.ReactCurrentBatchConfig;function Fn(i,s){if(i&&i.defaultProps){s=gi({},s),i=i.defaultProps;for(var l in i)s[l]===void 0&&(s[l]=i[l]);return s}return s}var Zd=Oo(null),qd=null,bl=null,Sg=null;function Tg(){Sg=bl=qd=null}function Ig(i){var s=Zd.current;ni(Zd),i._currentValue=s}function Dm(i,s,l){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===l)break;i=i.return}}function Pl(i,s){qd=i,Sg=bl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&s&&($r=!0),i.firstContext=null)}function In(i){var s=i._currentValue;if(Sg!==i)if(i={context:i,memoizedValue:s,next:null},bl===null){if(qd===null)throw Error(Re(308));bl=i,qd.dependencies={lanes:0,firstContext:i}}else bl=bl.next=i;return s}var ma=null;function Cg(i){ma===null?ma=[i]:ma.push(i)}function tx(i,s,l,f){var _=s.interleaved;return _===null?(l.next=l,Cg(s)):(l.next=_.next,_.next=l),s.interleaved=l,Bs(i,f)}function Bs(i,s){i.lanes|=s;var l=i.alternate;for(l!==null&&(l.lanes|=s),l=i,i=i.return;i!==null;)i.childLanes|=s,l=i.alternate,l!==null&&(l.childLanes|=s),l=i,i=i.return;return l.tag===3?l.stateNode:null}var xo=!1;function kg(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ix(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ls(i,s){return{eventTime:i,lane:s,tag:0,payload:null,callback:null,next:null}}function zo(i,s,l){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,Rt&2){var _=f.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),f.pending=s,Bs(i,l)}return _=f.interleaved,_===null?(s.next=s,Cg(f)):(s.next=_.next,_.next=s),f.interleaved=s,Bs(i,l)}function Td(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,dg(i,l)}}function o0(i,s){var l=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var _=null,T=null;if(l=l.firstBaseUpdate,l!==null){do{var w={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};T===null?_=T=w:T=T.next=w,l=l.next}while(l!==null);T===null?_=T=s:T=T.next=s}else _=T=s;l={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:T,shared:f.shared,effects:f.effects},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}function Gd(i,s,l,f){var _=i.updateQueue;xo=!1;var T=_.firstBaseUpdate,w=_.lastBaseUpdate,d=_.shared.pending;if(d!==null){_.shared.pending=null;var N=d,J=N.next;N.next=null,w===null?T=J:w.next=J,w=N;var he=i.alternate;he!==null&&(he=he.updateQueue,d=he.lastBaseUpdate,d!==w&&(d===null?he.firstBaseUpdate=J:d.next=J,he.lastBaseUpdate=N))}if(T!==null){var X=_.baseState;w=0,he=J=N=null,d=T;do{var U=d.lane,ze=d.eventTime;if((f&U)===U){he!==null&&(he=he.next={eventTime:ze,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var ke=i,Ee=d;switch(U=s,ze=l,Ee.tag){case 1:if(ke=Ee.payload,typeof ke=="function"){X=ke.call(ze,X,U);break e}X=ke;break e;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Ee.payload,U=typeof ke=="function"?ke.call(ze,X,U):ke,U==null)break e;X=gi({},X,U);break e;case 2:xo=!0}}d.callback!==null&&d.lane!==0&&(i.flags|=64,U=_.effects,U===null?_.effects=[d]:U.push(d))}else ze={eventTime:ze,lane:U,tag:d.tag,payload:d.payload,callback:d.callback,next:null},he===null?(J=he=ze,N=X):he=he.next=ze,w|=U;if(d=d.next,d===null){if(d=_.shared.pending,d===null)break;U=d,d=U.next,U.next=null,_.lastBaseUpdate=U,_.shared.pending=null}}while(!0);if(he===null&&(N=X),_.baseState=N,_.firstBaseUpdate=J,_.lastBaseUpdate=he,s=_.shared.interleaved,s!==null){_=s;do w|=_.lane,_=_.next;while(_!==s)}else T===null&&(_.shared.lanes=0);ba|=w,i.lanes=w,i.memoizedState=X}}function a0(i,s,l){if(i=s.effects,s.effects=null,i!==null)for(s=0;s<i.length;s++){var f=i[s],_=f.callback;if(_!==null){if(f.callback=null,f=l,typeof _!="function")throw Error(Re(191,_));_.call(f)}}}var rx=new tv.Component().refs;function Lm(i,s,l,f){s=i.memoizedState,l=l(f,s),l=l==null?s:gi({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var pp={isMounted:function(i){return(i=i._reactInternals)?Ia(i)===i:!1},enqueueSetState:function(i,s,l){i=i._reactInternals;var f=Dr(),_=Mo(i),T=Ls(f,_);T.payload=s,l!=null&&(T.callback=l),s=zo(i,T,_),s!==null&&(Vn(s,i,_,f),Td(s,i,_))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var f=Dr(),_=Mo(i),T=Ls(f,_);T.tag=1,T.payload=s,l!=null&&(T.callback=l),s=zo(i,T,_),s!==null&&(Vn(s,i,_,f),Td(s,i,_))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=Dr(),f=Mo(i),_=Ls(l,f);_.tag=2,s!=null&&(_.callback=s),s=zo(i,_,f),s!==null&&(Vn(s,i,f,l),Td(s,i,f))}};function l0(i,s,l,f,_,T,w){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,T,w):s.prototype&&s.prototype.isPureReactComponent?!kc(l,f)||!kc(_,T):!0}function nx(i,s,l){var f=!1,_=Fo,T=s.contextType;return typeof T=="object"&&T!==null?T=In(T):(_=qr(s)?va:vr.current,f=s.contextTypes,T=(f=f!=null)?Ml(i,_):Fo),s=new s(l,T),i.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=pp,i.stateNode=s,s._reactInternals=i,f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=T),s}function u0(i,s,l,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==i&&pp.enqueueReplaceState(s,s.state,null)}function Rm(i,s,l,f){var _=i.stateNode;_.props=l,_.state=i.memoizedState,_.refs=rx,kg(i);var T=s.contextType;typeof T=="object"&&T!==null?_.context=In(T):(T=qr(s)?va:vr.current,_.context=Ml(i,T)),_.state=i.memoizedState,T=s.getDerivedStateFromProps,typeof T=="function"&&(Lm(i,s,T,l),_.state=i.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(s=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),s!==_.state&&pp.enqueueReplaceState(_,_.state,null),Gd(i,l,_,f),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function rc(i,s,l){if(i=l.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(Re(309));var f=l.stateNode}if(!f)throw Error(Re(147,i));var _=f,T=""+i;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===T?s.ref:(s=function(w){var d=_.refs;d===rx&&(d=_.refs={}),w===null?delete d[T]:d[T]=w},s._stringRef=T,s)}if(typeof i!="string")throw Error(Re(284));if(!l._owner)throw Error(Re(290,i))}return i}function dd(i,s){throw i=Object.prototype.toString.call(s),Error(Re(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i))}function c0(i){var s=i._init;return s(i._payload)}function sx(i){function s(se,Q){if(i){var oe=se.deletions;oe===null?(se.deletions=[Q],se.flags|=16):oe.push(Q)}}function l(se,Q){if(!i)return null;for(;Q!==null;)s(se,Q),Q=Q.sibling;return null}function f(se,Q){for(se=new Map;Q!==null;)Q.key!==null?se.set(Q.key,Q):se.set(Q.index,Q),Q=Q.sibling;return se}function _(se,Q){return se=Do(se,Q),se.index=0,se.sibling=null,se}function T(se,Q,oe){return se.index=oe,i?(oe=se.alternate,oe!==null?(oe=oe.index,oe<Q?(se.flags|=2,Q):oe):(se.flags|=2,Q)):(se.flags|=1048576,Q)}function w(se){return i&&se.alternate===null&&(se.flags|=2),se}function d(se,Q,oe,ve){return Q===null||Q.tag!==6?(Q=Qf(oe,se.mode,ve),Q.return=se,Q):(Q=_(Q,oe),Q.return=se,Q)}function N(se,Q,oe,ve){var Ne=oe.type;return Ne===fl?he(se,Q,oe.props.children,ve,oe.key):Q!==null&&(Q.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===vo&&c0(Ne)===Q.type)?(ve=_(Q,oe.props),ve.ref=rc(se,Q,oe),ve.return=se,ve):(ve=zd(oe.type,oe.key,oe.props,null,se.mode,ve),ve.ref=rc(se,Q,oe),ve.return=se,ve)}function J(se,Q,oe,ve){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==oe.containerInfo||Q.stateNode.implementation!==oe.implementation?(Q=em(oe,se.mode,ve),Q.return=se,Q):(Q=_(Q,oe.children||[]),Q.return=se,Q)}function he(se,Q,oe,ve,Ne){return Q===null||Q.tag!==7?(Q=_a(oe,se.mode,ve,Ne),Q.return=se,Q):(Q=_(Q,oe),Q.return=se,Q)}function X(se,Q,oe){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Qf(""+Q,se.mode,oe),Q.return=se,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case td:return oe=zd(Q.type,Q.key,Q.props,null,se.mode,oe),oe.ref=rc(se,null,Q),oe.return=se,oe;case pl:return Q=em(Q,se.mode,oe),Q.return=se,Q;case vo:var ve=Q._init;return X(se,ve(Q._payload),oe)}if(ac(Q)||Ju(Q))return Q=_a(Q,se.mode,oe,null),Q.return=se,Q;dd(se,Q)}return null}function U(se,Q,oe,ve){var Ne=Q!==null?Q.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number")return Ne!==null?null:d(se,Q,""+oe,ve);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case td:return oe.key===Ne?N(se,Q,oe,ve):null;case pl:return oe.key===Ne?J(se,Q,oe,ve):null;case vo:return Ne=oe._init,U(se,Q,Ne(oe._payload),ve)}if(ac(oe)||Ju(oe))return Ne!==null?null:he(se,Q,oe,ve,null);dd(se,oe)}return null}function ze(se,Q,oe,ve,Ne){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return se=se.get(oe)||null,d(Q,se,""+ve,Ne);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case td:return se=se.get(ve.key===null?oe:ve.key)||null,N(Q,se,ve,Ne);case pl:return se=se.get(ve.key===null?oe:ve.key)||null,J(Q,se,ve,Ne);case vo:var Xe=ve._init;return ze(se,Q,oe,Xe(ve._payload),Ne)}if(ac(ve)||Ju(ve))return se=se.get(oe)||null,he(Q,se,ve,Ne,null);dd(Q,ve)}return null}function ke(se,Q,oe,ve){for(var Ne=null,Xe=null,Ke=Q,tt=Q=0,Dt=null;Ke!==null&&tt<oe.length;tt++){Ke.index>tt?(Dt=Ke,Ke=null):Dt=Ke.sibling;var xt=U(se,Ke,oe[tt],ve);if(xt===null){Ke===null&&(Ke=Dt);break}i&&Ke&&xt.alternate===null&&s(se,Ke),Q=T(xt,Q,tt),Xe===null?Ne=xt:Xe.sibling=xt,Xe=xt,Ke=Dt}if(tt===oe.length)return l(se,Ke),ui&&da(se,tt),Ne;if(Ke===null){for(;tt<oe.length;tt++)Ke=X(se,oe[tt],ve),Ke!==null&&(Q=T(Ke,Q,tt),Xe===null?Ne=Ke:Xe.sibling=Ke,Xe=Ke);return ui&&da(se,tt),Ne}for(Ke=f(se,Ke);tt<oe.length;tt++)Dt=ze(Ke,se,tt,oe[tt],ve),Dt!==null&&(i&&Dt.alternate!==null&&Ke.delete(Dt.key===null?tt:Dt.key),Q=T(Dt,Q,tt),Xe===null?Ne=Dt:Xe.sibling=Dt,Xe=Dt);return i&&Ke.forEach(function(Ot){return s(se,Ot)}),ui&&da(se,tt),Ne}function Ee(se,Q,oe,ve){var Ne=Ju(oe);if(typeof Ne!="function")throw Error(Re(150));if(oe=Ne.call(oe),oe==null)throw Error(Re(151));for(var Xe=Ne=null,Ke=Q,tt=Q=0,Dt=null,xt=oe.next();Ke!==null&&!xt.done;tt++,xt=oe.next()){Ke.index>tt?(Dt=Ke,Ke=null):Dt=Ke.sibling;var Ot=U(se,Ke,xt.value,ve);if(Ot===null){Ke===null&&(Ke=Dt);break}i&&Ke&&Ot.alternate===null&&s(se,Ke),Q=T(Ot,Q,tt),Xe===null?Ne=Ot:Xe.sibling=Ot,Xe=Ot,Ke=Dt}if(xt.done)return l(se,Ke),ui&&da(se,tt),Ne;if(Ke===null){for(;!xt.done;tt++,xt=oe.next())xt=X(se,xt.value,ve),xt!==null&&(Q=T(xt,Q,tt),Xe===null?Ne=xt:Xe.sibling=xt,Xe=xt);return ui&&da(se,tt),Ne}for(Ke=f(se,Ke);!xt.done;tt++,xt=oe.next())xt=ze(Ke,se,tt,xt.value,ve),xt!==null&&(i&&xt.alternate!==null&&Ke.delete(xt.key===null?tt:xt.key),Q=T(xt,Q,tt),Xe===null?Ne=xt:Xe.sibling=xt,Xe=xt);return i&&Ke.forEach(function(Nt){return s(se,Nt)}),ui&&da(se,tt),Ne}function Ue(se,Q,oe,ve){if(typeof oe=="object"&&oe!==null&&oe.type===fl&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case td:e:{for(var Ne=oe.key,Xe=Q;Xe!==null;){if(Xe.key===Ne){if(Ne=oe.type,Ne===fl){if(Xe.tag===7){l(se,Xe.sibling),Q=_(Xe,oe.props.children),Q.return=se,se=Q;break e}}else if(Xe.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===vo&&c0(Ne)===Xe.type){l(se,Xe.sibling),Q=_(Xe,oe.props),Q.ref=rc(se,Xe,oe),Q.return=se,se=Q;break e}l(se,Xe);break}else s(se,Xe);Xe=Xe.sibling}oe.type===fl?(Q=_a(oe.props.children,se.mode,ve,oe.key),Q.return=se,se=Q):(ve=zd(oe.type,oe.key,oe.props,null,se.mode,ve),ve.ref=rc(se,Q,oe),ve.return=se,se=ve)}return w(se);case pl:e:{for(Xe=oe.key;Q!==null;){if(Q.key===Xe)if(Q.tag===4&&Q.stateNode.containerInfo===oe.containerInfo&&Q.stateNode.implementation===oe.implementation){l(se,Q.sibling),Q=_(Q,oe.children||[]),Q.return=se,se=Q;break e}else{l(se,Q);break}else s(se,Q);Q=Q.sibling}Q=em(oe,se.mode,ve),Q.return=se,se=Q}return w(se);case vo:return Xe=oe._init,Ue(se,Q,Xe(oe._payload),ve)}if(ac(oe))return ke(se,Q,oe,ve);if(Ju(oe))return Ee(se,Q,oe,ve);dd(se,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"?(oe=""+oe,Q!==null&&Q.tag===6?(l(se,Q.sibling),Q=_(Q,oe),Q.return=se,se=Q):(l(se,Q),Q=Qf(oe,se.mode,ve),Q.return=se,se=Q),w(se)):l(se,Q)}return Ue}var Ll=sx(!0),ox=sx(!1),$c={},ss=Oo($c),Ac=Oo($c),Mc=Oo($c);function ga(i){if(i===$c)throw Error(Re(174));return i}function Eg(i,s){switch(Qt(Mc,s),Qt(Ac,i),Qt(ss,$c),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:pm(null,"");break;default:i=i===8?s.parentNode:s,s=i.namespaceURI||null,i=i.tagName,s=pm(s,i)}ni(ss),Qt(ss,s)}function Rl(){ni(ss),ni(Ac),ni(Mc)}function ax(i){ga(Mc.current);var s=ga(ss.current),l=pm(s,i.type);s!==l&&(Qt(Ac,i),Qt(ss,l))}function Pg(i){Ac.current===i&&(ni(ss),ni(Ac))}var fi=Oo(0);function Hd(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Hf=[];function zg(){for(var i=0;i<Hf.length;i++)Hf[i]._workInProgressVersionPrimary=null;Hf.length=0}var Id=Ns.ReactCurrentDispatcher,Wf=Ns.ReactCurrentBatchConfig,wa=0,mi=null,Ni=null,Wi=null,Wd=!1,gc=!1,Dc=0,iS=0;function gr(){throw Error(Re(321))}function Ag(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!jn(i[l],s[l]))return!1;return!0}function Mg(i,s,l,f,_,T){if(wa=T,mi=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Id.current=i===null||i.memoizedState===null?oS:aS,i=l(f,_),gc){T=0;do{if(gc=!1,Dc=0,25<=T)throw Error(Re(301));T+=1,Wi=Ni=null,s.updateQueue=null,Id.current=lS,i=l(f,_)}while(gc)}if(Id.current=Kd,s=Ni!==null&&Ni.next!==null,wa=0,Wi=Ni=mi=null,Wd=!1,s)throw Error(Re(300));return i}function Dg(){var i=Dc!==0;return Dc=0,i}function is(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wi===null?mi.memoizedState=Wi=i:Wi=Wi.next=i,Wi}function Cn(){if(Ni===null){var i=mi.alternate;i=i!==null?i.memoizedState:null}else i=Ni.next;var s=Wi===null?mi.memoizedState:Wi.next;if(s!==null)Wi=s,Ni=i;else{if(i===null)throw Error(Re(310));Ni=i,i={memoizedState:Ni.memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},Wi===null?mi.memoizedState=Wi=i:Wi=Wi.next=i}return Wi}function Lc(i,s){return typeof s=="function"?s(i):s}function Kf(i){var s=Cn(),l=s.queue;if(l===null)throw Error(Re(311));l.lastRenderedReducer=i;var f=Ni,_=f.baseQueue,T=l.pending;if(T!==null){if(_!==null){var w=_.next;_.next=T.next,T.next=w}f.baseQueue=_=T,l.pending=null}if(_!==null){T=_.next,f=f.baseState;var d=w=null,N=null,J=T;do{var he=J.lane;if((wa&he)===he)N!==null&&(N=N.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),f=J.hasEagerState?J.eagerState:i(f,J.action);else{var X={lane:he,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};N===null?(d=N=X,w=f):N=N.next=X,mi.lanes|=he,ba|=he}J=J.next}while(J!==null&&J!==T);N===null?w=f:N.next=d,jn(f,s.memoizedState)||($r=!0),s.memoizedState=f,s.baseState=w,s.baseQueue=N,l.lastRenderedState=f}if(i=l.interleaved,i!==null){_=i;do T=_.lane,mi.lanes|=T,ba|=T,_=_.next;while(_!==i)}else _===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function Xf(i){var s=Cn(),l=s.queue;if(l===null)throw Error(Re(311));l.lastRenderedReducer=i;var f=l.dispatch,_=l.pending,T=s.memoizedState;if(_!==null){l.pending=null;var w=_=_.next;do T=i(T,w.action),w=w.next;while(w!==_);jn(T,s.memoizedState)||($r=!0),s.memoizedState=T,s.baseQueue===null&&(s.baseState=T),l.lastRenderedState=T}return[T,f]}function lx(){}function ux(i,s){var l=mi,f=Cn(),_=s(),T=!jn(f.memoizedState,_);if(T&&(f.memoizedState=_,$r=!0),f=f.queue,Lg(dx.bind(null,l,f,i),[i]),f.getSnapshot!==s||T||Wi!==null&&Wi.memoizedState.tag&1){if(l.flags|=2048,Rc(9,hx.bind(null,l,f,_,s),void 0,null),Ki===null)throw Error(Re(349));wa&30||cx(l,s,_)}return _}function cx(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=mi.updateQueue,s===null?(s={lastEffect:null,stores:null},mi.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function hx(i,s,l,f){s.value=l,s.getSnapshot=f,px(s)&&fx(i)}function dx(i,s,l){return l(function(){px(s)&&fx(i)})}function px(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!jn(i,l)}catch{return!0}}function fx(i){var s=Bs(i,1);s!==null&&Vn(s,i,1,-1)}function h0(i){var s=is();return typeof i=="function"&&(i=i()),s.memoizedState=s.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lc,lastRenderedState:i},s.queue=i,i=i.dispatch=sS.bind(null,mi,i),[s.memoizedState,i]}function Rc(i,s,l,f){return i={tag:i,create:s,destroy:l,deps:f,next:null},s=mi.updateQueue,s===null?(s={lastEffect:null,stores:null},mi.updateQueue=s,s.lastEffect=i.next=i):(l=s.lastEffect,l===null?s.lastEffect=i.next=i:(f=l.next,l.next=i,i.next=f,s.lastEffect=i)),i}function mx(){return Cn().memoizedState}function Cd(i,s,l,f){var _=is();mi.flags|=i,_.memoizedState=Rc(1|s,l,void 0,f===void 0?null:f)}function fp(i,s,l,f){var _=Cn();f=f===void 0?null:f;var T=void 0;if(Ni!==null){var w=Ni.memoizedState;if(T=w.destroy,f!==null&&Ag(f,w.deps)){_.memoizedState=Rc(s,l,T,f);return}}mi.flags|=i,_.memoizedState=Rc(1|s,l,T,f)}function d0(i,s){return Cd(8390656,8,i,s)}function Lg(i,s){return fp(2048,8,i,s)}function gx(i,s){return fp(4,2,i,s)}function yx(i,s){return fp(4,4,i,s)}function _x(i,s){if(typeof s=="function")return i=i(),s(i),function(){s(null)};if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function vx(i,s,l){return l=l!=null?l.concat([i]):null,fp(4,4,_x.bind(null,s,i),l)}function Rg(){}function xx(i,s){var l=Cn();s=s===void 0?null:s;var f=l.memoizedState;return f!==null&&s!==null&&Ag(s,f[1])?f[0]:(l.memoizedState=[i,s],i)}function wx(i,s){var l=Cn();s=s===void 0?null:s;var f=l.memoizedState;return f!==null&&s!==null&&Ag(s,f[1])?f[0]:(i=i(),l.memoizedState=[i,s],i)}function bx(i,s,l){return wa&21?(jn(l,s)||(l=Iv(),mi.lanes|=l,ba|=l,i.baseState=!0),s):(i.baseState&&(i.baseState=!1,$r=!0),i.memoizedState=l)}function rS(i,s){var l=qt;qt=l!==0&&4>l?l:4,i(!0);var f=Wf.transition;Wf.transition={};try{i(!1),s()}finally{qt=l,Wf.transition=f}}function Sx(){return Cn().memoizedState}function nS(i,s,l){var f=Mo(i);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},Tx(i))Ix(s,l);else if(l=tx(i,s,l,f),l!==null){var _=Dr();Vn(l,i,f,_),Cx(l,s,f)}}function sS(i,s,l){var f=Mo(i),_={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(Tx(i))Ix(s,_);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=s.lastRenderedReducer,T!==null))try{var w=s.lastRenderedState,d=T(w,l);if(_.hasEagerState=!0,_.eagerState=d,jn(d,w)){var N=s.interleaved;N===null?(_.next=_,Cg(s)):(_.next=N.next,N.next=_),s.interleaved=_;return}}catch{}finally{}l=tx(i,s,_,f),l!==null&&(_=Dr(),Vn(l,i,f,_),Cx(l,s,f))}}function Tx(i){var s=i.alternate;return i===mi||s!==null&&s===mi}function Ix(i,s){gc=Wd=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function Cx(i,s,l){if(l&4194240){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,dg(i,l)}}var Kd={readContext:In,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},oS={readContext:In,useCallback:function(i,s){return is().memoizedState=[i,s===void 0?null:s],i},useContext:In,useEffect:d0,useImperativeHandle:function(i,s,l){return l=l!=null?l.concat([i]):null,Cd(4194308,4,_x.bind(null,s,i),l)},useLayoutEffect:function(i,s){return Cd(4194308,4,i,s)},useInsertionEffect:function(i,s){return Cd(4,2,i,s)},useMemo:function(i,s){var l=is();return s=s===void 0?null:s,i=i(),l.memoizedState=[i,s],i},useReducer:function(i,s,l){var f=is();return s=l!==void 0?l(s):s,f.memoizedState=f.baseState=s,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},f.queue=i,i=i.dispatch=nS.bind(null,mi,i),[f.memoizedState,i]},useRef:function(i){var s=is();return i={current:i},s.memoizedState=i},useState:h0,useDebugValue:Rg,useDeferredValue:function(i){return is().memoizedState=i},useTransition:function(){var i=h0(!1),s=i[0];return i=rS.bind(null,i[1]),is().memoizedState=i,[s,i]},useMutableSource:function(){},useSyncExternalStore:function(i,s,l){var f=mi,_=is();if(ui){if(l===void 0)throw Error(Re(407));l=l()}else{if(l=s(),Ki===null)throw Error(Re(349));wa&30||cx(f,s,l)}_.memoizedState=l;var T={value:l,getSnapshot:s};return _.queue=T,d0(dx.bind(null,f,T,i),[i]),f.flags|=2048,Rc(9,hx.bind(null,f,T,l,s),void 0,null),l},useId:function(){var i=is(),s=Ki.identifierPrefix;if(ui){var l=Ms,f=As;l=(f&~(1<<32-Nn(f)-1)).toString(32)+l,s=":"+s+"R"+l,l=Dc++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=iS++,s=":"+s+"r"+l.toString(32)+":";return i.memoizedState=s},unstable_isNewReconciler:!1},aS={readContext:In,useCallback:xx,useContext:In,useEffect:Lg,useImperativeHandle:vx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:wx,useReducer:Kf,useRef:mx,useState:function(){return Kf(Lc)},useDebugValue:Rg,useDeferredValue:function(i){var s=Cn();return bx(s,Ni.memoizedState,i)},useTransition:function(){var i=Kf(Lc)[0],s=Cn().memoizedState;return[i,s]},useMutableSource:lx,useSyncExternalStore:ux,useId:Sx,unstable_isNewReconciler:!1},lS={readContext:In,useCallback:xx,useContext:In,useEffect:Lg,useImperativeHandle:vx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:wx,useReducer:Xf,useRef:mx,useState:function(){return Xf(Lc)},useDebugValue:Rg,useDeferredValue:function(i){var s=Cn();return Ni===null?s.memoizedState=i:bx(s,Ni.memoizedState,i)},useTransition:function(){var i=Xf(Lc)[0],s=Cn().memoizedState;return[i,s]},useMutableSource:lx,useSyncExternalStore:ux,useId:Sx,unstable_isNewReconciler:!1};function Fl(i,s){try{var l="",f=s;do l+=Fb(f),f=f.return;while(f);var _=l}catch(T){_=`
Error generating stack: `+T.message+`
`+T.stack}return{value:i,source:s,stack:_,digest:null}}function Yf(i,s,l){return{value:i,source:null,stack:l??null,digest:s??null}}function Fm(i,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var uS=typeof WeakMap=="function"?WeakMap:Map;function kx(i,s,l){l=Ls(-1,l),l.tag=3,l.payload={element:null};var f=s.value;return l.callback=function(){Yd||(Yd=!0,Gm=f),Fm(i,s)},l}function Ex(i,s,l){l=Ls(-1,l),l.tag=3;var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var _=s.value;l.payload=function(){return f(_)},l.callback=function(){Fm(i,s)}}var T=i.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(l.callback=function(){Fm(i,s),typeof f!="function"&&(Ao===null?Ao=new Set([this]):Ao.add(this));var w=s.stack;this.componentDidCatch(s.value,{componentStack:w!==null?w:""})}),l}function p0(i,s,l){var f=i.pingCache;if(f===null){f=i.pingCache=new uS;var _=new Set;f.set(s,_)}else _=f.get(s),_===void 0&&(_=new Set,f.set(s,_));_.has(l)||(_.add(l),i=SS.bind(null,i,s,l),s.then(i,i))}function f0(i){do{var s;if((s=i.tag===13)&&(s=i.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return i;i=i.return}while(i!==null);return null}function m0(i,s,l,f,_){return i.mode&1?(i.flags|=65536,i.lanes=_,i):(i===s?i.flags|=65536:(i.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=Ls(-1,1),s.tag=2,zo(l,s,1))),l.lanes|=1),i)}var cS=Ns.ReactCurrentOwner,$r=!1;function Mr(i,s,l,f){s.child=i===null?ox(s,null,l,f):Ll(s,i.child,l,f)}function g0(i,s,l,f,_){l=l.render;var T=s.ref;return Pl(s,_),f=Mg(i,s,l,f,T,_),l=Dg(),i!==null&&!$r?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~_,Os(i,s,_)):(ui&&l&&xg(s),s.flags|=1,Mr(i,s,f,_),s.child)}function y0(i,s,l,f,_){if(i===null){var T=l.type;return typeof T=="function"&&!$g(T)&&T.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=T,Px(i,s,T,f,_)):(i=zd(l.type,null,f,s,s.mode,_),i.ref=s.ref,i.return=s,s.child=i)}if(T=i.child,!(i.lanes&_)){var w=T.memoizedProps;if(l=l.compare,l=l!==null?l:kc,l(w,f)&&i.ref===s.ref)return Os(i,s,_)}return s.flags|=1,i=Do(T,f),i.ref=s.ref,i.return=s,s.child=i}function Px(i,s,l,f,_){if(i!==null){var T=i.memoizedProps;if(kc(T,f)&&i.ref===s.ref)if($r=!1,s.pendingProps=f=T,(i.lanes&_)!==0)i.flags&131072&&($r=!0);else return s.lanes=i.lanes,Os(i,s,_)}return Bm(i,s,l,f,_)}function zx(i,s,l){var f=s.pendingProps,_=f.children,T=i!==null?i.memoizedState:null;if(f.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Tl,sn),sn|=l;else{if(!(l&1073741824))return i=T!==null?T.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:i,cachePool:null,transitions:null},s.updateQueue=null,Qt(Tl,sn),sn|=i,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=T!==null?T.baseLanes:l,Qt(Tl,sn),sn|=f}else T!==null?(f=T.baseLanes|l,s.memoizedState=null):f=l,Qt(Tl,sn),sn|=f;return Mr(i,s,_,l),s.child}function Ax(i,s){var l=s.ref;(i===null&&l!==null||i!==null&&i.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function Bm(i,s,l,f,_){var T=qr(l)?va:vr.current;return T=Ml(s,T),Pl(s,_),l=Mg(i,s,l,f,T,_),f=Dg(),i!==null&&!$r?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~_,Os(i,s,_)):(ui&&f&&xg(s),s.flags|=1,Mr(i,s,l,_),s.child)}function _0(i,s,l,f,_){if(qr(l)){var T=!0;jd(s)}else T=!1;if(Pl(s,_),s.stateNode===null)kd(i,s),nx(s,l,f),Rm(s,l,f,_),f=!0;else if(i===null){var w=s.stateNode,d=s.memoizedProps;w.props=d;var N=w.context,J=l.contextType;typeof J=="object"&&J!==null?J=In(J):(J=qr(l)?va:vr.current,J=Ml(s,J));var he=l.getDerivedStateFromProps,X=typeof he=="function"||typeof w.getSnapshotBeforeUpdate=="function";X||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(d!==f||N!==J)&&u0(s,w,f,J),xo=!1;var U=s.memoizedState;w.state=U,Gd(s,f,w,_),N=s.memoizedState,d!==f||U!==N||Zr.current||xo?(typeof he=="function"&&(Lm(s,l,he,f),N=s.memoizedState),(d=xo||l0(s,l,d,f,U,N,J))?(X||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(s.flags|=4194308)):(typeof w.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=N),w.props=f,w.state=N,w.context=J,f=d):(typeof w.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{w=s.stateNode,ix(i,s),d=s.memoizedProps,J=s.type===s.elementType?d:Fn(s.type,d),w.props=J,X=s.pendingProps,U=w.context,N=l.contextType,typeof N=="object"&&N!==null?N=In(N):(N=qr(l)?va:vr.current,N=Ml(s,N));var ze=l.getDerivedStateFromProps;(he=typeof ze=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(d!==X||U!==N)&&u0(s,w,f,N),xo=!1,U=s.memoizedState,w.state=U,Gd(s,f,w,_);var ke=s.memoizedState;d!==X||U!==ke||Zr.current||xo?(typeof ze=="function"&&(Lm(s,l,ze,f),ke=s.memoizedState),(J=xo||l0(s,l,J,f,U,ke,N)||!1)?(he||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,ke,N),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,ke,N)),typeof w.componentDidUpdate=="function"&&(s.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof w.componentDidUpdate!="function"||d===i.memoizedProps&&U===i.memoizedState||(s.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||d===i.memoizedProps&&U===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=ke),w.props=f,w.state=ke,w.context=N,f=J):(typeof w.componentDidUpdate!="function"||d===i.memoizedProps&&U===i.memoizedState||(s.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||d===i.memoizedProps&&U===i.memoizedState||(s.flags|=1024),f=!1)}return Om(i,s,l,f,T,_)}function Om(i,s,l,f,_,T){Ax(i,s);var w=(s.flags&128)!==0;if(!f&&!w)return _&&r0(s,l,!1),Os(i,s,T);f=s.stateNode,cS.current=s;var d=w&&typeof l.getDerivedStateFromError!="function"?null:f.render();return s.flags|=1,i!==null&&w?(s.child=Ll(s,i.child,null,T),s.child=Ll(s,null,d,T)):Mr(i,s,d,T),s.memoizedState=f.state,_&&r0(s,l,!0),s.child}function Mx(i){var s=i.stateNode;s.pendingContext?i0(i,s.pendingContext,s.pendingContext!==s.context):s.context&&i0(i,s.context,!1),Eg(i,s.containerInfo)}function v0(i,s,l,f,_){return Dl(),bg(_),s.flags|=256,Mr(i,s,l,f),s.child}var Nm={dehydrated:null,treeContext:null,retryLane:0};function Vm(i){return{baseLanes:i,cachePool:null,transitions:null}}function Dx(i,s,l){var f=s.pendingProps,_=fi.current,T=!1,w=(s.flags&128)!==0,d;if((d=w)||(d=i!==null&&i.memoizedState===null?!1:(_&2)!==0),d?(T=!0,s.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),Qt(fi,_&1),i===null)return Mm(s),i=s.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(s.mode&1?i.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(w=f.children,i=f.fallback,T?(f=s.mode,T=s.child,w={mode:"hidden",children:w},!(f&1)&&T!==null?(T.childLanes=0,T.pendingProps=w):T=yp(w,f,0,null),i=_a(i,f,l,null),T.return=s,i.return=s,T.sibling=i,s.child=T,s.child.memoizedState=Vm(l),s.memoizedState=Nm,i):Fg(s,w));if(_=i.memoizedState,_!==null&&(d=_.dehydrated,d!==null))return hS(i,s,w,f,d,_,l);if(T){T=f.fallback,w=s.mode,_=i.child,d=_.sibling;var N={mode:"hidden",children:f.children};return!(w&1)&&s.child!==_?(f=s.child,f.childLanes=0,f.pendingProps=N,s.deletions=null):(f=Do(_,N),f.subtreeFlags=_.subtreeFlags&14680064),d!==null?T=Do(d,T):(T=_a(T,w,l,null),T.flags|=2),T.return=s,f.return=s,f.sibling=T,s.child=f,f=T,T=s.child,w=i.child.memoizedState,w=w===null?Vm(l):{baseLanes:w.baseLanes|l,cachePool:null,transitions:w.transitions},T.memoizedState=w,T.childLanes=i.childLanes&~l,s.memoizedState=Nm,f}return T=i.child,i=T.sibling,f=Do(T,{mode:"visible",children:f.children}),!(s.mode&1)&&(f.lanes=l),f.return=s,f.sibling=null,i!==null&&(l=s.deletions,l===null?(s.deletions=[i],s.flags|=16):l.push(i)),s.child=f,s.memoizedState=null,f}function Fg(i,s){return s=yp({mode:"visible",children:s},i.mode,0,null),s.return=i,i.child=s}function pd(i,s,l,f){return f!==null&&bg(f),Ll(s,i.child,null,l),i=Fg(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function hS(i,s,l,f,_,T,w){if(l)return s.flags&256?(s.flags&=-257,f=Yf(Error(Re(422))),pd(i,s,w,f)):s.memoizedState!==null?(s.child=i.child,s.flags|=128,null):(T=f.fallback,_=s.mode,f=yp({mode:"visible",children:f.children},_,0,null),T=_a(T,_,w,null),T.flags|=2,f.return=s,T.return=s,f.sibling=T,s.child=f,s.mode&1&&Ll(s,i.child,null,w),s.child.memoizedState=Vm(w),s.memoizedState=Nm,T);if(!(s.mode&1))return pd(i,s,w,null);if(_.data==="$!"){if(f=_.nextSibling&&_.nextSibling.dataset,f)var d=f.dgst;return f=d,T=Error(Re(419)),f=Yf(T,f,void 0),pd(i,s,w,f)}if(d=(w&i.childLanes)!==0,$r||d){if(f=Ki,f!==null){switch(w&-w){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(f.suspendedLanes|w)?0:_,_!==0&&_!==T.retryLane&&(T.retryLane=_,Bs(i,_),Vn(f,i,_,-1))}return Ug(),f=Yf(Error(Re(421))),pd(i,s,w,f)}return _.data==="$?"?(s.flags|=128,s.child=i.child,s=TS.bind(null,i),_._reactRetry=s,null):(i=T.treeContext,on=Po(_.nextSibling),an=s,ui=!0,On=null,i!==null&&(wn[bn++]=As,wn[bn++]=Ms,wn[bn++]=xa,As=i.id,Ms=i.overflow,xa=s),s=Fg(s,f.children),s.flags|=4096,s)}function x0(i,s,l){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Dm(i.return,s,l)}function Jf(i,s,l,f,_){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:_}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=l,T.tailMode=_)}function Lx(i,s,l){var f=s.pendingProps,_=f.revealOrder,T=f.tail;if(Mr(i,s,f.children,l),f=fi.current,f&2)f=f&1|2,s.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&x0(i,l,s);else if(i.tag===19)x0(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}if(Qt(fi,f),!(s.mode&1))s.memoizedState=null;else switch(_){case"forwards":for(l=s.child,_=null;l!==null;)i=l.alternate,i!==null&&Hd(i)===null&&(_=l),l=l.sibling;l=_,l===null?(_=s.child,s.child=null):(_=l.sibling,l.sibling=null),Jf(s,!1,_,l,T);break;case"backwards":for(l=null,_=s.child,s.child=null;_!==null;){if(i=_.alternate,i!==null&&Hd(i)===null){s.child=_;break}i=_.sibling,_.sibling=l,l=_,_=i}Jf(s,!0,l,null,T);break;case"together":Jf(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function kd(i,s){!(s.mode&1)&&i!==null&&(i.alternate=null,s.alternate=null,s.flags|=2)}function Os(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),ba|=s.lanes,!(l&s.childLanes))return null;if(i!==null&&s.child!==i.child)throw Error(Re(153));if(s.child!==null){for(i=s.child,l=Do(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=Do(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function dS(i,s,l){switch(s.tag){case 3:Mx(s),Dl();break;case 5:ax(s);break;case 1:qr(s.type)&&jd(s);break;case 4:Eg(s,s.stateNode.containerInfo);break;case 10:var f=s.type._context,_=s.memoizedProps.value;Qt(Zd,f._currentValue),f._currentValue=_;break;case 13:if(f=s.memoizedState,f!==null)return f.dehydrated!==null?(Qt(fi,fi.current&1),s.flags|=128,null):l&s.child.childLanes?Dx(i,s,l):(Qt(fi,fi.current&1),i=Os(i,s,l),i!==null?i.sibling:null);Qt(fi,fi.current&1);break;case 19:if(f=(l&s.childLanes)!==0,i.flags&128){if(f)return Lx(i,s,l);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Qt(fi,fi.current),f)break;return null;case 22:case 23:return s.lanes=0,zx(i,s,l)}return Os(i,s,l)}var Rx,jm,Fx,Bx;Rx=function(i,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)i.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};jm=function(){};Fx=function(i,s,l,f){var _=i.memoizedProps;if(_!==f){i=s.stateNode,ga(ss.current);var T=null;switch(l){case"input":_=um(i,_),f=um(i,f),T=[];break;case"select":_=gi({},_,{value:void 0}),f=gi({},f,{value:void 0}),T=[];break;case"textarea":_=dm(i,_),f=dm(i,f),T=[];break;default:typeof _.onClick!="function"&&typeof f.onClick=="function"&&(i.onclick=Nd)}fm(l,f);var w;l=null;for(J in _)if(!f.hasOwnProperty(J)&&_.hasOwnProperty(J)&&_[J]!=null)if(J==="style"){var d=_[J];for(w in d)d.hasOwnProperty(w)&&(l||(l={}),l[w]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(xc.hasOwnProperty(J)?T||(T=[]):(T=T||[]).push(J,null));for(J in f){var N=f[J];if(d=_!=null?_[J]:void 0,f.hasOwnProperty(J)&&N!==d&&(N!=null||d!=null))if(J==="style")if(d){for(w in d)!d.hasOwnProperty(w)||N&&N.hasOwnProperty(w)||(l||(l={}),l[w]="");for(w in N)N.hasOwnProperty(w)&&d[w]!==N[w]&&(l||(l={}),l[w]=N[w])}else l||(T||(T=[]),T.push(J,l)),l=N;else J==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,d=d?d.__html:void 0,N!=null&&d!==N&&(T=T||[]).push(J,N)):J==="children"?typeof N!="string"&&typeof N!="number"||(T=T||[]).push(J,""+N):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(xc.hasOwnProperty(J)?(N!=null&&J==="onScroll"&&ri("scroll",i),T||d===N||(T=[])):(T=T||[]).push(J,N))}l&&(T=T||[]).push("style",l);var J=T;(s.updateQueue=J)&&(s.flags|=4)}};Bx=function(i,s,l,f){l!==f&&(s.flags|=4)};function nc(i,s){if(!ui)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function yr(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,f=0;if(s)for(var _=i.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags&14680064,f|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=f,i.childLanes=l,s}function pS(i,s,l){var f=s.pendingProps;switch(wg(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yr(s),null;case 1:return qr(s.type)&&Vd(),yr(s),null;case 3:return f=s.stateNode,Rl(),ni(Zr),ni(vr),zg(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(hd(s)?s.flags|=4:i===null||i.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,On!==null&&(Km(On),On=null))),jm(i,s),yr(s),null;case 5:Pg(s);var _=ga(Mc.current);if(l=s.type,i!==null&&s.stateNode!=null)Fx(i,s,l,f,_),i.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!f){if(s.stateNode===null)throw Error(Re(166));return yr(s),null}if(i=ga(ss.current),hd(s)){f=s.stateNode,l=s.type;var T=s.memoizedProps;switch(f[rs]=s,f[zc]=T,i=(s.mode&1)!==0,l){case"dialog":ri("cancel",f),ri("close",f);break;case"iframe":case"object":case"embed":ri("load",f);break;case"video":case"audio":for(_=0;_<uc.length;_++)ri(uc[_],f);break;case"source":ri("error",f);break;case"img":case"image":case"link":ri("error",f),ri("load",f);break;case"details":ri("toggle",f);break;case"input":P_(f,T),ri("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!T.multiple},ri("invalid",f);break;case"textarea":A_(f,T),ri("invalid",f)}fm(l,T),_=null;for(var w in T)if(T.hasOwnProperty(w)){var d=T[w];w==="children"?typeof d=="string"?f.textContent!==d&&(T.suppressHydrationWarning!==!0&&cd(f.textContent,d,i),_=["children",d]):typeof d=="number"&&f.textContent!==""+d&&(T.suppressHydrationWarning!==!0&&cd(f.textContent,d,i),_=["children",""+d]):xc.hasOwnProperty(w)&&d!=null&&w==="onScroll"&&ri("scroll",f)}switch(l){case"input":id(f),z_(f,T,!0);break;case"textarea":id(f),M_(f);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(f.onclick=Nd)}f=_,s.updateQueue=f,f!==null&&(s.flags|=4)}else{w=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=cv(l)),i==="http://www.w3.org/1999/xhtml"?l==="script"?(i=w.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof f.is=="string"?i=w.createElement(l,{is:f.is}):(i=w.createElement(l),l==="select"&&(w=i,f.multiple?w.multiple=!0:f.size&&(w.size=f.size))):i=w.createElementNS(i,l),i[rs]=s,i[zc]=f,Rx(i,s,!1,!1),s.stateNode=i;e:{switch(w=mm(l,f),l){case"dialog":ri("cancel",i),ri("close",i),_=f;break;case"iframe":case"object":case"embed":ri("load",i),_=f;break;case"video":case"audio":for(_=0;_<uc.length;_++)ri(uc[_],i);_=f;break;case"source":ri("error",i),_=f;break;case"img":case"image":case"link":ri("error",i),ri("load",i),_=f;break;case"details":ri("toggle",i),_=f;break;case"input":P_(i,f),_=um(i,f),ri("invalid",i);break;case"option":_=f;break;case"select":i._wrapperState={wasMultiple:!!f.multiple},_=gi({},f,{value:void 0}),ri("invalid",i);break;case"textarea":A_(i,f),_=dm(i,f),ri("invalid",i);break;default:_=f}fm(l,_),d=_;for(T in d)if(d.hasOwnProperty(T)){var N=d[T];T==="style"?pv(i,N):T==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&hv(i,N)):T==="children"?typeof N=="string"?(l!=="textarea"||N!=="")&&wc(i,N):typeof N=="number"&&wc(i,""+N):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(xc.hasOwnProperty(T)?N!=null&&T==="onScroll"&&ri("scroll",i):N!=null&&og(i,T,N,w))}switch(l){case"input":id(i),z_(i,f,!1);break;case"textarea":id(i),M_(i);break;case"option":f.value!=null&&i.setAttribute("value",""+Ro(f.value));break;case"select":i.multiple=!!f.multiple,T=f.value,T!=null?Il(i,!!f.multiple,T,!1):f.defaultValue!=null&&Il(i,!!f.multiple,f.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=Nd)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return yr(s),null;case 6:if(i&&s.stateNode!=null)Bx(i,s,i.memoizedProps,f);else{if(typeof f!="string"&&s.stateNode===null)throw Error(Re(166));if(l=ga(Mc.current),ga(ss.current),hd(s)){if(f=s.stateNode,l=s.memoizedProps,f[rs]=s,(T=f.nodeValue!==l)&&(i=an,i!==null))switch(i.tag){case 3:cd(f.nodeValue,l,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&cd(f.nodeValue,l,(i.mode&1)!==0)}T&&(s.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[rs]=s,s.stateNode=f}return yr(s),null;case 13:if(ni(fi),f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ui&&on!==null&&s.mode&1&&!(s.flags&128))ex(),Dl(),s.flags|=98560,T=!1;else if(T=hd(s),f!==null&&f.dehydrated!==null){if(i===null){if(!T)throw Error(Re(318));if(T=s.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(Re(317));T[rs]=s}else Dl(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;yr(s),T=!1}else On!==null&&(Km(On),On=null),T=!0;if(!T)return s.flags&65536?s:null}return s.flags&128?(s.lanes=l,s):(f=f!==null,f!==(i!==null&&i.memoizedState!==null)&&f&&(s.child.flags|=8192,s.mode&1&&(i===null||fi.current&1?Vi===0&&(Vi=3):Ug())),s.updateQueue!==null&&(s.flags|=4),yr(s),null);case 4:return Rl(),jm(i,s),i===null&&Ec(s.stateNode.containerInfo),yr(s),null;case 10:return Ig(s.type._context),yr(s),null;case 17:return qr(s.type)&&Vd(),yr(s),null;case 19:if(ni(fi),T=s.memoizedState,T===null)return yr(s),null;if(f=(s.flags&128)!==0,w=T.rendering,w===null)if(f)nc(T,!1);else{if(Vi!==0||i!==null&&i.flags&128)for(i=s.child;i!==null;){if(w=Hd(i),w!==null){for(s.flags|=128,nc(T,!1),f=w.updateQueue,f!==null&&(s.updateQueue=f,s.flags|=4),s.subtreeFlags=0,f=l,l=s.child;l!==null;)T=l,i=f,T.flags&=14680066,w=T.alternate,w===null?(T.childLanes=0,T.lanes=i,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=w.childLanes,T.lanes=w.lanes,T.child=w.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=w.memoizedProps,T.memoizedState=w.memoizedState,T.updateQueue=w.updateQueue,T.type=w.type,i=w.dependencies,T.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),l=l.sibling;return Qt(fi,fi.current&1|2),s.child}i=i.sibling}T.tail!==null&&Pi()>Bl&&(s.flags|=128,f=!0,nc(T,!1),s.lanes=4194304)}else{if(!f)if(i=Hd(w),i!==null){if(s.flags|=128,f=!0,l=i.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),nc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!w.alternate&&!ui)return yr(s),null}else 2*Pi()-T.renderingStartTime>Bl&&l!==1073741824&&(s.flags|=128,f=!0,nc(T,!1),s.lanes=4194304);T.isBackwards?(w.sibling=s.child,s.child=w):(l=T.last,l!==null?l.sibling=w:s.child=w,T.last=w)}return T.tail!==null?(s=T.tail,T.rendering=s,T.tail=s.sibling,T.renderingStartTime=Pi(),s.sibling=null,l=fi.current,Qt(fi,f?l&1|2:l&1),s):(yr(s),null);case 22:case 23:return jg(),f=s.memoizedState!==null,i!==null&&i.memoizedState!==null!==f&&(s.flags|=8192),f&&s.mode&1?sn&1073741824&&(yr(s),s.subtreeFlags&6&&(s.flags|=8192)):yr(s),null;case 24:return null;case 25:return null}throw Error(Re(156,s.tag))}function fS(i,s){switch(wg(s),s.tag){case 1:return qr(s.type)&&Vd(),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Rl(),ni(Zr),ni(vr),zg(),i=s.flags,i&65536&&!(i&128)?(s.flags=i&-65537|128,s):null;case 5:return Pg(s),null;case 13:if(ni(fi),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(Re(340));Dl()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return ni(fi),null;case 4:return Rl(),null;case 10:return Ig(s.type._context),null;case 22:case 23:return jg(),null;case 24:return null;default:return null}}var fd=!1,_r=!1,mS=typeof WeakSet=="function"?WeakSet:Set,it=null;function Sl(i,s){var l=i.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){xi(i,s,f)}else l.current=null}function Um(i,s,l){try{l()}catch(f){xi(i,s,f)}}var w0=!1;function gS(i,s){if(Im=Fd,i=jv(),vg(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var _=f.anchorOffset,T=f.focusNode;f=f.focusOffset;try{l.nodeType,T.nodeType}catch{l=null;break e}var w=0,d=-1,N=-1,J=0,he=0,X=i,U=null;t:for(;;){for(var ze;X!==l||_!==0&&X.nodeType!==3||(d=w+_),X!==T||f!==0&&X.nodeType!==3||(N=w+f),X.nodeType===3&&(w+=X.nodeValue.length),(ze=X.firstChild)!==null;)U=X,X=ze;for(;;){if(X===i)break t;if(U===l&&++J===_&&(d=w),U===T&&++he===f&&(N=w),(ze=X.nextSibling)!==null)break;X=U,U=X.parentNode}X=ze}l=d===-1||N===-1?null:{start:d,end:N}}else l=null}l=l||{start:0,end:0}}else l=null;for(Cm={focusedElem:i,selectionRange:l},Fd=!1,it=s;it!==null;)if(s=it,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,it=i;else for(;it!==null;){s=it;try{var ke=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(ke!==null){var Ee=ke.memoizedProps,Ue=ke.memoizedState,se=s.stateNode,Q=se.getSnapshotBeforeUpdate(s.elementType===s.type?Ee:Fn(s.type,Ee),Ue);se.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var oe=s.stateNode.containerInfo;oe.nodeType===1?oe.textContent="":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(ve){xi(s,s.return,ve)}if(i=s.sibling,i!==null){i.return=s.return,it=i;break}it=s.return}return ke=w0,w0=!1,ke}function yc(i,s,l){var f=s.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var _=f=f.next;do{if((_.tag&i)===i){var T=_.destroy;_.destroy=void 0,T!==void 0&&Um(s,l,T)}_=_.next}while(_!==f)}}function mp(i,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&i)===i){var f=l.create;l.destroy=f()}l=l.next}while(l!==s)}}function $m(i){var s=i.ref;if(s!==null){var l=i.stateNode;switch(i.tag){case 5:i=l;break;default:i=l}typeof s=="function"?s(i):s.current=i}}function Ox(i){var s=i.alternate;s!==null&&(i.alternate=null,Ox(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&(delete s[rs],delete s[zc],delete s[Pm],delete s[J2],delete s[Q2])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Nx(i){return i.tag===5||i.tag===3||i.tag===4}function b0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Nx(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Zm(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(i,s):l.insertBefore(i,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(i,l)):(s=l,s.appendChild(i)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Nd));else if(f!==4&&(i=i.child,i!==null))for(Zm(i,s,l),i=i.sibling;i!==null;)Zm(i,s,l),i=i.sibling}function qm(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(f!==4&&(i=i.child,i!==null))for(qm(i,s,l),i=i.sibling;i!==null;)qm(i,s,l),i=i.sibling}var ir=null,Bn=!1;function _o(i,s,l){for(l=l.child;l!==null;)Vx(i,s,l),l=l.sibling}function Vx(i,s,l){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(ap,l)}catch{}switch(l.tag){case 5:_r||Sl(l,s);case 6:var f=ir,_=Bn;ir=null,_o(i,s,l),ir=f,Bn=_,ir!==null&&(Bn?(i=ir,l=l.stateNode,i.nodeType===8?i.parentNode.removeChild(l):i.removeChild(l)):ir.removeChild(l.stateNode));break;case 18:ir!==null&&(Bn?(i=ir,l=l.stateNode,i.nodeType===8?qf(i.parentNode,l):i.nodeType===1&&qf(i,l),Ic(i)):qf(ir,l.stateNode));break;case 4:f=ir,_=Bn,ir=l.stateNode.containerInfo,Bn=!0,_o(i,s,l),ir=f,Bn=_;break;case 0:case 11:case 14:case 15:if(!_r&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){_=f=f.next;do{var T=_,w=T.destroy;T=T.tag,w!==void 0&&(T&2||T&4)&&Um(l,s,w),_=_.next}while(_!==f)}_o(i,s,l);break;case 1:if(!_r&&(Sl(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(d){xi(l,s,d)}_o(i,s,l);break;case 21:_o(i,s,l);break;case 22:l.mode&1?(_r=(f=_r)||l.memoizedState!==null,_o(i,s,l),_r=f):_o(i,s,l);break;default:_o(i,s,l)}}function S0(i){var s=i.updateQueue;if(s!==null){i.updateQueue=null;var l=i.stateNode;l===null&&(l=i.stateNode=new mS),s.forEach(function(f){var _=IS.bind(null,i,f);l.has(f)||(l.add(f),f.then(_,_))})}}function Rn(i,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var _=l[f];try{var T=i,w=s,d=w;e:for(;d!==null;){switch(d.tag){case 5:ir=d.stateNode,Bn=!1;break e;case 3:ir=d.stateNode.containerInfo,Bn=!0;break e;case 4:ir=d.stateNode.containerInfo,Bn=!0;break e}d=d.return}if(ir===null)throw Error(Re(160));Vx(T,w,_),ir=null,Bn=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(J){xi(_,s,J)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)jx(s,i),s=s.sibling}function jx(i,s){var l=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Rn(s,i),ts(i),f&4){try{yc(3,i,i.return),mp(3,i)}catch(Ee){xi(i,i.return,Ee)}try{yc(5,i,i.return)}catch(Ee){xi(i,i.return,Ee)}}break;case 1:Rn(s,i),ts(i),f&512&&l!==null&&Sl(l,l.return);break;case 5:if(Rn(s,i),ts(i),f&512&&l!==null&&Sl(l,l.return),i.flags&32){var _=i.stateNode;try{wc(_,"")}catch(Ee){xi(i,i.return,Ee)}}if(f&4&&(_=i.stateNode,_!=null)){var T=i.memoizedProps,w=l!==null?l.memoizedProps:T,d=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{d==="input"&&T.type==="radio"&&T.name!=null&&lv(_,T),mm(d,w);var J=mm(d,T);for(w=0;w<N.length;w+=2){var he=N[w],X=N[w+1];he==="style"?pv(_,X):he==="dangerouslySetInnerHTML"?hv(_,X):he==="children"?wc(_,X):og(_,he,X,J)}switch(d){case"input":cm(_,T);break;case"textarea":uv(_,T);break;case"select":var U=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!T.multiple;var ze=T.value;ze!=null?Il(_,!!T.multiple,ze,!1):U!==!!T.multiple&&(T.defaultValue!=null?Il(_,!!T.multiple,T.defaultValue,!0):Il(_,!!T.multiple,T.multiple?[]:"",!1))}_[zc]=T}catch(Ee){xi(i,i.return,Ee)}}break;case 6:if(Rn(s,i),ts(i),f&4){if(i.stateNode===null)throw Error(Re(162));_=i.stateNode,T=i.memoizedProps;try{_.nodeValue=T}catch(Ee){xi(i,i.return,Ee)}}break;case 3:if(Rn(s,i),ts(i),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Ic(s.containerInfo)}catch(Ee){xi(i,i.return,Ee)}break;case 4:Rn(s,i),ts(i);break;case 13:Rn(s,i),ts(i),_=i.child,_.flags&8192&&(T=_.memoizedState!==null,_.stateNode.isHidden=T,!T||_.alternate!==null&&_.alternate.memoizedState!==null||(Ng=Pi())),f&4&&S0(i);break;case 22:if(he=l!==null&&l.memoizedState!==null,i.mode&1?(_r=(J=_r)||he,Rn(s,i),_r=J):Rn(s,i),ts(i),f&8192){if(J=i.memoizedState!==null,(i.stateNode.isHidden=J)&&!he&&i.mode&1)for(it=i,he=i.child;he!==null;){for(X=it=he;it!==null;){switch(U=it,ze=U.child,U.tag){case 0:case 11:case 14:case 15:yc(4,U,U.return);break;case 1:Sl(U,U.return);var ke=U.stateNode;if(typeof ke.componentWillUnmount=="function"){f=U,l=U.return;try{s=f,ke.props=s.memoizedProps,ke.state=s.memoizedState,ke.componentWillUnmount()}catch(Ee){xi(f,l,Ee)}}break;case 5:Sl(U,U.return);break;case 22:if(U.memoizedState!==null){I0(X);continue}}ze!==null?(ze.return=U,it=ze):I0(X)}he=he.sibling}e:for(he=null,X=i;;){if(X.tag===5){if(he===null){he=X;try{_=X.stateNode,J?(T=_.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(d=X.stateNode,N=X.memoizedProps.style,w=N!=null&&N.hasOwnProperty("display")?N.display:null,d.style.display=dv("display",w))}catch(Ee){xi(i,i.return,Ee)}}}else if(X.tag===6){if(he===null)try{X.stateNode.nodeValue=J?"":X.memoizedProps}catch(Ee){xi(i,i.return,Ee)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===i)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===i)break e;for(;X.sibling===null;){if(X.return===null||X.return===i)break e;he===X&&(he=null),X=X.return}he===X&&(he=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:Rn(s,i),ts(i),f&4&&S0(i);break;case 21:break;default:Rn(s,i),ts(i)}}function ts(i){var s=i.flags;if(s&2){try{e:{for(var l=i.return;l!==null;){if(Nx(l)){var f=l;break e}l=l.return}throw Error(Re(160))}switch(f.tag){case 5:var _=f.stateNode;f.flags&32&&(wc(_,""),f.flags&=-33);var T=b0(i);qm(i,T,_);break;case 3:case 4:var w=f.stateNode.containerInfo,d=b0(i);Zm(i,d,w);break;default:throw Error(Re(161))}}catch(N){xi(i,i.return,N)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function yS(i,s,l){it=i,Ux(i)}function Ux(i,s,l){for(var f=(i.mode&1)!==0;it!==null;){var _=it,T=_.child;if(_.tag===22&&f){var w=_.memoizedState!==null||fd;if(!w){var d=_.alternate,N=d!==null&&d.memoizedState!==null||_r;d=fd;var J=_r;if(fd=w,(_r=N)&&!J)for(it=_;it!==null;)w=it,N=w.child,w.tag===22&&w.memoizedState!==null?C0(_):N!==null?(N.return=w,it=N):C0(_);for(;T!==null;)it=T,Ux(T),T=T.sibling;it=_,fd=d,_r=J}T0(i)}else _.subtreeFlags&8772&&T!==null?(T.return=_,it=T):T0(i)}}function T0(i){for(;it!==null;){var s=it;if(s.flags&8772){var l=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:_r||mp(5,s);break;case 1:var f=s.stateNode;if(s.flags&4&&!_r)if(l===null)f.componentDidMount();else{var _=s.elementType===s.type?l.memoizedProps:Fn(s.type,l.memoizedProps);f.componentDidUpdate(_,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var T=s.updateQueue;T!==null&&a0(s,T,f);break;case 3:var w=s.updateQueue;if(w!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}a0(s,w,l)}break;case 5:var d=s.stateNode;if(l===null&&s.flags&4){l=d;var N=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&l.focus();break;case"img":N.src&&(l.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var J=s.alternate;if(J!==null){var he=J.memoizedState;if(he!==null){var X=he.dehydrated;X!==null&&Ic(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}_r||s.flags&512&&$m(s)}catch(U){xi(s,s.return,U)}}if(s===i){it=null;break}if(l=s.sibling,l!==null){l.return=s.return,it=l;break}it=s.return}}function I0(i){for(;it!==null;){var s=it;if(s===i){it=null;break}var l=s.sibling;if(l!==null){l.return=s.return,it=l;break}it=s.return}}function C0(i){for(;it!==null;){var s=it;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{mp(4,s)}catch(N){xi(s,l,N)}break;case 1:var f=s.stateNode;if(typeof f.componentDidMount=="function"){var _=s.return;try{f.componentDidMount()}catch(N){xi(s,_,N)}}var T=s.return;try{$m(s)}catch(N){xi(s,T,N)}break;case 5:var w=s.return;try{$m(s)}catch(N){xi(s,w,N)}}}catch(N){xi(s,s.return,N)}if(s===i){it=null;break}var d=s.sibling;if(d!==null){d.return=s.return,it=d;break}it=s.return}}var _S=Math.ceil,Xd=Ns.ReactCurrentDispatcher,Bg=Ns.ReactCurrentOwner,Tn=Ns.ReactCurrentBatchConfig,Rt=0,Ki=null,Li=null,rr=0,sn=0,Tl=Oo(0),Vi=0,Fc=null,ba=0,gp=0,Og=0,_c=null,Ur=null,Ng=0,Bl=1/0,Ps=null,Yd=!1,Gm=null,Ao=null,md=!1,To=null,Jd=0,vc=0,Hm=null,Ed=-1,Pd=0;function Dr(){return Rt&6?Pi():Ed!==-1?Ed:Ed=Pi()}function Mo(i){return i.mode&1?Rt&2&&rr!==0?rr&-rr:tS.transition!==null?(Pd===0&&(Pd=Iv()),Pd):(i=qt,i!==0||(i=window.event,i=i===void 0?16:Mv(i.type)),i):1}function Vn(i,s,l,f){if(50<vc)throw vc=0,Hm=null,Error(Re(185));Vc(i,l,f),(!(Rt&2)||i!==Ki)&&(i===Ki&&(!(Rt&2)&&(gp|=l),Vi===4&&bo(i,rr)),Gr(i,f),l===1&&Rt===0&&!(s.mode&1)&&(Bl=Pi()+500,dp&&No()))}function Gr(i,s){var l=i.callbackNode;t2(i,s);var f=Rd(i,i===Ki?rr:0);if(f===0)l!==null&&R_(l),i.callbackNode=null,i.callbackPriority=0;else if(s=f&-f,i.callbackPriority!==s){if(l!=null&&R_(l),s===1)i.tag===0?eS(k0.bind(null,i)):Yv(k0.bind(null,i)),X2(function(){!(Rt&6)&&No()}),l=null;else{switch(Cv(f)){case 1:l=hg;break;case 4:l=Sv;break;case 16:l=Ld;break;case 536870912:l=Tv;break;default:l=Ld}l=Xx(l,$x.bind(null,i))}i.callbackPriority=s,i.callbackNode=l}}function $x(i,s){if(Ed=-1,Pd=0,Rt&6)throw Error(Re(327));var l=i.callbackNode;if(zl()&&i.callbackNode!==l)return null;var f=Rd(i,i===Ki?rr:0);if(f===0)return null;if(f&30||f&i.expiredLanes||s)s=Qd(i,f);else{s=f;var _=Rt;Rt|=2;var T=qx();(Ki!==i||rr!==s)&&(Ps=null,Bl=Pi()+500,ya(i,s));do try{wS();break}catch(d){Zx(i,d)}while(!0);Tg(),Xd.current=T,Rt=_,Li!==null?s=0:(Ki=null,rr=0,s=Vi)}if(s!==0){if(s===2&&(_=xm(i),_!==0&&(f=_,s=Wm(i,_))),s===1)throw l=Fc,ya(i,0),bo(i,f),Gr(i,Pi()),l;if(s===6)bo(i,f);else{if(_=i.current.alternate,!(f&30)&&!vS(_)&&(s=Qd(i,f),s===2&&(T=xm(i),T!==0&&(f=T,s=Wm(i,T))),s===1))throw l=Fc,ya(i,0),bo(i,f),Gr(i,Pi()),l;switch(i.finishedWork=_,i.finishedLanes=f,s){case 0:case 1:throw Error(Re(345));case 2:pa(i,Ur,Ps);break;case 3:if(bo(i,f),(f&130023424)===f&&(s=Ng+500-Pi(),10<s)){if(Rd(i,0)!==0)break;if(_=i.suspendedLanes,(_&f)!==f){Dr(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=Em(pa.bind(null,i,Ur,Ps),s);break}pa(i,Ur,Ps);break;case 4:if(bo(i,f),(f&4194240)===f)break;for(s=i.eventTimes,_=-1;0<f;){var w=31-Nn(f);T=1<<w,w=s[w],w>_&&(_=w),f&=~T}if(f=_,f=Pi()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*_S(f/1960))-f,10<f){i.timeoutHandle=Em(pa.bind(null,i,Ur,Ps),f);break}pa(i,Ur,Ps);break;case 5:pa(i,Ur,Ps);break;default:throw Error(Re(329))}}}return Gr(i,Pi()),i.callbackNode===l?$x.bind(null,i):null}function Wm(i,s){var l=_c;return i.current.memoizedState.isDehydrated&&(ya(i,s).flags|=256),i=Qd(i,s),i!==2&&(s=Ur,Ur=l,s!==null&&Km(s)),i}function Km(i){Ur===null?Ur=i:Ur.push.apply(Ur,i)}function vS(i){for(var s=i;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var _=l[f],T=_.getSnapshot;_=_.value;try{if(!jn(T(),_))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function bo(i,s){for(s&=~Og,s&=~gp,i.suspendedLanes|=s,i.pingedLanes&=~s,i=i.expirationTimes;0<s;){var l=31-Nn(s),f=1<<l;i[l]=-1,s&=~f}}function k0(i){if(Rt&6)throw Error(Re(327));zl();var s=Rd(i,0);if(!(s&1))return Gr(i,Pi()),null;var l=Qd(i,s);if(i.tag!==0&&l===2){var f=xm(i);f!==0&&(s=f,l=Wm(i,f))}if(l===1)throw l=Fc,ya(i,0),bo(i,s),Gr(i,Pi()),l;if(l===6)throw Error(Re(345));return i.finishedWork=i.current.alternate,i.finishedLanes=s,pa(i,Ur,Ps),Gr(i,Pi()),null}function Vg(i,s){var l=Rt;Rt|=1;try{return i(s)}finally{Rt=l,Rt===0&&(Bl=Pi()+500,dp&&No())}}function Sa(i){To!==null&&To.tag===0&&!(Rt&6)&&zl();var s=Rt;Rt|=1;var l=Tn.transition,f=qt;try{if(Tn.transition=null,qt=1,i)return i()}finally{qt=f,Tn.transition=l,Rt=s,!(Rt&6)&&No()}}function jg(){sn=Tl.current,ni(Tl)}function ya(i,s){i.finishedWork=null,i.finishedLanes=0;var l=i.timeoutHandle;if(l!==-1&&(i.timeoutHandle=-1,K2(l)),Li!==null)for(l=Li.return;l!==null;){var f=l;switch(wg(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Vd();break;case 3:Rl(),ni(Zr),ni(vr),zg();break;case 5:Pg(f);break;case 4:Rl();break;case 13:ni(fi);break;case 19:ni(fi);break;case 10:Ig(f.type._context);break;case 22:case 23:jg()}l=l.return}if(Ki=i,Li=i=Do(i.current,null),rr=sn=s,Vi=0,Fc=null,Og=gp=ba=0,Ur=_c=null,ma!==null){for(s=0;s<ma.length;s++)if(l=ma[s],f=l.interleaved,f!==null){l.interleaved=null;var _=f.next,T=l.pending;if(T!==null){var w=T.next;T.next=_,f.next=w}l.pending=f}ma=null}return i}function Zx(i,s){do{var l=Li;try{if(Tg(),Id.current=Kd,Wd){for(var f=mi.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}Wd=!1}if(wa=0,Wi=Ni=mi=null,gc=!1,Dc=0,Bg.current=null,l===null||l.return===null){Vi=1,Fc=s,Li=null;break}e:{var T=i,w=l.return,d=l,N=s;if(s=rr,d.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var J=N,he=d,X=he.tag;if(!(he.mode&1)&&(X===0||X===11||X===15)){var U=he.alternate;U?(he.updateQueue=U.updateQueue,he.memoizedState=U.memoizedState,he.lanes=U.lanes):(he.updateQueue=null,he.memoizedState=null)}var ze=f0(w);if(ze!==null){ze.flags&=-257,m0(ze,w,d,T,s),ze.mode&1&&p0(T,J,s),s=ze,N=J;var ke=s.updateQueue;if(ke===null){var Ee=new Set;Ee.add(N),s.updateQueue=Ee}else ke.add(N);break e}else{if(!(s&1)){p0(T,J,s),Ug();break e}N=Error(Re(426))}}else if(ui&&d.mode&1){var Ue=f0(w);if(Ue!==null){!(Ue.flags&65536)&&(Ue.flags|=256),m0(Ue,w,d,T,s),bg(Fl(N,d));break e}}T=N=Fl(N,d),Vi!==4&&(Vi=2),_c===null?_c=[T]:_c.push(T),T=w;do{switch(T.tag){case 3:T.flags|=65536,s&=-s,T.lanes|=s;var se=kx(T,N,s);o0(T,se);break e;case 1:d=N;var Q=T.type,oe=T.stateNode;if(!(T.flags&128)&&(typeof Q.getDerivedStateFromError=="function"||oe!==null&&typeof oe.componentDidCatch=="function"&&(Ao===null||!Ao.has(oe)))){T.flags|=65536,s&=-s,T.lanes|=s;var ve=Ex(T,d,s);o0(T,ve);break e}}T=T.return}while(T!==null)}Hx(l)}catch(Ne){s=Ne,Li===l&&l!==null&&(Li=l=l.return);continue}break}while(!0)}function qx(){var i=Xd.current;return Xd.current=Kd,i===null?Kd:i}function Ug(){(Vi===0||Vi===3||Vi===2)&&(Vi=4),Ki===null||!(ba&268435455)&&!(gp&268435455)||bo(Ki,rr)}function Qd(i,s){var l=Rt;Rt|=2;var f=qx();(Ki!==i||rr!==s)&&(Ps=null,ya(i,s));do try{xS();break}catch(_){Zx(i,_)}while(!0);if(Tg(),Rt=l,Xd.current=f,Li!==null)throw Error(Re(261));return Ki=null,rr=0,Vi}function xS(){for(;Li!==null;)Gx(Li)}function wS(){for(;Li!==null&&!Gb();)Gx(Li)}function Gx(i){var s=Kx(i.alternate,i,sn);i.memoizedProps=i.pendingProps,s===null?Hx(i):Li=s,Bg.current=null}function Hx(i){var s=i;do{var l=s.alternate;if(i=s.return,s.flags&32768){if(l=fS(l,s),l!==null){l.flags&=32767,Li=l;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Vi=6,Li=null;return}}else if(l=pS(l,s,sn),l!==null){Li=l;return}if(s=s.sibling,s!==null){Li=s;return}Li=s=i}while(s!==null);Vi===0&&(Vi=5)}function pa(i,s,l){var f=qt,_=Tn.transition;try{Tn.transition=null,qt=1,bS(i,s,l,f)}finally{Tn.transition=_,qt=f}return null}function bS(i,s,l,f){do zl();while(To!==null);if(Rt&6)throw Error(Re(327));l=i.finishedWork;var _=i.finishedLanes;if(l===null)return null;if(i.finishedWork=null,i.finishedLanes=0,l===i.current)throw Error(Re(177));i.callbackNode=null,i.callbackPriority=0;var T=l.lanes|l.childLanes;if(i2(i,T),i===Ki&&(Li=Ki=null,rr=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||md||(md=!0,Xx(Ld,function(){return zl(),null})),T=(l.flags&15990)!==0,l.subtreeFlags&15990||T){T=Tn.transition,Tn.transition=null;var w=qt;qt=1;var d=Rt;Rt|=4,Bg.current=null,gS(i,l),jx(l,i),U2(Cm),Fd=!!Im,Cm=Im=null,i.current=l,yS(l),Hb(),Rt=d,qt=w,Tn.transition=T}else i.current=l;if(md&&(md=!1,To=i,Jd=_),T=i.pendingLanes,T===0&&(Ao=null),Xb(l.stateNode),Gr(i,Pi()),s!==null)for(f=i.onRecoverableError,l=0;l<s.length;l++)_=s[l],f(_.value,{componentStack:_.stack,digest:_.digest});if(Yd)throw Yd=!1,i=Gm,Gm=null,i;return Jd&1&&i.tag!==0&&zl(),T=i.pendingLanes,T&1?i===Hm?vc++:(vc=0,Hm=i):vc=0,No(),null}function zl(){if(To!==null){var i=Cv(Jd),s=Tn.transition,l=qt;try{if(Tn.transition=null,qt=16>i?16:i,To===null)var f=!1;else{if(i=To,To=null,Jd=0,Rt&6)throw Error(Re(331));var _=Rt;for(Rt|=4,it=i.current;it!==null;){var T=it,w=T.child;if(it.flags&16){var d=T.deletions;if(d!==null){for(var N=0;N<d.length;N++){var J=d[N];for(it=J;it!==null;){var he=it;switch(he.tag){case 0:case 11:case 15:yc(8,he,T)}var X=he.child;if(X!==null)X.return=he,it=X;else for(;it!==null;){he=it;var U=he.sibling,ze=he.return;if(Ox(he),he===J){it=null;break}if(U!==null){U.return=ze,it=U;break}it=ze}}}var ke=T.alternate;if(ke!==null){var Ee=ke.child;if(Ee!==null){ke.child=null;do{var Ue=Ee.sibling;Ee.sibling=null,Ee=Ue}while(Ee!==null)}}it=T}}if(T.subtreeFlags&2064&&w!==null)w.return=T,it=w;else e:for(;it!==null;){if(T=it,T.flags&2048)switch(T.tag){case 0:case 11:case 15:yc(9,T,T.return)}var se=T.sibling;if(se!==null){se.return=T.return,it=se;break e}it=T.return}}var Q=i.current;for(it=Q;it!==null;){w=it;var oe=w.child;if(w.subtreeFlags&2064&&oe!==null)oe.return=w,it=oe;else e:for(w=Q;it!==null;){if(d=it,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:mp(9,d)}}catch(Ne){xi(d,d.return,Ne)}if(d===w){it=null;break e}var ve=d.sibling;if(ve!==null){ve.return=d.return,it=ve;break e}it=d.return}}if(Rt=_,No(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(ap,i)}catch{}f=!0}return f}finally{qt=l,Tn.transition=s}}return!1}function E0(i,s,l){s=Fl(l,s),s=kx(i,s,1),i=zo(i,s,1),s=Dr(),i!==null&&(Vc(i,1,s),Gr(i,s))}function xi(i,s,l){if(i.tag===3)E0(i,i,l);else for(;s!==null;){if(s.tag===3){E0(s,i,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ao===null||!Ao.has(f))){i=Fl(l,i),i=Ex(s,i,1),s=zo(s,i,1),i=Dr(),s!==null&&(Vc(s,1,i),Gr(s,i));break}}s=s.return}}function SS(i,s,l){var f=i.pingCache;f!==null&&f.delete(s),s=Dr(),i.pingedLanes|=i.suspendedLanes&l,Ki===i&&(rr&l)===l&&(Vi===4||Vi===3&&(rr&130023424)===rr&&500>Pi()-Ng?ya(i,0):Og|=l),Gr(i,s)}function Wx(i,s){s===0&&(i.mode&1?(s=sd,sd<<=1,!(sd&130023424)&&(sd=4194304)):s=1);var l=Dr();i=Bs(i,s),i!==null&&(Vc(i,s,l),Gr(i,l))}function TS(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),Wx(i,l)}function IS(i,s){var l=0;switch(i.tag){case 13:var f=i.stateNode,_=i.memoizedState;_!==null&&(l=_.retryLane);break;case 19:f=i.stateNode;break;default:throw Error(Re(314))}f!==null&&f.delete(s),Wx(i,l)}var Kx;Kx=function(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps||Zr.current)$r=!0;else{if(!(i.lanes&l)&&!(s.flags&128))return $r=!1,dS(i,s,l);$r=!!(i.flags&131072)}else $r=!1,ui&&s.flags&1048576&&Jv(s,$d,s.index);switch(s.lanes=0,s.tag){case 2:var f=s.type;kd(i,s),i=s.pendingProps;var _=Ml(s,vr.current);Pl(s,l),_=Mg(null,s,f,i,_,l);var T=Dg();return s.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,qr(f)?(T=!0,jd(s)):T=!1,s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,kg(s),_.updater=pp,s.stateNode=_,_._reactInternals=s,Rm(s,f,i,l),s=Om(null,s,f,!0,T,l)):(s.tag=0,ui&&T&&xg(s),Mr(null,s,_,l),s=s.child),s;case 16:f=s.elementType;e:{switch(kd(i,s),i=s.pendingProps,_=f._init,f=_(f._payload),s.type=f,_=s.tag=kS(f),i=Fn(f,i),_){case 0:s=Bm(null,s,f,i,l);break e;case 1:s=_0(null,s,f,i,l);break e;case 11:s=g0(null,s,f,i,l);break e;case 14:s=y0(null,s,f,Fn(f.type,i),l);break e}throw Error(Re(306,f,""))}return s;case 0:return f=s.type,_=s.pendingProps,_=s.elementType===f?_:Fn(f,_),Bm(i,s,f,_,l);case 1:return f=s.type,_=s.pendingProps,_=s.elementType===f?_:Fn(f,_),_0(i,s,f,_,l);case 3:e:{if(Mx(s),i===null)throw Error(Re(387));f=s.pendingProps,T=s.memoizedState,_=T.element,ix(i,s),Gd(s,f,null,l);var w=s.memoizedState;if(f=w.element,T.isDehydrated)if(T={element:f,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},s.updateQueue.baseState=T,s.memoizedState=T,s.flags&256){_=Fl(Error(Re(423)),s),s=v0(i,s,f,l,_);break e}else if(f!==_){_=Fl(Error(Re(424)),s),s=v0(i,s,f,l,_);break e}else for(on=Po(s.stateNode.containerInfo.firstChild),an=s,ui=!0,On=null,l=ox(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Dl(),f===_){s=Os(i,s,l);break e}Mr(i,s,f,l)}s=s.child}return s;case 5:return ax(s),i===null&&Mm(s),f=s.type,_=s.pendingProps,T=i!==null?i.memoizedProps:null,w=_.children,km(f,_)?w=null:T!==null&&km(f,T)&&(s.flags|=32),Ax(i,s),Mr(i,s,w,l),s.child;case 6:return i===null&&Mm(s),null;case 13:return Dx(i,s,l);case 4:return Eg(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=Ll(s,null,f,l):Mr(i,s,f,l),s.child;case 11:return f=s.type,_=s.pendingProps,_=s.elementType===f?_:Fn(f,_),g0(i,s,f,_,l);case 7:return Mr(i,s,s.pendingProps,l),s.child;case 8:return Mr(i,s,s.pendingProps.children,l),s.child;case 12:return Mr(i,s,s.pendingProps.children,l),s.child;case 10:e:{if(f=s.type._context,_=s.pendingProps,T=s.memoizedProps,w=_.value,Qt(Zd,f._currentValue),f._currentValue=w,T!==null)if(jn(T.value,w)){if(T.children===_.children&&!Zr.current){s=Os(i,s,l);break e}}else for(T=s.child,T!==null&&(T.return=s);T!==null;){var d=T.dependencies;if(d!==null){w=T.child;for(var N=d.firstContext;N!==null;){if(N.context===f){if(T.tag===1){N=Ls(-1,l&-l),N.tag=2;var J=T.updateQueue;if(J!==null){J=J.shared;var he=J.pending;he===null?N.next=N:(N.next=he.next,he.next=N),J.pending=N}}T.lanes|=l,N=T.alternate,N!==null&&(N.lanes|=l),Dm(T.return,l,s),d.lanes|=l;break}N=N.next}}else if(T.tag===10)w=T.type===s.type?null:T.child;else if(T.tag===18){if(w=T.return,w===null)throw Error(Re(341));w.lanes|=l,d=w.alternate,d!==null&&(d.lanes|=l),Dm(w,l,s),w=T.sibling}else w=T.child;if(w!==null)w.return=T;else for(w=T;w!==null;){if(w===s){w=null;break}if(T=w.sibling,T!==null){T.return=w.return,w=T;break}w=w.return}T=w}Mr(i,s,_.children,l),s=s.child}return s;case 9:return _=s.type,f=s.pendingProps.children,Pl(s,l),_=In(_),f=f(_),s.flags|=1,Mr(i,s,f,l),s.child;case 14:return f=s.type,_=Fn(f,s.pendingProps),_=Fn(f.type,_),y0(i,s,f,_,l);case 15:return Px(i,s,s.type,s.pendingProps,l);case 17:return f=s.type,_=s.pendingProps,_=s.elementType===f?_:Fn(f,_),kd(i,s),s.tag=1,qr(f)?(i=!0,jd(s)):i=!1,Pl(s,l),nx(s,f,_),Rm(s,f,_,l),Om(null,s,f,!0,i,l);case 19:return Lx(i,s,l);case 22:return zx(i,s,l)}throw Error(Re(156,s.tag))};function Xx(i,s){return bv(i,s)}function CS(i,s,l,f){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(i,s,l,f){return new CS(i,s,l,f)}function $g(i){return i=i.prototype,!(!i||!i.isReactComponent)}function kS(i){if(typeof i=="function")return $g(i)?1:0;if(i!=null){if(i=i.$$typeof,i===lg)return 11;if(i===ug)return 14}return 2}function Do(i,s){var l=i.alternate;return l===null?(l=Sn(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&14680064,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l}function zd(i,s,l,f,_,T){var w=2;if(f=i,typeof i=="function")$g(i)&&(w=1);else if(typeof i=="string")w=5;else e:switch(i){case fl:return _a(l.children,_,T,s);case ag:w=8,_|=8;break;case sm:return i=Sn(12,l,s,_|2),i.elementType=sm,i.lanes=T,i;case om:return i=Sn(13,l,s,_),i.elementType=om,i.lanes=T,i;case am:return i=Sn(19,l,s,_),i.elementType=am,i.lanes=T,i;case sv:return yp(l,_,T,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case rv:w=10;break e;case nv:w=9;break e;case lg:w=11;break e;case ug:w=14;break e;case vo:w=16,f=null;break e}throw Error(Re(130,i==null?i:typeof i,""))}return s=Sn(w,l,s,_),s.elementType=i,s.type=f,s.lanes=T,s}function _a(i,s,l,f){return i=Sn(7,i,f,s),i.lanes=l,i}function yp(i,s,l,f){return i=Sn(22,i,f,s),i.elementType=sv,i.lanes=l,i.stateNode={isHidden:!1},i}function Qf(i,s,l){return i=Sn(6,i,null,s),i.lanes=l,i}function em(i,s,l){return s=Sn(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function ES(i,s,l,f,_){this.tag=s,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lf(0),this.expirationTimes=Lf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lf(0),this.identifierPrefix=f,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Zg(i,s,l,f,_,T,w,d,N){return i=new ES(i,s,l,d,N),s===1?(s=1,T===!0&&(s|=8)):s=0,T=Sn(3,null,null,s),i.current=T,T.stateNode=i,T.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},kg(T),i}function PS(i,s,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pl,key:f==null?null:""+f,children:i,containerInfo:s,implementation:l}}function Yx(i){if(!i)return Fo;i=i._reactInternals;e:{if(Ia(i)!==i||i.tag!==1)throw Error(Re(170));var s=i;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(qr(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(Re(171))}if(i.tag===1){var l=i.type;if(qr(l))return Xv(i,l,s)}return s}function Jx(i,s,l,f,_,T,w,d,N){return i=Zg(l,f,!0,i,_,T,w,d,N),i.context=Yx(null),l=i.current,f=Dr(),_=Mo(l),T=Ls(f,_),T.callback=s??null,zo(l,T,_),i.current.lanes=_,Vc(i,_,f),Gr(i,f),i}function _p(i,s,l,f){var _=s.current,T=Dr(),w=Mo(_);return l=Yx(l),s.context===null?s.context=l:s.pendingContext=l,s=Ls(T,w),s.payload={element:i},f=f===void 0?null:f,f!==null&&(s.callback=f),i=zo(_,s,w),i!==null&&(Vn(i,_,w,T),Td(i,_,w)),w}function ep(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function P0(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function qg(i,s){P0(i,s),(i=i.alternate)&&P0(i,s)}function zS(){return null}var Qx=typeof reportError=="function"?reportError:function(i){console.error(i)};function Gg(i){this._internalRoot=i}vp.prototype.render=Gg.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(Re(409));_p(i,s,null,null)};vp.prototype.unmount=Gg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Sa(function(){_p(null,i,null,null)}),s[Fs]=null}};function vp(i){this._internalRoot=i}vp.prototype.unstable_scheduleHydration=function(i){if(i){var s=Pv();i={blockedOn:null,target:i,priority:s};for(var l=0;l<wo.length&&s!==0&&s<wo[l].priority;l++);wo.splice(l,0,i),l===0&&Av(i)}};function Hg(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function xp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function z0(){}function AS(i,s,l,f,_){if(_){if(typeof f=="function"){var T=f;f=function(){var J=ep(w);T.call(J)}}var w=Jx(s,f,i,0,null,!1,!1,"",z0);return i._reactRootContainer=w,i[Fs]=w.current,Ec(i.nodeType===8?i.parentNode:i),Sa(),w}for(;_=i.lastChild;)i.removeChild(_);if(typeof f=="function"){var d=f;f=function(){var J=ep(N);d.call(J)}}var N=Zg(i,0,!1,null,null,!1,!1,"",z0);return i._reactRootContainer=N,i[Fs]=N.current,Ec(i.nodeType===8?i.parentNode:i),Sa(function(){_p(s,N,l,f)}),N}function wp(i,s,l,f,_){var T=l._reactRootContainer;if(T){var w=T;if(typeof _=="function"){var d=_;_=function(){var N=ep(w);d.call(N)}}_p(s,w,i,_)}else w=AS(l,s,i,_,f);return ep(w)}kv=function(i){switch(i.tag){case 3:var s=i.stateNode;if(s.current.memoizedState.isDehydrated){var l=lc(s.pendingLanes);l!==0&&(dg(s,l|1),Gr(s,Pi()),!(Rt&6)&&(Bl=Pi()+500,No()))}break;case 13:Sa(function(){var f=Bs(i,1);if(f!==null){var _=Dr();Vn(f,i,1,_)}}),qg(i,1)}};pg=function(i){if(i.tag===13){var s=Bs(i,134217728);if(s!==null){var l=Dr();Vn(s,i,134217728,l)}qg(i,134217728)}};Ev=function(i){if(i.tag===13){var s=Mo(i),l=Bs(i,s);if(l!==null){var f=Dr();Vn(l,i,s,f)}qg(i,s)}};Pv=function(){return qt};zv=function(i,s){var l=qt;try{return qt=i,s()}finally{qt=l}};ym=function(i,s,l){switch(s){case"input":if(cm(i,l),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==i&&f.form===i.form){var _=hp(f);if(!_)throw Error(Re(90));av(f),cm(f,_)}}}break;case"textarea":uv(i,l);break;case"select":s=l.value,s!=null&&Il(i,!!l.multiple,s,!1)}};gv=Vg;yv=Sa;var MS={usingClientEntryPoint:!1,Events:[Uc,_l,hp,fv,mv,Vg]},sc={findFiberByHostInstance:fa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},DS={bundleType:sc.bundleType,version:sc.version,rendererPackageName:sc.rendererPackageName,rendererConfig:sc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=xv(i),i===null?null:i.stateNode},findFiberByHostInstance:sc.findFiberByHostInstance||zS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gd.isDisabled&&gd.supportsFiber)try{ap=gd.inject(DS),ns=gd}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MS;un.createPortal=function(i,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Hg(s))throw Error(Re(200));return PS(i,s,null,l)};un.createRoot=function(i,s){if(!Hg(i))throw Error(Re(299));var l=!1,f="",_=Qx;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),s=Zg(i,1,!1,null,null,l,!1,f,_),i[Fs]=s.current,Ec(i.nodeType===8?i.parentNode:i),new Gg(s)};un.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(Re(188)):(i=Object.keys(i).join(","),Error(Re(268,i)));return i=xv(s),i=i===null?null:i.stateNode,i};un.flushSync=function(i){return Sa(i)};un.hydrate=function(i,s,l){if(!xp(s))throw Error(Re(200));return wp(null,i,s,!0,l)};un.hydrateRoot=function(i,s,l){if(!Hg(i))throw Error(Re(405));var f=l!=null&&l.hydratedSources||null,_=!1,T="",w=Qx;if(l!=null&&(l.unstable_strictMode===!0&&(_=!0),l.identifierPrefix!==void 0&&(T=l.identifierPrefix),l.onRecoverableError!==void 0&&(w=l.onRecoverableError)),s=Jx(s,null,i,1,l??null,_,!1,T,w),i[Fs]=s.current,Ec(i),f)for(i=0;i<f.length;i++)l=f[i],_=l._getVersion,_=_(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,_]:s.mutableSourceEagerHydrationData.push(l,_);return new vp(s)};un.render=function(i,s,l){if(!xp(s))throw Error(Re(200));return wp(null,i,s,!1,l)};un.unmountComponentAtNode=function(i){if(!xp(i))throw Error(Re(40));return i._reactRootContainer?(Sa(function(){wp(null,null,i,!1,function(){i._reactRootContainer=null,i[Fs]=null})}),!0):!1};un.unstable_batchedUpdates=Vg;un.unstable_renderSubtreeIntoContainer=function(i,s,l,f){if(!xp(l))throw Error(Re(200));if(i==null||i._reactInternals===void 0)throw Error(Re(38));return wp(i,s,l,!1,f)};un.version="18.2.0-next-9e3b772b8-20220608";function e1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e1)}catch(i){console.error(i)}}e1(),J0.exports=un;var LS=J0.exports,A0=LS;rm.createRoot=A0.createRoot,rm.hydrateRoot=A0.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bc(){return Bc=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(i[f]=l[f])}return i},Bc.apply(this,arguments)}var Io;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Io||(Io={}));const M0="popstate";function RS(i){i===void 0&&(i={});function s(f,_){let{pathname:T,search:w,hash:d}=f.location;return Xm("",{pathname:T,search:w,hash:d},_.state&&_.state.usr||null,_.state&&_.state.key||"default")}function l(f,_){return typeof _=="string"?_:tp(_)}return BS(s,l,null,i)}function wi(i,s){if(i===!1||i===null||typeof i>"u")throw new Error(s)}function t1(i,s){if(!i){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function FS(){return Math.random().toString(36).substr(2,8)}function D0(i,s){return{usr:i.state,key:i.key,idx:s}}function Xm(i,s,l,f){return l===void 0&&(l=null),Bc({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof s=="string"?Ul(s):s,{state:l,key:s&&s.key||f||FS()})}function tp(i){let{pathname:s="/",search:l="",hash:f=""}=i;return l&&l!=="?"&&(s+=l.charAt(0)==="?"?l:"?"+l),f&&f!=="#"&&(s+=f.charAt(0)==="#"?f:"#"+f),s}function Ul(i){let s={};if(i){let l=i.indexOf("#");l>=0&&(s.hash=i.substr(l),i=i.substr(0,l));let f=i.indexOf("?");f>=0&&(s.search=i.substr(f),i=i.substr(0,f)),i&&(s.pathname=i)}return s}function BS(i,s,l,f){f===void 0&&(f={});let{window:_=document.defaultView,v5Compat:T=!1}=f,w=_.history,d=Io.Pop,N=null,J=he();J==null&&(J=0,w.replaceState(Bc({},w.state,{idx:J}),""));function he(){return(w.state||{idx:null}).idx}function X(){d=Io.Pop;let Ue=he(),se=Ue==null?null:Ue-J;J=Ue,N&&N({action:d,location:Ee.location,delta:se})}function U(Ue,se){d=Io.Push;let Q=Xm(Ee.location,Ue,se);l&&l(Q,Ue),J=he()+1;let oe=D0(Q,J),ve=Ee.createHref(Q);try{w.pushState(oe,"",ve)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;_.location.assign(ve)}T&&N&&N({action:d,location:Ee.location,delta:1})}function ze(Ue,se){d=Io.Replace;let Q=Xm(Ee.location,Ue,se);l&&l(Q,Ue),J=he();let oe=D0(Q,J),ve=Ee.createHref(Q);w.replaceState(oe,"",ve),T&&N&&N({action:d,location:Ee.location,delta:0})}function ke(Ue){let se=_.location.origin!=="null"?_.location.origin:_.location.href,Q=typeof Ue=="string"?Ue:tp(Ue);return Q=Q.replace(/ $/,"%20"),wi(se,"No window.location.(origin|href) available to create URL for href: "+Q),new URL(Q,se)}let Ee={get action(){return d},get location(){return i(_,w)},listen(Ue){if(N)throw new Error("A history only accepts one active listener");return _.addEventListener(M0,X),N=Ue,()=>{_.removeEventListener(M0,X),N=null}},createHref(Ue){return s(_,Ue)},createURL:ke,encodeLocation(Ue){let se=ke(Ue);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:U,replace:ze,go(Ue){return w.go(Ue)}};return Ee}var L0;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(L0||(L0={}));function OS(i,s,l){l===void 0&&(l="/");let f=typeof s=="string"?Ul(s):s,_=Ol(f.pathname||"/",l);if(_==null)return null;let T=i1(i);NS(T);let w=null;for(let d=0;w==null&&d<T.length;++d){let N=XS(_);w=WS(T[d],N)}return w}function i1(i,s,l,f){s===void 0&&(s=[]),l===void 0&&(l=[]),f===void 0&&(f="");let _=(T,w,d)=>{let N={relativePath:d===void 0?T.path||"":d,caseSensitive:T.caseSensitive===!0,childrenIndex:w,route:T};N.relativePath.startsWith("/")&&(wi(N.relativePath.startsWith(f),'Absolute route path "'+N.relativePath+'" nested under path '+('"'+f+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),N.relativePath=N.relativePath.slice(f.length));let J=Lo([f,N.relativePath]),he=l.concat(N);T.children&&T.children.length>0&&(wi(T.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+J+'".')),i1(T.children,s,he,J)),!(T.path==null&&!T.index)&&s.push({path:J,score:GS(J,T.index),routesMeta:he})};return i.forEach((T,w)=>{var d;if(T.path===""||!((d=T.path)!=null&&d.includes("?")))_(T,w);else for(let N of r1(T.path))_(T,w,N)}),s}function r1(i){let s=i.split("/");if(s.length===0)return[];let[l,...f]=s,_=l.endsWith("?"),T=l.replace(/\?$/,"");if(f.length===0)return _?[T,""]:[T];let w=r1(f.join("/")),d=[];return d.push(...w.map(N=>N===""?T:[T,N].join("/"))),_&&d.push(...w),d.map(N=>i.startsWith("/")&&N===""?"/":N)}function NS(i){i.sort((s,l)=>s.score!==l.score?l.score-s.score:HS(s.routesMeta.map(f=>f.childrenIndex),l.routesMeta.map(f=>f.childrenIndex)))}const VS=/^:[\w-]+$/,jS=3,US=2,$S=1,ZS=10,qS=-2,R0=i=>i==="*";function GS(i,s){let l=i.split("/"),f=l.length;return l.some(R0)&&(f+=qS),s&&(f+=US),l.filter(_=>!R0(_)).reduce((_,T)=>_+(VS.test(T)?jS:T===""?$S:ZS),f)}function HS(i,s){return i.length===s.length&&i.slice(0,-1).every((f,_)=>f===s[_])?i[i.length-1]-s[s.length-1]:0}function WS(i,s){let{routesMeta:l}=i,f={},_="/",T=[];for(let w=0;w<l.length;++w){let d=l[w],N=w===l.length-1,J=_==="/"?s:s.slice(_.length)||"/",he=Ym({path:d.relativePath,caseSensitive:d.caseSensitive,end:N},J);if(!he)return null;Object.assign(f,he.params);let X=d.route;T.push({params:f,pathname:Lo([_,he.pathname]),pathnameBase:eT(Lo([_,he.pathnameBase])),route:X}),he.pathnameBase!=="/"&&(_=Lo([_,he.pathnameBase]))}return T}function Ym(i,s){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[l,f]=KS(i.path,i.caseSensitive,i.end),_=s.match(l);if(!_)return null;let T=_[0],w=T.replace(/(.)\/+$/,"$1"),d=_.slice(1);return{params:f.reduce((J,he,X)=>{let{paramName:U,isOptional:ze}=he;if(U==="*"){let Ee=d[X]||"";w=T.slice(0,T.length-Ee.length).replace(/(.)\/+$/,"$1")}const ke=d[X];return ze&&!ke?J[U]=void 0:J[U]=(ke||"").replace(/%2F/g,"/"),J},{}),pathname:T,pathnameBase:w,pattern:i}}function KS(i,s,l){s===void 0&&(s=!1),l===void 0&&(l=!0),t1(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let f=[],_="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(w,d,N)=>(f.push({paramName:d,isOptional:N!=null}),N?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(f.push({paramName:"*"}),_+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?_+="\\/*$":i!==""&&i!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,s?void 0:"i"),f]}function XS(i){try{return i.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return t1(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),i}}function Ol(i,s){if(s==="/")return i;if(!i.toLowerCase().startsWith(s.toLowerCase()))return null;let l=s.endsWith("/")?s.length-1:s.length,f=i.charAt(l);return f&&f!=="/"?null:i.slice(l)||"/"}function YS(i,s){s===void 0&&(s="/");let{pathname:l,search:f="",hash:_=""}=typeof i=="string"?Ul(i):i;return{pathname:l?l.startsWith("/")?l:JS(l,s):s,search:tT(f),hash:iT(_)}}function JS(i,s){let l=s.replace(/\/+$/,"").split("/");return i.split("/").forEach(_=>{_===".."?l.length>1&&l.pop():_!=="."&&l.push(_)}),l.length>1?l.join("/"):"/"}function tm(i,s,l,f){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(f)+"].  Please separate it out to the ")+("`to."+l+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QS(i){return i.filter((s,l)=>l===0||s.route.path&&s.route.path.length>0)}function n1(i,s){let l=QS(i);return s?l.map((f,_)=>_===i.length-1?f.pathname:f.pathnameBase):l.map(f=>f.pathnameBase)}function s1(i,s,l,f){f===void 0&&(f=!1);let _;typeof i=="string"?_=Ul(i):(_=Bc({},i),wi(!_.pathname||!_.pathname.includes("?"),tm("?","pathname","search",_)),wi(!_.pathname||!_.pathname.includes("#"),tm("#","pathname","hash",_)),wi(!_.search||!_.search.includes("#"),tm("#","search","hash",_)));let T=i===""||_.pathname==="",w=T?"/":_.pathname,d;if(w==null)d=l;else{let X=s.length-1;if(!f&&w.startsWith("..")){let U=w.split("/");for(;U[0]==="..";)U.shift(),X-=1;_.pathname=U.join("/")}d=X>=0?s[X]:"/"}let N=YS(_,d),J=w&&w!=="/"&&w.endsWith("/"),he=(T||w===".")&&l.endsWith("/");return!N.pathname.endsWith("/")&&(J||he)&&(N.pathname+="/"),N}const Lo=i=>i.join("/").replace(/\/\/+/g,"/"),eT=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),tT=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,iT=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function rT(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const o1=["post","put","patch","delete"];new Set(o1);const nT=["get",...o1];new Set(nT);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oc(){return Oc=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(i[f]=l[f])}return i},Oc.apply(this,arguments)}const bp=He.createContext(null),a1=He.createContext(null),Vo=He.createContext(null),Sp=He.createContext(null),Ca=He.createContext({outlet:null,matches:[],isDataRoute:!1}),l1=He.createContext(null);function sT(i,s){let{relative:l}=s===void 0?{}:s;Zc()||wi(!1);let{basename:f,navigator:_}=He.useContext(Vo),{hash:T,pathname:w,search:d}=Tp(i,{relative:l}),N=w;return f!=="/"&&(N=w==="/"?f:Lo([f,w])),_.createHref({pathname:N,search:d,hash:T})}function Zc(){return He.useContext(Sp)!=null}function qc(){return Zc()||wi(!1),He.useContext(Sp).location}function u1(i){He.useContext(Vo).static||He.useLayoutEffect(i)}function oT(){let{isDataRoute:i}=He.useContext(Ca);return i?vT():aT()}function aT(){Zc()||wi(!1);let i=He.useContext(bp),{basename:s,future:l,navigator:f}=He.useContext(Vo),{matches:_}=He.useContext(Ca),{pathname:T}=qc(),w=JSON.stringify(n1(_,l.v7_relativeSplatPath)),d=He.useRef(!1);return u1(()=>{d.current=!0}),He.useCallback(function(J,he){if(he===void 0&&(he={}),!d.current)return;if(typeof J=="number"){f.go(J);return}let X=s1(J,JSON.parse(w),T,he.relative==="path");i==null&&s!=="/"&&(X.pathname=X.pathname==="/"?s:Lo([s,X.pathname])),(he.replace?f.replace:f.push)(X,he.state,he)},[s,f,w,T,i])}function Tp(i,s){let{relative:l}=s===void 0?{}:s,{future:f}=He.useContext(Vo),{matches:_}=He.useContext(Ca),{pathname:T}=qc(),w=JSON.stringify(n1(_,f.v7_relativeSplatPath));return He.useMemo(()=>s1(i,JSON.parse(w),T,l==="path"),[i,w,T,l])}function lT(i,s){return uT(i,s)}function uT(i,s,l,f){Zc()||wi(!1);let{navigator:_}=He.useContext(Vo),{matches:T}=He.useContext(Ca),w=T[T.length-1],d=w?w.params:{};w&&w.pathname;let N=w?w.pathnameBase:"/";w&&w.route;let J=qc(),he;if(s){var X;let Ue=typeof s=="string"?Ul(s):s;N==="/"||(X=Ue.pathname)!=null&&X.startsWith(N)||wi(!1),he=Ue}else he=J;let U=he.pathname||"/",ze=U;if(N!=="/"){let Ue=N.replace(/^\//,"").split("/");ze="/"+U.replace(/^\//,"").split("/").slice(Ue.length).join("/")}let ke=OS(i,{pathname:ze}),Ee=fT(ke&&ke.map(Ue=>Object.assign({},Ue,{params:Object.assign({},d,Ue.params),pathname:Lo([N,_.encodeLocation?_.encodeLocation(Ue.pathname).pathname:Ue.pathname]),pathnameBase:Ue.pathnameBase==="/"?N:Lo([N,_.encodeLocation?_.encodeLocation(Ue.pathnameBase).pathname:Ue.pathnameBase])})),T,l,f);return s&&Ee?He.createElement(Sp.Provider,{value:{location:Oc({pathname:"/",search:"",hash:"",state:null,key:"default"},he),navigationType:Io.Pop}},Ee):Ee}function cT(){let i=_T(),s=rT(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),l=i instanceof Error?i.stack:null,_={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return He.createElement(He.Fragment,null,He.createElement("h2",null,"Unexpected Application Error!"),He.createElement("h3",{style:{fontStyle:"italic"}},s),l?He.createElement("pre",{style:_},l):null,null)}const hT=He.createElement(cT,null);class dT extends He.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,l){return l.location!==s.location||l.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:l.error,location:l.location,revalidation:s.revalidation||l.revalidation}}componentDidCatch(s,l){console.error("React Router caught the following error during render",s,l)}render(){return this.state.error!==void 0?He.createElement(Ca.Provider,{value:this.props.routeContext},He.createElement(l1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pT(i){let{routeContext:s,match:l,children:f}=i,_=He.useContext(bp);return _&&_.static&&_.staticContext&&(l.route.errorElement||l.route.ErrorBoundary)&&(_.staticContext._deepestRenderedBoundaryId=l.route.id),He.createElement(Ca.Provider,{value:s},f)}function fT(i,s,l,f){var _;if(s===void 0&&(s=[]),l===void 0&&(l=null),f===void 0&&(f=null),i==null){var T;if((T=l)!=null&&T.errors)i=l.matches;else return null}let w=i,d=(_=l)==null?void 0:_.errors;if(d!=null){let he=w.findIndex(X=>X.route.id&&(d==null?void 0:d[X.route.id]));he>=0||wi(!1),w=w.slice(0,Math.min(w.length,he+1))}let N=!1,J=-1;if(l&&f&&f.v7_partialHydration)for(let he=0;he<w.length;he++){let X=w[he];if((X.route.HydrateFallback||X.route.hydrateFallbackElement)&&(J=he),X.route.id){let{loaderData:U,errors:ze}=l,ke=X.route.loader&&U[X.route.id]===void 0&&(!ze||ze[X.route.id]===void 0);if(X.route.lazy||ke){N=!0,J>=0?w=w.slice(0,J+1):w=[w[0]];break}}}return w.reduceRight((he,X,U)=>{let ze,ke=!1,Ee=null,Ue=null;l&&(ze=d&&X.route.id?d[X.route.id]:void 0,Ee=X.route.errorElement||hT,N&&(J<0&&U===0?(xT("route-fallback",!1),ke=!0,Ue=null):J===U&&(ke=!0,Ue=X.route.hydrateFallbackElement||null)));let se=s.concat(w.slice(0,U+1)),Q=()=>{let oe;return ze?oe=Ee:ke?oe=Ue:X.route.Component?oe=He.createElement(X.route.Component,null):X.route.element?oe=X.route.element:oe=he,He.createElement(pT,{match:X,routeContext:{outlet:he,matches:se,isDataRoute:l!=null},children:oe})};return l&&(X.route.ErrorBoundary||X.route.errorElement||U===0)?He.createElement(dT,{location:l.location,revalidation:l.revalidation,component:Ee,error:ze,children:Q(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):Q()},null)}var c1=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(c1||{}),ip=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(ip||{});function mT(i){let s=He.useContext(bp);return s||wi(!1),s}function gT(i){let s=He.useContext(a1);return s||wi(!1),s}function yT(i){let s=He.useContext(Ca);return s||wi(!1),s}function h1(i){let s=yT(),l=s.matches[s.matches.length-1];return l.route.id||wi(!1),l.route.id}function _T(){var i;let s=He.useContext(l1),l=gT(ip.UseRouteError),f=h1(ip.UseRouteError);return s!==void 0?s:(i=l.errors)==null?void 0:i[f]}function vT(){let{router:i}=mT(c1.UseNavigateStable),s=h1(ip.UseNavigateStable),l=He.useRef(!1);return u1(()=>{l.current=!0}),He.useCallback(function(_,T){T===void 0&&(T={}),l.current&&(typeof _=="number"?i.navigate(_):i.navigate(_,Oc({fromRouteId:s},T)))},[i,s])}const F0={};function xT(i,s,l){!s&&!F0[i]&&(F0[i]=!0)}function cc(i){wi(!1)}function wT(i){let{basename:s="/",children:l=null,location:f,navigationType:_=Io.Pop,navigator:T,static:w=!1,future:d}=i;Zc()&&wi(!1);let N=s.replace(/^\/*/,"/"),J=He.useMemo(()=>({basename:N,navigator:T,static:w,future:Oc({v7_relativeSplatPath:!1},d)}),[N,d,T,w]);typeof f=="string"&&(f=Ul(f));let{pathname:he="/",search:X="",hash:U="",state:ze=null,key:ke="default"}=f,Ee=He.useMemo(()=>{let Ue=Ol(he,N);return Ue==null?null:{location:{pathname:Ue,search:X,hash:U,state:ze,key:ke},navigationType:_}},[N,he,X,U,ze,ke,_]);return Ee==null?null:He.createElement(Vo.Provider,{value:J},He.createElement(Sp.Provider,{children:l,value:Ee}))}function bT(i){let{children:s,location:l}=i;return lT(Jm(s),l)}new Promise(()=>{});function Jm(i,s){s===void 0&&(s=[]);let l=[];return He.Children.forEach(i,(f,_)=>{if(!He.isValidElement(f))return;let T=[...s,_];if(f.type===He.Fragment){l.push.apply(l,Jm(f.props.children,T));return}f.type!==cc&&wi(!1),!f.props.index||!f.props.children||wi(!1);let w={id:f.props.id||T.join("-"),caseSensitive:f.props.caseSensitive,element:f.props.element,Component:f.props.Component,index:f.props.index,path:f.props.path,loader:f.props.loader,action:f.props.action,errorElement:f.props.errorElement,ErrorBoundary:f.props.ErrorBoundary,hasErrorBoundary:f.props.ErrorBoundary!=null||f.props.errorElement!=null,shouldRevalidate:f.props.shouldRevalidate,handle:f.props.handle,lazy:f.props.lazy};f.props.children&&(w.children=Jm(f.props.children,T)),l.push(w)}),l}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rp(){return rp=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(i[f]=l[f])}return i},rp.apply(this,arguments)}function d1(i,s){if(i==null)return{};var l={},f=Object.keys(i),_,T;for(T=0;T<f.length;T++)_=f[T],!(s.indexOf(_)>=0)&&(l[_]=i[_]);return l}function ST(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function TT(i,s){return i.button===0&&(!s||s==="_self")&&!ST(i)}const IT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],CT=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],kT="6";try{window.__reactRouterVersion=kT}catch{}const ET=He.createContext({isTransitioning:!1}),PT="startTransition",B0=Tb[PT];function zT(i){let{basename:s,children:l,future:f,window:_}=i,T=He.useRef();T.current==null&&(T.current=RS({window:_,v5Compat:!0}));let w=T.current,[d,N]=He.useState({action:w.action,location:w.location}),{v7_startTransition:J}=f||{},he=He.useCallback(X=>{J&&B0?B0(()=>N(X)):N(X)},[N,J]);return He.useLayoutEffect(()=>w.listen(he),[w,he]),He.createElement(wT,{basename:s,children:l,location:d.location,navigationType:d.action,navigator:w,future:f})}const AT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DT=He.forwardRef(function(s,l){let{onClick:f,relative:_,reloadDocument:T,replace:w,state:d,target:N,to:J,preventScrollReset:he,unstable_viewTransition:X}=s,U=d1(s,IT),{basename:ze}=He.useContext(Vo),ke,Ee=!1;if(typeof J=="string"&&MT.test(J)&&(ke=J,AT))try{let oe=new URL(window.location.href),ve=J.startsWith("//")?new URL(oe.protocol+J):new URL(J),Ne=Ol(ve.pathname,ze);ve.origin===oe.origin&&Ne!=null?J=Ne+ve.search+ve.hash:Ee=!0}catch{}let Ue=sT(J,{relative:_}),se=RT(J,{replace:w,state:d,target:N,preventScrollReset:he,relative:_,unstable_viewTransition:X});function Q(oe){f&&f(oe),oe.defaultPrevented||se(oe)}return He.createElement("a",rp({},U,{href:ke||Ue,onClick:Ee||T?f:Q,ref:l,target:N}))}),im=He.forwardRef(function(s,l){let{"aria-current":f="page",caseSensitive:_=!1,className:T="",end:w=!1,style:d,to:N,unstable_viewTransition:J,children:he}=s,X=d1(s,CT),U=Tp(N,{relative:X.relative}),ze=qc(),ke=He.useContext(a1),{navigator:Ee,basename:Ue}=He.useContext(Vo),se=ke!=null&&FT(U)&&J===!0,Q=Ee.encodeLocation?Ee.encodeLocation(U).pathname:U.pathname,oe=ze.pathname,ve=ke&&ke.navigation&&ke.navigation.location?ke.navigation.location.pathname:null;_||(oe=oe.toLowerCase(),ve=ve?ve.toLowerCase():null,Q=Q.toLowerCase()),ve&&Ue&&(ve=Ol(ve,Ue)||ve);const Ne=Q!=="/"&&Q.endsWith("/")?Q.length-1:Q.length;let Xe=oe===Q||!w&&oe.startsWith(Q)&&oe.charAt(Ne)==="/",Ke=ve!=null&&(ve===Q||!w&&ve.startsWith(Q)&&ve.charAt(Q.length)==="/"),tt={isActive:Xe,isPending:Ke,isTransitioning:se},Dt=Xe?f:void 0,xt;typeof T=="function"?xt=T(tt):xt=[T,Xe?"active":null,Ke?"pending":null,se?"transitioning":null].filter(Boolean).join(" ");let Ot=typeof d=="function"?d(tt):d;return He.createElement(DT,rp({},X,{"aria-current":Dt,className:xt,ref:l,style:Ot,to:N,unstable_viewTransition:J}),typeof he=="function"?he(tt):he)});var Qm;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(Qm||(Qm={}));var O0;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(O0||(O0={}));function LT(i){let s=He.useContext(bp);return s||wi(!1),s}function RT(i,s){let{target:l,replace:f,state:_,preventScrollReset:T,relative:w,unstable_viewTransition:d}=s===void 0?{}:s,N=oT(),J=qc(),he=Tp(i,{relative:w});return He.useCallback(X=>{if(TT(X,l)){X.preventDefault();let U=f!==void 0?f:tp(J)===tp(he);N(i,{replace:U,state:_,preventScrollReset:T,relative:w,unstable_viewTransition:d})}},[J,N,he,f,_,l,i,T,w,d])}function FT(i,s){s===void 0&&(s={});let l=He.useContext(ET);l==null&&wi(!1);let{basename:f}=LT(Qm.useViewTransitionState),_=Tp(i,{relative:s.relative});if(!l.isTransitioning)return!1;let T=Ol(l.currentLocation.pathname,f)||l.currentLocation.pathname,w=Ol(l.nextLocation.pathname,f)||l.nextLocation.pathname;return Ym(_.pathname,w)!=null||Ym(_.pathname,T)!=null}var p1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},N0=Ds.createContext&&Ds.createContext(p1),BT=["attr","size","title"];function OT(i,s){if(i==null)return{};var l=NT(i,s),f,_;if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(i);for(_=0;_<T.length;_++)f=T[_],!(s.indexOf(f)>=0)&&Object.prototype.propertyIsEnumerable.call(i,f)&&(l[f]=i[f])}return l}function NT(i,s){if(i==null)return{};var l={};for(var f in i)if(Object.prototype.hasOwnProperty.call(i,f)){if(s.indexOf(f)>=0)continue;l[f]=i[f]}return l}function np(){return np=Object.assign?Object.assign.bind():function(i){for(var s=1;s<arguments.length;s++){var l=arguments[s];for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(i[f]=l[f])}return i},np.apply(this,arguments)}function V0(i,s){var l=Object.keys(i);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(i);s&&(f=f.filter(function(_){return Object.getOwnPropertyDescriptor(i,_).enumerable})),l.push.apply(l,f)}return l}function sp(i){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?arguments[s]:{};s%2?V0(Object(l),!0).forEach(function(f){VT(i,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(l)):V0(Object(l)).forEach(function(f){Object.defineProperty(i,f,Object.getOwnPropertyDescriptor(l,f))})}return i}function VT(i,s,l){return s=jT(s),s in i?Object.defineProperty(i,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[s]=l,i}function jT(i){var s=UT(i,"string");return typeof s=="symbol"?s:s+""}function UT(i,s){if(typeof i!="object"||!i)return i;var l=i[Symbol.toPrimitive];if(l!==void 0){var f=l.call(i,s||"default");if(typeof f!="object")return f;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(i)}function f1(i){return i&&i.map((s,l)=>Ds.createElement(s.tag,sp({key:l},s.attr),f1(s.child)))}function Un(i){return s=>Ds.createElement($T,np({attr:sp({},i.attr)},s),f1(i.child))}function $T(i){var s=l=>{var{attr:f,size:_,title:T}=i,w=OT(i,BT),d=_||l.size||"1em",N;return l.className&&(N=l.className),i.className&&(N=(N?N+" ":"")+i.className),Ds.createElement("svg",np({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},l.attr,f,w,{className:N,style:sp(sp({color:i.color||l.color},l.style),i.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),T&&Ds.createElement("title",null,T),i.children)};return N0!==void 0?Ds.createElement(N0.Consumer,null,l=>s(l)):s(p1)}function yd(i){return Un({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z"},child:[]}]})(i)}function ZT(){return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"center",children:Ae.jsx("h1",{children:"G | GEOMTICA"})}),Ae.jsxs("div",{className:"grid",children:[Ae.jsxs("a",{className:"card",children:[Ae.jsxs("div",{className:"card_title",children:[Ae.jsx("h2",{children:"SIG-BDE"}),Ae.jsx("span",{children:Ae.jsx(yd,{})})]}),Ae.jsx("p",{children:"Sistemas de informacin Geogrfica y Base de Datos Espaciales"})]}),Ae.jsxs("a",{className:"card",children:[Ae.jsxs("div",{className:"card_title",children:[Ae.jsx("h2",{children:"AED"}),Ae.jsx("span",{children:Ae.jsx(yd,{})})]}),Ae.jsx("p",{children:"Anlisis Exploratorio de Datos para variables ambientales y climatolgicas"})]}),Ae.jsxs("a",{className:"card",children:[Ae.jsxs("div",{className:"card_title",children:[Ae.jsx("h2",{children:"MDE"}),Ae.jsx("span",{children:Ae.jsx(yd,{})})]}),Ae.jsx("p",{children:"Modelacin Dinmica Espacial de eventos ambientales climatolgicos"})]}),Ae.jsxs("a",{className:"card",children:[Ae.jsxs("div",{className:"card_title",children:[Ae.jsx("h2",{children:"GNSS "}),Ae.jsx("span",{children:Ae.jsx(yd,{})})]}),Ae.jsx("p",{children:"Levantamiento de informacin por Sistema Satelital de Navegacin Global y topografa convencional"})]})]})]})}const qT="/perfil.jpeg";function GT(i){return Un({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"},child:[]}]})(i)}function HT(i){return Un({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(i)}function WT(i){return Un({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532 0-200-89.451-200-200 0-110.531 89.451-200 200-200 110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43 0-140.484-61.425-140.484-141.567 0-79.152 60.275-139.401 139.762-139.401 55.531 0 88.738 26.62 97.593 34.779a11.965 11.965 0 0 1 1.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303 0-77.916 35.33-77.916 80.082 0 41.589 26.888 83.692 78.277 83.692 32.657 0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947 0 0 1-1.152 15.518z"},child:[]}]})(i)}function KT(i){return Un({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,48V88a12,12,0,0,1-24,0V60H184a12,12,0,0,1,0-24h40A12,12,0,0,1,236,48ZM72,196H44V168a12,12,0,0,0-24,0v40a12,12,0,0,0,12,12H72a12,12,0,0,0,0-24Zm152-40a12,12,0,0,0-12,12v28H184a12,12,0,0,0,0,24h40a12,12,0,0,0,12-12V168A12,12,0,0,0,224,156ZM32,100A12,12,0,0,0,44,88V60H72a12,12,0,0,0,0-24H32A12,12,0,0,0,20,48V88A12,12,0,0,0,32,100Zm158,70.42-56,32a12,12,0,0,1-11.9,0l-56-32A12,12,0,0,1,60,160V96a12,12,0,0,1,6-10.42l56-32a12,12,0,0,1,11.9,0l56,32A12,12,0,0,1,196,96v64A12,12,0,0,1,190,170.42ZM96.19,96,128,114.18,159.81,96,128,77.82ZM84,153l32,18.28V135L84,116.68Zm88,0V116.68L140,135v36.36Z"},child:[]}]})(i)}function XT(i){return Un({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,104v8a56.06,56.06,0,0,1-48.44,55.47A39.8,39.8,0,0,1,176,192v40a8,8,0,0,1-8,8H104a8,8,0,0,1-8-8V216H72a40,40,0,0,1-40-40A24,24,0,0,0,8,152a8,8,0,0,1,0-16,40,40,0,0,1,40,40,24,24,0,0,0,24,24H96v-8a39.8,39.8,0,0,1,8.44-24.53A56.06,56.06,0,0,1,56,112v-8a58.14,58.14,0,0,1,7.69-28.32A59.78,59.78,0,0,1,69.07,28,8,8,0,0,1,76,24a59.75,59.75,0,0,1,48,24h24a59.75,59.75,0,0,1,48-24,8,8,0,0,1,6.93,4,59.74,59.74,0,0,1,5.37,47.68A58,58,0,0,1,216,104Z"},child:[]}]})(i)}function YT(i){return Un({tag:"svg",attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 8.6425781 4 C 7.1835781 4 6 5.181625 6 6.640625 C 6 8.099625 7.182625 9.3085938 8.640625 9.3085938 C 10.098625 9.3085938 11.283203 8.099625 11.283203 6.640625 C 11.283203 5.182625 10.101578 4 8.6425781 4 z M 21.535156 11 C 19.316156 11 18.0465 12.160453 17.4375 13.314453 L 17.373047 13.314453 L 17.373047 11.310547 L 13 11.310547 L 13 26 L 17.556641 26 L 17.556641 18.728516 C 17.556641 16.812516 17.701266 14.960938 20.072266 14.960938 C 22.409266 14.960937 22.443359 17.145609 22.443359 18.849609 L 22.443359 26 L 26.994141 26 L 27 26 L 27 17.931641 C 27 13.983641 26.151156 11 21.535156 11 z M 6.3632812 11.310547 L 6.3632812 26 L 10.923828 26 L 10.923828 11.310547 L 6.3632812 11.310547 z"},child:[]}]})(i)}function JT(i){return Un({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M9 3h-4a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2z"},child:[]},{tag:"path",attr:{d:"M9 13h-4a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2z"},child:[]},{tag:"path",attr:{d:"M19 13h-4a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h4a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2z"},child:[]},{tag:"path",attr:{d:"M17 3a1 1 0 0 1 .993 .883l.007 .117v2h2a1 1 0 0 1 .117 1.993l-.117 .007h-2v2a1 1 0 0 1 -1.993 .117l-.007 -.117v-2h-2a1 1 0 0 1 -.117 -1.993l.117 -.007h2v-2a1 1 0 0 1 1 -1z"},child:[]}]})(i)}function QT(i){return Un({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"},child:[]}]})(i)}function eI(i){return Un({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M132.813 27.625l29.593 134.125c4.547 3.588 9.68 4.188 18.063 1.97l5.186-1.376 3.813 3.812 84.218 84.188 3.78 3.78-1.343 5.19c-2.42 9.36-1.483 15.047 3.375 19.905l13.53 13.53 97.533-97.563-13.532-13.53c-3.538-3.54-9.39-4.415-19.655-1.438l-5.313 1.53-3.906-3.906-86.187-86.188-1.626-3.28-1.094-3.314V64.376c-.013-.02-.018-.044-.03-.063L132.81 27.626zM310.592 85.5l-14.156 14.188 43.782 43.78 14.186-14.155L310.594 85.5zm120.25 95.844l-159.968 159.97 37.063 37.123 160-160-37.094-37.093zM196.5 199.594l-175 175v87.594l218.813-218.782-43.813-43.812z"},child:[]}]})(i)}function tI(){return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"about",children:Ae.jsxs("div",{children:[Ae.jsx("h1",{children:"Arturo A. Granada G."}),Ae.jsx("p",{children:"Hola bienvenido a mi sitio web, mi nombre es Arturo y soy Ingeniero Topogrfico de la Universidad del Valle. Trabajo con la gestin de datos geoespaciales: Captura, Almacenamiento y Anlisis de variables ambientales y antrpicas. Me apasiona el mundo de la programacin y el desarrollo web, que en conjunto con el uso de tcnicas y metodologas Geomticas permiten la visualizacin y presentacin de informacin y modelos geoespaciales. "})]})}),Ae.jsxs("div",{className:"about_grid",children:[Ae.jsx("div",{className:"about_menu",children:Ae.jsxs("ul",{children:[Ae.jsxs("li",{className:"boton",children:[Ae.jsx(HT,{})," Perfil"]}),Ae.jsxs("li",{className:"boton",children:[Ae.jsx(eI,{})," Habilidades"]}),Ae.jsxs("li",{className:"boton",children:[Ae.jsx(JT,{})," Mis Proyectos"]}),Ae.jsxs("li",{className:"boton",children:[Ae.jsx(KT,{})," Investigacin"]}),Ae.jsxs("li",{className:"boton",children:[Ae.jsx(QT,{})," Referencias"]})]})}),Ae.jsxs("div",{className:"about_pages",children:[Ae.jsxs("div",{className:"about_perfil",children:[Ae.jsx("div",{className:"portada",children:Ae.jsx("img",{src:qT,className:"perfil",alt:"A. Granada"})}),Ae.jsx("div",{className:"contenedor",children:Ae.jsxs("ul",{className:"redes",children:[Ae.jsxs("li",{children:[Ae.jsx(GT,{})," CvLAC"]}),Ae.jsxs("li",{children:[Ae.jsx(XT,{})," GitHub"]}),Ae.jsxs("li",{children:[Ae.jsx(YT,{})," LinkedIn"]})]})})]}),Ae.jsx("div",{children:Ae.jsxs("ul",{className:"contacto",children:[Ae.jsx("li",{className:"card",children:"  arturo.granada@correounivalle.edu.co"})," ",Ae.jsx("li",{className:"card",children:"  +57 301 4230342"})]})})]})]})]})}function iI(i){return Un({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3q0-.405-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708M3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026z"},child:[]}]})(i)}function rI(){return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"center",children:Ae.jsx("h1",{children:"SERVICIOS"})}),Ae.jsxs("div",{className:"service_grid",children:[Ae.jsx("div",{children:"Pagina en"}),Ae.jsx("div",{children:"Desarrollo"}),Ae.jsx("div",{children:Ae.jsx(iI,{})})]})]})}function nI(){}function sI(){return Ae.jsxs("div",{className:"description",children:[Ae.jsxs("p",{children:[Ae.jsx(im,{to:"/",className:({isActive:i})=>i?"active":"",children:"G | Geomtica"}),Ae.jsx(im,{to:"about",children:"about"}),Ae.jsx(im,{to:"servicios",children:"servicios"})]}),Ae.jsxs("div",{children:[" ",Ae.jsx("a",{children:"A. Granada | rea de Geomtica "}),Ae.jsxs("a",{children:["2024 ",Ae.jsx(WT,{})]})]})]})}var m1={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.2/LICENSE.txt
 */(function(i,s){(function(l,f){i.exports=f()})(lb,function(){var l={},f={};function _(w,d,N){if(f[w]=N,w==="index"){var J="var sharedModule = {}; ("+f.shared+")(sharedModule); ("+f.worker+")(sharedModule);",he={};return f.shared(he),f.index(l,he),typeof window<"u"&&l.setWorkerUrl(window.URL.createObjectURL(new Blob([J],{type:"text/javascript"}))),l}}_("shared",["exports"],function(w){function d(r,e,n,a){return new(n||(n=Promise))(function(h,g){function y(C){try{S(a.next(C))}catch(E){g(E)}}function v(C){try{S(a.throw(C))}catch(E){g(E)}}function S(C){var E;C.done?h(C.value):(E=C.value,E instanceof n?E:new n(function(P){P(E)})).then(y,v)}S((a=a.apply(r,e||[])).next())})}function N(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var J=he;function he(r,e){this.x=r,this.y=e}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,n=r.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),n=Math.sin(r),a=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=a,this},_rotateAround:function(r,e){var n=Math.cos(r),a=Math.sin(r),h=e.y+a*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(r){return r instanceof he?r:Array.isArray(r)?new he(r[0],r[1]):r};var X=N(J),U=ze;function ze(r,e,n,a){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=n,this.p2y=a}ze.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,a=0;a<8;a++){var h=this.sampleCurveX(n)-r;if(Math.abs(h)<e)return n;var g=this.sampleCurveDerivativeX(n);if(Math.abs(g)<1e-6)break;n-=h/g}var y=0,v=1;for(n=r,a=0;a<20&&(h=this.sampleCurveX(n),!(Math.abs(h-r)<e));a++)r>h?y=n:v=n,n=.5*(v-y)+y;return n},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var ke=N(U);let Ee,Ue;function se(){return Ee==null&&(Ee=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ee}function Q(){if(Ue==null&&(Ue=!1,se())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let a=0;a<5*5;a++){const h=4*a;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(a%5,Math.floor(a/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&n[a]!==a){Ue=!0;break}}}return Ue||!1}function oe(r,e,n,a){const h=new ke(r,e,n,a);return function(g){return h.solve(g)}}const ve=oe(.25,.1,.25,1);function Ne(r,e,n){return Math.min(n,Math.max(e,r))}function Xe(r,e,n){const a=n-e,h=((r-e)%a+a)%a+e;return h===e?n:h}function Ke(r,...e){for(const n of e)for(const a in n)r[a]=n[a];return r}let tt=1;function Dt(r,e,n){const a={};for(const h in r)a[h]=e.call(n||this,r[h],h,r);return a}function xt(r,e,n){const a={};for(const h in r)e.call(n||this,r[h],h,r)&&(a[h]=r[h]);return a}function Ot(r){return Array.isArray(r)?r.map(Ot):typeof r=="object"&&r?Dt(r,Ot):r}const Nt={};function si(r){Nt[r]||(typeof console<"u"&&console.warn(r),Nt[r]=!0)}function sr(r,e,n){return(n.y-r.y)*(e.x-r.x)>(e.y-r.y)*(n.x-r.x)}function kn(r){let e=0;for(let n,a,h=0,g=r.length,y=g-1;h<g;y=h++)n=r[h],a=r[y],e+=(a.x-n.x)*(n.y+a.y);return e}function xr(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let hn=null;function Ge(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function dt(r,e,n,a,h){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(r,{timestamp:0});try{const y=g==null?void 0:g.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),S=new Uint8ClampedArray(a*h*4);if(yield g.copyTo(S,function(C,E,P,D,R){const B=4*Math.max(-E,0),j=(Math.max(0,P)-P)*D*4+B,H=4*D,Y=Math.max(0,E),ce=Math.max(0,P);return{rect:{x:Y,y:ce,width:Math.min(C.width,E+D)-Y,height:Math.min(C.height,P+R)-ce},layout:[{offset:j,stride:H}]}}(r,e,n,a,h)),v)for(let C=0;C<S.length;C+=4){const E=S[C];S[C]=S[C+2],S[C+2]=E}return S}finally{g.close()}})}let Et,Mt;const Fr="AbortError";function zi(){return new Error(Fr)}const Hr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ri(r){return Hr.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const ji="global-dispatcher";class Wr extends Error{constructor(e,n,a,h){super(`AJAXError: ${n} (${e}): ${a}`),this.status=e,this.statusText=n,this.url=a,this.body=h}}const Vs=()=>xr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,$n=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const a=Ri(r.url);if(a)return a(r,e);if(xr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:r,targetMapId:ji},e)}if(!(/^file:/.test(n=r.url)||/^file:/.test(Vs())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,h){return d(this,void 0,void 0,function*(){const g=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:Vs(),signal:h.signal});a.type==="json"&&g.headers.set("Accept","application/json");const y=yield fetch(g);if(!y.ok){const C=yield y.blob();throw new Wr(y.status,y.statusText,a.url,C)}let v;v=a.type==="arrayBuffer"||a.type==="image"?y.arrayBuffer():a.type==="json"?y.json():y.text();const S=yield v;if(h.signal.aborted)throw zi();return{data:S,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(r,e);if(xr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:r,mustQueue:!0,targetMapId:ji},e)}var n;return function(a,h){return new Promise((g,y)=>{const v=new XMLHttpRequest;v.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(v.responseType="arraybuffer");for(const S in a.headers)v.setRequestHeader(S,a.headers[S]);a.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=a.credentials==="include",v.onerror=()=>{y(new Error(v.statusText))},v.onload=()=>{if(!h.signal.aborted)if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let S=v.response;if(a.type==="json")try{S=JSON.parse(v.response)}catch(C){return void y(C)}g({data:S,cacheControl:v.getResponseHeader("Cache-Control"),expires:v.getResponseHeader("Expires")})}else{const S=new Blob([v.response],{type:v.getResponseHeader("Content-Type")});y(new Wr(v.status,v.statusText,a.url,S))}},h.signal.addEventListener("abort",()=>{v.abort(),y(zi())}),v.send(a.body)})}(r,e)};function ka(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const e=new URL(r),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function Zn(r,e,n){n[r]&&n[r].indexOf(e)!==-1||(n[r]=n[r]||[],n[r].push(e))}function qn(r,e,n){if(n&&n[r]){const a=n[r].indexOf(e);a!==-1&&n[r].splice(a,1)}}class Gn{constructor(e,n={}){Ke(this,n),this.type=e}}class bi extends Gn{constructor(e,n={}){super("error",Ke({error:e},n))}}class os{on(e,n){return this._listeners=this._listeners||{},Zn(e,n,this._listeners),this}off(e,n){return qn(e,n,this._listeners),qn(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Zn(e,n,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,n){typeof e=="string"&&(e=new Gn(e,n||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,e);const g=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of g)qn(a,v,this._oneTimeListeners),v.call(this,e);const y=this._eventedParent;y&&(Ke(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof bi&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const as=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jo(r,e){const n={};for(const a in r)a!=="ref"&&(n[a]=r[a]);return as.forEach(a=>{a in e&&(n[a]=e[a])}),n}function It(r,e){if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!It(r[n],e[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object"||Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(!It(r[n],e[n]))return!1;return!0}return r===e}function Fi(r,e){r.push(e)}function dn(r,e,n){Fi(n,{command:"addSource",args:[r,e[r]]})}function js(r,e,n){Fi(e,{command:"removeSource",args:[r]}),n[r]=!0}function Us(r,e,n,a){js(r,n,a),dn(r,e,n)}function $s(r,e,n){let a;for(a in r[n])if(Object.prototype.hasOwnProperty.call(r[n],a)&&a!=="data"&&!It(r[n][a],e[n][a]))return!1;for(a in e[n])if(Object.prototype.hasOwnProperty.call(e[n],a)&&a!=="data"&&!It(r[n][a],e[n][a]))return!1;return!0}function ls(r,e,n,a,h,g){r=r||{},e=e||{};for(const y in r)Object.prototype.hasOwnProperty.call(r,y)&&(It(r[y],e[y])||n.push({command:g,args:[a,y,e[y],h]}));for(const y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(r,y)&&(It(r[y],e[y])||n.push({command:g,args:[a,y,e[y],h]}))}function Zs(r){return r.id}function Uo(r,e){return r[e.id]=e,r}class Le{constructor(e,n,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function wr(r,...e){for(const n of e)for(const a in n)r[a]=n[a];return r}class or extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class $o{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[a,h]of n)this.bindings[a]=h}concat(e){return new $o(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const us={kind:"null"},Me={kind:"number"},yt={kind:"string"},pt={kind:"boolean"},Bi={kind:"color"},Br={kind:"object"},ft={kind:"value"},Hn={kind:"collator"},En={kind:"formatted"},q={kind:"padding"},M={kind:"resolvedImage"},L={kind:"variableAnchorOffsetCollection"};function O(r,e){return{kind:"array",itemType:r,N:e}}function $(r){if(r.kind==="array"){const e=$(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const re=[us,Me,yt,pt,Bi,En,Br,O(ft),q,M,L];function ne(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ne(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const n of re)if(!ne(n,e))return null}}return`Expected ${$(r)} but found ${$(e)} instead.`}function ue(r,e){return e.some(n=>n.kind===r.kind)}function te(r,e){return e.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function de(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const Te=.96422,_e=.82521,we=4/29,Je=6/29,at=3*Je*Je,st=Je*Je*Je,Ct=Math.PI/180,ut=180/Math.PI;function Gt(r){return(r%=360)<0&&(r+=360),r}function Vt([r,e,n,a]){let h,g;const y=mt((.2225045*(r=ci(r))+.7168786*(e=ci(e))+.0606169*(n=ci(n)))/1);r===e&&e===n?h=g=y:(h=mt((.4360747*r+.3850649*e+.1430804*n)/Te),g=mt((.0139322*r+.0971045*e+.7141733*n)/_e));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-g),a]}function ci(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function mt(r){return r>st?Math.pow(r,1/3):r/at+we}function ei([r,e,n,a]){let h=(r+16)/116,g=isNaN(e)?h:h+e/500,y=isNaN(n)?h:h-n/200;return h=1*ar(h),g=Te*ar(g),y=_e*ar(y),[Ai(3.1338561*g-1.6168667*h-.4906146*y),Ai(-.9787684*g+1.9161415*h+.033454*y),Ai(.0719453*g-.2289914*h+1.4052427*y),a]}function Ai(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function ar(r){return r>Je?r*r*r:at*(r-we)}function Ui(r){return parseInt(r.padEnd(2,r),16)/255}function Xi(r,e){return br(e?r/100:r,0,1)}function br(r,e,n){return Math.min(Math.max(e,r),n)}function Gc(r){return!r.some(Number.isNaN)}const Ip={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ft{constructor(e,n,a,h=1,g=!0){this.r=e,this.g=n,this.b=a,this.a=h,g||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,n,a,h]))}static parse(e){if(e instanceof Ft)return e;if(typeof e!="string")return;const n=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ip[a];if(h){const[y,v,S]=h;return[y/255,v/255,S/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const y=a.length<6?1:2;let v=1;return[Ui(a.slice(v,v+=y)),Ui(a.slice(v,v+=y)),Ui(a.slice(v,v+=y)),Ui(a.slice(v,v+y)||"ff")]}if(a.startsWith("rgb")){const y=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,S,C,E,P,D,R,B,j,H,Y,ce]=y,ee=[E||" ",R||" ",H].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const ae=[C,D,j].join(""),xe=ae==="%%%"?100:ae===""?255:0;if(xe){const be=[br(+S/xe,0,1),br(+P/xe,0,1),br(+B/xe,0,1),Y?Xi(+Y,ce):1];if(Gc(be))return be}}return}}const g=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[y,v,S,C,E,P,D,R,B]=g,j=[S||" ",E||" ",D].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const H=[+v,br(+C,0,100),br(+P,0,100),R?Xi(+R,B):1];if(Gc(H))return function([Y,ce,ee,ae]){function xe(be){const je=(be+Y/30)%12,Ye=ce*Math.min(ee,1-ee);return ee-Ye*Math.max(-1,Math.min(je-3,9-je,1))}return Y=Gt(Y),ce/=100,ee/=100,[xe(0),xe(8),xe(4),ae]}(H)}}}(e);return n?new Ft(...n,!1):void 0}get rgb(){const{r:e,g:n,b:a,a:h}=this,g=h||1/0;return this.overwriteGetter("rgb",[e/g,n/g,a/g,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[n,a,h,g]=Vt(e),y=Math.sqrt(a*a+h*h);return[Math.round(1e4*y)?Gt(Math.atan2(h,a)*ut):NaN,y,n,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Vt(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,a,h]=this.rgb;return`rgba(${[e,n,a].map(g=>Math.round(255*g)).join(",")},${h})`}}Ft.black=new Ft(0,0,0,1),Ft.white=new Ft(1,1,1,1),Ft.transparent=new Ft(0,0,0,0),Ft.red=new Ft(1,0,0,1);class $l{constructor(e,n,a){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zl{constructor(e,n,a,h,g){this.text=e,this.image=n,this.scale=a,this.fontStack=h,this.textColor=g}}class Sr{constructor(e){this.sections=e}static fromString(e){return new Sr([new Zl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Sr?e:Sr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Tr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Tr)return e;if(typeof e=="number")return new Tr([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Tr(e)}}toString(){return JSON.stringify(this.values)}}const Hc=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class $i{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof $i)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const a=e[n],h=e[n+1];if(typeof a!="string"||!Hc.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new $i(e)}}toString(){return JSON.stringify(this.values)}}class Or{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Or({name:e,available:!1}):null}}function Wc(r,e,n,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,n,a]:[r,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wn(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Ft||r instanceof $l||r instanceof Sr||r instanceof Tr||r instanceof $i||r instanceof Or)return!0;if(Array.isArray(r)){for(const e of r)if(!Wn(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Wn(r[e]))return!1;return!0}return!1}function yi(r){if(r===null)return us;if(typeof r=="string")return yt;if(typeof r=="boolean")return pt;if(typeof r=="number")return Me;if(r instanceof Ft)return Bi;if(r instanceof $l)return Hn;if(r instanceof Sr)return En;if(r instanceof Tr)return q;if(r instanceof $i)return L;if(r instanceof Or)return M;if(Array.isArray(r)){const e=r.length;let n;for(const a of r){const h=yi(a);if(n){if(n===h)continue;n=ft;break}n=h}return O(n||ft,e)}return Br}function Zo(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof Ft||r instanceof Sr||r instanceof Tr||r instanceof $i||r instanceof Or?r.toString():JSON.stringify(r)}class cs{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Wn(e[1]))return n.error("invalid value");const a=e[1];let h=yi(a);const g=n.expectedType;return h.kind!=="array"||h.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(h=g),new cs(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class oi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const hs={string:yt,number:Me,boolean:pt,object:Br};class Kr{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let a,h=1;const g=e[0];if(g==="array"){let v,S;if(e.length>2){const C=e[1];if(typeof C!="string"||!(C in hs)||C==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=hs[C],h++}else v=ft;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);S=e[2],h++}a=O(v,S)}else{if(!hs[g])throw new Error(`Types doesn't contain name = ${g}`);a=hs[g]}const y=[];for(;h<e.length;h++){const v=n.parse(e[h],h,ft);if(!v)return null;y.push(v)}return new Kr(a,y)}evaluate(e){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(e);if(!ne(this.type,yi(a)))return a;if(n===this.args.length-1)throw new oi(`Expected value to be of type ${$(this.type)}, but found ${$(yi(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Ea={"to-boolean":pt,"to-color":Bi,"to-number":Me,"to-string":yt};class pn{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[0];if(!Ea[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return n.error("Expected one argument.");const h=Ea[a],g=[];for(let y=1;y<e.length;y++){const v=n.parse(e[y],y,ft);if(!v)return null;g.push(v)}return new pn(h,g)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,a;for(const h of this.args){if(n=h.evaluate(e),a=null,n instanceof Ft)return n;if(typeof n=="string"){const g=e.parseColor(n);if(g)return g}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Wc(n[0],n[1],n[2],n[3]),!a))return new Ft(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new oi(a||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const a of this.args){n=a.evaluate(e);const h=Tr.parse(n);if(h)return h}throw new oi(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const a of this.args){n=a.evaluate(e);const h=$i.parse(n);if(h)return h}throw new oi(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const a of this.args){if(n=a.evaluate(e),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new oi(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Sr.fromString(Zo(this.args[0].evaluate(e)));case"resolvedImage":return Or.fromString(Zo(this.args[0].evaluate(e)));default:return Zo(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ql=["Unknown","Point","LineString","Polygon"];class qs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ql[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Ft.parse(e)),n}}class Lt{constructor(e,n,a=[],h,g=new $o,y=[]){this.registry=e,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=g,this.errors=y,this.expectedType=h,this._isConstant=n}parse(e,n,a,h,g={}){return n?this.concat(n,a,h)._parse(e,g):this._parse(e,g)}_parse(e,n){function a(h,g,y){return y==="assert"?new Kr(g,[h]):y==="coerce"?new pn(g,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[h];if(g){let y=g.parse(e,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,S=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||S.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(v.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(v,S))return null}else y=a(y,v,n.typeAnnotation||"coerce");else y=a(y,v,n.typeAnnotation||"coerce");else y=a(y,v,n.typeAnnotation||"coerce");else y=a(y,v,n.typeAnnotation||"assert")}if(!(y instanceof cs)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new qs;try{y=new cs(y.type,y.evaluate(v))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,a){const h=typeof e=="number"?this.path.concat(e):this.path,g=a?this.scope.concat(a):this.scope;return new Lt(this.registry,this._isConstant,h,n||null,g,this.errors)}error(e,...n){const a=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new or(a,e))}checkSubtype(e,n){const a=ne(e,n);return a&&this.error(a),a}}class Pa{constructor(e,n,a){this.type=Hn,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const h=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,pt);if(!h)return null;const g=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,pt);if(!g)return null;let y=null;return a.locale&&(y=n.parse(a.locale,1,yt),!y)?null:new Pa(h,g,y)}evaluate(e){return new $l(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const fn=8192;function Gl(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function qo(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Kc(r,e){const n=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*fn),Math.round(a*h*fn)]}function Cp(r,e,n){const a=r[0]-e[0],h=r[1]-e[1],g=r[0]-n[0],y=r[1]-n[1];return a*y-g*h==0&&a*g<=0&&h*y<=0}function za(r,e){let n=!1;for(let y=0,v=e.length;y<v;y++){const S=e[y];for(let C=0,E=S.length;C<E-1;C++){if(Cp(r,S[C],S[C+1]))return!1;(h=S[C])[1]>(a=r)[1]!=(g=S[C+1])[1]>a[1]&&a[0]<(g[0]-h[0])*(a[1]-h[1])/(g[1]-h[1])+h[0]&&(n=!n)}}var a,h,g;return n}function Xc(r,e){for(let n=0;n<e.length;n++)if(za(r,e[n]))return!0;return!1}function Yc(r,e,n,a){const h=a[0]-n[0],g=a[1]-n[1],y=(r[0]-n[0])*g-h*(r[1]-n[1]),v=(e[0]-n[0])*g-h*(e[1]-n[1]);return y>0&&v<0||y<0&&v>0}function kp(r,e,n){for(const C of n)for(let E=0;E<C.length-1;++E)if((v=[(y=C[E+1])[0]-(g=C[E])[0],y[1]-g[1]])[0]*(S=[(h=e)[0]-(a=r)[0],h[1]-a[1]])[1]-v[1]*S[0]!=0&&Yc(a,h,g,y)&&Yc(g,y,a,h))return!0;var a,h,g,y,v,S;return!1}function Jc(r,e){for(let n=0;n<r.length;++n)if(!za(r[n],e))return!1;for(let n=0;n<r.length-1;++n)if(kp(r[n],r[n+1],e))return!1;return!0}function Ep(r,e){for(let n=0;n<e.length;n++)if(Jc(r,e[n]))return!0;return!1}function Aa(r,e,n){const a=[];for(let h=0;h<r.length;h++){const g=[];for(let y=0;y<r[h].length;y++){const v=Kc(r[h][y],n);Gl(e,v),g.push(v)}a.push(g)}return a}function Hl(r,e,n){const a=[];for(let h=0;h<r.length;h++){const g=Aa(r[h],e,n);a.push(g)}return a}function Qc(r,e,n,a){if(r[0]<n[0]||r[0]>n[2]){const h=.5*a;let g=r[0]-n[0]>h?-a:n[0]-r[0]>h?a:0;g===0&&(g=r[0]-n[2]>h?-a:n[2]-r[0]>h?a:0),r[0]+=g}Gl(e,r)}function eh(r,e,n,a){const h=Math.pow(2,a.z)*fn,g=[a.x*fn,a.y*fn],y=[];for(const v of r)for(const S of v){const C=[S.x+g[0],S.y+g[1]];Qc(C,e,n,h),y.push(C)}return y}function Ma(r,e,n,a){const h=Math.pow(2,a.z)*fn,g=[a.x*fn,a.y*fn],y=[];for(const S of r){const C=[];for(const E of S){const P=[E.x+g[0],E.y+g[1]];Gl(e,P),C.push(P)}y.push(C)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const S of y)for(const C of S)Qc(C,e,n,h)}var v;return y}class ds{constructor(e,n){this.type=pt,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Wn(e[1])){const a=e[1];if(a.type==="FeatureCollection"){const h=[];for(const g of a.features){const{type:y,coordinates:v}=g.geometry;y==="Polygon"&&h.push(v),y==="MultiPolygon"&&h.push(...v)}if(h.length)return new ds(a,{type:"MultiPolygon",coordinates:h})}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new ds(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new ds(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(a.type==="Polygon"){const v=Aa(a.coordinates,g,y),S=eh(n.geometry(),h,g,y);if(!qo(h,g))return!1;for(const C of S)if(!za(C,v))return!1}if(a.type==="MultiPolygon"){const v=Hl(a.coordinates,g,y),S=eh(n.geometry(),h,g,y);if(!qo(h,g))return!1;for(const C of S)if(!Xc(C,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,a){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(a.type==="Polygon"){const v=Aa(a.coordinates,g,y),S=Ma(n.geometry(),h,g,y);if(!qo(h,g))return!1;for(const C of S)if(!Jc(C,v))return!1}if(a.type==="MultiPolygon"){const v=Hl(a.coordinates,g,y),S=Ma(n.geometry(),h,g,y);if(!qo(h,g))return!1;for(const C of S)if(!Ep(C,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Da{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=e[1];return n.scope.has(a)?new Da(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Nr{constructor(e,n,a,h){this.name=e,this.type=n,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const a=e[0],h=Nr.definitions[a];if(!h)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let S=null;for(const[C,E]of v){S=new Lt(n.registry,Go,n.path,null,n.scope);const P=[];let D=!1;for(let R=1;R<e.length;R++){const B=e[R],j=Array.isArray(C)?C[R-1]:C.type,H=S.parse(B,1+P.length,j);if(!H){D=!0;break}P.push(H)}if(!D)if(Array.isArray(C)&&C.length!==P.length)S.error(`Expected ${C.length} arguments, but found ${P.length} instead.`);else{for(let R=0;R<P.length;R++){const B=Array.isArray(C)?C[R]:C.type,j=P[R];S.concat(R+1).checkSubtype(B,j.type)}if(S.errors.length===0)return new Nr(a,g,E,P)}}if(v.length===1)n.errors.push(...S.errors);else{const C=(v.length?v:y).map(([P])=>{return D=P,Array.isArray(D)?`(${D.map($).join(", ")})`:`(${$(D.type)}...)`;var D}).join(" | "),E=[];for(let P=1;P<e.length;P++){const D=n.parse(e[P],1+E.length);if(!D)return null;E.push($(D.type))}n.error(`Expected arguments of type ${C}, but found (${E.join(", ")}) instead.`)}return null}static register(e,n){Nr.definitions=n;for(const a in n)e[a]=Nr}}function Go(r){if(r instanceof Da)return Go(r.boundExpression);if(r instanceof Nr&&r.name==="error"||r instanceof Pa||r instanceof ds)return!1;const e=r instanceof pn||r instanceof Kr;let n=!0;return r.eachChild(a=>{n=e?n&&Go(a):n&&a instanceof cs}),!!n&&Ho(r)&&La(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ho(r){if(r instanceof Nr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof ds)return!1;let e=!0;return r.eachChild(n=>{e&&!Ho(n)&&(e=!1)}),e}function Wo(r){if(r instanceof Nr&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(n=>{e&&!Wo(n)&&(e=!1)}),e}function La(r,e){if(r instanceof Nr&&e.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(a=>{n&&!La(a,e)&&(n=!1)}),n}function Ko(r,e){const n=r.length-1;let a,h,g=0,y=n,v=0;for(;g<=y;)if(v=Math.floor((g+y)/2),a=r[v],h=r[v+1],a<=e){if(v===n||e<h)return v;g=v+1}else{if(!(a>e))throw new oi("Input is not a number.");y=v-1}return 0}class Gs{constructor(e,n,a){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,g]of a)this.labels.push(h),this.outputs.push(g)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(e[1],1,Me);if(!a)return null;const h=[];let g=null;n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(let y=1;y<e.length;y+=2){const v=y===1?-1/0:e[y],S=e[y+1],C=y,E=y+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const P=n.parse(S,E,g);if(!P)return null;g=g||P.type,h.push([v,P])}return new Gs(g,a,h)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return a[0].evaluate(e);const g=n.length;return h>=n[g-1]?a[g-1].evaluate(e):a[Ko(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Pp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var zp=th;function th(r,e,n,a){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=n,this.p2y=a}th.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,a=0;a<8;a++){var h=this.sampleCurveX(n)-r;if(Math.abs(h)<e)return n;var g=this.sampleCurveDerivativeX(n);if(Math.abs(g)<1e-6)break;n-=h/g}var y=0,v=1;for(n=r,a=0;a<20&&(h=this.sampleCurveX(n),!(Math.abs(h-r)<e));a++)r>h?y=n:v=n,n=.5*(v-y)+y;return n},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var Ap=Pp(zp);function ps(r,e,n){return r+n*(e-r)}function Ra(r,e,n){return r.map((a,h)=>ps(a,e[h],n))}const Ir={number:ps,color:function(r,e,n,a="rgb"){switch(a){case"rgb":{const[h,g,y,v]=Ra(r.rgb,e.rgb,n);return new Ft(h,g,y,v,!1)}case"hcl":{const[h,g,y,v]=r.hcl,[S,C,E,P]=e.hcl;let D,R;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?D=NaN:(D=S,y!==1&&y!==0||(R=C)):(D=h,E!==1&&E!==0||(R=g));else{let ce=S-h;S>h&&ce>180?ce-=360:S<h&&h-S>180&&(ce+=360),D=h+n*ce}const[B,j,H,Y]=function([ce,ee,ae,xe]){return ce=isNaN(ce)?0:ce*Ct,ei([ae,Math.cos(ce)*ee,Math.sin(ce)*ee,xe])}([D,R??ps(g,C,n),ps(y,E,n),ps(v,P,n)]);return new Ft(B,j,H,Y,!1)}case"lab":{const[h,g,y,v]=ei(Ra(r.lab,e.lab,n));return new Ft(h,g,y,v,!1)}}},array:Ra,padding:function(r,e,n){return new Tr(Ra(r.values,e.values,n))},variableAnchorOffsetCollection:function(r,e,n){const a=r.values,h=e.values;if(a.length!==h.length)throw new oi(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${e.toString()}`);const g=[];for(let y=0;y<a.length;y+=2){if(a[y]!==h[y])throw new oi(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${a[y]}, to[${y}]: ${h[y]}`);g.push(a[y]);const[v,S]=a[y+1],[C,E]=h[y+1];g.push([ps(v,C,n),ps(S,E,n)])}return new $i(g)}};class Yi{constructor(e,n,a,h,g){this.type=e,this.operator=n,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of g)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(e,n,a,h){let g=0;if(e.name==="exponential")g=Hs(n,e.base,a,h);else if(e.name==="linear")g=Hs(n,1,a,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;g=new Ap(y[0],y[1],y[2],y[3]).solve(Hs(n,1,a,h))}return g}static parse(e,n){let[a,h,g,...y]=e;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const C=h[1];if(typeof C!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:C}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const C=h.slice(1);if(C.length!==4||C.some(E=>typeof E!="number"||E<0||E>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(g=n.parse(g,2,Me),!g)return null;const v=[];let S=null;a==="interpolate-hcl"||a==="interpolate-lab"?S=Bi:n.expectedType&&n.expectedType.kind!=="value"&&(S=n.expectedType);for(let C=0;C<y.length;C+=2){const E=y[C],P=y[C+1],D=C+3,R=C+4;if(typeof E!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(v.length&&v[v.length-1][0]>=E)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const B=n.parse(P,R,S);if(!B)return null;S=S||B.type,v.push([E,B])}return de(S,Me)||de(S,Bi)||de(S,q)||de(S,L)||de(S,O(Me))?new Yi(S,a,h,g,v):n.error(`Type ${$(S)} is not interpolatable.`)}evaluate(e){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return a[0].evaluate(e);const g=n.length;if(h>=n[g-1])return a[g-1].evaluate(e);const y=Ko(n,h),v=Yi.interpolationFactor(this.interpolation,h,n[y],n[y+1]),S=a[y].evaluate(e),C=a[y+1].evaluate(e);switch(this.operator){case"interpolate":return Ir[this.type.kind](S,C,v);case"interpolate-hcl":return Ir.color(S,C,v,"hcl");case"interpolate-lab":return Ir.color(S,C,v,"lab")}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Hs(r,e,n,a){const h=a-n,g=r-n;return h===0?0:e===1?g/h:(Math.pow(e,g)-1)/(Math.pow(e,h)-1)}class Pt{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let a=null;const h=n.expectedType;h&&h.kind!=="value"&&(a=h);const g=[];for(const v of e.slice(1)){const S=n.parse(v,1+g.length,a,void 0,{typeAnnotation:"omit"});if(!S)return null;a=a||S.type,g.push(S)}if(!a)throw new Error("No output type");const y=h&&g.some(v=>ne(h,v.type));return new Pt(y?ft:a,g)}evaluate(e){let n,a=null,h=0;for(const g of this.args)if(h++,a=g.evaluate(e),a&&a instanceof Or&&!a.available&&(n||(n=a.name),a=null,h===this.args.length&&(a=n)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Fa{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let g=1;g<e.length-1;g+=2){const y=e[g];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);const v=n.parse(e[g+1],g+1);if(!v)return null;a.push([y,v])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,a);return h?new Fa(a,h):null}outputDefined(){return this.result.outputDefined()}}class Wl{constructor(e,n,a){this.type=e,this.index=n,this.input=a}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,Me),h=n.parse(e[2],2,O(n.expectedType||ft));return a&&h?new Wl(h.type.itemType,a,h):null}evaluate(e){const n=this.index.evaluate(e),a=this.input.evaluate(e);if(n<0)throw new oi(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new oi(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new oi(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Kl{constructor(e,n){this.type=pt,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,ft),h=n.parse(e[2],2,ft);return a&&h?ue(a.type,[pt,yt,Me,us,ft])?new Kl(a,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(a.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!te(n,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${$(yi(n))} instead.`);if(!te(a,["string","array"]))throw new oi(`Expected second argument to be of type array or string, but found ${$(yi(a))} instead.`);return a.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Ba{constructor(e,n,a){this.type=Me,this.needle=e,this.haystack=n,this.fromIndex=a}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,ft),h=n.parse(e[2],2,ft);if(!a||!h)return null;if(!ue(a.type,[pt,yt,Me,us,ft]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(a.type)} instead`);if(e.length===4){const g=n.parse(e[3],3,Me);return g?new Ba(a,h,g):null}return new Ba(a,h)}evaluate(e){const n=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!te(n,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${$(yi(n))} instead.`);if(!te(a,["string","array"]))throw new oi(`Expected second argument to be of type array or string, but found ${$(yi(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(n,h)}return a.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Xl{constructor(e,n,a,h,g,y){this.inputType=e,this.type=n,this.input=a,this.cases=h,this.outputs=g,this.otherwise=y}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let a,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const g={},y=[];for(let C=2;C<e.length-1;C+=2){let E=e[C];const P=e[C+1];Array.isArray(E)||(E=[E]);const D=n.concat(C);if(E.length===0)return D.error("Expected at least one branch label.");for(const B of E){if(typeof B!="number"&&typeof B!="string")return D.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return D.error("Numeric branch labels must be integer values.");if(a){if(D.checkSubtype(a,yi(B)))return null}else a=yi(B);if(g[String(B)]!==void 0)return D.error("Branch labels must be unique.");g[String(B)]=y.length}const R=n.parse(P,C,h);if(!R)return null;h=h||R.type,y.push(R)}const v=n.parse(e[1],1,ft);if(!v)return null;const S=n.parse(e[e.length-1],e.length-1,h);return S?v.type.kind!=="value"&&n.concat(1).checkSubtype(a,v.type)?null:new Xl(a,h,v,g,y,S):null}evaluate(e){const n=this.input.evaluate(e);return(yi(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Yl{constructor(e,n,a){this.type=e,this.branches=n,this.otherwise=a}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const v=n.parse(e[y],y,pt);if(!v)return null;const S=n.parse(e[y+1],y+1,a);if(!S)return null;h.push([v,S]),a=a||S.type}const g=n.parse(e[e.length-1],e.length-1,a);if(!g)return null;if(!a)throw new Error("Can't infer output type");return new Yl(a,h,g)}evaluate(e){for(const[n,a]of this.branches)if(n.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,a]of this.branches)e(n),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Oa{constructor(e,n,a,h){this.type=e,this.input=n,this.beginIndex=a,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=n.parse(e[1],1,ft),h=n.parse(e[2],2,Me);if(!a||!h)return null;if(!ue(a.type,[O(ft),yt,ft]))return n.error(`Expected first argument to be of type array or string, but found ${$(a.type)} instead`);if(e.length===4){const g=n.parse(e[3],3,Me);return g?new Oa(a.type,a,h,g):null}return new Oa(a.type,a,h)}evaluate(e){const n=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!te(n,["string","array"]))throw new oi(`Expected first argument to be of type array or string, but found ${$(yi(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(a,h)}return n.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ih(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function rh(r,e,n,a){return a.compare(e,n)===0}function Ws(r,e,n){const a=r!=="=="&&r!=="!=";return class g1{constructor(g,y,v){this.type=pt,this.lhs=g,this.rhs=y,this.collator=v,this.hasUntypedArgument=g.type.kind==="value"||y.type.kind==="value"}static parse(g,y){if(g.length!==3&&g.length!==4)return y.error("Expected two or three arguments.");const v=g[0];let S=y.parse(g[1],1,ft);if(!S)return null;if(!ih(v,S.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${$(S.type)}'.`);let C=y.parse(g[2],2,ft);if(!C)return null;if(!ih(v,C.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${$(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${$(S.type)}' and '${$(C.type)}'.`);a&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new Kr(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new Kr(S.type,[C])));let E=null;if(g.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(E=y.parse(g[3],3,Hn),!E)return null}return new g1(S,C,E)}evaluate(g){const y=this.lhs.evaluate(g),v=this.rhs.evaluate(g);if(a&&this.hasUntypedArgument){const S=yi(y),C=yi(v);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new oi(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const S=yi(y),C=yi(v);if(S.kind!=="string"||C.kind!=="string")return e(g,y,v)}return this.collator?n(g,y,v,this.collator.evaluate(g)):e(g,y,v)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Mp=Ws("==",function(r,e,n){return e===n},rh),Dp=Ws("!=",function(r,e,n){return e!==n},function(r,e,n,a){return!rh(0,e,n,a)}),Lp=Ws("<",function(r,e,n){return e<n},function(r,e,n,a){return a.compare(e,n)<0}),Rp=Ws(">",function(r,e,n){return e>n},function(r,e,n,a){return a.compare(e,n)>0}),Fp=Ws("<=",function(r,e,n){return e<=n},function(r,e,n,a){return a.compare(e,n)<=0}),Bp=Ws(">=",function(r,e,n){return e>=n},function(r,e,n,a){return a.compare(e,n)>=0});class Jl{constructor(e,n,a,h,g){this.type=yt,this.number=e,this.locale=n,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const a=n.parse(e[1],1,Me);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=n.parse(h.locale,1,yt),!g))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,yt),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=n.parse(h["min-fraction-digits"],1,Me),!v))return null;let S=null;return h["max-fraction-digits"]&&(S=n.parse(h["max-fraction-digits"],1,Me),!S)?null:new Jl(a,g,y,v,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Na{constructor(e){this.type=En,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const h=[];let g=!1;for(let y=1;y<=e.length-1;++y){const v=e[y];if(g&&typeof v=="object"&&!Array.isArray(v)){g=!1;let S=null;if(v["font-scale"]&&(S=n.parse(v["font-scale"],1,Me),!S))return null;let C=null;if(v["text-font"]&&(C=n.parse(v["text-font"],1,O(yt)),!C))return null;let E=null;if(v["text-color"]&&(E=n.parse(v["text-color"],1,Bi),!E))return null;const P=h[h.length-1];P.scale=S,P.font=C,P.textColor=E}else{const S=n.parse(e[y],1,ft);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Na(h)}evaluate(e){return new Sr(this.sections.map(n=>{const a=n.content.evaluate(e);return yi(a)===M?new Zl("",a,null,null,null):new Zl(Zo(a),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}}class Ql{constructor(e){this.type=M,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const a=n.parse(e[1],1,yt);return a?new Ql(a):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),a=Or.fromString(n);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(n)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class eu{constructor(e){this.type=Me,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=n.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${$(a.type)} instead.`):new eu(a):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new oi(`Expected value to be of type string or array, but found ${$(yi(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Ks={"==":Mp,"!=":Dp,">":Rp,"<":Lp,">=":Bp,"<=":Fp,array:Kr,at:Wl,boolean:Kr,case:Yl,coalesce:Pt,collator:Pa,format:Na,image:Ql,in:Kl,"index-of":Ba,interpolate:Yi,"interpolate-hcl":Yi,"interpolate-lab":Yi,length:eu,let:Fa,literal:cs,match:Xl,number:Kr,"number-format":Jl,object:Kr,slice:Oa,step:Gs,string:Kr,"to-boolean":pn,"to-color":pn,"to-number":pn,"to-string":pn,var:Da,within:ds};function nh(r,[e,n,a,h]){e=e.evaluate(r),n=n.evaluate(r),a=a.evaluate(r);const g=h?h.evaluate(r):1,y=Wc(e,n,a,g);if(y)throw new oi(y);return new Ft(e/255,n/255,a/255,g,!1)}function sh(r,e){return r in e}function tu(r,e){const n=e[r];return n===void 0?null:n}function fs(r){return{type:r}}function oh(r){return{result:"success",value:r}}function Xs(r){return{result:"error",value:r}}function Ys(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function ah(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function iu(r){return!!r.expression&&r.expression.interpolated}function zt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Js(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Op(r){return r}function lh(r,e){const n=e.type==="color",a=r.stops&&typeof r.stops[0][0]=="object",h=a||!(a||r.property!==void 0),g=r.type||(iu(e)?"exponential":"interval");if(n||e.type==="padding"){const E=n?Ft.parse:Tr.parse;(r=wr({},r)).stops&&(r.stops=r.stops.map(P=>[P[0],E(P[1])])),r.default=E(r.default?r.default:e.default)}if(r.colorSpace&&(y=r.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var y;let v,S,C;if(g==="exponential")v=uh;else if(g==="interval")v=hi;else if(g==="categorical"){v=Np,S=Object.create(null);for(const E of r.stops)S[E[0]]=E[1];C=typeof r.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=kt}if(a){const E={},P=[];for(let B=0;B<r.stops.length;B++){const j=r.stops[B],H=j[0].zoom;E[H]===void 0&&(E[H]={zoom:H,type:r.type,property:r.property,default:r.default,stops:[]},P.push(H)),E[H].stops.push([j[0].value,j[1]])}const D=[];for(const B of P)D.push([E[B].zoom,lh(E[B],e)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:Yi.interpolationFactor.bind(void 0,R),zoomStops:D.map(B=>B[0]),evaluate:({zoom:B},j)=>uh({stops:D,base:r.base},e,B).evaluate(B,j)}}if(h){const E=g==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:Yi.interpolationFactor.bind(void 0,E),zoomStops:r.stops.map(P=>P[0]),evaluate:({zoom:P})=>v(r,e,P,S,C)}}return{kind:"source",evaluate(E,P){const D=P&&P.properties?P.properties[r.property]:void 0;return D===void 0?Xo(r.default,e.default):v(r,e,D,S,C)}}}function Xo(r,e,n){return r!==void 0?r:e!==void 0?e:n!==void 0?n:void 0}function Np(r,e,n,a,h){return Xo(typeof n===h?a[n]:void 0,r.default,e.default)}function hi(r,e,n){if(zt(n)!=="number")return Xo(r.default,e.default);const a=r.stops.length;if(a===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[a-1][0])return r.stops[a-1][1];const h=Ko(r.stops.map(g=>g[0]),n);return r.stops[h][1]}function uh(r,e,n){const a=r.base!==void 0?r.base:1;if(zt(n)!=="number")return Xo(r.default,e.default);const h=r.stops.length;if(h===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[h-1][0])return r.stops[h-1][1];const g=Ko(r.stops.map(E=>E[0]),n),y=function(E,P,D,R){const B=R-D,j=E-D;return B===0?0:P===1?j/B:(Math.pow(P,j)-1)/(Math.pow(P,B)-1)}(n,a,r.stops[g][0],r.stops[g+1][0]),v=r.stops[g][1],S=r.stops[g+1][1],C=Ir[e.type]||Op;return typeof v.evaluate=="function"?{evaluate(...E){const P=v.evaluate.apply(void 0,E),D=S.evaluate.apply(void 0,E);if(P!==void 0&&D!==void 0)return C(P,D,y,r.colorSpace)}}:C(v,S,y,r.colorSpace)}function kt(r,e,n){switch(e.type){case"color":n=Ft.parse(n);break;case"formatted":n=Sr.fromString(n.toString());break;case"resolvedImage":n=Or.fromString(n.toString());break;case"padding":n=Tr.parse(n);break;default:zt(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return Xo(n,r.default,e.default)}Nr.register(Ks,{error:[{kind:"error"},[yt],(r,[e])=>{throw new oi(e.evaluate(r))}],typeof:[yt,[ft],(r,[e])=>$(yi(e.evaluate(r)))],"to-rgba":[O(Me,4),[Bi],(r,[e])=>{const[n,a,h,g]=e.evaluate(r).rgb;return[255*n,255*a,255*h,g]}],rgb:[Bi,[Me,Me,Me],nh],rgba:[Bi,[Me,Me,Me,Me],nh],has:{type:pt,overloads:[[[yt],(r,[e])=>sh(e.evaluate(r),r.properties())],[[yt,Br],(r,[e,n])=>sh(e.evaluate(r),n.evaluate(r))]]},get:{type:ft,overloads:[[[yt],(r,[e])=>tu(e.evaluate(r),r.properties())],[[yt,Br],(r,[e,n])=>tu(e.evaluate(r),n.evaluate(r))]]},"feature-state":[ft,[yt],(r,[e])=>tu(e.evaluate(r),r.featureState||{})],properties:[Br,[],r=>r.properties()],"geometry-type":[yt,[],r=>r.geometryType()],id:[ft,[],r=>r.id()],zoom:[Me,[],r=>r.globals.zoom],"heatmap-density":[Me,[],r=>r.globals.heatmapDensity||0],"line-progress":[Me,[],r=>r.globals.lineProgress||0],accumulated:[ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Me,fs(Me),(r,e)=>{let n=0;for(const a of e)n+=a.evaluate(r);return n}],"*":[Me,fs(Me),(r,e)=>{let n=1;for(const a of e)n*=a.evaluate(r);return n}],"-":{type:Me,overloads:[[[Me,Me],(r,[e,n])=>e.evaluate(r)-n.evaluate(r)],[[Me],(r,[e])=>-e.evaluate(r)]]},"/":[Me,[Me,Me],(r,[e,n])=>e.evaluate(r)/n.evaluate(r)],"%":[Me,[Me,Me],(r,[e,n])=>e.evaluate(r)%n.evaluate(r)],ln2:[Me,[],()=>Math.LN2],pi:[Me,[],()=>Math.PI],e:[Me,[],()=>Math.E],"^":[Me,[Me,Me],(r,[e,n])=>Math.pow(e.evaluate(r),n.evaluate(r))],sqrt:[Me,[Me],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))],log2:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Me,[Me],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Me,[Me],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Me,[Me],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Me,[Me],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Me,[Me],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Me,[Me],(r,[e])=>Math.atan(e.evaluate(r))],min:[Me,fs(Me),(r,e)=>Math.min(...e.map(n=>n.evaluate(r)))],max:[Me,fs(Me),(r,e)=>Math.max(...e.map(n=>n.evaluate(r)))],abs:[Me,[Me],(r,[e])=>Math.abs(e.evaluate(r))],round:[Me,[Me],(r,[e])=>{const n=e.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Me,[Me],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Me,[Me],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[pt,[yt,ft],(r,[e,n])=>r.properties()[e.value]===n.value],"filter-id-==":[pt,[ft],(r,[e])=>r.id()===e.value],"filter-type-==":[pt,[yt],(r,[e])=>r.geometryType()===e.value],"filter-<":[pt,[yt,ft],(r,[e,n])=>{const a=r.properties()[e.value],h=n.value;return typeof a==typeof h&&a<h}],"filter-id-<":[pt,[ft],(r,[e])=>{const n=r.id(),a=e.value;return typeof n==typeof a&&n<a}],"filter->":[pt,[yt,ft],(r,[e,n])=>{const a=r.properties()[e.value],h=n.value;return typeof a==typeof h&&a>h}],"filter-id->":[pt,[ft],(r,[e])=>{const n=r.id(),a=e.value;return typeof n==typeof a&&n>a}],"filter-<=":[pt,[yt,ft],(r,[e,n])=>{const a=r.properties()[e.value],h=n.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[pt,[ft],(r,[e])=>{const n=r.id(),a=e.value;return typeof n==typeof a&&n<=a}],"filter->=":[pt,[yt,ft],(r,[e,n])=>{const a=r.properties()[e.value],h=n.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[pt,[ft],(r,[e])=>{const n=r.id(),a=e.value;return typeof n==typeof a&&n>=a}],"filter-has":[pt,[ft],(r,[e])=>e.value in r.properties()],"filter-has-id":[pt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[pt,[O(yt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[pt,[O(ft)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[pt,[yt,O(ft)],(r,[e,n])=>n.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[pt,[yt,O(ft)],(r,[e,n])=>function(a,h,g,y){for(;g<=y;){const v=g+y>>1;if(h[v]===a)return!0;h[v]>a?y=v-1:g=v+1}return!1}(r.properties()[e.value],n.value,0,n.value.length-1)],all:{type:pt,overloads:[[[pt,pt],(r,[e,n])=>e.evaluate(r)&&n.evaluate(r)],[fs(pt),(r,e)=>{for(const n of e)if(!n.evaluate(r))return!1;return!0}]]},any:{type:pt,overloads:[[[pt,pt],(r,[e,n])=>e.evaluate(r)||n.evaluate(r)],[fs(pt),(r,e)=>{for(const n of e)if(n.evaluate(r))return!0;return!1}]]},"!":[pt,[pt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[pt,[yt],(r,[e])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(e.evaluate(r))}],upcase:[yt,[yt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[yt,[yt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[yt,fs(ft),(r,e)=>e.map(n=>Zo(n.evaluate(r))).join("")],"resolved-locale":[yt,[Hn],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Yo{constructor(e,n){var a;this.expression=e,this._warningHistory={},this._evaluator=new qs,this._defaultValue=n?(a=n).type==="color"&&Js(a.default)?new Ft(0,0,0,0):a.type==="color"?Ft.parse(a.default)||null:a.type==="padding"?Tr.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?$i.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,a,h,g,y){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,n,a,h,g,y){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new oi(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function $t(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Ks}function jt(r,e){const n=new Lt(Ks,Go,[],e?function(h){const g={color:Bi,string:yt,number:Me,enum:yt,boolean:pt,formatted:En,padding:q,resolvedImage:M,variableAnchorOffsetCollection:L};return h.type==="array"?O(g[h.value]||ft,h.length):g[h.type]}(e):void 0),a=n.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?oh(new Yo(a,e)):Xs(n.errors)}class Qs{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Wo(n.expression)}evaluateWithoutErrorHandling(e,n,a,h,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,h,g,y)}evaluate(e,n,a,h,g,y){return this._styleExpression.evaluate(e,n,a,h,g,y)}}class Va{constructor(e,n,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Wo(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,a,h,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,a,h,g,y)}evaluate(e,n,a,h,g,y){return this._styleExpression.evaluate(e,n,a,h,g,y)}interpolationFactor(e,n,a){return this.interpolationType?Yi.interpolationFactor(this.interpolationType,e,n,a):0}}function ch(r,e){const n=jt(r,e);if(n.result==="error")return n;const a=n.value.expression,h=Ho(a);if(!h&&!Ys(e))return Xs([new or("","data expressions not supported")]);const g=La(a,["zoom"]);if(!g&&!ah(e))return Xs([new or("","zoom expressions not supported")]);const y=Ua(a);return y||g?y instanceof or?Xs([y]):y instanceof Yi&&!iu(e)?Xs([new or("",'"interpolate" expressions cannot be used with this property')]):oh(y?new Va(h?"camera":"composite",n.value,y.labels,y instanceof Yi?y.interpolation:void 0):new Qs(h?"constant":"source",n.value)):Xs([new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ja{constructor(e,n){this._parameters=e,this._specification=n,wr(this,lh(this._parameters,this._specification))}static deserialize(e){return new ja(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Ua(r){let e=null;if(r instanceof Fa)e=Ua(r.result);else if(r instanceof Pt){for(const n of r.args)if(e=Ua(n),e)break}else(r instanceof Gs||r instanceof Yi)&&r.input instanceof Nr&&r.input.name==="zoom"&&(e=r);return e instanceof or||r.eachChild(n=>{const a=Ua(n);a instanceof or?e=a:!e&&a?e=new or("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new or("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ru(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!ru(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const hh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function $a(r){if(r==null)return{filter:()=>!0,needGeometry:!1};ru(r)||(r=eo(r));const e=jt(r,hh);if(e.result==="error")throw new Error(e.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,a,h)=>e.value.evaluate(n,a,{},h),needGeometry:nu(r)}}function dh(r,e){return r<e?-1:r>e?1:0}function nu(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(nu(r[e]))return!0;return!1}function eo(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?su(r[1],r[2],"=="):e==="!="?Za(su(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?su(r[1],r[2],e):e==="any"?(n=r.slice(1),["any"].concat(n.map(eo))):e==="all"?["all"].concat(r.slice(1).map(eo)):e==="none"?["all"].concat(r.slice(1).map(eo).map(Za)):e==="in"?ph(r[1],r.slice(2)):e==="!in"?Za(ph(r[1],r.slice(2))):e==="has"?fh(r[1]):e==="!has"?Za(fh(r[1])):e!=="within"||r;var n}function su(r,e,n){switch(r){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,r,e]}}function ph(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",r,["literal",e.sort(dh)]]:["filter-in-small",r,["literal",e]]}}function fh(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Za(r){return["!",r]}function ou(r){const e=typeof r;if(e==="number"||e==="boolean"||e==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let h="[";for(const g of r)h+=`${ou(g)},`;return`${h}]`}const n=Object.keys(r).sort();let a="{";for(let h=0;h<n.length;h++)a+=`${JSON.stringify(n[h])}:${ou(r[n[h]])},`;return`${a}}`}function Vp(r){let e="";for(const n of as)e+=`/${ou(r[n])}`;return e}function mh(r){const e=r.value;return e?[new Le(r.key,e,"constants have been deprecated as of v8")]:[]}function ai(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Kn(r){if(Array.isArray(r))return r.map(Kn);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const n in r)e[n]=Kn(r[n]);return e}return ai(r)}function Cr(r){const e=r.key,n=r.value,a=r.valueSpec||{},h=r.objectElementValidators||{},g=r.style,y=r.styleSpec,v=r.validateSpec;let S=[];const C=zt(n);if(C!=="object")return[new Le(e,n,`object expected, ${C} found`)];for(const E in n){const P=E.split(".")[0],D=a[P]||a["*"];let R;if(h[P])R=h[P];else if(a[P])R=v;else if(h["*"])R=h["*"];else{if(!a["*"]){S.push(new Le(e,n[E],`unknown property "${E}"`));continue}R=v}S=S.concat(R({key:(e&&`${e}.`)+E,value:n[E],valueSpec:D,style:g,styleSpec:y,object:n,objectKey:E,validateSpec:v},n))}for(const E in a)h[E]||a[E].required&&a[E].default===void 0&&n[E]===void 0&&S.push(new Le(e,n,`missing required property "${E}"`));return S}function to(r){const e=r.value,n=r.valueSpec,a=r.style,h=r.styleSpec,g=r.key,y=r.arrayElementValidator||r.validateSpec;if(zt(e)!=="array")return[new Le(g,e,`array expected, ${zt(e)} found`)];if(n.length&&e.length!==n.length)return[new Le(g,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new Le(g,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let v={type:n.value,values:n.values};h.$version<7&&(v.function=n.function),zt(n.value)==="object"&&(v=n.value);let S=[];for(let C=0;C<e.length;C++)S=S.concat(y({array:e,arrayIndex:C,value:e[C],valueSpec:v,validateSpec:r.validateSpec,style:a,styleSpec:h,key:`${g}[${C}]`}));return S}function au(r){const e=r.key,n=r.value,a=r.valueSpec;let h=zt(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new Le(e,n,`number expected, ${h} found`)]:"minimum"in a&&n<a.minimum?[new Le(e,n,`${n} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&n>a.maximum?[new Le(e,n,`${n} is greater than the maximum value ${a.maximum}`)]:[]}function lu(r){const e=r.valueSpec,n=ai(r.value.type);let a,h,g,y={};const v=n!=="categorical"&&r.value.property===void 0,S=!v,C=zt(r.value.stops)==="array"&&zt(r.value.stops[0])==="array"&&zt(r.value.stops[0][0])==="object",E=Cr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(R){if(n==="identity")return[new Le(R.key,R.value,'identity function may not have a "stops" property')];let B=[];const j=R.value;return B=B.concat(to({key:R.key,value:j,valueSpec:R.valueSpec,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:P})),zt(j)==="array"&&j.length===0&&B.push(new Le(R.key,j,"array must have at least one stop")),B},default:function(R){return R.validateSpec({key:R.key,value:R.value,valueSpec:e,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec})}}});return n==="identity"&&v&&E.push(new Le(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||E.push(new Le(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!iu(r.valueSpec)&&E.push(new Le(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!Ys(r.valueSpec)?E.push(new Le(r.key,r.value,"property functions not supported")):v&&!ah(r.valueSpec)&&E.push(new Le(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!C||r.value.property!==void 0||E.push(new Le(r.key,r.value,'"property" property is required')),E;function P(R){let B=[];const j=R.value,H=R.key;if(zt(j)!=="array")return[new Le(H,j,`array expected, ${zt(j)} found`)];if(j.length!==2)return[new Le(H,j,`array length 2 expected, length ${j.length} found`)];if(C){if(zt(j[0])!=="object")return[new Le(H,j,`object expected, ${zt(j[0])} found`)];if(j[0].zoom===void 0)return[new Le(H,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Le(H,j,"object stop key must have value")];if(g&&g>ai(j[0].zoom))return[new Le(H,j[0].zoom,"stop zoom values must appear in ascending order")];ai(j[0].zoom)!==g&&(g=ai(j[0].zoom),h=void 0,y={}),B=B.concat(Cr({key:`${H}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:au,value:D}}))}else B=B.concat(D({key:`${H}[0]`,value:j[0],valueSpec:{},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec},j));return $t(Kn(j[1]))?B.concat([new Le(`${H}[1]`,j[1],"expressions are not allowed in function stops.")]):B.concat(R.validateSpec({key:`${H}[1]`,value:j[1],valueSpec:e,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec}))}function D(R,B){const j=zt(R.value),H=ai(R.value),Y=R.value!==null?R.value:B;if(a){if(j!==a)return[new Le(R.key,Y,`${j} stop domain type must match previous stop domain type ${a}`)]}else a=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new Le(R.key,Y,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&n!=="categorical"){let ce=`number expected, ${j} found`;return Ys(e)&&n===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Le(R.key,Y,ce)]}return n!=="categorical"||j!=="number"||isFinite(H)&&Math.floor(H)===H?n!=="categorical"&&j==="number"&&h!==void 0&&H<h?[new Le(R.key,Y,"stop domain values must appear in ascending order")]:(h=H,n==="categorical"&&H in y?[new Le(R.key,Y,"stop domain values must be unique")]:(y[H]=!0,[])):[new Le(R.key,Y,`integer expected, found ${H}`)]}}function io(r){const e=(r.expressionContext==="property"?ch:jt)(Kn(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new Le(`${r.key}${a.key}`,r.value,a.message));const n=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new Le(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Wo(n))return[new Le(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Wo(n))return[new Le(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!La(n,["zoom","feature-state"]))return[new Le(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ho(n))return[new Le(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ms(r){const e=r.key,n=r.value,a=r.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(ai(n))===-1&&h.push(new Le(e,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(ai(n))===-1&&h.push(new Le(e,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function ro(r){return ru(Kn(r.value))?io(wr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Jo(r)}function Jo(r){const e=r.value,n=r.key;if(zt(e)!=="array")return[new Le(n,e,`array expected, ${zt(e)} found`)];const a=r.styleSpec;let h,g=[];if(e.length<1)return[new Le(n,e,"filter array must have at least 1 element")];switch(g=g.concat(ms({key:`${n}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),ai(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&ai(e[1])==="$type"&&g.push(new Le(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&g.push(new Le(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=zt(e[1]),h!=="string"&&g.push(new Le(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=zt(e[y]),ai(e[1])==="$type"?g=g.concat(ms({key:`${n}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&g.push(new Le(`${n}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)g=g.concat(Jo({key:`${n}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=zt(e[1]),e.length!==2?g.push(new Le(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&g.push(new Le(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=zt(e[1]),e.length!==2?g.push(new Le(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&g.push(new Le(`${n}[1]`,e[1],`object expected, ${h} found`))}return g}function uu(r,e){const n=r.key,a=r.validateSpec,h=r.style,g=r.styleSpec,y=r.value,v=r.objectKey,S=g[`${e}_${r.layerType}`];if(!S)return[];const C=v.match(/^(.*)-transition$/);if(e==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return a({key:n,value:y,valueSpec:g.transition,style:h,styleSpec:g});const E=r.valueSpec||S[v];if(!E)return[new Le(n,y,`unknown property "${v}"`)];let P;if(zt(y)==="string"&&Ys(E)&&!E.tokens&&(P=/^{([^}]+)}$/.exec(y)))return[new Le(n,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(P[1])} }\`.`)];const D=[];return r.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&D.push(new Le(n,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Js(Kn(y))&&ai(y.type)==="identity"&&D.push(new Le(n,y,'"text-font" does not support identity functions'))),D.concat(a({key:r.key,value:y,valueSpec:E,style:h,styleSpec:g,expressionContext:"property",propertyType:e,propertyKey:v}))}function qa(r){return uu(r,"paint")}function cu(r){return uu(r,"layout")}function hu(r){let e=[];const n=r.value,a=r.key,h=r.style,g=r.styleSpec;n.type||n.ref||e.push(new Le(a,n,'either "type" or "ref" is required'));let y=ai(n.type);const v=ai(n.ref);if(n.id){const S=ai(n.id);for(let C=0;C<r.arrayIndex;C++){const E=h.layers[C];ai(E.id)===S&&e.push(new Le(a,n.id,`duplicate layer id "${n.id}", previously used at line ${E.id.__line__}`))}}if("ref"in n){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in n&&e.push(new Le(a,n[C],`"${C}" is prohibited for ref layers`))}),h.layers.forEach(C=>{ai(C.id)===v&&(S=C)}),S?S.ref?e.push(new Le(a,n.ref,"ref cannot reference another ref layer")):y=ai(S.type):e.push(new Le(a,n.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(n.source){const S=h.sources&&h.sources[n.source],C=S&&ai(S.type);S?C==="vector"&&y==="raster"?e.push(new Le(a,n.source,`layer "${n.id}" requires a raster source`)):C!=="raster-dem"&&y==="hillshade"?e.push(new Le(a,n.source,`layer "${n.id}" requires a raster-dem source`)):C==="raster"&&y!=="raster"?e.push(new Le(a,n.source,`layer "${n.id}" requires a vector source`)):C!=="vector"||n["source-layer"]?C==="raster-dem"&&y!=="hillshade"?e.push(new Le(a,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||e.push(new Le(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Le(a,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new Le(a,n.source,`source "${n.source}" not found`))}else e.push(new Le(a,n,'missing required property "source"'));return e=e.concat(Cr({key:a,value:n,valueSpec:g.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${a}.type`,value:n.type,valueSpec:g.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:ro,layout:S=>Cr({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>cu(wr({layerType:y},C))}}),paint:S=>Cr({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>qa(wr({layerType:y},C))}})}})),e}function mn(r){const e=r.value,n=r.key,a=zt(e);return a!=="string"?[new Le(n,e,`string expected, ${a} found`)]:[]}const gh={promoteId:function({key:r,value:e}){if(zt(e)==="string")return mn({key:r,value:e});{const n=[];for(const a in e)n.push(...mn({key:`${r}.${a}`,value:e[a]}));return n}}};function yh(r){const e=r.value,n=r.key,a=r.styleSpec,h=r.style,g=r.validateSpec;if(!e.type)return[new Le(n,e,'"type" is required')];const y=ai(e.type);let v;switch(y){case"vector":case"raster":return v=Cr({key:n,value:e,valueSpec:a[`source_${y.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:gh,validateSpec:g}),v;case"raster-dem":return v=function(S){var C;const E=(C=S.sourceName)!==null&&C!==void 0?C:"",P=S.value,D=S.styleSpec,R=D.source_raster_dem,B=S.style;let j=[];const H=zt(P);if(P===void 0)return j;if(H!=="object")return j.push(new Le("source_raster_dem",P,`object expected, ${H} found`)),j;const Y=ai(P.encoding)==="custom",ce=["redFactor","greenFactor","blueFactor","baseShift"],ee=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const ae in P)!Y&&ce.includes(ae)?j.push(new Le(ae,P[ae],`In "${E}": "${ae}" is only valid when "encoding" is set to "custom". ${ee} encoding found`)):R[ae]?j=j.concat(S.validateSpec({key:ae,value:P[ae],valueSpec:R[ae],validateSpec:S.validateSpec,style:B,styleSpec:D})):j.push(new Le(ae,P[ae],`unknown property "${ae}"`));return j}({sourceName:n,value:e,style:r.style,styleSpec:a,validateSpec:g}),v;case"geojson":if(v=Cr({key:n,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:g,objectElementValidators:gh}),e.cluster)for(const S in e.clusterProperties){const[C,E]=e.clusterProperties[S],P=typeof C=="string"?[C,["accumulated"],["get",S]]:C;v.push(...io({key:`${n}.${S}.map`,value:E,validateSpec:g,expressionContext:"cluster-map"})),v.push(...io({key:`${n}.${S}.reduce`,value:P,validateSpec:g,expressionContext:"cluster-reduce"}))}return v;case"video":return Cr({key:n,value:e,valueSpec:a.source_video,style:h,validateSpec:g,styleSpec:a});case"image":return Cr({key:n,value:e,valueSpec:a.source_image,style:h,validateSpec:g,styleSpec:a});case"canvas":return[new Le(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ms({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:g,styleSpec:a})}}function _h(r){const e=r.value,n=r.styleSpec,a=n.light,h=r.style;let g=[];const y=zt(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new Le("light",e,`object expected, ${y} found`)]),g;for(const v in e){const S=v.match(/^(.*)-transition$/);g=g.concat(S&&a[S[1]]&&a[S[1]].transition?r.validateSpec({key:v,value:e[v],valueSpec:n.transition,validateSpec:r.validateSpec,style:h,styleSpec:n}):a[v]?r.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new Le(v,e[v],`unknown property "${v}"`)])}return g}function vh(r){const e=r.value,n=r.styleSpec,a=n.sky,h=r.style,g=zt(e);if(e===void 0)return[];if(g!=="object")return[new Le("sky",e,`object expected, ${g} found`)];let y=[];for(const v in e)y=y.concat(a[v]?Mi({key:v,value:e[v],valueSpec:a[v],style:h,styleSpec:n}):[new Le(v,e[v],`unknown property "${v}"`)]);return y}function xh(r){const e=r.value,n=r.styleSpec,a=n.terrain,h=r.style;let g=[];const y=zt(e);if(e===void 0)return g;if(y!=="object")return g=g.concat([new Le("terrain",e,`object expected, ${y} found`)]),g;for(const v in e)g=g.concat(a[v]?r.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:r.validateSpec,style:h,styleSpec:n}):[new Le(v,e[v],`unknown property "${v}"`)]);return g}function Qo(r){let e=[];const n=r.value,a=r.key;if(Array.isArray(n)){const h=[],g=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&e.push(new Le(a,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&g.includes(n[y].url)&&e.push(new Le(a,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),g.push(n[y].url),e=e.concat(Cr({key:`${a}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return e}return mn({key:a,value:n})}const ea={"*":()=>[],array:to,boolean:function(r){const e=r.value,n=r.key,a=zt(e);return a!=="boolean"?[new Le(n,e,`boolean expected, ${a} found`)]:[]},number:au,color:function(r){const e=r.key,n=r.value,a=zt(n);return a!=="string"?[new Le(e,n,`color expected, ${a} found`)]:Ft.parse(String(n))?[]:[new Le(e,n,`color expected, "${n}" found`)]},constants:mh,enum:ms,filter:ro,function:lu,layer:hu,object:Cr,source:yh,light:_h,sky:vh,terrain:xh,string:mn,formatted:function(r){return mn(r).length===0?[]:io(r)},resolvedImage:function(r){return mn(r).length===0?[]:io(r)},padding:function(r){const e=r.key,n=r.value;if(zt(n)==="array"){if(n.length<1||n.length>4)return[new Le(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const a={type:"number"};let h=[];for(let g=0;g<n.length;g++)h=h.concat(r.validateSpec({key:`${e}[${g}]`,value:n[g],validateSpec:r.validateSpec,valueSpec:a}));return h}return au({key:e,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const e=r.key,n=r.value,a=zt(n),h=r.styleSpec;if(a!=="array"||n.length<1||n.length%2!=0)return[new Le(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let y=0;y<n.length;y+=2)g=g.concat(ms({key:`${e}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),g=g.concat(to({key:`${e}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:h}));return g},sprite:Qo};function Mi(r){const e=r.value,n=r.valueSpec,a=r.styleSpec;return r.validateSpec=Mi,n.expression&&Js(ai(e))?lu(r):n.expression&&$t(Kn(e))?io(r):n.type&&ea[n.type]?ea[n.type](r):Cr(wr({},r,{valueSpec:n.type?a[n.type]:n}))}function no(r){const e=r.value,n=r.key,a=mn(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Le(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Le(n,e,'"glyphs" url must include a "{range}" token'))),a}function Vr(r,e=ye){let n=[];return n=n.concat(Mi({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:Mi,objectElementValidators:{glyphs:no,"*":()=>[]}})),r.constants&&(n=n.concat(mh({key:"constants",value:r.constants,style:r,styleSpec:e,validateSpec:Mi}))),wh(n)}function gn(r){return function(e){return r({...e,validateSpec:Mi})}}function wh(r){return[].concat(r).sort((e,n)=>e.line-n.line)}function lr(r){return function(...e){return wh(r.apply(this,e))}}Vr.source=lr(gn(yh)),Vr.sprite=lr(gn(Qo)),Vr.glyphs=lr(gn(no)),Vr.light=lr(gn(_h)),Vr.sky=lr(gn(vh)),Vr.terrain=lr(gn(xh)),Vr.layer=lr(gn(hu)),Vr.filter=lr(gn(ro)),Vr.paintProperty=lr(gn(qa)),Vr.layoutProperty=lr(gn(cu));const so=Vr,du=so.light,jp=so.paintProperty,pu=so.layoutProperty;function bh(r,e){let n=!1;if(e&&e.length)for(const a of e)r.fire(new bi(new Error(a.message))),n=!0;return n}class Pn{constructor(e,n,a){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(n=y[1])+2*(a=y[2]);for(let S=0;S<this.d*this.d;S++){const C=y[3+S],E=y[3+S+1];h.push(C===E?null:y.subarray(C,E))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=n+2*a;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=a,this.scale=n/e,this.uid=0;const g=a/n*e;this.min=-g,this.max=e+g}insert(e,n,a,h,g){this._forEachCell(n,a,h,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,a,h,g,y){this.cells[g].push(y)}query(e,n,a,h,g){const y=this.min,v=this.max;if(e<=y&&n<=y&&v<=a&&v<=h&&!g)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,n,a,h,this._queryCell,S,{},g),S}}_queryCell(e,n,a,h,g,y,v,S){const C=this.cells[g];if(C!==null){const E=this.keys,P=this.bboxes;for(let D=0;D<C.length;D++){const R=C[D];if(v[R]===void 0){const B=4*R;(S?S(P[B+0],P[B+1],P[B+2],P[B+3]):e<=P[B+2]&&n<=P[B+3]&&a>=P[B+0]&&h>=P[B+1])?(v[R]=!0,y.push(E[R])):v[R]=!1}}}}_forEachCell(e,n,a,h,g,y,v,S){const C=this._convertToCellCoord(e),E=this._convertToCellCoord(n),P=this._convertToCellCoord(a),D=this._convertToCellCoord(h);for(let R=C;R<=P;R++)for(let B=E;B<=D;B++){const j=this.d*B+R;if((!S||S(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&g.call(this,e,n,a,h,j,y,v,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let a=0;for(let y=0;y<this.cells.length;y++)a+=this.cells[y].length;const h=new Int32Array(n+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let g=n;for(let y=0;y<e.length;y++){const v=e[y];h[3+y]=g,h.set(v,g),g+=v.length}return h[3+e.length]=g,h.set(this.keys,g),g+=this.keys.length,h[3+e.length+1]=g,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer}static serialize(e,n){const a=e.toArrayBuffer();return n&&n.push(a),{buffer:a}}static deserialize(e){return new Pn(e.buffer)}}const Xn={};function qe(r,e,n={}){if(Xn[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),Xn[r]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}qe("Object",Object),qe("TransferableGridIndex",Pn),qe("Color",Ft),qe("Error",Error),qe("AJAXError",Wr),qe("ResolvedImage",Or),qe("StylePropertyFunction",ja),qe("StyleExpression",Yo,{omit:["_evaluator"]}),qe("ZoomDependentExpression",Va),qe("ZoomConstantExpression",Qs),qe("CompoundExpression",Nr,{omit:["_evaluate"]});for(const r in Ks)Ks[r]._classRegistryKey||qe(`Expression_${r}`,Ks[r]);function fu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function gs(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error)return r;if(fu(r)||Ge(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const n=r;return e&&e.push(n.buffer),n}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const n=[];for(const a of r)n.push(gs(a,e));return n}if(typeof r=="object"){const n=r.constructor,a=n._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${n.name}`);if(!Xn[a])throw new Error(`${a} is not registered.`);const h=n.serialize?n.serialize(r,e):{};if(n.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in r){if(!r.hasOwnProperty(g)||Xn[a].omit.indexOf(g)>=0)continue;const y=r[g];h[g]=Xn[a].shallow.indexOf(g)>=0?y:gs(y,e)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof r)}function oo(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||fu(r)||Ge(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(oo);if(typeof r=="object"){const e=r.$name||"Object";if(!Xn[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=Xn[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(r);const a=Object.create(n.prototype);for(const h of Object.keys(r)){if(h==="$name")continue;const g=r[h];a[h]=Xn[e].shallow.indexOf(h)>=0?g:oo(g)}return a}throw new Error("can't deserialize object of type "+typeof r)}class mu{constructor(){this.first=!0}update(e,n){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const $e={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function ta(r){for(const e of r)if(Ha(e.charCodeAt(0)))return!0;return!1}function Ga(r){for(const e of r)if(!Sh(e.charCodeAt(0)))return!1;return!0}function Sh(r){return!($e.Arabic(r)||$e["Arabic Supplement"](r)||$e["Arabic Extended-A"](r)||$e["Arabic Presentation Forms-A"](r)||$e["Arabic Presentation Forms-B"](r))}function Ha(r){return!(r!==746&&r!==747&&(r<4352||!($e["Bopomofo Extended"](r)||$e.Bopomofo(r)||$e["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||$e["CJK Compatibility Ideographs"](r)||$e["CJK Compatibility"](r)||$e["CJK Radicals Supplement"](r)||$e["CJK Strokes"](r)||!(!$e["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||$e["CJK Unified Ideographs Extension A"](r)||$e["CJK Unified Ideographs"](r)||$e["Enclosed CJK Letters and Months"](r)||$e["Hangul Compatibility Jamo"](r)||$e["Hangul Jamo Extended-A"](r)||$e["Hangul Jamo Extended-B"](r)||$e["Hangul Jamo"](r)||$e["Hangul Syllables"](r)||$e.Hiragana(r)||$e["Ideographic Description Characters"](r)||$e.Kanbun(r)||$e["Kangxi Radicals"](r)||$e["Katakana Phonetic Extensions"](r)||$e.Katakana(r)&&r!==12540||!(!$e["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!$e["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||$e["Unified Canadian Aboriginal Syllabics"](r)||$e["Unified Canadian Aboriginal Syllabics Extended"](r)||$e["Vertical Forms"](r)||$e["Yijing Hexagram Symbols"](r)||$e["Yi Syllables"](r)||$e["Yi Radicals"](r))))}function gu(r){return!(Ha(r)||function(e){return!!($e["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||$e["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||$e["Letterlike Symbols"](e)||$e["Number Forms"](e)||$e["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||$e["Control Pictures"](e)&&e!==9251||$e["Optical Character Recognition"](e)||$e["Enclosed Alphanumerics"](e)||$e["Geometric Shapes"](e)||$e["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||$e["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||$e["CJK Symbols and Punctuation"](e)||$e.Katakana(e)||$e["Private Use Area"](e)||$e["CJK Compatibility Forms"](e)||$e["Small Form Variants"](e)||$e["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function yu(r){return r>=1424&&r<=2303||$e["Arabic Presentation Forms-A"](r)||$e["Arabic Presentation Forms-B"](r)}function _u(r,e){return!(!e&&yu(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||$e.Khmer(r))}function Th(r){for(const e of r)if(yu(e.charCodeAt(0)))return!0;return!1}const ys=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Ht{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mu,this.transition={})}isSupportedScript(e){return function(n,a){for(const h of n)if(!_u(h.charCodeAt(0),a))return!1;return!0}(e,ys.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*n}}}class Wa{constructor(e,n){this.property=e,this.value=n,this.expression=function(a,h){if(Js(a))return new ja(a,h);if($t(a)){const g=ch(a,h);if(g.result==="error")throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=a;return h.type==="color"&&typeof a=="string"?g=Ft.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)&&(g=$i.parse(a)):g=Tr.parse(a),{kind:"constant",evaluate:()=>g}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,a){return this.property.possiblyEvaluate(this,e,n,a)}}class Ka{constructor(e){this.property=e,this.value=new Wa(e,void 0)}transitioned(e,n){return new xu(this.property,this.value,n,Ke({},e.transition,this.transition),e.now)}untransitioned(){return new xu(this.property,this.value,null,{},0)}}class vu{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ot(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ka(this._values[e].property)),this._values[e].value=new Wa(this._values[e].property,n===null?void 0:Ot(n))}getTransition(e){return Ot(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ka(this._values[e].property)),this._values[e].transition=Ot(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a);const h=this.getTransition(n);h!==void 0&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const a=new Ih(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,n._values[h]);return a}untransitioned(){const e=new Ih(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class xu{constructor(e,n,a,h,g){this.property=e,this.value=n,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,n,a){const h=e.now||0,g=this.value.possiblyEvaluate(e,n,a),y=this.prior;if(y){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return y.possiblyEvaluate(e,n,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,n,a),g,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,E=C*S;return 4*(S<.5?E:3*(S-C)+E-.75)}(v))}}return g}}class Ih{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,a){const h=new ia(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,n,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Up{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Ot(this._values[e].value)}setValue(e,n){this._values[e]=new Wa(this._values[e].property,n===null?void 0:Ot(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(e[n]=a)}return e}possiblyEvaluate(e,n,a){const h=new ia(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(e,n,a);return h}}class Xr{constructor(e,n,a){this.property=e,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,a,h){return this.property.evaluate(this.value,this.parameters,e,n,a,h)}}class ia{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class et{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,a){const h=Ir[this.specification.type];return h?h(e,n,a):e}}class nt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,a,h){return new Xr(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},a,h)}:e.expression,n)}interpolate(e,n,a){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Xr(this,{kind:"constant",value:void 0},e.parameters);const h=Ir[this.specification.type];if(h){const g=h(e.value.value,n.value.value,a);return new Xr(this,{kind:"constant",value:g},e.parameters)}return e}evaluate(e,n,a,h,g,y){return e.kind==="constant"?e.value:e.evaluate(n,a,h,g,y)}}class _s extends nt{possiblyEvaluate(e,n,a,h){if(e.value===void 0)return new Xr(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const g=e.expression.evaluate(n,null,{},a,h),y=e.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,v=this._calculate(y,y,y,n);return new Xr(this,{kind:"constant",value:v},n)}if(e.expression.kind==="camera"){const g=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new Xr(this,{kind:"constant",value:g},n)}return new Xr(this,e.expression,n)}evaluate(e,n,a,h,g,y){if(e.kind==="source"){const v=e.evaluate(n,a,h,g,y);return this._calculate(v,v,v,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},a,h),e.evaluate({zoom:Math.floor(n.zoom)},a,h),e.evaluate({zoom:Math.floor(n.zoom)+1},a,h),n):e.value}_calculate(e,n,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:a,to:n}}interpolate(e){return e}}class wu{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const g=e.expression.evaluate(n,null,{},a,h);return this._calculate(g,g,g,n)}return this._calculate(e.expression.evaluate(new Ht(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Ht(Math.floor(n.zoom),n)),e.expression.evaluate(new Ht(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:a,to:n}}interpolate(e){return e}}class ra{constructor(e){this.specification=e}possiblyEvaluate(e,n,a,h){return!!e.expression.evaluate(n,null,{},a,h)}interpolate(){return!1}}class ur{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const a=e[n];a.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new Wa(a,void 0),g=this.defaultTransitionablePropertyValues[n]=new Ka(a);this.defaultTransitioningPropertyValues[n]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}qe("DataDrivenProperty",nt),qe("DataConstantProperty",et),qe("CrossFadedDataDrivenProperty",_s),qe("CrossFadedProperty",wu),qe("ColorRampProperty",ra);const Ch="-transition";class Yr extends os{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Up(n.layout)),n.paint)){this._transitionablePaint=new vu(n.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ia(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,a={}){n!=null&&this._validate(pu,`layers.${this.id}.layout.${e}`,e,n,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return e.endsWith(Ch)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,a={}){if(n!=null&&this._validate(jp,`layers.${this.id}.paint.${e}`,e,n,a))return!1;if(e.endsWith(Ch))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[e],g=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||y||g||this._handleOverridablePaintPropertyUpdate(e,v,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),xt(e,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(e,n,a,h,g={}){return(!g||g.validate!==!1)&&bh(this,e.call(so,{key:n,layerType:this.type,objectKey:a,value:h,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Xr&&Ys(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const kh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ao{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ti{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function di(r,e=1){let n=0,a=0;return{members:r.map(h=>{const g=kh[h.type].BYTES_PER_ELEMENT,y=n=Eh(n,Math.max(e,g)),v=h.components||1;return a=Math.max(a,g),n+=g*v,{name:h.name,type:h.type,components:v,offset:y}}),size:Eh(n,Math.max(a,e)),alignment:e}}function Eh(r,e){return Math.ceil(r/e)*e}class na extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=a,e}}na.prototype.bytesPerElement=4,qe("StructArrayLayout2i4",na);class Xa extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const g=3*e;return this.int16[g+0]=n,this.int16[g+1]=a,this.int16[g+2]=h,e}}Xa.prototype.bytesPerElement=6,qe("StructArrayLayout3i6",Xa);class Yn extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,a,h)}emplace(e,n,a,h,g){const y=4*e;return this.int16[y+0]=n,this.int16[y+1]=a,this.int16[y+2]=h,this.int16[y+3]=g,e}}Yn.prototype.bytesPerElement=8,qe("StructArrayLayout4i8",Yn);class bu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,a,h,g,y)}emplace(e,n,a,h,g,y,v){const S=6*e;return this.int16[S+0]=n,this.int16[S+1]=a,this.int16[S+2]=h,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=v,e}}bu.prototype.bytesPerElement=12,qe("StructArrayLayout2i4i12",bu);class Su extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,a,h,g,y)}emplace(e,n,a,h,g,y,v){const S=4*e,C=8*e;return this.int16[S+0]=n,this.int16[S+1]=a,this.uint8[C+4]=h,this.uint8[C+5]=g,this.uint8[C+6]=y,this.uint8[C+7]=v,e}}Su.prototype.bytesPerElement=8,qe("StructArrayLayout2i4ub8",Su);class sa extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=a,e}}sa.prototype.bytesPerElement=8,qe("StructArrayLayout2f8",sa);class Tu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y,v,S,C,E){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,a,h,g,y,v,S,C,E)}emplace(e,n,a,h,g,y,v,S,C,E,P){const D=10*e;return this.uint16[D+0]=n,this.uint16[D+1]=a,this.uint16[D+2]=h,this.uint16[D+3]=g,this.uint16[D+4]=y,this.uint16[D+5]=v,this.uint16[D+6]=S,this.uint16[D+7]=C,this.uint16[D+8]=E,this.uint16[D+9]=P,e}}Tu.prototype.bytesPerElement=20,qe("StructArrayLayout10ui20",Tu);class Ya extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y,v,S,C,E,P,D){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,a,h,g,y,v,S,C,E,P,D)}emplace(e,n,a,h,g,y,v,S,C,E,P,D,R){const B=12*e;return this.int16[B+0]=n,this.int16[B+1]=a,this.int16[B+2]=h,this.int16[B+3]=g,this.uint16[B+4]=y,this.uint16[B+5]=v,this.uint16[B+6]=S,this.uint16[B+7]=C,this.int16[B+8]=E,this.int16[B+9]=P,this.int16[B+10]=D,this.int16[B+11]=R,e}}Ya.prototype.bytesPerElement=24,qe("StructArrayLayout4i4ui4i24",Ya);class Iu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const g=3*e;return this.float32[g+0]=n,this.float32[g+1]=a,this.float32[g+2]=h,e}}Iu.prototype.bytesPerElement=12,qe("StructArrayLayout3f12",Iu);class Cu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Cu.prototype.bytesPerElement=4,qe("StructArrayLayout1ul4",Cu);class zn extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y,v,S,C){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,a,h,g,y,v,S,C)}emplace(e,n,a,h,g,y,v,S,C,E){const P=10*e,D=5*e;return this.int16[P+0]=n,this.int16[P+1]=a,this.int16[P+2]=h,this.int16[P+3]=g,this.int16[P+4]=y,this.int16[P+5]=v,this.uint32[D+3]=S,this.uint16[P+8]=C,this.uint16[P+9]=E,e}}zn.prototype.bytesPerElement=20,qe("StructArrayLayout6i1ul2ui20",zn);class Ja extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,a,h,g,y)}emplace(e,n,a,h,g,y,v){const S=6*e;return this.int16[S+0]=n,this.int16[S+1]=a,this.int16[S+2]=h,this.int16[S+3]=g,this.int16[S+4]=y,this.int16[S+5]=v,e}}Ja.prototype.bytesPerElement=12,qe("StructArrayLayout2i2i2i12",Ja);class oa extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,a,h,g)}emplace(e,n,a,h,g,y){const v=4*e,S=8*e;return this.float32[v+0]=n,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[S+6]=g,this.int16[S+7]=y,e}}oa.prototype.bytesPerElement=16,qe("StructArrayLayout2f1f2i16",oa);class Qa extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,a,h)}emplace(e,n,a,h,g){const y=12*e,v=3*e;return this.uint8[y+0]=n,this.uint8[y+1]=a,this.float32[v+1]=h,this.float32[v+2]=g,e}}Qa.prototype.bytesPerElement=12,qe("StructArrayLayout2ub2f12",Qa);class lo extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const g=3*e;return this.uint16[g+0]=n,this.uint16[g+1]=a,this.uint16[g+2]=h,e}}lo.prototype.bytesPerElement=6,qe("StructArrayLayout3ui6",lo);class ku extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y){const ce=this.length;return this.resize(ce+1),this.emplace(ce,e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y)}emplace(e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y,ce){const ee=24*e,ae=12*e,xe=48*e;return this.int16[ee+0]=n,this.int16[ee+1]=a,this.uint16[ee+2]=h,this.uint16[ee+3]=g,this.uint32[ae+2]=y,this.uint32[ae+3]=v,this.uint32[ae+4]=S,this.uint16[ee+10]=C,this.uint16[ee+11]=E,this.uint16[ee+12]=P,this.float32[ae+7]=D,this.float32[ae+8]=R,this.uint8[xe+36]=B,this.uint8[xe+37]=j,this.uint8[xe+38]=H,this.uint32[ae+10]=Y,this.int16[ee+22]=ce,e}}ku.prototype.bytesPerElement=48,qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ku);class uo extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y,ce,ee,ae,xe,be,je,Ye,Ve,Oe,De,We){const Be=this.length;return this.resize(Be+1),this.emplace(Be,e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y,ce,ee,ae,xe,be,je,Ye,Ve,Oe,De,We)}emplace(e,n,a,h,g,y,v,S,C,E,P,D,R,B,j,H,Y,ce,ee,ae,xe,be,je,Ye,Ve,Oe,De,We,Be){const Pe=32*e,rt=16*e;return this.int16[Pe+0]=n,this.int16[Pe+1]=a,this.int16[Pe+2]=h,this.int16[Pe+3]=g,this.int16[Pe+4]=y,this.int16[Pe+5]=v,this.int16[Pe+6]=S,this.int16[Pe+7]=C,this.uint16[Pe+8]=E,this.uint16[Pe+9]=P,this.uint16[Pe+10]=D,this.uint16[Pe+11]=R,this.uint16[Pe+12]=B,this.uint16[Pe+13]=j,this.uint16[Pe+14]=H,this.uint16[Pe+15]=Y,this.uint16[Pe+16]=ce,this.uint16[Pe+17]=ee,this.uint16[Pe+18]=ae,this.uint16[Pe+19]=xe,this.uint16[Pe+20]=be,this.uint16[Pe+21]=je,this.uint16[Pe+22]=Ye,this.uint32[rt+12]=Ve,this.float32[rt+13]=Oe,this.float32[rt+14]=De,this.uint16[Pe+30]=We,this.uint16[Pe+31]=Be,e}}uo.prototype.bytesPerElement=64,qe("StructArrayLayout8i15ui1ul2f2ui64",uo);class Jn extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Jn.prototype.bytesPerElement=4,qe("StructArrayLayout1f4",Jn);class Eu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const g=3*e;return this.uint16[6*e+0]=n,this.float32[g+1]=a,this.float32[g+2]=h,e}}Eu.prototype.bytesPerElement=12,qe("StructArrayLayout1ui2f12",Eu);class el extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,a)}emplace(e,n,a,h){const g=4*e;return this.uint32[2*e+0]=n,this.uint16[g+2]=a,this.uint16[g+3]=h,e}}el.prototype.bytesPerElement=8,qe("StructArrayLayout1ul2ui8",el);class vs extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const a=this.length;return this.resize(a+1),this.emplace(a,e,n)}emplace(e,n,a){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=a,e}}vs.prototype.bytesPerElement=4,qe("StructArrayLayout2ui4",vs);class Pu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Pu.prototype.bytesPerElement=2,qe("StructArrayLayout1ui2",Pu);class zu extends ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,a,h){const g=this.length;return this.resize(g+1),this.emplace(g,e,n,a,h)}emplace(e,n,a,h,g){const y=4*e;return this.float32[y+0]=n,this.float32[y+1]=a,this.float32[y+2]=h,this.float32[y+3]=g,e}}zu.prototype.bytesPerElement=16,qe("StructArrayLayout4f16",zu);class Au extends ao{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new X(this.anchorPointX,this.anchorPointY)}}Au.prototype.size=20;class Ph extends zn{get(e){return new Au(this,e)}}qe("CollisionBoxArray",Ph);class p extends ao{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}p.prototype.size=48;class t extends ku{get(e){return new p(this,e)}}qe("PlacedSymbolArray",t);class o extends ao{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}o.prototype.size=64;class u extends uo{get(e){return new o(this,e)}}qe("SymbolInstanceArray",u);class c extends Jn{getoffsetX(e){return this.float32[1*e+0]}}qe("GlyphOffsetArray",c);class m extends Xa{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}qe("SymbolLineVertexArray",m);class x extends ao{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}x.prototype.size=12;class b extends Eu{get(e){return new x(this,e)}}qe("TextAnchorOffsetArray",b);class I extends ao{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}I.prototype.size=8;class k extends el{get(e){return new I(this,e)}}qe("FeatureIndexArray",k);class z extends na{}class A extends na{}class F extends na{}class G extends bu{}class Z extends Su{}class W extends sa{}class V extends Tu{}class ie extends Ya{}class pe extends Iu{}class K extends Cu{}class le extends Ja{}class fe extends Qa{}class me extends lo{}class ge extends vs{}const Ce=di([{name:"a_pos",components:2,type:"Int16"}],4),{members:Se}=Ce;class Ie{constructor(e=[]){this.segments=e}prepareSegment(e,n,a,h){let g=this.segments[this.segments.length-1];return e>Ie.MAX_VERTEX_ARRAY_LENGTH&&si(`Max vertices per segment is ${Ie.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>Ie.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h)&&(g={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(g.sortKey=h),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,a,h){return new Ie([{vertexOffset:e,primitiveOffset:n,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function Ze(r,e){return 256*(r=Ne(Math.floor(r),0,255))+Ne(Math.floor(e),0,255)}Ie.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qe("SegmentVector",Ie);const ct=di([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Fe={exports:{}},ot={exports:{}};ot.exports=function(r,e){var n,a,h,g,y,v,S,C;for(a=r.length-(n=3&r.length),h=e,y=3432918353,v=461845907,C=0;C<a;)S=255&r.charCodeAt(C)|(255&r.charCodeAt(++C))<<8|(255&r.charCodeAt(++C))<<16|(255&r.charCodeAt(++C))<<24,++C,h=27492+(65535&(g=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(S=0,n){case 3:S^=(255&r.charCodeAt(C+2))<<16;case 2:S^=(255&r.charCodeAt(C+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(C)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295}return h^=r.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var gt=ot.exports,St={exports:{}};St.exports=function(r,e){for(var n,a=r.length,h=e^a,g=0;a>=4;)n=1540483477*(65535&(n=255&r.charCodeAt(g)|(255&r.charCodeAt(++g))<<8|(255&r.charCodeAt(++g))<<16|(255&r.charCodeAt(++g))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),a-=4,++g;switch(a){case 3:h^=(255&r.charCodeAt(g+2))<<16;case 2:h^=(255&r.charCodeAt(g+1))<<8;case 1:h=1540483477*(65535&(h^=255&r.charCodeAt(g)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var lt=gt,_t=St.exports;Fe.exports=lt,Fe.exports.murmur3=lt,Fe.exports.murmur2=_t;var vt=N(Fe.exports);class Jt{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,a,h){this.ids.push(Ut(e)),this.positions.push(n,a,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Ut(e);let a=0,h=this.ids.length-1;for(;a<h;){const y=a+h>>1;this.ids[y]>=n?h=y:a=y+1}const g=[];for(;this.ids[a]===n;)g.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return g}static serialize(e,n){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return cr(a,h,0,a.length-1),n&&n.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const n=new Jt;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Ut(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:vt(String(r))}function cr(r,e,n,a){for(;n<a;){const h=r[n+a>>1];let g=n-1,y=a+1;for(;;){do g++;while(r[g]<h);do y--;while(r[y]>h);if(g>=y)break;_i(r,g,y),_i(e,3*g,3*y),_i(e,3*g+1,3*y+1),_i(e,3*g+2,3*y+2)}y-n<a-y?(cr(r,e,n,y),n=y+1):(cr(r,e,y+1,a),a=y)}}function _i(r,e,n){const a=r[e];r[e]=r[n],r[n]=a}qe("FeaturePositionMap",Jt);class Zt{constructor(e,n){this.gl=e.gl,this.location=n}}class Zi extends Zt{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Jr extends Zt{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class yn extends Zt{constructor(e,n){super(e,n),this.current=Ft.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const xs=new Float32Array(16);function ws(r){return[Ze(255*r.r,255*r.g),Ze(255*r.b,255*r.a)]}class _n{constructor(e,n,a){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=a}setUniform(e,n,a){e.set(a.constantOr(this.value))}getBinding(e,n,a){return this.type==="color"?new yn(e,n):new Zi(e,n)}}class Qr{constructor(e,n){this.uniformNames=n.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setUniform(e,n,a,h){const g=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&e.set(g)}getBinding(e,n,a){return a.substr(0,9)==="u_pattern"?new Jr(e,n):new Zi(e,n)}}class ii{constructor(e,n,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(g=>({name:`a_${g}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,a,h,g){const y=this.paintVertexArray.length,v=this.expression.evaluate(new Ht(0),n,{},h,[],g);this.paintVertexArray.resize(e),this._setPaintValue(y,e,v)}updatePaintArray(e,n,a,h){const g=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(e,n,g)}_setPaintValue(e,n,a){if(this.type==="color"){const h=ws(a);for(let g=e;g<n;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wt{constructor(e,n,a,h,g,y){this.expression=e,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,n,a,h,g){const y=this.expression.evaluate(new Ht(this.zoom),n,{},h,[],g),v=this.expression.evaluate(new Ht(this.zoom+1),n,{},h,[],g),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,v)}updatePaintArray(e,n,a,h){const g=this.expression.evaluate({zoom:this.zoom},a,h),y=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(e,n,g,y)}_setPaintValue(e,n,a,h){if(this.type==="color"){const g=ws(a),y=ws(h);for(let v=e;v<n;v++)this.paintVertexArray.emplace(v,g[0],g[1],y[0],y[1])}else{for(let g=e;g<n;g++)this.paintVertexArray.emplace(g,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const a=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=Ne(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,n,a){return new Zi(e,n)}}class li{constructor(e,n,a,h,g,y){this.expression=e,this.type=n,this.useIntegerZoom=a,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(e,n,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(e,n,a,h,g){this._setPaintValues(e,n,a.patterns&&a.patterns[this.layerId],g)}_setPaintValues(e,n,a,h){if(!h||!a)return;const{min:g,mid:y,max:v}=a,S=h[g],C=h[y],E=h[v];if(S&&C&&E)for(let P=e;P<n;P++)this.zoomInPaintVertexArray.emplace(P,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,C.tl[0],C.tl[1],C.br[0],C.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],C.pixelRatio,E.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ct.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ct.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class co{constructor(e,n,a){this.binders={},this._buffers=[];const h=[];for(const g in e.paint._values){if(!a(g))continue;const y=e.paint.get(g);if(!(y instanceof Xr&&Ys(y.property.specification)))continue;const v=Di(g,e.type),S=y.value,C=y.property.specification.type,E=y.property.useIntegerZoom,P=y.property.specification["property-type"],D=P==="cross-faded"||P==="cross-faded-data-driven";if(S.kind==="constant")this.binders[g]=D?new Qr(S.value,v):new _n(S.value,v,C),h.push(`/u_${g}`);else if(S.kind==="source"||D){const R=kr(g,C,"source");this.binders[g]=D?new li(S,C,E,n,R,e.id):new ii(S,v,C,R),h.push(`/a_${g}`)}else{const R=kr(g,C,"composite");this.binders[g]=new Wt(S,v,C,E,n,R),h.push(`/z_${g}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof ii||n instanceof Wt?n.maxValue:0}populatePaintArrays(e,n,a,h,g){for(const y in this.binders){const v=this.binders[y];(v instanceof ii||v instanceof Wt||v instanceof li)&&v.populatePaintArray(e,n,a,h,g)}}setConstantPatternPositions(e,n){for(const a in this.binders){const h=this.binders[a];h instanceof Qr&&h.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,a,h,g){let y=!1;for(const v in e){const S=n.getPositions(v);for(const C of S){const E=a.feature(C.index);for(const P in this.binders){const D=this.binders[P];if((D instanceof ii||D instanceof Wt||D instanceof li)&&D.expression.isStateDependent===!0){const R=h.paint.get(P);D.expression=R.value,D.updatePaintArray(C.start,C.end,E,e[v],g),y=!0}}}}return y}defines(){const e=[];for(const n in this.binders){const a=this.binders[n];(a instanceof _n||a instanceof Qr)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof ii||a instanceof Wt)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name);else if(a instanceof li)for(let h=0;h<ct.members.length;h++)e.push(ct.members[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof _n||a instanceof Qr||a instanceof Wt)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const a=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof _n||g instanceof Qr||g instanceof Wt){for(const y of g.uniformNames)if(n[y]){const v=g.getBinding(e,n[y],y);a.push({name:y,property:h,binding:v})}}}return a}setUniforms(e,n,a,h){for(const{name:g,property:y,binding:v}of n)this.binders[y].setUniform(v,h,a.get(y),g)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const a=this.binders[n];if(e&&a instanceof li){const h=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof ii||a instanceof Wt)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const n in this.binders){const a=this.binders[n];(a instanceof ii||a instanceof Wt||a instanceof li)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof ii||n instanceof Wt||n instanceof li)&&n.destroy()}}}class Xt{constructor(e,n,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new co(h,n,a);this.needsUpload=!1,this._featureMap=new Jt,this._bufferOffset=0}populatePaintArrays(e,n,a,h,g,y){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,n,h,g,y);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,a,h){for(const g of a)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(e,this._featureMap,n,g,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Di(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function kr(r,e,n){const a={color:{source:sa,composite:zu},number:{source:Jn,composite:sa}},h=function(g){return{"line-pattern":{source:V,composite:V},"fill-pattern":{source:V,composite:V},"fill-extrusion-pattern":{source:V,composite:V}}[g]}(r);return h&&h[n]||a[e][n]}qe("ConstantBinder",_n),qe("CrossFadedConstantBinder",Qr),qe("SourceExpressionBinder",ii),qe("CrossFadedCompositeBinder",li),qe("CompositeExpressionBinder",Wt),qe("ProgramConfiguration",co,{omit:["_buffers"]}),qe("ProgramConfigurationSet",Xt);const bt=8192,Mu=Math.pow(2,14)-1,zh=-Mu-1;function bs(r){const e=bt/r.extent,n=r.loadGeometry();for(let a=0;a<n.length;a++){const h=n[a];for(let g=0;g<h.length;g++){const y=h[g],v=Math.round(y.x*e),S=Math.round(y.y*e);y.x=Ne(v,zh,Mu),y.y=Ne(S,zh,Mu),(v<y.x||v>y.x+1||S<y.y||S>y.y+1)&&si("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ss(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?bs(r):[]}}function tl(r,e,n,a,h){r.emplaceBack(2*e+(a+1)/2,2*n+(h+1)/2)}class Du{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new A,this.indexArray=new me,this.segments=new Ie,this.programConfigurations=new Xt(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a){const h=this.layers[0],g=[];let y=null,v=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),v=!y.isConstant());for(const{feature:S,id:C,index:E,sourceLayerIndex:P}of e){const D=this.layers[0]._featureFilter.needGeometry,R=Ss(S,D);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),R,a))continue;const B=v?y.evaluate(R,{},a):void 0,j={id:C,properties:S.properties,type:S.type,sourceLayerIndex:P,index:E,geometry:D?R.geometry:bs(S),patterns:{},sortKey:B};g.push(j)}v&&g.sort((S,C)=>S.sortKey-C.sortKey);for(const S of g){const{geometry:C,index:E,sourceLayerIndex:P}=S,D=e[E].feature;this.addFeature(S,C,E,a),n.featureIndex.insert(D,C,E,P,this.index)}}update(e,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Se),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,a,h){for(const g of n)for(const y of g){const v=y.x,S=y.y;if(v<0||v>=bt||S<0||S>=bt)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),E=C.vertexLength;tl(this.layoutVertexArray,v,S,-1,-1),tl(this.layoutVertexArray,v,S,1,-1),tl(this.layoutVertexArray,v,S,1,1),tl(this.layoutVertexArray,v,S,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h)}}function Ts(r,e){for(let n=0;n<r.length;n++)if(il(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(il(r,e[n]))return!0;return!!aa(r,e)}function Ah(r,e,n){return!!il(r,e)||!!la(e,r,n)}function Lu(r,e){if(r.length===1)return Kg(e,r[0]);for(let n=0;n<e.length;n++){const a=e[n];for(let h=0;h<a.length;h++)if(il(r,a[h]))return!0}for(let n=0;n<r.length;n++)if(Kg(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(aa(r,e[n]))return!0;return!1}function Mh(r,e,n){if(r.length>1){if(aa(r,e))return!0;for(let a=0;a<e.length;a++)if(la(e[a],r,n))return!0}for(let a=0;a<r.length;a++)if(la(r[a],e,n))return!0;return!1}function aa(r,e){if(r.length===0||e.length===0)return!1;for(let n=0;n<r.length-1;n++){const a=r[n],h=r[n+1];for(let g=0;g<e.length-1;g++)if(Dh(a,h,e[g],e[g+1]))return!0}return!1}function Dh(r,e,n,a){return sr(r,n,a)!==sr(e,n,a)&&sr(r,e,n)!==sr(r,e,a)}function la(r,e,n){const a=n*n;if(e.length===1)return r.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(Wg(r,e[h-1],e[h])<a)return!0;return!1}function Wg(r,e,n){const a=e.distSqr(n);if(a===0)return r.distSqr(e);const h=((r.x-e.x)*(n.x-e.x)+(r.y-e.y)*(n.y-e.y))/a;return r.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function Kg(r,e){let n,a,h,g=!1;for(let y=0;y<r.length;y++){n=r[y];for(let v=0,S=n.length-1;v<n.length;S=v++)a=n[v],h=n[S],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(g=!g)}return g}function il(r,e){let n=!1;for(let a=0,h=r.length-1;a<r.length;h=a++){const g=r[a],y=r[h];g.y>e.y!=y.y>e.y&&e.x<(y.x-g.x)*(e.y-g.y)/(y.y-g.y)+g.x&&(n=!n)}return n}function y1(r,e,n){const a=n[0],h=n[2];if(r.x<a.x&&e.x<a.x||r.x>h.x&&e.x>h.x||r.y<a.y&&e.y<a.y||r.y>h.y&&e.y>h.y)return!1;const g=sr(r,e,n[0]);return g!==sr(r,e,n[1])||g!==sr(r,e,n[2])||g!==sr(r,e,n[3])}function Ru(r,e,n){const a=e.paint.get(r).value;return a.kind==="constant"?a.value:n.programConfigurations.get(e.id).getMaxValue(r)}function Lh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Rh(r,e,n,a,h){if(!e[0]&&!e[1])return r;const g=X.convert(e)._mult(h);n==="viewport"&&g._rotate(-a);const y=[];for(let v=0;v<r.length;v++)y.push(r[v].sub(g));return y}let Xg,Yg;qe("CircleBucket",Du,{omit:["layers"]});var _1={get paint(){return Yg=Yg||new ur({"circle-radius":new nt(ye.paint_circle["circle-radius"]),"circle-color":new nt(ye.paint_circle["circle-color"]),"circle-blur":new nt(ye.paint_circle["circle-blur"]),"circle-opacity":new nt(ye.paint_circle["circle-opacity"]),"circle-translate":new et(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new et(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new et(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new et(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nt(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nt(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nt(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return Xg=Xg||new ur({"circle-sort-key":new nt(ye.layout_circle["circle-sort-key"])})}},hr=1e-6,rl=typeof Float32Array<"u"?Float32Array:Array;function $p(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Jg(r,e,n){var a=e[0],h=e[1],g=e[2],y=e[3],v=e[4],S=e[5],C=e[6],E=e[7],P=e[8],D=e[9],R=e[10],B=e[11],j=e[12],H=e[13],Y=e[14],ce=e[15],ee=n[0],ae=n[1],xe=n[2],be=n[3];return r[0]=ee*a+ae*v+xe*P+be*j,r[1]=ee*h+ae*S+xe*D+be*H,r[2]=ee*g+ae*C+xe*R+be*Y,r[3]=ee*y+ae*E+xe*B+be*ce,r[4]=(ee=n[4])*a+(ae=n[5])*v+(xe=n[6])*P+(be=n[7])*j,r[5]=ee*h+ae*S+xe*D+be*H,r[6]=ee*g+ae*C+xe*R+be*Y,r[7]=ee*y+ae*E+xe*B+be*ce,r[8]=(ee=n[8])*a+(ae=n[9])*v+(xe=n[10])*P+(be=n[11])*j,r[9]=ee*h+ae*S+xe*D+be*H,r[10]=ee*g+ae*C+xe*R+be*Y,r[11]=ee*y+ae*E+xe*B+be*ce,r[12]=(ee=n[12])*a+(ae=n[13])*v+(xe=n[14])*P+(be=n[15])*j,r[13]=ee*h+ae*S+xe*D+be*H,r[14]=ee*g+ae*C+xe*R+be*Y,r[15]=ee*y+ae*E+xe*B+be*ce,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Fu,v1=Jg;function Fh(r,e,n){var a=e[0],h=e[1],g=e[2],y=e[3];return r[0]=n[0]*a+n[4]*h+n[8]*g+n[12]*y,r[1]=n[1]*a+n[5]*h+n[9]*g+n[13]*y,r[2]=n[2]*a+n[6]*h+n[10]*g+n[14]*y,r[3]=n[3]*a+n[7]*h+n[11]*g+n[15]*y,r}Fu=new rl(4),rl!=Float32Array&&(Fu[0]=0,Fu[1]=0,Fu[2]=0,Fu[3]=0);class x1 extends Yr{constructor(e){super(e,_1)}createBucket(e){return new Du(e)}queryRadius(e){const n=e;return Ru("circle-radius",this,n)+Ru("circle-stroke-width",this,n)+Lh(this.paint.get("circle-translate"))}queryIntersectsFeature(e,n,a,h,g,y,v,S){const C=Rh(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,v),E=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a),P=this.paint.get("circle-pitch-alignment")==="map",D=P?C:function(B,j){return B.map(H=>Qg(H,j))}(C,S),R=P?E*v:E;for(const B of h)for(const j of B){const H=P?j:Qg(j,S);let Y=R;const ce=Fh([],[j.x,j.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Y*=ce[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Y*=y.cameraToCenterDistance/ce[3]),Ah(D,H,Y))return!0}return!1}}function Qg(r,e){const n=Fh([],[r.x,r.y,0,1],e);return new X(n[0]/n[3],n[1]/n[3])}class ey extends Du{}let ty;qe("HeatmapBucket",ey,{omit:["layers"]});var w1={get paint(){return ty=ty||new ur({"heatmap-radius":new nt(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nt(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new et(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ra(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new et(ye.paint_heatmap["heatmap-opacity"])})}};function Zp(r,{width:e,height:n},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*n*a}`)}else h=new Uint8Array(e*n*a);return r.width=e,r.height=n,r.data=h,r}function iy(r,{width:e,height:n},a){if(e===r.width&&n===r.height)return;const h=Zp({},{width:e,height:n},a);qp(r,h,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,n)},a),r.width=e,r.height=n,r.data=h.data}function qp(r,e,n,a,h,g){if(h.width===0||h.height===0)return e;if(h.width>r.width||h.height>r.height||n.x>r.width-h.width||n.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,v=e.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const C=((n.y+S)*r.width+n.x)*g,E=((a.y+S)*e.width+a.x)*g;for(let P=0;P<h.width*g;P++)v[E+P]=y[C+P]}return e}class Bu{constructor(e,n){Zp(this,e,1,n)}resize(e){iy(this,e,1)}clone(){return new Bu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,h,g){qp(e,n,a,h,g,1)}}class en{constructor(e,n){Zp(this,e,4,n)}resize(e){iy(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new en({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,a,h,g){qp(e,n,a,h,g,4)}}function ry(r){const e={},n=r.resolution||256,a=r.clips?r.clips.length:1,h=r.image||new en({width:n,height:a});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const g=(y,v,S)=>{e[r.evaluationKey]=S;const C=r.expression.evaluate(e);h.data[y+v+0]=Math.floor(255*C.r/C.a),h.data[y+v+1]=Math.floor(255*C.g/C.a),h.data[y+v+2]=Math.floor(255*C.b/C.a),h.data[y+v+3]=Math.floor(255*C.a)};if(r.clips)for(let y=0,v=0;y<a;++y,v+=4*n)for(let S=0,C=0;S<n;S++,C+=4){const E=S/(n-1),{start:P,end:D}=r.clips[y];g(v,C,P*(1-E)+D*E)}else for(let y=0,v=0;y<n;y++,v+=4)g(0,v,y/(n-1));return h}qe("AlphaImage",Bu),qe("RGBAImage",en);class b1 extends Yr{createBucket(e){return new ey(e)}constructor(e){super(e,w1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ry({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let ny;var S1={get paint(){return ny=ny||new ur({"hillshade-illumination-direction":new et(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new et(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new et(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new et(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new et(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new et(ye.paint_hillshade["hillshade-accent-color"])})}};class T1 extends Yr{constructor(e){super(e,S1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const I1=di([{name:"a_pos",components:2,type:"Int16"}],4),{members:C1}=I1;var Gp={exports:{}};function Bh(r,e,n){n=n||2;var a,h,g,y,v,S,C,E=e&&e.length,P=E?e[0]*n:r.length,D=sy(r,0,P,n,!0),R=[];if(!D||D.next===D.prev)return R;if(E&&(D=function(j,H,Y,ce){var ee,ae,xe,be=[];for(ee=0,ae=H.length;ee<ae;ee++)(xe=sy(j,H[ee]*ce,ee<ae-1?H[ee+1]*ce:j.length,ce,!1))===xe.next&&(xe.steiner=!0),be.push(L1(xe));for(be.sort(A1),ee=0;ee<be.length;ee++)Y=M1(be[ee],Y);return Y}(r,e,D,n)),r.length>80*n){a=g=r[0],h=y=r[1];for(var B=n;B<P;B+=n)(v=r[B])<a&&(a=v),(S=r[B+1])<h&&(h=S),v>g&&(g=v),S>y&&(y=S);C=(C=Math.max(g-a,y-h))!==0?32767/C:0}return Ou(D,R,n,a,h,C,0),R}function sy(r,e,n,a,h){var g,y;if(h===Kp(r,e,n,a)>0)for(g=e;g<n;g+=a)y=ly(g,r[g],r[g+1],y);else for(g=n-a;g>=e;g-=a)y=ly(g,r[g],r[g+1],y);return y&&Oh(y,y.next)&&(Vu(y),y=y.next),y}function ua(r,e){if(!r)return r;e||(e=r);var n,a=r;do if(n=!1,a.steiner||!Oh(a,a.next)&&pi(a.prev,a,a.next)!==0)a=a.next;else{if(Vu(a),(a=e=a.prev)===a.next)break;n=!0}while(n||a!==e);return e}function Ou(r,e,n,a,h,g,y){if(r){!y&&g&&function(E,P,D,R){var B=E;do B.z===0&&(B.z=Hp(B.x,B.y,P,D,R)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==E);B.prevZ.nextZ=null,B.prevZ=null,function(j){var H,Y,ce,ee,ae,xe,be,je,Ye=1;do{for(Y=j,j=null,ae=null,xe=0;Y;){for(xe++,ce=Y,be=0,H=0;H<Ye&&(be++,ce=ce.nextZ);H++);for(je=Ye;be>0||je>0&&ce;)be!==0&&(je===0||!ce||Y.z<=ce.z)?(ee=Y,Y=Y.nextZ,be--):(ee=ce,ce=ce.nextZ,je--),ae?ae.nextZ=ee:j=ee,ee.prevZ=ae,ae=ee;Y=ce}ae.nextZ=null,Ye*=2}while(xe>1)}(B)}(r,a,h,g);for(var v,S,C=r;r.prev!==r.next;)if(v=r.prev,S=r.next,g?E1(r,a,h,g):k1(r))e.push(v.i/n|0),e.push(r.i/n|0),e.push(S.i/n|0),Vu(r),r=S.next,C=S.next;else if((r=S)===C){y?y===1?Ou(r=P1(ua(r),e,n),e,n,a,h,g,2):y===2&&z1(r,e,n,a,h,g):Ou(ua(r),e,n,a,h,g,1);break}}}function k1(r){var e=r.prev,n=r,a=r.next;if(pi(e,n,a)>=0)return!1;for(var h=e.x,g=n.x,y=a.x,v=e.y,S=n.y,C=a.y,E=h<g?h<y?h:y:g<y?g:y,P=v<S?v<C?v:C:S<C?S:C,D=h>g?h>y?h:y:g>y?g:y,R=v>S?v>C?v:C:S>C?S:C,B=a.next;B!==e;){if(B.x>=E&&B.x<=D&&B.y>=P&&B.y<=R&&nl(h,v,g,S,y,C,B.x,B.y)&&pi(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function E1(r,e,n,a){var h=r.prev,g=r,y=r.next;if(pi(h,g,y)>=0)return!1;for(var v=h.x,S=g.x,C=y.x,E=h.y,P=g.y,D=y.y,R=v<S?v<C?v:C:S<C?S:C,B=E<P?E<D?E:D:P<D?P:D,j=v>S?v>C?v:C:S>C?S:C,H=E>P?E>D?E:D:P>D?P:D,Y=Hp(R,B,e,n,a),ce=Hp(j,H,e,n,a),ee=r.prevZ,ae=r.nextZ;ee&&ee.z>=Y&&ae&&ae.z<=ce;){if(ee.x>=R&&ee.x<=j&&ee.y>=B&&ee.y<=H&&ee!==h&&ee!==y&&nl(v,E,S,P,C,D,ee.x,ee.y)&&pi(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,ae.x>=R&&ae.x<=j&&ae.y>=B&&ae.y<=H&&ae!==h&&ae!==y&&nl(v,E,S,P,C,D,ae.x,ae.y)&&pi(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;ee&&ee.z>=Y;){if(ee.x>=R&&ee.x<=j&&ee.y>=B&&ee.y<=H&&ee!==h&&ee!==y&&nl(v,E,S,P,C,D,ee.x,ee.y)&&pi(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;ae&&ae.z<=ce;){if(ae.x>=R&&ae.x<=j&&ae.y>=B&&ae.y<=H&&ae!==h&&ae!==y&&nl(v,E,S,P,C,D,ae.x,ae.y)&&pi(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function P1(r,e,n){var a=r;do{var h=a.prev,g=a.next.next;!Oh(h,g)&&oy(h,a,a.next,g)&&Nu(h,g)&&Nu(g,h)&&(e.push(h.i/n|0),e.push(a.i/n|0),e.push(g.i/n|0),Vu(a),Vu(a.next),a=r=g),a=a.next}while(a!==r);return ua(a)}function z1(r,e,n,a,h,g){var y=r;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&R1(y,v)){var S=ay(y,v);return y=ua(y,y.next),S=ua(S,S.next),Ou(y,e,n,a,h,g,0),void Ou(S,e,n,a,h,g,0)}v=v.next}y=y.next}while(y!==r)}function A1(r,e){return r.x-e.x}function M1(r,e){var n=function(h,g){var y,v=g,S=h.x,C=h.y,E=-1/0;do{if(C<=v.y&&C>=v.next.y&&v.next.y!==v.y){var P=v.x+(C-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(P<=S&&P>E&&(E=P,y=v.x<v.next.x?v:v.next,P===S))return y}v=v.next}while(v!==g);if(!y)return null;var D,R=y,B=y.x,j=y.y,H=1/0;v=y;do S>=v.x&&v.x>=B&&S!==v.x&&nl(C<j?S:E,C,B,j,C<j?E:S,C,v.x,v.y)&&(D=Math.abs(C-v.y)/(S-v.x),Nu(v,h)&&(D<H||D===H&&(v.x>y.x||v.x===y.x&&D1(y,v)))&&(y=v,H=D)),v=v.next;while(v!==R);return y}(r,e);if(!n)return e;var a=ay(n,r);return ua(a,a.next),ua(n,n.next)}function D1(r,e){return pi(r.prev,r,e.prev)<0&&pi(e.next,r,r.next)<0}function Hp(r,e,n,a,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function L1(r){var e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function nl(r,e,n,a,h,g,y,v){return(h-y)*(e-v)>=(r-y)*(g-v)&&(r-y)*(a-v)>=(n-y)*(e-v)&&(n-y)*(g-v)>=(h-y)*(a-v)}function R1(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(n,a){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==a.i&&h.next.i!==a.i&&oy(h,h.next,n,a))return!0;h=h.next}while(h!==n);return!1}(r,e)&&(Nu(r,e)&&Nu(e,r)&&function(n,a){var h=n,g=!1,y=(n.x+a.x)/2,v=(n.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==n);return g}(r,e)&&(pi(r.prev,r,e.prev)||pi(r,e.prev,e))||Oh(r,e)&&pi(r.prev,r,r.next)>0&&pi(e.prev,e,e.next)>0)}function pi(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function Oh(r,e){return r.x===e.x&&r.y===e.y}function oy(r,e,n,a){var h=Vh(pi(r,e,n)),g=Vh(pi(r,e,a)),y=Vh(pi(n,a,r)),v=Vh(pi(n,a,e));return h!==g&&y!==v||!(h!==0||!Nh(r,n,e))||!(g!==0||!Nh(r,a,e))||!(y!==0||!Nh(n,r,a))||!(v!==0||!Nh(n,e,a))}function Nh(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function Vh(r){return r>0?1:r<0?-1:0}function Nu(r,e){return pi(r.prev,r,r.next)<0?pi(r,e,r.next)>=0&&pi(r,r.prev,e)>=0:pi(r,e,r.prev)<0||pi(r,r.next,e)<0}function ay(r,e){var n=new Wp(r.i,r.x,r.y),a=new Wp(e.i,e.x,e.y),h=r.next,g=e.prev;return r.next=e,e.prev=r,n.next=h,h.prev=n,a.next=n,n.prev=a,g.next=a,a.prev=g,a}function ly(r,e,n,a){var h=new Wp(r,e,n);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function Vu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Wp(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Kp(r,e,n,a){for(var h=0,g=e,y=n-a;g<n;g+=a)h+=(r[y]-r[g])*(r[g+1]+r[y+1]),y=g;return h}Gp.exports=Bh,Gp.exports.default=Bh,Bh.deviation=function(r,e,n,a){var h=e&&e.length,g=Math.abs(Kp(r,0,h?e[0]*n:r.length,n));if(h)for(var y=0,v=e.length;y<v;y++)g-=Math.abs(Kp(r,e[y]*n,y<v-1?e[y+1]*n:r.length,n));var S=0;for(y=0;y<a.length;y+=3){var C=a[y]*n,E=a[y+1]*n,P=a[y+2]*n;S+=Math.abs((r[C]-r[P])*(r[E+1]-r[C+1])-(r[C]-r[E])*(r[P+1]-r[C+1]))}return g===0&&S===0?0:Math.abs((S-g)/g)},Bh.flatten=function(r){for(var e=r[0][0].length,n={vertices:[],holes:[],dimensions:e},a=0,h=0;h<r.length;h++){for(var g=0;g<r[h].length;g++)for(var y=0;y<e;y++)n.vertices.push(r[h][g][y]);h>0&&n.holes.push(a+=r[h-1].length)}return n};var uy=N(Gp.exports);function F1(r,e,n,a,h){cy(r,e,n||0,a||r.length-1,h||B1)}function cy(r,e,n,a,h){for(;a>n;){if(a-n>600){var g=a-n+1,y=e-n+1,v=Math.log(g),S=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*S*(g-S)/g)*(y-g/2<0?-1:1);cy(r,e,Math.max(n,Math.floor(e-y*S/g+C)),Math.min(a,Math.floor(e+(g-y)*S/g+C)),h)}var E=r[e],P=n,D=a;for(ju(r,n,e),h(r[a],E)>0&&ju(r,n,a);P<D;){for(ju(r,P,D),P++,D--;h(r[P],E)<0;)P++;for(;h(r[D],E)>0;)D--}h(r[n],E)===0?ju(r,n,D):ju(r,++D,a),D<=e&&(n=D+1),e<=D&&(a=D-1)}}function ju(r,e,n){var a=r[e];r[e]=r[n],r[n]=a}function B1(r,e){return r<e?-1:r>e?1:0}function Xp(r,e){const n=r.length;if(n<=1)return[r];const a=[];let h,g;for(let y=0;y<n;y++){const v=kn(r[y]);v!==0&&(r[y].area=Math.abs(v),g===void 0&&(g=v<0),g===v<0?(h&&a.push(h),h=[r[y]]):h.push(r[y]))}if(h&&a.push(h),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(F1(a[y],e,1,a[y].length-1,O1),a[y]=a[y].slice(0,e));return a}function O1(r,e){return e.area-r.area}function Yp(r,e,n){const a=n.patternDependencies;let h=!1;for(const g of e){const y=g.paint.get(`${r}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function Jp(r,e,n,a,h){const g=h.patternDependencies;for(const y of e){const v=y.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let S=v.evaluate({zoom:a-1},n,{},h.availableImages),C=v.evaluate({zoom:a},n,{},h.availableImages),E=v.evaluate({zoom:a+1},n,{},h.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,E=E&&E.name?E.name:E,g[S]=!0,g[C]=!0,g[E]=!0,n.patterns[y.id]={min:S,mid:C,max:E}}}return n}class Qp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new F,this.indexArray=new me,this.indexArray2=new ge,this.programConfigurations=new Xt(e.layers,e.zoom),this.segments=new Ie,this.segments2=new Ie,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a){this.hasPattern=Yp("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),g=!h.isConstant(),y=[];for(const{feature:v,id:S,index:C,sourceLayerIndex:E}of e){const P=this.layers[0]._featureFilter.needGeometry,D=Ss(v,P);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),D,a))continue;const R=g?h.evaluate(D,{},a,n.availableImages):void 0,B={id:S,properties:v.properties,type:v.type,sourceLayerIndex:E,index:C,geometry:P?D.geometry:bs(v),patterns:{},sortKey:R};y.push(B)}g&&y.sort((v,S)=>v.sortKey-S.sortKey);for(const v of y){const{geometry:S,index:C,sourceLayerIndex:E}=v;if(this.hasPattern){const P=Jp("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(P)}else this.addFeature(v,S,C,a,{});n.featureIndex.insert(e[C].feature,S,C,E,this.index)}}update(e,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a)}addFeatures(e,n,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,C1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,a,h,g){for(const y of Xp(n,500)){let v=0;for(const R of y)v+=R.length;const S=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),C=S.vertexLength,E=[],P=[];for(const R of y){if(R.length===0)continue;R!==y[0]&&P.push(E.length/2);const B=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),j=B.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(j+R.length-1,j),E.push(R[0].x),E.push(R[0].y);for(let H=1;H<R.length;H++)this.layoutVertexArray.emplaceBack(R[H].x,R[H].y),this.indexArray2.emplaceBack(j+H-1,j+H),E.push(R[H].x),E.push(R[H].y);B.vertexLength+=R.length,B.primitiveLength+=R.length}const D=uy(E,P);for(let R=0;R<D.length;R+=3)this.indexArray.emplaceBack(C+D[R],C+D[R+1],C+D[R+2]);S.vertexLength+=v,S.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,h)}}let hy,dy;qe("FillBucket",Qp,{omit:["layers","patternFeatures"]});var N1={get paint(){return dy=dy||new ur({"fill-antialias":new et(ye.paint_fill["fill-antialias"]),"fill-opacity":new nt(ye.paint_fill["fill-opacity"]),"fill-color":new nt(ye.paint_fill["fill-color"]),"fill-outline-color":new nt(ye.paint_fill["fill-outline-color"]),"fill-translate":new et(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new et(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new _s(ye.paint_fill["fill-pattern"])})},get layout(){return hy=hy||new ur({"fill-sort-key":new nt(ye.layout_fill["fill-sort-key"])})}};class V1 extends Yr{constructor(e){super(e,N1)}recalculate(e,n){super.recalculate(e,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Qp(e)}queryRadius(){return Lh(this.paint.get("fill-translate"))}queryIntersectsFeature(e,n,a,h,g,y,v){return Lu(Rh(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,v),h)}isTileClipped(){return!0}}const j1=di([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),U1=di([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$1}=j1;var ho={},Z1=J,py=sl;function sl(r,e,n,a,h){this.properties={},this.extent=n,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=h,r.readFields(q1,this,e)}function q1(r,e,n){r==1?e.id=n.readVarint():r==2?function(a,h){for(var g=a.readVarint()+a.pos;a.pos<g;){var y=h._keys[a.readVarint()],v=h._values[a.readVarint()];h.properties[y]=v}}(n,e):r==3?e.type=n.readVarint():r==4&&(e._geometry=n.pos)}function G1(r){for(var e,n,a=0,h=0,g=r.length,y=g-1;h<g;y=h++)a+=((n=r[y]).x-(e=r[h]).x)*(e.y+n.y);return a}sl.types=["Unknown","Point","LineString","Polygon"],sl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,n=r.readVarint()+r.pos,a=1,h=0,g=0,y=0,v=[];r.pos<n;){if(h<=0){var S=r.readVarint();a=7&S,h=S>>3}if(h--,a===1||a===2)g+=r.readSVarint(),y+=r.readSVarint(),a===1&&(e&&v.push(e),e=[]),e.push(new Z1(g,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&v.push(e),v},sl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,n=1,a=0,h=0,g=0,y=1/0,v=-1/0,S=1/0,C=-1/0;r.pos<e;){if(a<=0){var E=r.readVarint();n=7&E,a=E>>3}if(a--,n===1||n===2)(h+=r.readSVarint())<y&&(y=h),h>v&&(v=h),(g+=r.readSVarint())<S&&(S=g),g>C&&(C=g);else if(n!==7)throw new Error("unknown command "+n)}return[y,S,v,C]},sl.prototype.toGeoJSON=function(r,e,n){var a,h,g=this.extent*Math.pow(2,n),y=this.extent*r,v=this.extent*e,S=this.loadGeometry(),C=sl.types[this.type];function E(R){for(var B=0;B<R.length;B++){var j=R[B];R[B]=[360*(j.x+y)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(a=0;a<S.length;a++)P[a]=S[a][0];E(S=P);break;case 2:for(a=0;a<S.length;a++)E(S[a]);break;case 3:for(S=function(R){var B=R.length;if(B<=1)return[R];for(var j,H,Y=[],ce=0;ce<B;ce++){var ee=G1(R[ce]);ee!==0&&(H===void 0&&(H=ee<0),H===ee<0?(j&&Y.push(j),j=[R[ce]]):j.push(R[ce]))}return j&&Y.push(j),Y}(S),a=0;a<S.length;a++)for(h=0;h<S[a].length;h++)E(S[a][h])}S.length===1?S=S[0]:C="Multi"+C;var D={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(D.id=this.id),D};var H1=py,fy=my;function my(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(W1,this,e),this.length=this._features.length}function W1(r,e,n){r===15?e.version=n.readVarint():r===1?e.name=n.readString():r===5?e.extent=n.readVarint():r===2?e._features.push(n.pos):r===3?e._keys.push(n.readString()):r===4&&e._values.push(function(a){for(var h=null,g=a.readVarint()+a.pos;a.pos<g;){var y=a.readVarint()>>3;h=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return h}(n))}my.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new H1(this._pbf,e,this.extent,this._keys,this._values)};var K1=fy;function X1(r,e,n){if(r===3){var a=new K1(n,n.readVarint()+n.pos);a.length&&(e[a.name]=a)}}ho.VectorTile=function(r,e){this.layers=r.readFields(X1,{},e)},ho.VectorTileFeature=py,ho.VectorTileLayer=fy;const Y1=ho.VectorTileFeature.types,ef=Math.pow(2,13);function Uu(r,e,n,a,h,g,y,v){r.emplaceBack(e,n,2*Math.floor(a*ef)+y,h*ef*2,g*ef*2,Math.round(v))}class tf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new G,this.centroidVertexArray=new z,this.indexArray=new me,this.programConfigurations=new Xt(e.layers,e.zoom),this.segments=new Ie,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a){this.features=[],this.hasPattern=Yp("fill-extrusion",this.layers,n);for(const{feature:h,id:g,index:y,sourceLayerIndex:v}of e){const S=this.layers[0]._featureFilter.needGeometry,C=Ss(h,S);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),C,a))continue;const E={id:g,sourceLayerIndex:v,index:y,geometry:S?C.geometry:bs(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Jp("fill-extrusion",this.layers,E,this.zoom,n)):this.addFeature(E,E.geometry,y,a,{}),n.featureIndex.insert(h,E.geometry,y,v,this.index,!0)}}addFeatures(e,n,a){for(const h of this.features){const{geometry:g}=h;this.addFeature(h,g,h.index,n,a)}}update(e,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$1),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,U1.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,a,h,g){const y={x:0,y:0,vertexCount:0};for(const v of Xp(n,500)){let S=0;for(const B of v)S+=B.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const B of v){if(B.length===0||Q1(B))continue;let j=0;for(let H=0;H<B.length;H++){const Y=B[H];if(H>=1){const ce=B[H-1];if(!J1(Y,ce)){C.vertexLength+4>Ie.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ee=Y.sub(ce)._perp()._unit(),ae=ce.dist(Y);j+ae>32768&&(j=0),Uu(this.layoutVertexArray,Y.x,Y.y,ee.x,ee.y,0,0,j),Uu(this.layoutVertexArray,Y.x,Y.y,ee.x,ee.y,0,1,j),y.x+=2*Y.x,y.y+=2*Y.y,y.vertexCount+=2,j+=ae,Uu(this.layoutVertexArray,ce.x,ce.y,ee.x,ee.y,0,0,j),Uu(this.layoutVertexArray,ce.x,ce.y,ee.x,ee.y,0,1,j),y.x+=2*ce.x,y.y+=2*ce.y,y.vertexCount+=2;const xe=C.vertexLength;this.indexArray.emplaceBack(xe,xe+2,xe+1),this.indexArray.emplaceBack(xe+1,xe+2,xe+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>Ie.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Y1[e.type]!=="Polygon")continue;const E=[],P=[],D=C.vertexLength;for(const B of v)if(B.length!==0){B!==v[0]&&P.push(E.length/2);for(let j=0;j<B.length;j++){const H=B[j];Uu(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),y.x+=H.x,y.y+=H.y,y.vertexCount+=1,E.push(H.x),E.push(H.y)}}const R=uy(E,P);for(let B=0;B<R.length;B+=3)this.indexArray.emplaceBack(D+R[B],D+R[B+2],D+R[B+1]);C.primitiveLength+=R.length/3,C.vertexLength+=S}for(let v=0;v<y.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,h)}}function J1(r,e){return r.x===e.x&&(r.x<0||r.x>bt)||r.y===e.y&&(r.y<0||r.y>bt)}function Q1(r){return r.every(e=>e.x<0)||r.every(e=>e.x>bt)||r.every(e=>e.y<0)||r.every(e=>e.y>bt)}let gy;qe("FillExtrusionBucket",tf,{omit:["layers","features"]});var ew={get paint(){return gy=gy||new ur({"fill-extrusion-opacity":new et(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nt(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new et(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new et(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _s(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nt(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nt(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new et(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class tw extends Yr{constructor(e){super(e,ew)}createBucket(e){return new tf(e)}queryRadius(){return Lh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,n,a,h,g,y,v,S){const C=Rh(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,v),E=this.paint.get("fill-extrusion-height").evaluate(n,a),P=this.paint.get("fill-extrusion-base").evaluate(n,a),D=function(B,j,H,Y){const ce=[];for(const ee of B){const ae=[ee.x,ee.y,0,1];Fh(ae,ae,j),ce.push(new X(ae[0]/ae[3],ae[1]/ae[3]))}return ce}(C,S),R=function(B,j,H,Y){const ce=[],ee=[],ae=Y[8]*j,xe=Y[9]*j,be=Y[10]*j,je=Y[11]*j,Ye=Y[8]*H,Ve=Y[9]*H,Oe=Y[10]*H,De=Y[11]*H;for(const We of B){const Be=[],Pe=[];for(const rt of We){const Qe=rt.x,wt=rt.y,Kt=Y[0]*Qe+Y[4]*wt+Y[12],Yt=Y[1]*Qe+Y[5]*wt+Y[13],Ti=Y[2]*Qe+Y[6]*wt+Y[14],jr=Y[3]*Qe+Y[7]*wt+Y[15],dr=Ti+be,vi=jr+je,Oi=Kt+Ye,Gi=Yt+Ve,pr=Ti+Oe,fr=jr+De,Ii=new X((Kt+ae)/vi,(Yt+xe)/vi);Ii.z=dr/vi,Be.push(Ii);const Ci=new X(Oi/fr,Gi/fr);Ci.z=pr/fr,Pe.push(Ci)}ce.push(Be),ee.push(Pe)}return[ce,ee]}(h,P,E,S);return function(B,j,H){let Y=1/0;Lu(H,j)&&(Y=yy(H,j[0]));for(let ce=0;ce<j.length;ce++){const ee=j[ce],ae=B[ce];for(let xe=0;xe<ee.length-1;xe++){const be=ee[xe],je=[be,ee[xe+1],ae[xe+1],ae[xe],be];Ts(H,je)&&(Y=Math.min(Y,yy(H,je)))}}return Y!==1/0&&Y}(R[0],R[1],D)}}function $u(r,e){return r.x*e.x+r.y*e.y}function yy(r,e){if(r.length===1){let n=0;const a=e[n++];let h;for(;!h||a.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const g=e[n],y=r[0],v=h.sub(a),S=g.sub(a),C=y.sub(a),E=$u(v,v),P=$u(v,S),D=$u(S,S),R=$u(C,v),B=$u(C,S),j=E*D-P*P,H=(D*R-P*B)/j,Y=(E*B-P*R)/j,ce=a.z*(1-H-Y)+h.z*H+g.z*Y;if(isFinite(ce))return ce}return 1/0}{let n=1/0;for(const a of e)n=Math.min(n,a.z);return n}}const iw=di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:rw}=iw,nw=di([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:sw}=nw,ow=ho.VectorTileFeature.types,aw=Math.cos(Math.PI/180*37.5),_y=Math.pow(2,14)/.5;class rf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Z,this.layoutVertexArray2=new W,this.indexArray=new me,this.programConfigurations=new Xt(e.layers,e.zoom),this.segments=new Ie,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,a){this.hasPattern=Yp("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),g=!h.isConstant(),y=[];for(const{feature:v,id:S,index:C,sourceLayerIndex:E}of e){const P=this.layers[0]._featureFilter.needGeometry,D=Ss(v,P);if(!this.layers[0]._featureFilter.filter(new Ht(this.zoom),D,a))continue;const R=g?h.evaluate(D,{},a):void 0,B={id:S,properties:v.properties,type:v.type,sourceLayerIndex:E,index:C,geometry:P?D.geometry:bs(v),patterns:{},sortKey:R};y.push(B)}g&&y.sort((v,S)=>v.sortKey-S.sortKey);for(const v of y){const{geometry:S,index:C,sourceLayerIndex:E}=v;if(this.hasPattern){const P=Jp("line",this.layers,v,this.zoom,n);this.patternFeatures.push(P)}else this.addFeature(v,S,C,a,{});n.featureIndex.insert(e[C].feature,S,C,E,this.index)}}update(e,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,a)}addFeatures(e,n,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,sw)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,rw),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,a,h,g){const y=this.layers[0].layout,v=y.get("line-join").evaluate(e,{}),S=y.get("line-cap"),C=y.get("line-miter-limit"),E=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const P of n)this.addLine(P,e,v,S,C,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,g,h)}addLine(e,n,a,h,g,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<e.length-1;Y++)this.totalDistance+=e[Y].dist(e[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=ow[n.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let C=0;for(;C<S-1&&e[C].equals(e[C+1]);)C++;if(S<(v?3:2))return;a==="bevel"&&(g=1.05);const E=this.overscaling<=16?15*bt/(512*this.overscaling):0,P=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let D,R,B,j,H;this.e1=this.e2=-1,v&&(D=e[S-2],H=e[C].sub(D)._unit()._perp());for(let Y=C;Y<S;Y++){if(B=Y===S-1?v?e[C+1]:void 0:e[Y+1],B&&e[Y].equals(B))continue;H&&(j=H),D&&(R=D),D=e[Y],H=B?B.sub(D)._unit()._perp():j,j=j||H;let ce=j.add(H);ce.x===0&&ce.y===0||ce._unit();const ee=j.x*H.x+j.y*H.y,ae=ce.x*H.x+ce.y*H.y,xe=ae!==0?1/ae:1/0,be=2*Math.sqrt(2-2*ae),je=ae<aw&&R&&B,Ye=j.x*H.y-j.y*H.x>0;if(je&&Y>C){const De=D.dist(R);if(De>2*E){const We=D.sub(D.sub(R)._mult(E/De)._round());this.updateDistance(R,We),this.addCurrentVertex(We,j,0,0,P),R=We}}const Ve=R&&B;let Oe=Ve?a:v?"butt":h;if(Ve&&Oe==="round"&&(xe<y?Oe="miter":xe<=2&&(Oe="fakeround")),Oe==="miter"&&xe>g&&(Oe="bevel"),Oe==="bevel"&&(xe>2&&(Oe="flipbevel"),xe<g&&(Oe="miter")),R&&this.updateDistance(R,D),Oe==="miter")ce._mult(xe),this.addCurrentVertex(D,ce,0,0,P);else if(Oe==="flipbevel"){if(xe>100)ce=H.mult(-1);else{const De=xe*j.add(H).mag()/j.sub(H).mag();ce._perp()._mult(De*(Ye?-1:1))}this.addCurrentVertex(D,ce,0,0,P),this.addCurrentVertex(D,ce.mult(-1),0,0,P)}else if(Oe==="bevel"||Oe==="fakeround"){const De=-Math.sqrt(xe*xe-1),We=Ye?De:0,Be=Ye?0:De;if(R&&this.addCurrentVertex(D,j,We,Be,P),Oe==="fakeround"){const Pe=Math.round(180*be/Math.PI/20);for(let rt=1;rt<Pe;rt++){let Qe=rt/Pe;if(Qe!==.5){const Kt=Qe-.5;Qe+=Qe*Kt*(Qe-1)*((1.0904+ee*(ee*(3.55645-1.43519*ee)-3.2452))*Kt*Kt+(.848013+ee*(.215638*ee-1.06021)))}const wt=H.sub(j)._mult(Qe)._add(j)._unit()._mult(Ye?-1:1);this.addHalfVertex(D,wt.x,wt.y,!1,Ye,0,P)}}B&&this.addCurrentVertex(D,H,-We,-Be,P)}else if(Oe==="butt")this.addCurrentVertex(D,ce,0,0,P);else if(Oe==="square"){const De=R?1:-1;this.addCurrentVertex(D,ce,De,De,P)}else Oe==="round"&&(R&&(this.addCurrentVertex(D,j,0,0,P),this.addCurrentVertex(D,j,1,1,P,!0)),B&&(this.addCurrentVertex(D,H,-1,-1,P,!0),this.addCurrentVertex(D,H,0,0,P)));if(je&&Y<S-1){const De=D.dist(B);if(De>2*E){const We=D.add(B.sub(D)._mult(E/De)._round());this.updateDistance(D,We),this.addCurrentVertex(We,H,0,0,P),D=We}}}}addCurrentVertex(e,n,a,h,g,y=!1){const v=n.y*h-n.x,S=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*a,n.y-n.x*a,y,!1,a,g),this.addHalfVertex(e,v,S,y,!0,-h,g),this.distance>_y/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,a,h,g,y))}addHalfVertex({x:e,y:n},a,h,g,y,v,S){const C=.5*(this.lineClips?this.scaledDistance*(_y-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(n<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),S.primitiveLength++),y?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}let vy,xy;qe("LineBucket",rf,{omit:["layers","patternFeatures"]});var wy={get paint(){return xy=xy||new ur({"line-opacity":new nt(ye.paint_line["line-opacity"]),"line-color":new nt(ye.paint_line["line-color"]),"line-translate":new et(ye.paint_line["line-translate"]),"line-translate-anchor":new et(ye.paint_line["line-translate-anchor"]),"line-width":new nt(ye.paint_line["line-width"]),"line-gap-width":new nt(ye.paint_line["line-gap-width"]),"line-offset":new nt(ye.paint_line["line-offset"]),"line-blur":new nt(ye.paint_line["line-blur"]),"line-dasharray":new wu(ye.paint_line["line-dasharray"]),"line-pattern":new _s(ye.paint_line["line-pattern"]),"line-gradient":new ra(ye.paint_line["line-gradient"])})},get layout(){return vy=vy||new ur({"line-cap":new et(ye.layout_line["line-cap"]),"line-join":new nt(ye.layout_line["line-join"]),"line-miter-limit":new et(ye.layout_line["line-miter-limit"]),"line-round-limit":new et(ye.layout_line["line-round-limit"]),"line-sort-key":new nt(ye.layout_line["line-sort-key"])})}};class lw extends nt{possiblyEvaluate(e,n){return n=new Ht(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,a,h){return n=Ke({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,a,h)}}let jh;class uw extends Yr{constructor(e){super(e,wy),this.gradientVersion=0,jh||(jh=new lw(wy.paint.properties["line-width"].specification),jh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof Gs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new rf(e)}queryRadius(e){const n=e,a=by(Ru("line-width",this,n),Ru("line-gap-width",this,n)),h=Ru("line-offset",this,n);return a/2+Math.abs(h)+Lh(this.paint.get("line-translate"))}queryIntersectsFeature(e,n,a,h,g,y,v){const S=Rh(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,v),C=v/2*by(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),E=this.paint.get("line-offset").evaluate(n,a);return E&&(h=function(P,D){const R=[];for(let B=0;B<P.length;B++){const j=P[B],H=[];for(let Y=0;Y<j.length;Y++){const ce=j[Y-1],ee=j[Y],ae=j[Y+1],xe=Y===0?new X(0,0):ee.sub(ce)._unit()._perp(),be=Y===j.length-1?new X(0,0):ae.sub(ee)._unit()._perp(),je=xe._add(be)._unit(),Ye=je.x*be.x+je.y*be.y;Ye!==0&&je._mult(1/Ye),H.push(je._mult(D)._add(ee))}R.push(H)}return R}(h,E*v)),function(P,D,R){for(let B=0;B<D.length;B++){const j=D[B];if(P.length>=3){for(let H=0;H<j.length;H++)if(il(P,j[H]))return!0}if(Mh(P,j,R))return!0}return!1}(S,h,C)}isTileClipped(){return!0}}function by(r,e){return e>0?e+2*r:r}const cw=di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hw=di([{name:"a_projected_pos",components:3,type:"Float32"}],4);di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const dw=di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);di([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Sy=di([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pw=di([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function fw(r,e,n){return r.sections.forEach(a=>{a.text=function(h,g,y){const v=g.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),ys.applyArabicShaping&&(h=ys.applyArabicShaping(h)),h}(a.text,e,n)}),r}di([{name:"triangle",components:3,type:"Uint16"}]),di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),di([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),di([{type:"Float32",name:"offsetX"}]),di([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),di([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Zu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Si=24,Ty=Bt,Iy=function(r,e,n,a,h){var g,y,v=8*h-a-1,S=(1<<v)-1,C=S>>1,E=-7,P=n?h-1:0,D=n?-1:1,R=r[e+P];for(P+=D,g=R&(1<<-E)-1,R>>=-E,E+=v;E>0;g=256*g+r[e+P],P+=D,E-=8);for(y=g&(1<<-E)-1,g>>=-E,E+=a;E>0;y=256*y+r[e+P],P+=D,E-=8);if(g===0)g=1-C;else{if(g===S)return y?NaN:1/0*(R?-1:1);y+=Math.pow(2,a),g-=C}return(R?-1:1)*y*Math.pow(2,g-a)},Cy=function(r,e,n,a,h,g){var y,v,S,C=8*g-h-1,E=(1<<C)-1,P=E>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=a?0:g-1,B=a?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,y=E):(y=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-y))<1&&(y--,S*=2),(e+=y+P>=1?D/S:D*Math.pow(2,1-P))*S>=2&&(y++,S/=2),y+P>=E?(v=0,y=E):y+P>=1?(v=(e*S-1)*Math.pow(2,h),y+=P):(v=e*Math.pow(2,P-1)*Math.pow(2,h),y=0));h>=8;r[n+R]=255&v,R+=B,v/=256,h-=8);for(y=y<<h|v,C+=h;C>0;r[n+R]=255&y,R+=B,y/=256,C-=8);r[n+R-B]|=128*j};function Bt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Bt.Varint=0,Bt.Fixed64=1,Bt.Bytes=2,Bt.Fixed32=5;var nf=4294967296,ky=1/nf,Ey=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Is(r){return r.type===Bt.Bytes?r.readVarint()+r.pos:r.pos+1}function ol(r,e,n){return n?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function Py(r,e,n){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(a);for(var h=n.pos-1;h>=r;h--)n.buf[h+a]=n.buf[h]}function mw(r,e){for(var n=0;n<r.length;n++)e.writeVarint(r[n])}function gw(r,e){for(var n=0;n<r.length;n++)e.writeSVarint(r[n])}function yw(r,e){for(var n=0;n<r.length;n++)e.writeFloat(r[n])}function _w(r,e){for(var n=0;n<r.length;n++)e.writeDouble(r[n])}function vw(r,e){for(var n=0;n<r.length;n++)e.writeBoolean(r[n])}function xw(r,e){for(var n=0;n<r.length;n++)e.writeFixed32(r[n])}function ww(r,e){for(var n=0;n<r.length;n++)e.writeSFixed32(r[n])}function bw(r,e){for(var n=0;n<r.length;n++)e.writeFixed64(r[n])}function Sw(r,e){for(var n=0;n<r.length;n++)e.writeSFixed64(r[n])}function Uh(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function al(r,e,n){r[n]=e,r[n+1]=e>>>8,r[n+2]=e>>>16,r[n+3]=e>>>24}function zy(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}Bt.prototype={destroy:function(){this.buf=null},readFields:function(r,e,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),h=a>>3,g=this.pos;this.type=7&a,r(h,e,this),this.pos===g&&this.skip(a)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Uh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=zy(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Uh(this.buf,this.pos)+Uh(this.buf,this.pos+4)*nf;return this.pos+=8,r},readSFixed64:function(){var r=Uh(this.buf,this.pos)+zy(this.buf,this.pos+4)*nf;return this.pos+=8,r},readFloat:function(){var r=Iy(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Iy(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,n,a=this.buf;return e=127&(n=a[this.pos++]),n<128?e:(e|=(127&(n=a[this.pos++]))<<7,n<128?e:(e|=(127&(n=a[this.pos++]))<<14,n<128?e:(e|=(127&(n=a[this.pos++]))<<21,n<128?e:function(h,g,y){var v,S,C=y.buf;if(v=(112&(S=C[y.pos++]))>>4,S<128||(v|=(127&(S=C[y.pos++]))<<3,S<128)||(v|=(127&(S=C[y.pos++]))<<10,S<128)||(v|=(127&(S=C[y.pos++]))<<17,S<128)||(v|=(127&(S=C[y.pos++]))<<24,S<128)||(v|=(1&(S=C[y.pos++]))<<31,S<128))return ol(h,v,g);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Ey?function(n,a,h){return Ey.decode(n.subarray(a,h))}(this.buf,e,r):function(n,a,h){for(var g="",y=a;y<h;){var v,S,C,E=n[y],P=null,D=E>239?4:E>223?3:E>191?2:1;if(y+D>h)break;D===1?E<128&&(P=E):D===2?(192&(v=n[y+1]))==128&&(P=(31&E)<<6|63&v)<=127&&(P=null):D===3?(S=n[y+2],(192&(v=n[y+1]))==128&&(192&S)==128&&((P=(15&E)<<12|(63&v)<<6|63&S)<=2047||P>=55296&&P<=57343)&&(P=null)):D===4&&(S=n[y+2],C=n[y+3],(192&(v=n[y+1]))==128&&(192&S)==128&&(192&C)==128&&((P=(15&E)<<18|(63&v)<<12|(63&S)<<6|63&C)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,D=1):P>65535&&(P-=65536,g+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),g+=String.fromCharCode(P),y+=D}return g}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Bt.Bytes)return r.push(this.readVarint(e));var n=Is(this);for(r=r||[];this.pos<n;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Bt.Bytes)return r.push(this.readSVarint());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Bt.Bytes)return r.push(this.readBoolean());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Bt.Bytes)return r.push(this.readFloat());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Bt.Bytes)return r.push(this.readDouble());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Bt.Bytes)return r.push(this.readFixed32());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Bt.Bytes)return r.push(this.readSFixed32());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Bt.Bytes)return r.push(this.readFixed64());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Bt.Bytes)return r.push(this.readSFixed64());var e=Is(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Bt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Bt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Bt.Fixed32)this.pos+=4;else{if(e!==Bt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),al(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),al(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),al(this.buf,-1&r,this.pos),al(this.buf,Math.floor(r*ky),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),al(this.buf,-1&r,this.pos),al(this.buf,Math.floor(r*ky),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,n){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(g,y,v){v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,g>>>=7,v.buf[v.pos++]=127&g|128,v.buf[v.pos]=127&(g>>>=7)}(a,0,n),function(g,y){var v=(7&g)<<4;y.buf[y.pos++]|=v|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))}(h,n)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(a,h,g){for(var y,v,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!v){y>56319||S+1===h.length?(a[g++]=239,a[g++]=191,a[g++]=189):v=y;continue}if(y<56320){a[g++]=239,a[g++]=191,a[g++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(a[g++]=239,a[g++]=191,a[g++]=189,v=null);y<128?a[g++]=y:(y<2048?a[g++]=y>>6|192:(y<65536?a[g++]=y>>12|224:(a[g++]=y>>18|240,a[g++]=y>>12&63|128),a[g++]=y>>6&63|128),a[g++]=63&y|128)}return g}(this.buf,r,this.pos);var n=this.pos-e;n>=128&&Py(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(r){this.realloc(4),Cy(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Cy(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=r[n]},writeRawMessage:function(r,e){this.pos++;var n=this.pos;r(e,this);var a=this.pos-n;a>=128&&Py(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,e,n){this.writeTag(r,Bt.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,mw,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,gw,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,vw,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,yw,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,_w,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,xw,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,ww,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,bw,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,Sw,e)},writeBytesField:function(r,e){this.writeTag(r,Bt.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Bt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Bt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Bt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Bt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Bt.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Bt.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Bt.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Bt.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Bt.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var sf=N(Ty);const of=3;function Tw(r,e,n){r===1&&n.readMessage(Iw,e)}function Iw(r,e,n){if(r===3){const{id:a,bitmap:h,width:g,height:y,left:v,top:S,advance:C}=n.readMessage(Cw,{});e.push({id:a,bitmap:new Bu({width:g+2*of,height:y+2*of},h),metrics:{width:g,height:y,left:v,top:S,advance:C}})}}function Cw(r,e,n){r===1?e.id=n.readVarint():r===2?e.bitmap=n.readBytes():r===3?e.width=n.readVarint():r===4?e.height=n.readVarint():r===5?e.left=n.readSVarint():r===6?e.top=n.readSVarint():r===7&&(e.advance=n.readVarint())}const Ay=of;function My(r){let e=0,n=0;for(const y of r)e+=y.w*y.h,n=Math.max(n,y.w);r.sort((y,v)=>v.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,g=0;for(const y of r)for(let v=a.length-1;v>=0;v--){const S=a[v];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,g=Math.max(g,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const C=a.pop();v<a.length&&(a[v]=C)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(a.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:g,fill:e/(h*g)||0}}const Er=1;class af{constructor(e,{pixelRatio:n,version:a,stretchX:h,stretchY:g,content:y}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=g,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+Er,this.paddedRect.y+Er]}get br(){return[this.paddedRect.x+this.paddedRect.w-Er,this.paddedRect.y+this.paddedRect.h-Er]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Er)/this.pixelRatio,(this.paddedRect.h-2*Er)/this.pixelRatio]}}class Dy{constructor(e,n){const a={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(e,a,g),this.addImages(n,h,g);const{w:y,h:v}=My(g),S=new en({width:y||1,height:v||1});for(const C in e){const E=e[C],P=a[C].paddedRect;en.copy(E.data,S,{x:0,y:0},{x:P.x+Er,y:P.y+Er},E.data)}for(const C in n){const E=n[C],P=h[C].paddedRect,D=P.x+Er,R=P.y+Er,B=E.data.width,j=E.data.height;en.copy(E.data,S,{x:0,y:0},{x:D,y:R},E.data),en.copy(E.data,S,{x:0,y:j-1},{x:D,y:R-1},{width:B,height:1}),en.copy(E.data,S,{x:0,y:0},{x:D,y:R+j},{width:B,height:1}),en.copy(E.data,S,{x:B-1,y:0},{x:D-1,y:R},{width:1,height:j}),en.copy(E.data,S,{x:0,y:0},{x:D+B,y:R},{width:1,height:j})}this.image=S,this.iconPositions=a,this.patternPositions=h}addImages(e,n,a){for(const h in e){const g=e[h],y={x:0,y:0,w:g.data.width+2*Er,h:g.data.height+2*Er};a.push(y),n[h]=new af(y,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),n)}patchUpdatedImage(e,n,a){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,g]=e.tl;a.update(n.data,void 0,{x:h,y:g})}}var po;qe("ImagePosition",af),qe("ImageAtlas",Dy),w.ah=void 0,(po=w.ah||(w.ah={}))[po.none=0]="none",po[po.horizontal=1]="horizontal",po[po.vertical=2]="vertical",po[po.horizontalOnly=3]="horizontalOnly";const qu=-17;class Gu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const a=new Gu;return a.scale=e||1,a.fontStack=n,a}static forImage(e){const n=new Gu;return n.imageName=e,n}}class ll{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const a=new ll;for(let h=0;h<e.sections.length;h++){const g=e.sections[h];g.image?a.addImageSection(g):a.addTextSection(g,n)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let n="";for(let a=0;a<e.length;a++){const h=e.charCodeAt(a+1)||null,g=e.charCodeAt(a-1)||null;n+=h&&gu(h)&&!Zu[e[a+1]]||g&&gu(g)&&!Zu[e[a-1]]||!Zu[e[a]]?e[a]:Zu[e[a]]}return n}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&Zh[this.text.charCodeAt(a)];a++)e++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Zh[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const a=new ll;return a.text=this.text.substring(e,n),a.sectionIndex=this.sectionIndex.slice(e,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Gu.forText(e.scale,e.fontStack||n));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void si("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Gu.forImage(n)),this.sectionIndex.push(this.sections.length-1)):si("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $h(r,e,n,a,h,g,y,v,S,C,E,P,D,R,B,j){const H=ll.fromFeature(r,h);let Y;P===w.ah.vertical&&H.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:ee}=ys;if(ce&&H.sections.length===1){Y=[];const be=ce(H.toString(),lf(H,C,g,e,a,R,B));for(const je of be){const Ye=new ll;Ye.text=je,Ye.sections=H.sections;for(let Ve=0;Ve<je.length;Ve++)Ye.sectionIndex.push(0);Y.push(Ye)}}else if(ee){Y=[];const be=ee(H.text,H.sectionIndex,lf(H,C,g,e,a,R,B));for(const je of be){const Ye=new ll;Ye.text=je[0],Ye.sectionIndex=je[1],Ye.sections=H.sections,Y.push(Ye)}}else Y=function(be,je){const Ye=[],Ve=be.text;let Oe=0;for(const De of je)Ye.push(be.substring(Oe,De)),Oe=De;return Oe<Ve.length&&Ye.push(be.substring(Oe,Ve.length)),Ye}(H,lf(H,C,g,e,a,R,B));const ae=[],xe={positionedLines:ae,text:H.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:P,iconsInText:!1,verticalizable:!1};return function(be,je,Ye,Ve,Oe,De,We,Be,Pe,rt,Qe,wt){let Kt=0,Yt=qu,Ti=0,jr=0;const dr=Be==="right"?1:Be==="left"?0:.5;let vi=0;for(const Ii of Oe){Ii.trim();const Ci=Ii.getMaxScale(),Ji=(Ci-1)*Si,mr={positionedGlyphs:[],lineOffset:0};be.positionedLines[vi]=mr;const Qi=mr.positionedGlyphs;let Pr=0;if(!Ii.length()){Yt+=De,++vi;continue}for(let ki=0;ki<Ii.length();ki++){const Tt=Ii.getSection(ki),er=Ii.getSectionIndex(ki),Hi=Ii.getCharCode(ki);let Ei=0,vn=null,An=null,Mn=null,Cs=Si;const xn=!(Pe===w.ah.horizontal||!Qe&&!Ha(Hi)||Qe&&(Zh[Hi]||(Oi=Hi,$e.Arabic(Oi)||$e["Arabic Supplement"](Oi)||$e["Arabic Extended-A"](Oi)||$e["Arabic Presentation Forms-A"](Oi)||$e["Arabic Presentation Forms-B"](Oi))));if(Tt.imageName){const rn=Ve[Tt.imageName];if(!rn)continue;Mn=Tt.imageName,be.iconsInText=be.iconsInText||!0,An=rn.paddedRect;const Ar=rn.displaySize;Tt.scale=Tt.scale*Si/wt,vn={width:Ar[0],height:Ar[1],left:Er,top:-Ay,advance:xn?Ar[1]:Ar[0]},Ei=Ji+(Si-Ar[1]*Tt.scale),Cs=vn.advance;const ks=xn?Ar[0]*Tt.scale-Si*Ci:Ar[1]*Tt.scale-Si*Ci;ks>0&&ks>Pr&&(Pr=ks)}else{const rn=Ye[Tt.fontStack],Ar=rn&&rn[Hi];if(Ar&&Ar.rect)An=Ar.rect,vn=Ar.metrics;else{const ks=je[Tt.fontStack],Yu=ks&&ks[Hi];if(!Yu)continue;vn=Yu.metrics}Ei=(Ci-Tt.scale)*Si}xn?(be.verticalizable=!0,Qi.push({glyph:Hi,imageName:Mn,x:Kt,y:Yt+Ei,vertical:xn,scale:Tt.scale,fontStack:Tt.fontStack,sectionIndex:er,metrics:vn,rect:An}),Kt+=Cs*Tt.scale+rt):(Qi.push({glyph:Hi,imageName:Mn,x:Kt,y:Yt+Ei,vertical:xn,scale:Tt.scale,fontStack:Tt.fontStack,sectionIndex:er,metrics:vn,rect:An}),Kt+=vn.advance*Tt.scale+rt)}Qi.length!==0&&(Ti=Math.max(Kt-rt,Ti),Pw(Qi,0,Qi.length-1,dr,Pr)),Kt=0;const zr=De*Ci+Pr;mr.lineOffset=Math.max(Pr,Ji),Yt+=zr,jr=Math.max(zr,jr),++vi}var Oi;const Gi=Yt-qu,{horizontalAlign:pr,verticalAlign:fr}=uf(We);(function(Ii,Ci,Ji,mr,Qi,Pr,zr,ki,Tt){const er=(Ci-Ji)*Qi;let Hi=0;Hi=Pr!==zr?-ki*mr-qu:(-mr*Tt+.5)*zr;for(const Ei of Ii)for(const vn of Ei.positionedGlyphs)vn.x+=er,vn.y+=Hi})(be.positionedLines,dr,pr,fr,Ti,jr,De,Gi,Oe.length),be.top+=-fr*Gi,be.bottom=be.top+Gi,be.left+=-pr*Ti,be.right=be.left+Ti}(xe,e,n,a,Y,y,v,S,P,C,D,j),!function(be){for(const je of be)if(je.positionedGlyphs.length!==0)return!1;return!0}(ae)&&xe}const Zh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ly(r,e,n,a,h,g){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Si/g+h:0}{const y=n[e.fontStack],v=y&&y[r];return v?v.metrics.advance*e.scale+h:0}}function Ry(r,e,n,a){const h=Math.pow(r-e,2);return a?r<e?h/2:2*h:h+Math.abs(n)*n}function Ew(r,e,n){let a=0;return r===10&&(a-=1e4),n&&(a+=150),r!==40&&r!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Fy(r,e,n,a,h,g){let y=null,v=Ry(e,n,h,g);for(const S of a){const C=Ry(e-S.x,n,h,g)+S.badness;C<=v&&(y=S,v=C)}return{index:r,x:e,priorBreak:y,badness:v}}function By(r){return r?By(r.priorBreak).concat(r.index):[]}function lf(r,e,n,a,h,g,y){if(g!=="point")return[];if(!r)return[];const v=[],S=function(D,R,B,j,H,Y){let ce=0;for(let ee=0;ee<D.length();ee++){const ae=D.getSection(ee);ce+=Ly(D.getCharCode(ee),ae,j,H,R,Y)}return ce/Math.max(1,Math.ceil(ce/B))}(r,e,n,a,h,y),C=r.text.indexOf("")>=0;let E=0;for(let D=0;D<r.length();D++){const R=r.getSection(D),B=r.getCharCode(D);if(Zh[B]||(E+=Ly(B,R,a,h,e,y)),D<r.length()-1){const j=!((P=B)<11904||!($e["Bopomofo Extended"](P)||$e.Bopomofo(P)||$e["CJK Compatibility Forms"](P)||$e["CJK Compatibility Ideographs"](P)||$e["CJK Compatibility"](P)||$e["CJK Radicals Supplement"](P)||$e["CJK Strokes"](P)||$e["CJK Symbols and Punctuation"](P)||$e["CJK Unified Ideographs Extension A"](P)||$e["CJK Unified Ideographs"](P)||$e["Enclosed CJK Letters and Months"](P)||$e["Halfwidth and Fullwidth Forms"](P)||$e.Hiragana(P)||$e["Ideographic Description Characters"](P)||$e["Kangxi Radicals"](P)||$e["Katakana Phonetic Extensions"](P)||$e.Katakana(P)||$e["Vertical Forms"](P)||$e["Yi Radicals"](P)||$e["Yi Syllables"](P)));(kw[B]||j||R.imageName)&&v.push(Fy(D+1,E,S,v,Ew(B,r.getCharCode(D+1),j&&C),!1))}}var P;return By(Fy(r.length(),E,S,v,0,!0))}function uf(r){let e=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Pw(r,e,n,a,h){if(!a&&!h)return;const g=r[n],y=(r[n].x+g.metrics.advance*g.scale)*a;for(let v=e;v<=n;v++)r[v].x-=y,r[v].y+=h}function zw(r,e,n){const{horizontalAlign:a,verticalAlign:h}=uf(n),g=e[0]-r.displaySize[0]*a,y=e[1]-r.displaySize[1]*h;return{image:r,top:y,bottom:y+r.displaySize[1],left:g,right:g+r.displaySize[0]}}function Oy(r,e,n,a,h,g){const y=r.image;let v;if(y.content){const H=y.content,Y=y.pixelRatio||1;v=[H[0]/Y,H[1]/Y,y.displaySize[0]-H[2]/Y,y.displaySize[1]-H[3]/Y]}const S=e.left*g,C=e.right*g;let E,P,D,R;n==="width"||n==="both"?(R=h[0]+S-a[3],P=h[0]+C+a[1]):(R=h[0]+(S+C-y.displaySize[0])/2,P=R+y.displaySize[0]);const B=e.top*g,j=e.bottom*g;return n==="height"||n==="both"?(E=h[1]+B-a[0],D=h[1]+j+a[2]):(E=h[1]+(B+j-y.displaySize[1])/2,D=E+y.displaySize[1]),{image:y,top:E,right:P,bottom:D,left:R,collisionPadding:v}}const Hu=255,Qn=128,fo=Hu*Qn;function Ny(r,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Ht(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=n;let g=0;for(;g<a.length&&a[g]<=r;)g++;g=Math.max(0,g-1);let y=g;for(;y<a.length&&a[y]<r+1;)y++;y=Math.min(a.length-1,y);const v=a[g],S=a[y];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:S,minSize:n.evaluate(new Ht(v)),maxSize:n.evaluate(new Ht(S)),interpolationType:h}}}function cf(r,e,n){let a="never";const h=r.get(e);return h?a=h:r.get(n)&&(a="always"),a}const Aw=ho.VectorTileFeature.types,Mw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qh(r,e,n,a,h,g,y,v,S,C,E,P,D){const R=v?Math.min(fo,Math.round(v[0])):0,B=v?Math.min(fo,Math.round(v[1])):0;r.emplaceBack(e,n,Math.round(32*a),Math.round(32*h),g,y,(R<<1)+(S?1:0),B,16*C,16*E,256*P,256*D)}function hf(r,e,n){r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n)}function Dw(r){for(const e of r.sections)if(Th(e.text))return!0;return!1}class df{constructor(e){this.layoutVertexArray=new ie,this.indexArray=new me,this.programConfigurations=e,this.segments=new Ie,this.dynamicLayoutVertexArray=new pe,this.opacityVertexArray=new K,this.hasVisibleVertices=!1,this.placedSymbolArray=new t}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cw.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,hw.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Mw,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}qe("SymbolBuffers",df);class pf{constructor(e,n,a){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new a,this.segments=new Ie,this.collisionVertexArray=new fe}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,dw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}qe("CollisionBuffers",pf);class ul{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$p([]),this.placementViewportMatrix=$p([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ny(this.zoom,n["text-size"]),this.iconSizeData=Ny(this.zoom,n["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),g=a.get("symbol-z-order");this.canOverlap=cf(a,"text-overlap","text-allow-overlap")!=="never"||cf(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(y=>w.ah[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new df(new Xt(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new df(new Xt(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new c,this.lineVertexArray=new m,this.symbolInstances=new u,this.textAnchorOffsets=new b}calculateGlyphDependencies(e,n,a,h,g){for(let y=0;y<e.length;y++)if(n[e.charCodeAt(y)]=!0,(a||h)&&g){const v=Zu[e.charAt(y)];v&&(n[v.charCodeAt(0)]=!0)}}populate(e,n,a){const h=this.layers[0],g=h.layout,y=g.get("text-font"),v=g.get("text-field"),S=g.get("icon-image"),C=(v.value.kind!=="constant"||v.value.value instanceof Sr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),E=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,P=g.get("symbol-sort-key");if(this.features=[],!C&&!E)return;const D=n.iconDependencies,R=n.glyphDependencies,B=n.availableImages,j=new Ht(this.zoom);for(const{feature:H,id:Y,index:ce,sourceLayerIndex:ee}of e){const ae=h._featureFilter.needGeometry,xe=Ss(H,ae);if(!h._featureFilter.filter(j,xe,a))continue;let be,je;if(ae||(xe.geometry=bs(H)),C){const Ve=h.getValueAndResolveTokens("text-field",xe,a,B),Oe=Sr.factory(Ve),De=this.hasRTLText=this.hasRTLText||Dw(Oe);(!De||ys.getRTLTextPluginStatus()==="unavailable"||De&&ys.isParsed())&&(be=fw(Oe,h,xe))}if(E){const Ve=h.getValueAndResolveTokens("icon-image",xe,a,B);je=Ve instanceof Or?Ve:Or.fromString(Ve)}if(!be&&!je)continue;const Ye=this.sortFeaturesByKey?P.evaluate(xe,{},a):void 0;if(this.features.push({id:Y,text:be,icon:je,index:ce,sourceLayerIndex:ee,geometry:xe.geometry,properties:H.properties,type:Aw[H.type],sortKey:Ye}),je&&(D[je.name]=!0),be){const Ve=y.evaluate(xe,{},a).join(","),Oe=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(w.ah.vertical)>=0;for(const De of be.sections)if(De.image)D[De.image.name]=!0;else{const We=ta(be.toString()),Be=De.fontStack||Ve,Pe=R[Be]=R[Be]||{};this.calculateGlyphDependencies(De.text,Pe,Oe,this.allowVerticalPlacement,We)}}}g.get("symbol-placement")==="line"&&(this.features=function(H){const Y={},ce={},ee=[];let ae=0;function xe(Ve){ee.push(H[Ve]),ae++}function be(Ve,Oe,De){const We=ce[Ve];return delete ce[Ve],ce[Oe]=We,ee[We].geometry[0].pop(),ee[We].geometry[0]=ee[We].geometry[0].concat(De[0]),We}function je(Ve,Oe,De){const We=Y[Oe];return delete Y[Oe],Y[Ve]=We,ee[We].geometry[0].shift(),ee[We].geometry[0]=De[0].concat(ee[We].geometry[0]),We}function Ye(Ve,Oe,De){const We=De?Oe[0][Oe[0].length-1]:Oe[0][0];return`${Ve}:${We.x}:${We.y}`}for(let Ve=0;Ve<H.length;Ve++){const Oe=H[Ve],De=Oe.geometry,We=Oe.text?Oe.text.toString():null;if(!We){xe(Ve);continue}const Be=Ye(We,De),Pe=Ye(We,De,!0);if(Be in ce&&Pe in Y&&ce[Be]!==Y[Pe]){const rt=je(Be,Pe,De),Qe=be(Be,Pe,ee[rt].geometry);delete Y[Be],delete ce[Pe],ce[Ye(We,ee[Qe].geometry,!0)]=Qe,ee[rt].geometry=null}else Be in ce?be(Be,Pe,De):Pe in Y?je(Be,Pe,De):(xe(Ve),Y[Be]=ae-1,ce[Pe]=ae-1)}return ee.filter(Ve=>Ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Y)=>H.sortKey-Y.sortKey)}update(e,n,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const a=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(n[e.segment+1]),g=e.dist(n[e.segment]);const y={};for(let v=e.segment+1;v<n.length;v++)y[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:h},v<n.length-1&&(h+=n[v+1].dist(n[v]));for(let v=e.segment||0;v>=0;v--)y[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:g},v>0&&(g+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const S=y[v];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,n,a,h,g,y,v,S,C,E,P,D){const R=e.indexArray,B=e.layoutVertexArray,j=e.segments.prepareSegment(4*n.length,B,R,this.canOverlap?y.sortKey:void 0),H=this.glyphOffsetArray.length,Y=j.vertexLength,ce=this.allowVerticalPlacement&&v===w.ah.vertical?Math.PI/2:0,ee=y.text&&y.text.sections;for(let ae=0;ae<n.length;ae++){const{tl:xe,tr:be,bl:je,br:Ye,tex:Ve,pixelOffsetTL:Oe,pixelOffsetBR:De,minFontScaleX:We,minFontScaleY:Be,glyphOffset:Pe,isSDF:rt,sectionIndex:Qe}=n[ae],wt=j.vertexLength,Kt=Pe[1];qh(B,S.x,S.y,xe.x,Kt+xe.y,Ve.x,Ve.y,a,rt,Oe.x,Oe.y,We,Be),qh(B,S.x,S.y,be.x,Kt+be.y,Ve.x+Ve.w,Ve.y,a,rt,De.x,Oe.y,We,Be),qh(B,S.x,S.y,je.x,Kt+je.y,Ve.x,Ve.y+Ve.h,a,rt,Oe.x,De.y,We,Be),qh(B,S.x,S.y,Ye.x,Kt+Ye.y,Ve.x+Ve.w,Ve.y+Ve.h,a,rt,De.x,De.y,We,Be),hf(e.dynamicLayoutVertexArray,S,ce),R.emplaceBack(wt,wt+1,wt+2),R.emplaceBack(wt+1,wt+2,wt+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pe[0]),ae!==n.length-1&&Qe===n[ae+1].sectionIndex||e.programConfigurations.populatePaintArrays(B.length,y,y.index,{},D,ee&&ee[Qe])}e.placedSymbolArray.emplaceBack(S.x,S.y,H,this.glyphOffsetArray.length-H,Y,C,E,S.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,P)}_addCollisionDebugVertex(e,n,a,h,g,y){return n.emplaceBack(0,0),e.emplaceBack(a.x,a.y,h,g,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,n,a,h,g,y,v){const S=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),C=S.vertexLength,E=g.layoutVertexArray,P=g.collisionVertexArray,D=v.anchorX,R=v.anchorY;this._addCollisionDebugVertex(E,P,y,D,R,new X(e,n)),this._addCollisionDebugVertex(E,P,y,D,R,new X(a,n)),this._addCollisionDebugVertex(E,P,y,D,R,new X(a,h)),this._addCollisionDebugVertex(E,P,y,D,R,new X(e,h)),S.vertexLength+=4;const B=g.indexArray;B.emplaceBack(C,C+1),B.emplaceBack(C+1,C+2),B.emplaceBack(C+2,C+3),B.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(e,n,a,h){for(let g=e;g<n;g++){const y=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pf(le,Sy.members,ge),this.iconCollisionBox=new pf(le,Sy.members,ge);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,a,h,g,y,v,S,C){const E={};for(let P=n;P<a;P++){const D=e.get(P);E.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},E.textFeatureIndex=D.featureIndex;break}for(let P=h;P<g;P++){const D=e.get(P);E.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},E.verticalTextFeatureIndex=D.featureIndex;break}for(let P=y;P<v;P++){const D=e.get(P);E.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},E.iconFeatureIndex=D.featureIndex;break}for(let P=S;P<C;P++){const D=e.get(P);E.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},E.verticalIconFeatureIndex=D.featureIndex;break}return E}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const a=e.placedSymbolArray.get(n),h=a.vertexStartIndex+4*a.numGlyphs;for(let g=a.vertexStartIndex;g<h;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),a=Math.cos(e),h=[],g=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const S=this.symbolInstances.get(v);h.push(0|Math.round(n*S.anchorX+a*S.anchorY)),g.push(S.featureIndex)}return y.sort((v,S)=>h[v]-h[S]||g[S]-g[v]),y}addToSortKeyRanges(e,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,g,y)=>{h>=0&&y.indexOf(h)===g&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Vy,jy;qe("SymbolBucket",ul,{omit:["layers","collisionBoxArray","features","compareText"]}),ul.MAX_GLYPHS=65535,ul.addDynamicAttributes=hf;var ff={get paint(){return jy=jy||new ur({"icon-opacity":new nt(ye.paint_symbol["icon-opacity"]),"icon-color":new nt(ye.paint_symbol["icon-color"]),"icon-halo-color":new nt(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new nt(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nt(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new et(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new et(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new nt(ye.paint_symbol["text-opacity"]),"text-color":new nt(ye.paint_symbol["text-color"],{runtimeType:Bi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new nt(ye.paint_symbol["text-halo-color"]),"text-halo-width":new nt(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new nt(ye.paint_symbol["text-halo-blur"]),"text-translate":new et(ye.paint_symbol["text-translate"]),"text-translate-anchor":new et(ye.paint_symbol["text-translate-anchor"])})},get layout(){return Vy=Vy||new ur({"symbol-placement":new et(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new et(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new et(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nt(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new et(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new et(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new et(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new et(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new et(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new et(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new nt(ye.layout_symbol["icon-size"]),"icon-text-fit":new et(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new et(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new nt(ye.layout_symbol["icon-image"]),"icon-rotate":new nt(ye.layout_symbol["icon-rotate"]),"icon-padding":new nt(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new et(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new nt(ye.layout_symbol["icon-offset"]),"icon-anchor":new nt(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new et(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new et(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new et(ye.layout_symbol["text-rotation-alignment"]),"text-field":new nt(ye.layout_symbol["text-field"]),"text-font":new nt(ye.layout_symbol["text-font"]),"text-size":new nt(ye.layout_symbol["text-size"]),"text-max-width":new nt(ye.layout_symbol["text-max-width"]),"text-line-height":new et(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new nt(ye.layout_symbol["text-letter-spacing"]),"text-justify":new nt(ye.layout_symbol["text-justify"]),"text-radial-offset":new nt(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new et(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new nt(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new nt(ye.layout_symbol["text-anchor"]),"text-max-angle":new et(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new et(ye.layout_symbol["text-writing-mode"]),"text-rotate":new nt(ye.layout_symbol["text-rotate"]),"text-padding":new et(ye.layout_symbol["text-padding"]),"text-keep-upright":new et(ye.layout_symbol["text-keep-upright"]),"text-transform":new nt(ye.layout_symbol["text-transform"]),"text-offset":new nt(ye.layout_symbol["text-offset"]),"text-allow-overlap":new et(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new et(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new et(ye.layout_symbol["text-ignore-placement"]),"text-optional":new et(ye.layout_symbol["text-optional"])})}};class Uy{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:us,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}qe("FormatSectionOverride",Uy,{omit:["defaultValue"]});class Gh extends Yr{constructor(e){super(e,ff)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const g of a)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,a,h){const g=this.layout.get(e).evaluate(n,{},a,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||$t(y.value)||!g?g:function(v,S){return S.replace(/{([^{}]+)}/g,(C,E)=>v&&E in v?String(v[E]):"")}(n.properties,g)}createBucket(e){return new ul(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of ff.paint.overridableProperties){if(!Gh.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),a=new Uy(n),h=new Yo(a,n.property.specification);let g=null;g=n.value.kind==="constant"||n.value.kind==="source"?new Qs("source",h):new Va("composite",h,n.value.zoomStops),this.paint._values[e]=new Xr(n.property,g,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&Gh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const a=e.get("text-field"),h=ff.paint.properties[n];let g=!1;const y=v=>{for(const S of v)if(h.overrides&&h.overrides.hasOverride(S))return void(g=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Sr)y(a.value.value.sections);else if(a.value.kind==="source"){const v=C=>{g||(C instanceof cs&&yi(C.value)===En?y(C.value.sections):C instanceof Na?y(C.sections):C.eachChild(v))},S=a.value;S._styleExpression&&v(S._styleExpression.expression)}return g}}let $y;var Lw={get paint(){return $y=$y||new ur({"background-color":new et(ye.paint_background["background-color"]),"background-pattern":new wu(ye.paint_background["background-pattern"]),"background-opacity":new et(ye.paint_background["background-opacity"])})}};class Rw extends Yr{constructor(e){super(e,Lw)}}let Zy;var Fw={get paint(){return Zy=Zy||new ur({"raster-opacity":new et(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new et(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new et(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new et(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new et(ye.paint_raster["raster-saturation"]),"raster-contrast":new et(ye.paint_raster["raster-contrast"]),"raster-resampling":new et(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new et(ye.paint_raster["raster-fade-duration"])})}};class Bw extends Yr{constructor(e){super(e,Fw)}}class Ow extends Yr{constructor(e){super(e,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Nw{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mf=63710088e-1;class mo{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new mo(Xe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,a=this.lat*n,h=e.lat*n,g=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return mf*Math.acos(Math.min(g,1))}static convert(e){if(e instanceof mo)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new mo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new mo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const qy=2*Math.PI*mf;function Gy(r){return qy*Math.cos(r*Math.PI/180)}function Hy(r){return(180+r)/360}function Wy(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ky(r,e){return r/Gy(e)}function gf(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Hh{constructor(e,n,a=0){this.x=+e,this.y=+n,this.z=+a}static fromLngLat(e,n=0){const a=mo.convert(e);return new Hh(Hy(a.lng),Wy(a.lat),Ky(n,a.lat))}toLngLat(){return new mo(360*this.x-180,gf(this.y))}toAltitude(){return this.z*Gy(gf(this.y))}meterInMercatorCoordinateUnits(){return 1/qy*(e=gf(this.y),1/Math.cos(e*Math.PI/180));var e}}function Xy(r,e,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[r*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class yf{constructor(e,n,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||n<0||n>=Math.pow(2,e))throw new Error(`x=${n}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=a,this.key=Wu(0,e,e,n,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,a){const h=(y=this.y,v=this.z,S=Xy(256*(g=this.x),256*(y=Math.pow(2,v)-y-1),v),C=Xy(256*(g+1),256*(y+1),v),S[0]+","+S[1]+","+C[0]+","+C[1]);var g,y,v,S,C;const E=function(P,D,R){let B,j="";for(let H=P;H>0;H--)B=1<<H-1,j+=(D&B?1:0)+(R&B?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new X((e.x*n-this.x)*bt,(e.y*n-this.y)*bt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Yy{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Wu(e,n.z,n.z,n.x,n.y)}}class tn{constructor(e,n,a,h,g){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=n,this.canonical=new yf(a,+h,+g),this.key=Wu(n,e,a,h,g)}clone(){return new tn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new tn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?Wu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Wu(this.wrap*+n,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new tn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new tn(n,this.wrap,n,a,h),new tn(n,this.wrap,n,a+1,h),new tn(n,this.wrap,n,a,h+1),new tn(n,this.wrap,n,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new tn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new tn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Yy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Hh(e.x-this.wrap,e.y))}}function Wu(r,e,n,a,h){(r*=2)<0&&(r=-1*r-1);const g=1<<n;return(g*g*r+g*h+a).toString(36)+n.toString(36)+e.toString(36)}qe("CanonicalTileID",yf),qe("OverscaledTileID",tn,{omit:["posMatrix"]});class Jy{constructor(e,n,a,h=1,g=1,y=1,v=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void si(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const S=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=g,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<S;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(S,C)]=this.data[this._idx(S-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,S)]=this.data[this._idx(C,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<S;C++)for(let E=0;E<S;E++){const P=this.get(C,E);P>this.max&&(this.max=P),P<this.min&&(this.min=P)}}get(e,n){const a=new Uint8Array(this.data.buffer),h=4*this._idx(e,n);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}unpack(e,n,a){return e*this.redFactor+n*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new en({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,g=n*this.dim+this.dim,y=a*this.dim,v=a*this.dim+this.dim;switch(n){case-1:h=g-1;break;case 1:g=h+1}switch(a){case-1:y=v-1;break;case 1:v=y+1}const S=-n*this.dim,C=-a*this.dim;for(let E=y;E<v;E++)for(let P=h;P<g;P++)this.data[this._idx(P,E)]=e.data[this._idx(P+S,E+C)]}}qe("DEMData",Jy);class Qy{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const a=e[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class e_{constructor(e,n,a,h,g){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=a,e._y=h,this.properties=e.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class t_{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Pn(bt,16,0),this.grid3D=new Pn(bt,16,0),this.featureIndexArray=new k,this.promoteId=n}insert(e,n,a,h,g,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,g);const S=y?this.grid3D:this.grid;for(let C=0;C<n.length;C++){const E=n[C],P=[1/0,1/0,-1/0,-1/0];for(let D=0;D<E.length;D++){const R=E[D];P[0]=Math.min(P[0],R.x),P[1]=Math.min(P[1],R.y),P[2]=Math.max(P[2],R.x),P[3]=Math.max(P[3],R.y)}P[0]<bt&&P[1]<bt&&P[2]>=0&&P[3]>=0&&S.insert(v,P[0],P[1],P[2],P[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ho.VectorTile(new sf(this.rawTileData)).layers,this.sourceLayerCoder=new Qy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,n,a,h){this.loadVTLayers();const g=e.params||{},y=bt/e.tileSize/e.scale,v=$a(g.filter),S=e.queryGeometry,C=e.queryPadding*y,E=r_(S),P=this.grid.query(E.minX-C,E.minY-C,E.maxX+C,E.maxY+C),D=r_(e.cameraQueryGeometry),R=this.grid3D.query(D.minX-C,D.minY-C,D.maxX+C,D.maxY+C,(H,Y,ce,ee)=>function(ae,xe,be,je,Ye){for(const Oe of ae)if(xe<=Oe.x&&be<=Oe.y&&je>=Oe.x&&Ye>=Oe.y)return!0;const Ve=[new X(xe,be),new X(xe,Ye),new X(je,Ye),new X(je,be)];if(ae.length>2){for(const Oe of Ve)if(il(ae,Oe))return!0}for(let Oe=0;Oe<ae.length-1;Oe++)if(y1(ae[Oe],ae[Oe+1],Ve))return!0;return!1}(e.cameraQueryGeometry,H-C,Y-C,ce+C,ee+C));for(const H of R)P.push(H);P.sort(Vw);const B={};let j;for(let H=0;H<P.length;H++){const Y=P[H];if(Y===j)continue;j=Y;const ce=this.featureIndexArray.get(Y);let ee=null;this.loadMatchingFeature(B,ce.bucketIndex,ce.sourceLayerIndex,ce.featureIndex,v,g.layers,g.availableImages,n,a,h,(ae,xe,be)=>(ee||(ee=bs(ae)),xe.queryIntersectsFeature(S,ae,be,ee,this.z,e.transform,y,e.pixelPosMatrix)))}return B}loadMatchingFeature(e,n,a,h,g,y,v,S,C,E,P){const D=this.bucketLayerIDs[n];if(y&&!function(H,Y){for(let ce=0;ce<H.length;ce++)if(Y.indexOf(H[ce])>=0)return!0;return!1}(y,D))return;const R=this.sourceLayerCoder.decode(a),B=this.vtLayers[R].feature(h);if(g.needGeometry){const H=Ss(B,!0);if(!g.filter(new Ht(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!g.filter(new Ht(this.tileID.overscaledZ),B))return;const j=this.getId(B,R);for(let H=0;H<D.length;H++){const Y=D[H];if(y&&y.indexOf(Y)<0)continue;const ce=S[Y];if(!ce)continue;let ee={};j&&E&&(ee=E.getState(ce.sourceLayer||"_geojsonTileLayer",j));const ae=Ke({},C[Y]);ae.paint=i_(ae.paint,ce.paint,B,ee,v),ae.layout=i_(ae.layout,ce.layout,B,ee,v);const xe=!P||P(B,ce,ee);if(!xe)continue;const be=new e_(B,this.z,this.x,this.y,j);be.layer=ae;let je=e[Y];je===void 0&&(je=e[Y]=[]),je.push({featureIndex:h,feature:be,intersectionZ:xe})}}lookupSymbolFeatures(e,n,a,h,g,y,v,S){const C={};this.loadVTLayers();const E=$a(g);for(const P of e)this.loadMatchingFeature(C,a,h,P,E,y,v,S,n);return C}hasLayer(e){for(const n of this.bucketLayerIDs)for(const a of n)if(e===a)return!0;return!1}getId(e,n){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof a=="boolean"&&(a=Number(a))),a}}function i_(r,e,n,a,h){return Dt(r,(g,y)=>{const v=e instanceof ia?e.get(y):null;return v&&v.evaluate?v.evaluate(n,a,h):v})}function r_(r){let e=1/0,n=1/0,a=-1/0,h=-1/0;for(const g of r)e=Math.min(e,g.x),n=Math.min(n,g.y),a=Math.max(a,g.x),h=Math.max(h,g.y);return{minX:e,minY:n,maxX:a,maxY:h}}function Vw(r,e){return e-r}function n_(r,e,n,a,h){const g=[];for(let y=0;y<r.length;y++){const v=r[y];let S;for(let C=0;C<v.length-1;C++){let E=v[C],P=v[C+1];E.x<e&&P.x<e||(E.x<e?E=new X(e,E.y+(e-E.x)/(P.x-E.x)*(P.y-E.y))._round():P.x<e&&(P=new X(e,E.y+(e-E.x)/(P.x-E.x)*(P.y-E.y))._round()),E.y<n&&P.y<n||(E.y<n?E=new X(E.x+(n-E.y)/(P.y-E.y)*(P.x-E.x),n)._round():P.y<n&&(P=new X(E.x+(n-E.y)/(P.y-E.y)*(P.x-E.x),n)._round()),E.x>=a&&P.x>=a||(E.x>=a?E=new X(a,E.y+(a-E.x)/(P.x-E.x)*(P.y-E.y))._round():P.x>=a&&(P=new X(a,E.y+(a-E.x)/(P.x-E.x)*(P.y-E.y))._round()),E.y>=h&&P.y>=h||(E.y>=h?E=new X(E.x+(h-E.y)/(P.y-E.y)*(P.x-E.x),h)._round():P.y>=h&&(P=new X(E.x+(h-E.y)/(P.y-E.y)*(P.x-E.x),h)._round()),S&&E.equals(S[S.length-1])||(S=[E],g.push(S)),S.push(P)))))}}return g}qe("FeatureIndex",t_,{omit:["rawTileData","sourceLayerCoder"]});class go extends X{constructor(e,n,a,h){super(e,n),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new go(this.x,this.y,this.angle,this.segment)}}function s_(r,e,n,a,h){if(e.segment===void 0||n===0)return!0;let g=e,y=e.segment+1,v=0;for(;v>-n/2;){if(y--,y<0)return!1;v-=r[y].dist(g),g=r[y]}v+=r[y].dist(r[y+1]),y++;const S=[];let C=0;for(;v<n/2;){const E=r[y],P=r[y+1];if(!P)return!1;let D=r[y-1].angleTo(E)-E.angleTo(P);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:v,angleDelta:D}),C+=D;v-S[0].distance>a;)C-=S.shift().angleDelta;if(C>h)return!1;y++,v+=E.dist(P)}return!0}function o_(r){let e=0;for(let n=0;n<r.length-1;n++)e+=r[n].dist(r[n+1]);return e}function a_(r,e,n){return r?.6*e*n:0}function l_(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function jw(r,e,n,a,h,g){const y=a_(n,h,g),v=l_(n,a)*g;let S=0;const C=o_(r)/2;for(let E=0;E<r.length-1;E++){const P=r[E],D=r[E+1],R=P.dist(D);if(S+R>C){const B=(C-S)/R,j=Ir.number(P.x,D.x,B),H=Ir.number(P.y,D.y,B),Y=new go(j,H,D.angleTo(P),E);return Y._round(),!y||s_(r,Y,v,y,e)?Y:void 0}S+=R}}function Uw(r,e,n,a,h,g,y,v,S){const C=a_(a,g,y),E=l_(a,h),P=E*y,D=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return e-P<e/4&&(e=P+e/4),u_(r,D?e/2*v%e:(E/2+2*g)*y*v%e,e,C,n,P,D,!1,S)}function u_(r,e,n,a,h,g,y,v,S){const C=g/2,E=o_(r);let P=0,D=e-n,R=[];for(let B=0;B<r.length-1;B++){const j=r[B],H=r[B+1],Y=j.dist(H),ce=H.angleTo(j);for(;D+n<P+Y;){D+=n;const ee=(D-P)/Y,ae=Ir.number(j.x,H.x,ee),xe=Ir.number(j.y,H.y,ee);if(ae>=0&&ae<S&&xe>=0&&xe<S&&D-C>=0&&D+C<=E){const be=new go(ae,xe,ce,B);be._round(),a&&!s_(r,be,g,a,h)||R.push(be)}}P+=Y}return v||R.length||y||(R=u_(r,P/2,n,a,h,g,y,!0,S)),R}qe("Anchor",go);const cl=Er;function c_(r,e,n,a){const h=[],g=r.image,y=g.pixelRatio,v=g.paddedRect.w-2*cl,S=g.paddedRect.h-2*cl,C=r.right-r.left,E=r.bottom-r.top,P=g.stretchX||[[0,v]],D=g.stretchY||[[0,S]],R=(De,We)=>De+We[1]-We[0],B=P.reduce(R,0),j=D.reduce(R,0),H=v-B,Y=S-j;let ce=0,ee=B,ae=0,xe=j,be=0,je=H,Ye=0,Ve=Y;if(g.content&&a){const De=g.content;ce=Wh(P,0,De[0]),ae=Wh(D,0,De[1]),ee=Wh(P,De[0],De[2]),xe=Wh(D,De[1],De[3]),be=De[0]-ce,Ye=De[1]-ae,je=De[2]-De[0]-ee,Ve=De[3]-De[1]-xe}const Oe=(De,We,Be,Pe)=>{const rt=Kh(De.stretch-ce,ee,C,r.left),Qe=Xh(De.fixed-be,je,De.stretch,B),wt=Kh(We.stretch-ae,xe,E,r.top),Kt=Xh(We.fixed-Ye,Ve,We.stretch,j),Yt=Kh(Be.stretch-ce,ee,C,r.left),Ti=Xh(Be.fixed-be,je,Be.stretch,B),jr=Kh(Pe.stretch-ae,xe,E,r.top),dr=Xh(Pe.fixed-Ye,Ve,Pe.stretch,j),vi=new X(rt,wt),Oi=new X(Yt,wt),Gi=new X(Yt,jr),pr=new X(rt,jr),fr=new X(Qe/y,Kt/y),Ii=new X(Ti/y,dr/y),Ci=e*Math.PI/180;if(Ci){const Qi=Math.sin(Ci),Pr=Math.cos(Ci),zr=[Pr,-Qi,Qi,Pr];vi._matMult(zr),Oi._matMult(zr),pr._matMult(zr),Gi._matMult(zr)}const Ji=De.stretch+De.fixed,mr=We.stretch+We.fixed;return{tl:vi,tr:Oi,bl:pr,br:Gi,tex:{x:g.paddedRect.x+cl+Ji,y:g.paddedRect.y+cl+mr,w:Be.stretch+Be.fixed-Ji,h:Pe.stretch+Pe.fixed-mr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:fr,pixelOffsetBR:Ii,minFontScaleX:je/y/C,minFontScaleY:Ve/y/E,isSDF:n}};if(a&&(g.stretchX||g.stretchY)){const De=h_(P,H,B),We=h_(D,Y,j);for(let Be=0;Be<De.length-1;Be++){const Pe=De[Be],rt=De[Be+1];for(let Qe=0;Qe<We.length-1;Qe++)h.push(Oe(Pe,We[Qe],rt,We[Qe+1]))}}else h.push(Oe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:S+1}));return h}function Wh(r,e,n){let a=0;for(const h of r)a+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return a}function h_(r,e,n){const a=[{fixed:-cl,stretch:0}];for(const[h,g]of r){const y=a[a.length-1];a.push({fixed:h-y.stretch,stretch:y.stretch}),a.push({fixed:h-y.stretch,stretch:y.stretch+(g-h)})}return a.push({fixed:e+cl,stretch:n}),a}function Kh(r,e,n,a){return r/e*n+a}function Xh(r,e,n,a){return r-e*n/a}class Yh{constructor(e,n,a,h,g,y,v,S,C,E){if(this.boxStartIndex=e.length,C){let P=y.top,D=y.bottom;const R=y.collisionPadding;R&&(P-=R[1],D+=R[3]);let B=D-P;B>0&&(B=Math.max(10,B),this.circleDiameter=B)}else{let P=y.top*v-S[0],D=y.bottom*v+S[2],R=y.left*v-S[3],B=y.right*v+S[1];const j=y.collisionPadding;if(j&&(R-=j[0]*v,P-=j[1]*v,B+=j[2]*v,D+=j[3]*v),E){const H=new X(R,P),Y=new X(B,P),ce=new X(R,D),ee=new X(B,D),ae=E*Math.PI/180;H._rotate(ae),Y._rotate(ae),ce._rotate(ae),ee._rotate(ae),R=Math.min(H.x,Y.x,ce.x,ee.x),B=Math.max(H.x,Y.x,ce.x,ee.x),P=Math.min(H.y,Y.y,ce.y,ee.y),D=Math.max(H.y,Y.y,ce.y,ee.y)}e.emplaceBack(n.x,n.y,R,P,B,D,a,h,g)}this.boxEndIndex=e.length}}class $w{constructor(e=[],n=Zw){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:a}=this,h=n[e];for(;e>0;){const g=e-1>>1,y=n[g];if(a(h,y)>=0)break;n[e]=y,e=g}n[e]=h}_down(e){const{data:n,compare:a}=this,h=this.length>>1,g=n[e];for(;e<h;){let y=1+(e<<1),v=n[y];const S=y+1;if(S<this.length&&a(n[S],v)<0&&(y=S,v=n[S]),a(v,g)>=0)break;n[e]=v,e=y}n[e]=g}}function Zw(r,e){return r<e?-1:r>e?1:0}function qw(r,e=1,n=!1){let a=1/0,h=1/0,g=-1/0,y=-1/0;const v=r[0];for(let R=0;R<v.length;R++){const B=v[R];(!R||B.x<a)&&(a=B.x),(!R||B.y<h)&&(h=B.y),(!R||B.x>g)&&(g=B.x),(!R||B.y>y)&&(y=B.y)}const S=Math.min(g-a,y-h);let C=S/2;const E=new $w([],Gw);if(S===0)return new X(a,h);for(let R=a;R<g;R+=S)for(let B=h;B<y;B+=S)E.push(new hl(R+C,B+C,C,r));let P=function(R){let B=0,j=0,H=0;const Y=R[0];for(let ce=0,ee=Y.length,ae=ee-1;ce<ee;ae=ce++){const xe=Y[ce],be=Y[ae],je=xe.x*be.y-be.x*xe.y;j+=(xe.x+be.x)*je,H+=(xe.y+be.y)*je,B+=3*je}return new hl(j/B,H/B,0,R)}(r),D=E.length;for(;E.length;){const R=E.pop();(R.d>P.d||!P.d)&&(P=R,n&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,D)),R.max-P.d<=e||(C=R.h/2,E.push(new hl(R.p.x-C,R.p.y-C,C,r)),E.push(new hl(R.p.x+C,R.p.y-C,C,r)),E.push(new hl(R.p.x-C,R.p.y+C,C,r)),E.push(new hl(R.p.x+C,R.p.y+C,C,r)),D+=4)}return n&&(console.log(`num probes: ${D}`),console.log(`best distance: ${P.d}`)),P.p}function Gw(r,e){return e.max-r.max}function hl(r,e,n,a){this.p=new X(r,e),this.h=n,this.d=function(h,g){let y=!1,v=1/0;for(let S=0;S<g.length;S++){const C=g[S];for(let E=0,P=C.length,D=P-1;E<P;D=E++){const R=C[E],B=C[D];R.y>h.y!=B.y>h.y&&h.x<(B.x-R.x)*(h.y-R.y)/(B.y-R.y)+R.x&&(y=!y),v=Math.min(v,Wg(h,R,B))}}return(y?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var qi;w.ap=void 0,(qi=w.ap||(w.ap={}))[qi.center=1]="center",qi[qi.left=2]="left",qi[qi.right=3]="right",qi[qi.top=4]="top",qi[qi.bottom=5]="bottom",qi[qi["top-left"]=6]="top-left",qi[qi["top-right"]=7]="top-right",qi[qi["bottom-left"]=8]="bottom-left",qi[qi["bottom-right"]=9]="bottom-right";const yo=7,_f=Number.POSITIVE_INFINITY;function d_(r,e){return e[1]!==_f?function(n,a,h){let g=0,y=0;switch(a=Math.abs(a),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-yo;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+yo}switch(n){case"top-right":case"bottom-right":case"right":g=-a;break;case"top-left":case"bottom-left":case"left":g=a}return[g,y]}(r,e[0],e[1]):function(n,a){let h=0,g=0;a<0&&(a=0);const y=a/Math.SQRT2;switch(n){case"top-right":case"top-left":g=y-yo;break;case"bottom-right":case"bottom-left":g=-y+yo;break;case"bottom":g=-a+yo;break;case"top":g=a-yo}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=a;break;case"right":h=-a}return[h,g]}(r,e[0])}function p_(r,e,n){var a;const h=r.layout,g=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(e,{},n);if(g){const v=g.values,S=[];for(let C=0;C<v.length;C+=2){const E=S[C]=v[C],P=v[C+1].map(D=>D*Si);E.startsWith("top")?P[1]-=yo:E.startsWith("bottom")&&(P[1]+=yo),S[C+1]=P}return new $i(S)}const y=h.get("text-variable-anchor");if(y){let v;v=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},n)*Si,_f]:h.get("text-offset").evaluate(e,{},n).map(C=>C*Si);const S=[];for(const C of y)S.push(C,d_(C,v));return new $i(S)}return null}function vf(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hw(r,e,n,a,h,g,y,v,S,C,E){let P=g.textMaxSize.evaluate(e,{});P===void 0&&(P=y);const D=r.layers[0].layout,R=D.get("icon-offset").evaluate(e,{},E),B=m_(n.horizontal),j=y/24,H=r.tilePixelRatio*j,Y=r.tilePixelRatio*P/24,ce=r.tilePixelRatio*v,ee=r.tilePixelRatio*D.get("symbol-spacing"),ae=D.get("text-padding")*r.tilePixelRatio,xe=function(Pe,rt,Qe,wt=1){const Kt=Pe.get("icon-padding").evaluate(rt,{},Qe),Yt=Kt&&Kt.values;return[Yt[0]*wt,Yt[1]*wt,Yt[2]*wt,Yt[3]*wt]}(D,e,E,r.tilePixelRatio),be=D.get("text-max-angle")/180*Math.PI,je=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point",Ye=D.get("icon-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",Ve=D.get("symbol-placement"),Oe=ee/2,De=D.get("icon-text-fit");let We;a&&De!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(We=Oy(a,n.vertical,De,D.get("icon-text-fit-padding"),R,j)),B&&(a=Oy(a,B,De,D.get("icon-text-fit-padding"),R,j)));const Be=(Pe,rt)=>{rt.x<0||rt.x>=bt||rt.y<0||rt.y>=bt||function(Qe,wt,Kt,Yt,Ti,jr,dr,vi,Oi,Gi,pr,fr,Ii,Ci,Ji,mr,Qi,Pr,zr,ki,Tt,er,Hi,Ei,vn){const An=Qe.addToLineVertexArray(wt,Kt);let Mn,Cs,xn,rn,Ar=0,ks=0,Yu=0,v_=0,kf=-1,Ef=-1;const Es={};let x_=vt("");if(Qe.allowVerticalPlacement&&Yt.vertical){const tr=vi.layout.get("text-rotate").evaluate(Tt,{},Ei)+90;xn=new Yh(Oi,wt,Gi,pr,fr,Yt.vertical,Ii,Ci,Ji,tr),dr&&(rn=new Yh(Oi,wt,Gi,pr,fr,dr,Qi,Pr,Ji,tr))}if(Ti){const tr=vi.layout.get("icon-rotate").evaluate(Tt,{}),nn=vi.layout.get("icon-text-fit")!=="none",ca=c_(Ti,tr,Hi,nn),Ln=dr?c_(dr,tr,Hi,nn):void 0;Cs=new Yh(Oi,wt,Gi,pr,fr,Ti,Qi,Pr,!1,tr),Ar=4*ca.length;const ha=Qe.iconSizeData;let es=null;ha.kind==="source"?(es=[Qn*vi.layout.get("icon-size").evaluate(Tt,{})],es[0]>fo&&si(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Hu}. Reduce your "icon-size".`)):ha.kind==="composite"&&(es=[Qn*er.compositeIconSizes[0].evaluate(Tt,{},Ei),Qn*er.compositeIconSizes[1].evaluate(Tt,{},Ei)],(es[0]>fo||es[1]>fo)&&si(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Hu}. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,ca,es,ki,zr,Tt,w.ah.none,wt,An.lineStartIndex,An.lineLength,-1,Ei),kf=Qe.icon.placedSymbolArray.length-1,Ln&&(ks=4*Ln.length,Qe.addSymbols(Qe.icon,Ln,es,ki,zr,Tt,w.ah.vertical,wt,An.lineStartIndex,An.lineLength,-1,Ei),Ef=Qe.icon.placedSymbolArray.length-1)}const w_=Object.keys(Yt.horizontal);for(const tr of w_){const nn=Yt.horizontal[tr];if(!Mn){x_=vt(nn.text);const Ln=vi.layout.get("text-rotate").evaluate(Tt,{},Ei);Mn=new Yh(Oi,wt,Gi,pr,fr,nn,Ii,Ci,Ji,Ln)}const ca=nn.positionedLines.length===1;if(Yu+=f_(Qe,wt,nn,jr,vi,Ji,Tt,mr,An,Yt.vertical?w.ah.horizontal:w.ah.horizontalOnly,ca?w_:[tr],Es,kf,er,Ei),ca)break}Yt.vertical&&(v_+=f_(Qe,wt,Yt.vertical,jr,vi,Ji,Tt,mr,An,w.ah.vertical,["vertical"],Es,Ef,er,Ei));const Xw=Mn?Mn.boxStartIndex:Qe.collisionBoxArray.length,Yw=Mn?Mn.boxEndIndex:Qe.collisionBoxArray.length,Jw=xn?xn.boxStartIndex:Qe.collisionBoxArray.length,Qw=xn?xn.boxEndIndex:Qe.collisionBoxArray.length,eb=Cs?Cs.boxStartIndex:Qe.collisionBoxArray.length,tb=Cs?Cs.boxEndIndex:Qe.collisionBoxArray.length,ib=rn?rn.boxStartIndex:Qe.collisionBoxArray.length,rb=rn?rn.boxEndIndex:Qe.collisionBoxArray.length;let Dn=-1;const Qh=(tr,nn)=>tr&&tr.circleDiameter?Math.max(tr.circleDiameter,nn):nn;Dn=Qh(Mn,Dn),Dn=Qh(xn,Dn),Dn=Qh(Cs,Dn),Dn=Qh(rn,Dn);const b_=Dn>-1?1:0;b_&&(Dn*=vn/Si),Qe.glyphOffsetArray.length>=ul.MAX_GLYPHS&&si("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Tt.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,Tt.sortKey);const nb=p_(vi,Tt,Ei),[sb,ob]=function(tr,nn){const ca=tr.length,Ln=nn==null?void 0:nn.values;if((Ln==null?void 0:Ln.length)>0)for(let ha=0;ha<Ln.length;ha+=2){const es=Ln[ha+1];tr.emplaceBack(w.ap[Ln[ha]],es[0],es[1])}return[ca,tr.length]}(Qe.textAnchorOffsets,nb);Qe.symbolInstances.emplaceBack(wt.x,wt.y,Es.right>=0?Es.right:-1,Es.center>=0?Es.center:-1,Es.left>=0?Es.left:-1,Es.vertical||-1,kf,Ef,x_,Xw,Yw,Jw,Qw,eb,tb,ib,rb,Gi,Yu,v_,Ar,ks,b_,0,Ii,Dn,sb,ob)}(r,rt,Pe,n,a,h,We,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,H,[ae,ae,ae,ae],je,S,ce,xe,Ye,R,e,g,C,E,y)};if(Ve==="line")for(const Pe of n_(e.geometry,0,0,bt,bt)){const rt=Uw(Pe,ee,be,n.vertical||B,a,24,Y,r.overscaling,bt);for(const Qe of rt)B&&Ww(r,B.text,Oe,Qe)||Be(Pe,Qe)}else if(Ve==="line-center"){for(const Pe of e.geometry)if(Pe.length>1){const rt=jw(Pe,be,n.vertical||B,a,24,Y);rt&&Be(Pe,rt)}}else if(e.type==="Polygon")for(const Pe of Xp(e.geometry,0)){const rt=qw(Pe,16);Be(Pe[0],new go(rt.x,rt.y,0))}else if(e.type==="LineString")for(const Pe of e.geometry)Be(Pe,new go(Pe[0].x,Pe[0].y,0));else if(e.type==="Point")for(const Pe of e.geometry)for(const rt of Pe)Be([rt],new go(rt.x,rt.y,0))}function f_(r,e,n,a,h,g,y,v,S,C,E,P,D,R,B){const j=function(ce,ee,ae,xe,be,je,Ye,Ve){const Oe=xe.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,De=[];for(const We of ee.positionedLines)for(const Be of We.positionedGlyphs){if(!Be.rect)continue;const Pe=Be.rect||{};let rt=Ay+1,Qe=!0,wt=1,Kt=0;const Yt=(be||Ve)&&Be.vertical,Ti=Be.metrics.advance*Be.scale/2;if(Ve&&ee.verticalizable&&(Kt=We.lineOffset/2-(Be.imageName?-(Si-Be.metrics.width*Be.scale)/2:(Be.scale-1)*Si)),Be.imageName){const ki=Ye[Be.imageName];Qe=ki.sdf,wt=ki.pixelRatio,rt=Er/wt}const jr=be?[Be.x+Ti,Be.y]:[0,0];let dr=be?[0,0]:[Be.x+Ti+ae[0],Be.y+ae[1]-Kt],vi=[0,0];Yt&&(vi=dr,dr=[0,0]);const Oi=Be.metrics.isDoubleResolution?2:1,Gi=(Be.metrics.left-rt)*Be.scale-Ti+dr[0],pr=(-Be.metrics.top-rt)*Be.scale+dr[1],fr=Gi+Pe.w/Oi*Be.scale/wt,Ii=pr+Pe.h/Oi*Be.scale/wt,Ci=new X(Gi,pr),Ji=new X(fr,pr),mr=new X(Gi,Ii),Qi=new X(fr,Ii);if(Yt){const ki=new X(-Ti,Ti-qu),Tt=-Math.PI/2,er=Si/2-Ti,Hi=new X(5-qu-er,-(Be.imageName?er:0)),Ei=new X(...vi);Ci._rotateAround(Tt,ki)._add(Hi)._add(Ei),Ji._rotateAround(Tt,ki)._add(Hi)._add(Ei),mr._rotateAround(Tt,ki)._add(Hi)._add(Ei),Qi._rotateAround(Tt,ki)._add(Hi)._add(Ei)}if(Oe){const ki=Math.sin(Oe),Tt=Math.cos(Oe),er=[Tt,-ki,ki,Tt];Ci._matMult(er),Ji._matMult(er),mr._matMult(er),Qi._matMult(er)}const Pr=new X(0,0),zr=new X(0,0);De.push({tl:Ci,tr:Ji,bl:mr,br:Qi,tex:Pe,writingMode:ee.writingMode,glyphOffset:jr,sectionIndex:Be.sectionIndex,isSDF:Qe,pixelOffsetTL:Pr,pixelOffsetBR:zr,minFontScaleX:0,minFontScaleY:0})}return De}(0,n,v,h,g,y,a,r.allowVerticalPlacement),H=r.textSizeData;let Y=null;H.kind==="source"?(Y=[Qn*h.layout.get("text-size").evaluate(y,{})],Y[0]>fo&&si(`${r.layerIds[0]}: Value for "text-size" is >= ${Hu}. Reduce your "text-size".`)):H.kind==="composite"&&(Y=[Qn*R.compositeTextSizes[0].evaluate(y,{},B),Qn*R.compositeTextSizes[1].evaluate(y,{},B)],(Y[0]>fo||Y[1]>fo)&&si(`${r.layerIds[0]}: Value for "text-size" is >= ${Hu}. Reduce your "text-size".`)),r.addSymbols(r.text,j,Y,v,g,y,C,e,S.lineStartIndex,S.lineLength,D,B);for(const ce of E)P[ce]=r.text.placedSymbolArray.length-1;return 4*j.length}function m_(r){for(const e in r)return r[e];return null}function Ww(r,e,n,a){const h=r.compareText;if(e in h){const g=h[e];for(let y=g.length-1;y>=0;y--)if(a.dist(g[y])<n)return!0}else h[e]=[];return h[e].push(a),!1}const g_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,a]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const g=g_[15&a];if(!g)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new xf(v,y,g,e)}constructor(e,n=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const g=g_.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-v%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=n,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return wf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:v}=this,S=[0,g.length-1,0],C=[];for(;S.length;){const E=S.pop()||0,P=S.pop()||0,D=S.pop()||0;if(P-D<=v){for(let H=D;H<=P;H++){const Y=y[2*H],ce=y[2*H+1];Y>=e&&Y<=a&&ce>=n&&ce<=h&&C.push(g[H])}continue}const R=D+P>>1,B=y[2*R],j=y[2*R+1];B>=e&&B<=a&&j>=n&&j<=h&&C.push(g[R]),(E===0?e<=B:n<=j)&&(S.push(D),S.push(R-1),S.push(1-E)),(E===0?a>=B:h>=j)&&(S.push(R+1),S.push(P),S.push(1-E))}return C}within(e,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:y}=this,v=[0,h.length-1,0],S=[],C=a*a;for(;v.length;){const E=v.pop()||0,P=v.pop()||0,D=v.pop()||0;if(P-D<=y){for(let H=D;H<=P;H++)__(g[2*H],g[2*H+1],e,n)<=C&&S.push(h[H]);continue}const R=D+P>>1,B=g[2*R],j=g[2*R+1];__(B,j,e,n)<=C&&S.push(h[R]),(E===0?e-a<=B:n-a<=j)&&(v.push(D),v.push(R-1),v.push(1-E)),(E===0?e+a>=B:n+a>=j)&&(v.push(R+1),v.push(P),v.push(1-E))}return S}}function wf(r,e,n,a,h,g){if(h-a<=n)return;const y=a+h>>1;y_(r,e,y,a,h,g),wf(r,e,n,a,y-1,1-g),wf(r,e,n,y+1,h,1-g)}function y_(r,e,n,a,h,g){for(;h>a;){if(h-a>600){const C=h-a+1,E=n-a+1,P=Math.log(C),D=.5*Math.exp(2*P/3),R=.5*Math.sqrt(P*D*(C-D)/C)*(E-C/2<0?-1:1);y_(r,e,n,Math.max(a,Math.floor(n-E*D/C+R)),Math.min(h,Math.floor(n+(C-E)*D/C+R)),g)}const y=e[2*n+g];let v=a,S=h;for(Ku(r,e,a,n),e[2*h+g]>y&&Ku(r,e,a,h);v<S;){for(Ku(r,e,v,S),v++,S--;e[2*v+g]<y;)v++;for(;e[2*S+g]>y;)S--}e[2*a+g]===y?Ku(r,e,a,S):(S++,Ku(r,e,S,h)),S<=n&&(a=S+1),n<=S&&(h=S-1)}}function Ku(r,e,n,a){bf(r,n,a),bf(e,2*n,2*a),bf(e,2*n+1,2*a+1)}function bf(r,e,n){const a=r[e];r[e]=r[n],r[n]=a}function __(r,e,n,a){const h=r-n,g=e-a;return h*h+g*g}var Sf;w.bd=void 0,(Sf=w.bd||(w.bd={})).create="create",Sf.load="load",Sf.fullLoad="fullLoad";let Jh=null,Xu=[];const Tf=1e3/60,If="loadTime",Cf="fullLoadTime",Kw={mark(r){performance.mark(r)},frame(r){const e=r;Jh!=null&&Xu.push(e-Jh),Jh=e},clearMetrics(){Jh=null,Xu=[],performance.clearMeasures(If),performance.clearMeasures(Cf);for(const r in w.bd)performance.clearMarks(w.bd[r])},getPerformanceMetrics(){performance.measure(If,w.bd.create,w.bd.load),performance.measure(Cf,w.bd.create,w.bd.fullLoad);const r=performance.getEntriesByName(If)[0].duration,e=performance.getEntriesByName(Cf)[0].duration,n=Xu.length,a=1/(Xu.reduce((g,y)=>g+y,0)/n/1e3),h=Xu.filter(g=>g>Tf).reduce((g,y)=>g+(y-Tf)/Tf,0);return{loadTime:r,fullLoadTime:e,fps:a,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};w.$=Ie,w.A=rl,w.B=function(r){if(hn==null){const e=r.navigator?r.navigator.userAgent:null;hn=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return hn},w.C=class{constructor(r,e){this.target=r,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Nw(()=>this.process()),this.subscription=function(n,a,h,g){return n.addEventListener(a,h,!1),{unsubscribe:()=>{n.removeEventListener(a,h,!1)}}}(this.target,"message",n=>this.receive(n)),this.globalScope=xr(self)?r:window}registerMessageHandler(r,e){this.messageHandlers[r]=e}sendAsync(r,e){return new Promise((n,a)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:n,reject:a},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[h];const v={id:h,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(v)},{once:!0});const g=[],y=Object.assign(Object.assign({},r),{id:h,sourceMapId:this.mapId,origin:location.origin,data:gs(r.data,g)});this.target.postMessage(y,{transfer:g})})}receive(r){const e=r.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const a=this.abortControllers[n];return delete this.abortControllers[n],void(a&&a.abort())}if(xr(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){return d(this,void 0,void 0,function*(){if(e.type==="<response>"){const h=this.resolveRejects[r];return delete this.resolveRejects[r],h?void(e.error?h.reject(oo(e.error)):h.resolve(oo(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=oo(e.data),a=new AbortController;this.abortControllers[r]=a;try{const h=yield this.messageHandlers[e.type](e.sourceMapId,n,a);this.completeTask(r,null,h)}catch(h){this.completeTask(r,h)}})}completeTask(r,e,n){const a=[];delete this.abortControllers[r];const h={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?gs(e):null,data:gs(n,a)};this.target.postMessage(h,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},w.D=et,w.E=os,w.F=function(){var r=new rl(16);return rl!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},w.G=ji,w.H=function(r,e,n){var a,h,g,y,v,S,C,E,P,D,R,B,j=n[0],H=n[1],Y=n[2];return e===r?(r[12]=e[0]*j+e[4]*H+e[8]*Y+e[12],r[13]=e[1]*j+e[5]*H+e[9]*Y+e[13],r[14]=e[2]*j+e[6]*H+e[10]*Y+e[14],r[15]=e[3]*j+e[7]*H+e[11]*Y+e[15]):(h=e[1],g=e[2],y=e[3],v=e[4],S=e[5],C=e[6],E=e[7],P=e[8],D=e[9],R=e[10],B=e[11],r[0]=a=e[0],r[1]=h,r[2]=g,r[3]=y,r[4]=v,r[5]=S,r[6]=C,r[7]=E,r[8]=P,r[9]=D,r[10]=R,r[11]=B,r[12]=a*j+v*H+P*Y+e[12],r[13]=h*j+S*H+D*Y+e[13],r[14]=g*j+C*H+R*Y+e[14],r[15]=y*j+E*H+B*Y+e[15]),r},w.I=af,w.J=function(r,e,n){var a=n[0],h=n[1],g=n[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*h,r[5]=e[5]*h,r[6]=e[6]*h,r[7]=e[7]*h,r[8]=e[8]*g,r[9]=e[9]*g,r[10]=e[10]*g,r[11]=e[11]*g,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},w.K=Jg,w.L=function(r,e){const n={};for(let a=0;a<e.length;a++){const h=e[a];h in r&&(n[h]=r[h])}return n},w.M=mo,w.N=Hy,w.O=Wy,w.P=X,w.Q=tn,w.R=en,w.S=se,w.T=vu,w.U=Q,w.V=dt,w.W=bt,w.X=di,w.Y=Hh,w.Z=class extends Yn{},w._=d,w.a=Hr,w.a$=function(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r[3]=e[3]*n[3],r},w.a0=yf,w.a1=Le,w.a2=r=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(n=>{e.onloadstart=()=>{n(e)};for(const a of r){const h=window.document.createElement("source");ka(a)||(e.crossOrigin="Anonymous"),h.src=a,e.appendChild(h)}})},w.a3=function(){return tt++},w.a4=Ph,w.a5=ul,w.a6=$a,w.a7=Ss,w.a8=Ht,w.a9=e_,w.aA=Ot,w.aB=function(r,e){if(!r)return[{command:"setStyle",args:[e]}];let n=[];try{if(!It(r.version,e.version))return[{command:"setStyle",args:[e]}];It(r.center,e.center)||n.push({command:"setCenter",args:[e.center]}),It(r.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),It(r.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),It(r.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),It(r.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),It(r.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),It(r.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),It(r.light,e.light)||n.push({command:"setLight",args:[e.light]}),It(r.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),It(r.sky,e.sky)||n.push({command:"setSky",args:[e.sky]});const a={},h=[];(function(y,v,S,C){let E;for(E in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,E)&&(Object.prototype.hasOwnProperty.call(v,E)||js(E,S,C));for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&(Object.prototype.hasOwnProperty.call(y,E)?It(y[E],v[E])||(y[E].type==="geojson"&&v[E].type==="geojson"&&$s(y,v,E)?Fi(S,{command:"setGeoJSONSourceData",args:[E,v[E].data]}):Us(E,v,S,C)):dn(E,v,S))})(r.sources,e.sources,h,a);const g=[];r.layers&&r.layers.forEach(y=>{"source"in y&&a[y.source]?n.push({command:"removeLayer",args:[y.id]}):g.push(y)}),n=n.concat(h),function(y,v,S){v=v||[];const C=(y=y||[]).map(Zs),E=v.map(Zs),P=y.reduce(Uo,{}),D=v.reduce(Uo,{}),R=C.slice(),B=Object.create(null);let j,H,Y,ce,ee;for(let ae=0,xe=0;ae<C.length;ae++)j=C[ae],Object.prototype.hasOwnProperty.call(D,j)?xe++:(Fi(S,{command:"removeLayer",args:[j]}),R.splice(R.indexOf(j,xe),1));for(let ae=0,xe=0;ae<E.length;ae++)j=E[E.length-1-ae],R[R.length-1-ae]!==j&&(Object.prototype.hasOwnProperty.call(P,j)?(Fi(S,{command:"removeLayer",args:[j]}),R.splice(R.lastIndexOf(j,R.length-xe),1)):xe++,ce=R[R.length-ae],Fi(S,{command:"addLayer",args:[D[j],ce]}),R.splice(R.length-ae,0,j),B[j]=!0);for(let ae=0;ae<E.length;ae++)if(j=E[ae],H=P[j],Y=D[j],!B[j]&&!It(H,Y))if(It(H.source,Y.source)&&It(H["source-layer"],Y["source-layer"])&&It(H.type,Y.type)){for(ee in ls(H.layout,Y.layout,S,j,null,"setLayoutProperty"),ls(H.paint,Y.paint,S,j,null,"setPaintProperty"),It(H.filter,Y.filter)||Fi(S,{command:"setFilter",args:[j,Y.filter]}),It(H.minzoom,Y.minzoom)&&It(H.maxzoom,Y.maxzoom)||Fi(S,{command:"setLayerZoomRange",args:[j,Y.minzoom,Y.maxzoom]}),H)Object.prototype.hasOwnProperty.call(H,ee)&&ee!=="layout"&&ee!=="paint"&&ee!=="filter"&&ee!=="metadata"&&ee!=="minzoom"&&ee!=="maxzoom"&&(ee.indexOf("paint.")===0?ls(H[ee],Y[ee],S,j,ee.slice(6),"setPaintProperty"):It(H[ee],Y[ee])||Fi(S,{command:"setLayerProperty",args:[j,ee,Y[ee]]}));for(ee in Y)Object.prototype.hasOwnProperty.call(Y,ee)&&!Object.prototype.hasOwnProperty.call(H,ee)&&ee!=="layout"&&ee!=="paint"&&ee!=="filter"&&ee!=="metadata"&&ee!=="minzoom"&&ee!=="maxzoom"&&(ee.indexOf("paint.")===0?ls(H[ee],Y[ee],S,j,ee.slice(6),"setPaintProperty"):It(H[ee],Y[ee])||Fi(S,{command:"setLayerProperty",args:[j,ee,Y[ee]]}))}else Fi(S,{command:"removeLayer",args:[j]}),ce=R[R.lastIndexOf(j)+1],Fi(S,{command:"addLayer",args:[Y,ce]})}(g,e.layers,n)}catch(a){console.warn("Unable to compute style diff:",a),n=[{command:"setStyle",args:[e]}]}return n},w.aC=function(r){const e=[],n=r.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},w.aD=function r(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let a=0;a<e.length;a++)if(!r(e[a],n[a]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(!r(e[a],n[a]))return!1;return!0}return e===n},w.aE=Dt,w.aF=xt,w.aG=class extends Zt{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},w.aH=Zi,w.aI=class extends Zt{constructor(r,e){super(r,e),this.current=xs}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},w.aJ=Jr,w.aK=class extends Zt{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},w.aL=class extends Zt{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},w.aM=yn,w.aN=function(r,e,n,a,h,g,y){var v=1/(e-n),S=1/(a-h),C=1/(g-y);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*C,r[11]=0,r[12]=(e+n)*v,r[13]=(h+a)*S,r[14]=(y+g)*C,r[15]=1,r},w.aO=Ft,w.aP=v1,w.aQ=class extends oa{},w.aR=pw,w.aS=class extends lo{},w.aT=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},w.aU=ry,w.aV=z,w.aW=class extends Pu{},w.aX=me,w.aY=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]},w.aZ=function(r,e){var n=r[0],a=r[1],h=r[2],g=r[3],y=r[4],v=r[5],S=r[6],C=r[7],E=r[8],P=r[9],D=r[10],R=r[11],B=r[12],j=r[13],H=r[14],Y=r[15],ce=e[0],ee=e[1],ae=e[2],xe=e[3],be=e[4],je=e[5],Ye=e[6],Ve=e[7],Oe=e[8],De=e[9],We=e[10],Be=e[11],Pe=e[12],rt=e[13],Qe=e[14],wt=e[15];return Math.abs(n-ce)<=hr*Math.max(1,Math.abs(n),Math.abs(ce))&&Math.abs(a-ee)<=hr*Math.max(1,Math.abs(a),Math.abs(ee))&&Math.abs(h-ae)<=hr*Math.max(1,Math.abs(h),Math.abs(ae))&&Math.abs(g-xe)<=hr*Math.max(1,Math.abs(g),Math.abs(xe))&&Math.abs(y-be)<=hr*Math.max(1,Math.abs(y),Math.abs(be))&&Math.abs(v-je)<=hr*Math.max(1,Math.abs(v),Math.abs(je))&&Math.abs(S-Ye)<=hr*Math.max(1,Math.abs(S),Math.abs(Ye))&&Math.abs(C-Ve)<=hr*Math.max(1,Math.abs(C),Math.abs(Ve))&&Math.abs(E-Oe)<=hr*Math.max(1,Math.abs(E),Math.abs(Oe))&&Math.abs(P-De)<=hr*Math.max(1,Math.abs(P),Math.abs(De))&&Math.abs(D-We)<=hr*Math.max(1,Math.abs(D),Math.abs(We))&&Math.abs(R-Be)<=hr*Math.max(1,Math.abs(R),Math.abs(Be))&&Math.abs(B-Pe)<=hr*Math.max(1,Math.abs(B),Math.abs(Pe))&&Math.abs(j-rt)<=hr*Math.max(1,Math.abs(j),Math.abs(rt))&&Math.abs(H-Qe)<=hr*Math.max(1,Math.abs(H),Math.abs(Qe))&&Math.abs(Y-wt)<=hr*Math.max(1,Math.abs(Y),Math.abs(wt))},w.a_=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},w.aa=function(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,h,g)=>{const y=h||g;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},w.ab=function(r,e){const n=[];for(const a in r)a in e||n.push(a);return n},w.ac=Ne,w.ad=function(r,e,n){var a=Math.sin(n),h=Math.cos(n),g=e[0],y=e[1],v=e[2],S=e[3],C=e[4],E=e[5],P=e[6],D=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=g*h+C*a,r[1]=y*h+E*a,r[2]=v*h+P*a,r[3]=S*h+D*a,r[4]=C*h-g*a,r[5]=E*h-y*a,r[6]=P*h-v*a,r[7]=D*h-S*a,r},w.ae=function(r){var e=new rl(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},w.af=Fh,w.ag=function(r,e){let n=0,a=0;if(r.kind==="constant")a=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:y}=r,v=h?Ne(Yi.interpolationFactor(h,e,g,y),0,1):0;r.kind==="camera"?a=Ir.number(r.minSize,r.maxSize,v):n=v}return{uSizeT:n,uSize:a}},w.ai=function(r,{uSize:e,uSizeT:n},{lowerSize:a,upperSize:h}){return r.kind==="source"?a/Qn:r.kind==="composite"?Ir.number(a/Qn,h/Qn,n):e},w.aj=hf,w.ak=function(r,e,n,a){const h=e.y-r.y,g=e.x-r.x,y=a.y-n.y,v=a.x-n.x,S=y*g-v*h;if(S===0)return null;const C=(v*(r.y-n.y)-y*(r.x-n.x))/S;return new X(r.x+C*g,r.y+C*h)},w.al=n_,w.am=Ts,w.an=$p,w.ao=Si,w.aq=cf,w.ar=function(r,e){var n=e[0],a=e[1],h=e[2],g=e[3],y=e[4],v=e[5],S=e[6],C=e[7],E=e[8],P=e[9],D=e[10],R=e[11],B=e[12],j=e[13],H=e[14],Y=e[15],ce=n*v-a*y,ee=n*S-h*y,ae=n*C-g*y,xe=a*S-h*v,be=a*C-g*v,je=h*C-g*S,Ye=E*j-P*B,Ve=E*H-D*B,Oe=E*Y-R*B,De=P*H-D*j,We=P*Y-R*j,Be=D*Y-R*H,Pe=ce*Be-ee*We+ae*De+xe*Oe-be*Ve+je*Ye;return Pe?(r[0]=(v*Be-S*We+C*De)*(Pe=1/Pe),r[1]=(h*We-a*Be-g*De)*Pe,r[2]=(j*je-H*be+Y*xe)*Pe,r[3]=(D*be-P*je-R*xe)*Pe,r[4]=(S*Oe-y*Be-C*Ve)*Pe,r[5]=(n*Be-h*Oe+g*Ve)*Pe,r[6]=(H*ae-B*je-Y*ee)*Pe,r[7]=(E*je-D*ae+R*ee)*Pe,r[8]=(y*We-v*Oe+C*Ye)*Pe,r[9]=(a*Oe-n*We-g*Ye)*Pe,r[10]=(B*be-j*ae+Y*ce)*Pe,r[11]=(P*ae-E*be-R*ce)*Pe,r[12]=(v*Ve-y*De-S*Ye)*Pe,r[13]=(n*De-a*Ve+h*Ye)*Pe,r[14]=(j*ee-B*xe-H*ce)*Pe,r[15]=(E*xe-P*ee+D*ce)*Pe,r):null},w.as=vf,w.at=uf,w.au=xf,w.av=function(){const r={},e=ye.$version;for(const n in ye.$root){const a=ye.$root[n];if(a.required){let h=null;h=n==="version"?e:a.type==="array"?[]:{},h!=null&&(r[n]=h)}}return r},w.aw=mu,w.ax=Vs,w.ay=function(r){r=r.slice();const e=Object.create(null);for(let n=0;n<r.length;n++)e[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=jo(r[n],e[r[n].ref]));return r},w.az=function(r){if(r.type==="custom")return new Ow(r);switch(r.type){case"background":return new Rw(r);case"circle":return new x1(r);case"fill":return new V1(r);case"fill-extrusion":return new tw(r);case"heatmap":return new b1(r);case"hillshade":return new T1(r);case"line":return new uw(r);case"raster":return new Bw(r);case"symbol":return new Gh(r)}},w.b=Ge,w.b0=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},w.b1=Xe,w.b2=Yy,w.b3=Ky,w.b4=function(r,e,n,a,h){var g,y=1/Math.tan(e/2);return r[0]=y/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+a)*(g=1/(a-h)),r[14]=2*h*a*g):(r[10]=-1,r[14]=-2*a),r},w.b5=function(r,e,n){var a=Math.sin(n),h=Math.cos(n),g=e[4],y=e[5],v=e[6],S=e[7],C=e[8],E=e[9],P=e[10],D=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=g*h+C*a,r[5]=y*h+E*a,r[6]=v*h+P*a,r[7]=S*h+D*a,r[8]=C*h-g*a,r[9]=E*h-y*a,r[10]=P*h-v*a,r[11]=D*h-S*a,r},w.b6=oe,w.b7=ve,w.b8=function(r){return r*Math.PI/180},w.b9=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},w.bA=ys,w.ba=class extends Xa{},w.bb=mf,w.bc=Kw,w.be=Wr,w.bf=function(r,e){Hr.REGISTERED_PROTOCOLS[r]=e},w.bg=function(r){delete Hr.REGISTERED_PROTOCOLS[r]},w.bh=function(r,e){const n={};for(let h=0;h<r.length;h++){const g=e&&e[r[h].id]||Vp(r[h]);e&&(e[r[h].id]=g);let y=n[g];y||(y=n[g]=[]),y.push(r[h])}const a=[];for(const h in n)a.push(n[h]);return a},w.bi=qe,w.bj=Qy,w.bk=t_,w.bl=Dy,w.bm=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=bt/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0],n=e.layout,a=e._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new Ht(r.bucket.zoom+1),r.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new Ht(r.bucket.zoom+1),r.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new Ht(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:E}=r.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Ht(C),r.canonical),a["text-size"].possiblyEvaluate(new Ht(E),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:E}=r.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Ht(C),r.canonical),a["icon-size"].possiblyEvaluate(new Ht(E),r.canonical)]}const g=n.get("text-line-height")*Si,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",v=n.get("text-keep-upright"),S=n.get("text-size");for(const C of r.bucket.features){const E=n.get("text-font").evaluate(C,{},r.canonical).join(","),P=S.evaluate(C,{},r.canonical),D=h.layoutTextSize.evaluate(C,{},r.canonical),R=h.layoutIconSize.evaluate(C,{},r.canonical),B={horizontal:{},vertical:void 0},j=C.text;let H,Y=[0,0];if(j){const ae=j.toString(),xe=n.get("text-letter-spacing").evaluate(C,{},r.canonical)*Si,be=Ga(ae)?xe:0,je=n.get("text-anchor").evaluate(C,{},r.canonical),Ye=p_(e,C,r.canonical);if(!Ye){const Be=n.get("text-radial-offset").evaluate(C,{},r.canonical);Y=Be?d_(je,[Be*Si,_f]):n.get("text-offset").evaluate(C,{},r.canonical).map(Pe=>Pe*Si)}let Ve=y?"center":n.get("text-justify").evaluate(C,{},r.canonical);const Oe=n.get("symbol-placement"),De=Oe==="point"?n.get("text-max-width").evaluate(C,{},r.canonical)*Si:0,We=()=>{r.bucket.allowVerticalPlacement&&ta(ae)&&(B.vertical=$h(j,r.glyphMap,r.glyphPositions,r.imagePositions,E,De,g,je,"left",be,Y,w.ah.vertical,!0,Oe,D,P))};if(!y&&Ye){const Be=new Set;if(Ve==="auto")for(let rt=0;rt<Ye.values.length;rt+=2)Be.add(vf(Ye.values[rt]));else Be.add(Ve);let Pe=!1;for(const rt of Be)if(!B.horizontal[rt])if(Pe)B.horizontal[rt]=B.horizontal[0];else{const Qe=$h(j,r.glyphMap,r.glyphPositions,r.imagePositions,E,De,g,"center",rt,be,Y,w.ah.horizontal,!1,Oe,D,P);Qe&&(B.horizontal[rt]=Qe,Pe=Qe.positionedLines.length===1)}We()}else{Ve==="auto"&&(Ve=vf(je));const Be=$h(j,r.glyphMap,r.glyphPositions,r.imagePositions,E,De,g,je,Ve,be,Y,w.ah.horizontal,!1,Oe,D,P);Be&&(B.horizontal[Ve]=Be),We(),ta(ae)&&y&&v&&(B.vertical=$h(j,r.glyphMap,r.glyphPositions,r.imagePositions,E,De,g,je,Ve,be,Y,w.ah.vertical,!1,Oe,D,P))}}let ce=!1;if(C.icon&&C.icon.name){const ae=r.imageMap[C.icon.name];ae&&(H=zw(r.imagePositions[C.icon.name],n.get("icon-offset").evaluate(C,{},r.canonical),n.get("icon-anchor").evaluate(C,{},r.canonical)),ce=!!ae.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ce:r.bucket.sdfIcons!==ce&&si("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ae.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ee=m_(B.horizontal)||B.vertical;r.bucket.iconsInText=!!ee&&ee.iconsInText,(ee||H)&&Hw(r.bucket,C,B,H,r.imageMap,h,D,R,Y,ce,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},w.bn=rf,w.bo=Qp,w.bp=tf,w.bq=ho,w.br=sf,w.bs=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},w.bt=function(r,e,n,a,h){return d(this,void 0,void 0,function*(){if(Q())try{return yield dt(r,e,n,a,h)}catch{}return function(g,y,v,S,C){const E=g.width,P=g.height;Et&&Mt||(Et=new OffscreenCanvas(E,P),Mt=Et.getContext("2d",{willReadFrequently:!0})),Et.width=E,Et.height=P,Mt.drawImage(g,0,0,E,P);const D=Mt.getImageData(y,v,S,C);return Mt.clearRect(0,0,E,P),D.data}(r,e,n,a,h)})},w.bu=Jy,w.bv=N,w.bw=J,w.bx=Ty,w.by=jt,w.bz=function(r){return r.message===Fr},w.c=zi,w.d=r=>d(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),w.e=Ke,w.f=r=>new Promise((e,n)=>{const a=new Image;a.onload=()=>{e(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=ht})},a.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(r)],{type:"image/png"});a.src=r.byteLength?URL.createObjectURL(h):ht}),w.g=Ri,w.h=(r,e)=>$n(Ke(r,{type:"json"}),e),w.i=xr,w.j=bi,w.k=Gn,w.l=(r,e)=>$n(Ke(r,{type:"arrayBuffer"}),e),w.m=$n,w.n=function(r){return new sf(r).readFields(Tw,[])},w.o=Bu,w.p=My,w.q=ur,w.r=du,w.s=ka,w.t=bh,w.u=$e,w.v=ye,w.w=si,w.x=so,w.y=function([r,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(n),y:r*Math.sin(e)*Math.sin(n),z:r*Math.cos(n)}},w.z=Ir}),_("worker",["./shared"],function(w){class d{constructor(M){this.keyCache={},M&&this.replace(M)}replace(M){this._layerConfigs={},this._layers={},this.update(M,[])}update(M,L){for(const $ of M){this._layerConfigs[$.id]=$;const re=this._layers[$.id]=w.az($);re._featureFilter=w.a6(re.filter),this.keyCache[$.id]&&delete this.keyCache[$.id]}for(const $ of L)delete this.keyCache[$],delete this._layerConfigs[$],delete this._layers[$];this.familiesBySource={};const O=w.bh(Object.values(this._layerConfigs),this.keyCache);for(const $ of O){const re=$.map(_e=>this._layers[_e.id]),ne=re[0];if(ne.visibility==="none")continue;const ue=ne.source||"";let te=this.familiesBySource[ue];te||(te=this.familiesBySource[ue]={});const de=ne.sourceLayer||"_geojsonTileLayer";let Te=te[de];Te||(Te=te[de]=[]),Te.push(re)}}}class N{constructor(M){const L={},O=[];for(const ue in M){const te=M[ue],de=L[ue]={};for(const Te in te){const _e=te[+Te];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;const we={x:0,y:0,w:_e.bitmap.width+2,h:_e.bitmap.height+2};O.push(we),de[Te]={rect:we,metrics:_e.metrics}}}const{w:$,h:re}=w.p(O),ne=new w.o({width:$||1,height:re||1});for(const ue in M){const te=M[ue];for(const de in te){const Te=te[+de];if(!Te||Te.bitmap.width===0||Te.bitmap.height===0)continue;const _e=L[ue][de].rect;w.o.copy(Te.bitmap,ne,{x:0,y:0},{x:_e.x+1,y:_e.y+1},Te.bitmap)}}this.image=ne,this.positions=L}}w.bi("GlyphAtlas",N);class J{constructor(M){this.tileID=new w.Q(M.tileID.overscaledZ,M.tileID.wrap,M.tileID.canonical.z,M.tileID.canonical.x,M.tileID.canonical.y),this.uid=M.uid,this.zoom=M.zoom,this.pixelRatio=M.pixelRatio,this.tileSize=M.tileSize,this.source=M.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=M.showCollisionBoxes,this.collectResourceTiming=!!M.collectResourceTiming,this.returnDependencies=!!M.returnDependencies,this.promoteId=M.promoteId,this.inFlightDependencies=[]}parse(M,L,O,$){return w._(this,void 0,void 0,function*(){this.status="parsing",this.data=M,this.collisionBoxArray=new w.a4;const re=new w.bj(Object.keys(M.layers).sort()),ne=new w.bk(this.tileID,this.promoteId);ne.bucketLayerIDs=[];const ue={},te={featureIndex:ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:O},de=L.familiesBySource[this.source];for(const mt in de){const ei=M.layers[mt];if(!ei)continue;ei.version===1&&w.w(`Vector tile source "${this.source}" layer "${mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ai=re.encode(mt),ar=[];for(let Ui=0;Ui<ei.length;Ui++){const Xi=ei.feature(Ui),br=ne.getId(Xi,mt);ar.push({feature:Xi,id:br,index:Ui,sourceLayerIndex:Ai})}for(const Ui of de[mt]){const Xi=Ui[0];Xi.source!==this.source&&w.w(`layer.source = ${Xi.source} does not equal this.source = ${this.source}`),Xi.minzoom&&this.zoom<Math.floor(Xi.minzoom)||Xi.maxzoom&&this.zoom>=Xi.maxzoom||Xi.visibility!=="none"&&(he(Ui,this.zoom,O),(ue[Xi.id]=Xi.createBucket({index:ne.bucketLayerIDs.length,layers:Ui,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ai,sourceID:this.source})).populate(ar,te,this.tileID.canonical),ne.bucketLayerIDs.push(Ui.map(br=>br.id)))}}const Te=w.aE(te.glyphDependencies,mt=>Object.keys(mt).map(Number));this.inFlightDependencies.forEach(mt=>mt==null?void 0:mt.abort()),this.inFlightDependencies=[];let _e=Promise.resolve({});if(Object.keys(Te).length){const mt=new AbortController;this.inFlightDependencies.push(mt),_e=$.sendAsync({type:"getGlyphs",data:{stacks:Te,source:this.source,tileID:this.tileID,type:"glyphs"}},mt)}const we=Object.keys(te.iconDependencies);let Je=Promise.resolve({});if(we.length){const mt=new AbortController;this.inFlightDependencies.push(mt),Je=$.sendAsync({type:"getImages",data:{icons:we,source:this.source,tileID:this.tileID,type:"icons"}},mt)}const at=Object.keys(te.patternDependencies);let st=Promise.resolve({});if(at.length){const mt=new AbortController;this.inFlightDependencies.push(mt),st=$.sendAsync({type:"getImages",data:{icons:at,source:this.source,tileID:this.tileID,type:"patterns"}},mt)}const[Ct,ut,Gt]=yield Promise.all([_e,Je,st]),Vt=new N(Ct),ci=new w.bl(ut,Gt);for(const mt in ue){const ei=ue[mt];ei instanceof w.a5?(he(ei.layers,this.zoom,O),w.bm({bucket:ei,glyphMap:Ct,glyphPositions:Vt.positions,imageMap:ut,imagePositions:ci.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ei.hasPattern&&(ei instanceof w.bn||ei instanceof w.bo||ei instanceof w.bp)&&(he(ei.layers,this.zoom,O),ei.addFeatures(te,this.tileID.canonical,ci.patternPositions))}return this.status="done",{buckets:Object.values(ue).filter(mt=>!mt.isEmpty()),featureIndex:ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vt.image,imageAtlas:ci,glyphMap:this.returnDependencies?Ct:null,iconMap:this.returnDependencies?ut:null,glyphPositions:this.returnDependencies?Vt.positions:null}})}}function he(q,M,L){const O=new w.a8(M);for(const $ of q)$.recalculate(O,L)}class X{constructor(M,L,O){this.actor=M,this.layerIndex=L,this.availableImages=O,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(M,L){return w._(this,void 0,void 0,function*(){const O=yield w.l(M.request,L);try{return{vectorTile:new w.bq.VectorTile(new w.br(O.data)),rawData:O.data,cacheControl:O.cacheControl,expires:O.expires}}catch($){const re=new Uint8Array(O.data);let ne=`Unable to parse the tile at ${M.request.url}, `;throw ne+=re[0]===31&&re[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${$.messge}`,new Error(ne)}})}loadTile(M){return w._(this,void 0,void 0,function*(){const L=M.uid,O=!!(M&&M.request&&M.request.collectResourceTiming)&&new w.bs(M.request),$=new J(M);this.loading[L]=$;const re=new AbortController;$.abort=re;try{const ne=yield this.loadVectorTile(M,re);if(delete this.loading[L],!ne)return null;const ue=ne.rawData,te={};ne.expires&&(te.expires=ne.expires),ne.cacheControl&&(te.cacheControl=ne.cacheControl);const de={};if(O){const _e=O.finish();_e&&(de.resourceTiming=JSON.parse(JSON.stringify(_e)))}$.vectorTile=ne.vectorTile;const Te=$.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[L]=$,this.fetching[L]={rawTileData:ue,cacheControl:te,resourceTiming:de};try{const _e=yield Te;return w.e({rawTileData:ue.slice(0)},_e,te,de)}finally{delete this.fetching[L]}}catch(ne){throw delete this.loading[L],$.status="done",this.loaded[L]=$,ne}})}reloadTile(M){return w._(this,void 0,void 0,function*(){const L=M.uid;if(!this.loaded||!this.loaded[L])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const O=this.loaded[L];if(O.showCollisionBoxes=M.showCollisionBoxes,O.status==="parsing"){const $=yield O.parse(O.vectorTile,this.layerIndex,this.availableImages,this.actor);let re;if(this.fetching[L]){const{rawTileData:ne,cacheControl:ue,resourceTiming:te}=this.fetching[L];delete this.fetching[L],re=w.e({rawTileData:ne.slice(0)},$,ue,te)}else re=$;return re}if(O.status==="done"&&O.vectorTile)return O.parse(O.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(M){return w._(this,void 0,void 0,function*(){const L=this.loading,O=M.uid;L&&L[O]&&L[O].abort&&(L[O].abort.abort(),delete L[O])})}removeTile(M){return w._(this,void 0,void 0,function*(){this.loaded&&this.loaded[M.uid]&&delete this.loaded[M.uid]})}}class U{constructor(){this.loaded={}}loadTile(M){return w._(this,void 0,void 0,function*(){const{uid:L,encoding:O,rawImageData:$,redFactor:re,greenFactor:ne,blueFactor:ue,baseShift:te}=M,de=$.width+2,Te=$.height+2,_e=w.b($)?new w.R({width:de,height:Te},yield w.bt($,-1,-1,de,Te)):$,we=new w.bu(L,_e,O,re,ne,ue,te);return this.loaded=this.loaded||{},this.loaded[L]=we,we})}removeTile(M){const L=this.loaded,O=M.uid;L&&L[O]&&delete L[O]}}function ze(q,M){if(q.length!==0){ke(q[0],M);for(var L=1;L<q.length;L++)ke(q[L],!M)}}function ke(q,M){for(var L=0,O=0,$=0,re=q.length,ne=re-1;$<re;ne=$++){var ue=(q[$][0]-q[ne][0])*(q[ne][1]+q[$][1]),te=L+ue;O+=Math.abs(L)>=Math.abs(ue)?L-te+ue:ue-te+L,L=te}L+O>=0!=!!M&&q.reverse()}var Ee=w.bv(function q(M,L){var O,$=M&&M.type;if($==="FeatureCollection")for(O=0;O<M.features.length;O++)q(M.features[O],L);else if($==="GeometryCollection")for(O=0;O<M.geometries.length;O++)q(M.geometries[O],L);else if($==="Feature")q(M.geometry,L);else if($==="Polygon")ze(M.coordinates,L);else if($==="MultiPolygon")for(O=0;O<M.coordinates.length;O++)ze(M.coordinates[O],L);return M});const Ue=w.bq.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},Q=w.bw,oe=w.bq.VectorTileFeature,ve=Ne;function Ne(q,M){this.options=M||{},this.features=q,this.length=q.length}function Xe(q,M){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=M||4096}Ne.prototype.feature=function(q){return new Xe(this.features[q],this.options.extent)},Xe.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var M=0;M<q.length;M++){for(var L=q[M],O=[],$=0;$<L.length;$++)O.push(new Q(L[$][0],L[$][1]));this.geometry.push(O)}return this.geometry},Xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,M=1/0,L=-1/0,O=1/0,$=-1/0,re=0;re<q.length;re++)for(var ne=q[re],ue=0;ue<ne.length;ue++){var te=ne[ue];M=Math.min(M,te.x),L=Math.max(L,te.x),O=Math.min(O,te.y),$=Math.max($,te.y)}return[M,O,L,$]},Xe.prototype.toGeoJSON=oe.prototype.toGeoJSON;var Ke=w.bx,tt=ve;function Dt(q){var M=new Ke;return function(L,O){for(var $ in L.layers)O.writeMessage(3,xt,L.layers[$])}(q,M),M.finish()}function xt(q,M){var L;M.writeVarintField(15,q.version||1),M.writeStringField(1,q.name||""),M.writeVarintField(5,q.extent||4096);var O={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<q.length;L++)O.feature=q.feature(L),M.writeMessage(2,Ot,O);var $=O.keys;for(L=0;L<$.length;L++)M.writeStringField(3,$[L]);var re=O.values;for(L=0;L<re.length;L++)M.writeMessage(4,xr,re[L])}function Ot(q,M){var L=q.feature;L.id!==void 0&&M.writeVarintField(1,L.id),M.writeMessage(2,Nt,q),M.writeVarintField(3,L.type),M.writeMessage(4,kn,L)}function Nt(q,M){var L=q.feature,O=q.keys,$=q.values,re=q.keycache,ne=q.valuecache;for(var ue in L.properties){var te=L.properties[ue],de=re[ue];if(te!==null){de===void 0&&(O.push(ue),re[ue]=de=O.length-1),M.writeVarint(de);var Te=typeof te;Te!=="string"&&Te!=="boolean"&&Te!=="number"&&(te=JSON.stringify(te));var _e=Te+":"+te,we=ne[_e];we===void 0&&($.push(te),ne[_e]=we=$.length-1),M.writeVarint(we)}}}function si(q,M){return(M<<3)+(7&q)}function sr(q){return q<<1^q>>31}function kn(q,M){for(var L=q.loadGeometry(),O=q.type,$=0,re=0,ne=L.length,ue=0;ue<ne;ue++){var te=L[ue],de=1;O===1&&(de=te.length),M.writeVarint(si(1,de));for(var Te=O===3?te.length-1:te.length,_e=0;_e<Te;_e++){_e===1&&O!==1&&M.writeVarint(si(2,Te-1));var we=te[_e].x-$,Je=te[_e].y-re;M.writeVarint(sr(we)),M.writeVarint(sr(Je)),$+=we,re+=Je}O===3&&M.writeVarint(si(7,1))}}function xr(q,M){var L=typeof q;L==="string"?M.writeStringField(1,q):L==="boolean"?M.writeBooleanField(7,q):L==="number"&&(q%1!=0?M.writeDoubleField(3,q):q<0?M.writeSVarintField(6,q):M.writeVarintField(5,q))}se.exports=Dt,se.exports.fromVectorTileJs=Dt,se.exports.fromGeojsonVt=function(q,M){M=M||{};var L={};for(var O in q)L[O]=new tt(q[O].features,M),L[O].name=O,L[O].version=M.version,L[O].extent=M.extent;return Dt({layers:L})},se.exports.GeoJSONWrapper=tt;var hn=w.bv(se.exports);const Ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},ht=Math.fround||(dt=new Float32Array(1),q=>(dt[0]=+q,dt[0]));var dt;const Et=3,Mt=5,Fr=6;class zi{constructor(M){this.options=Object.assign(Object.create(Ge),M),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(M){const{log:L,minZoom:O,maxZoom:$}=this.options;L&&console.time("total time");const re=`prepare ${M.length} points`;L&&console.time(re),this.points=M;const ne=[];for(let te=0;te<M.length;te++){const de=M[te];if(!de.geometry)continue;const[Te,_e]=de.geometry.coordinates,we=ht(ji(Te)),Je=ht(Wr(_e));ne.push(we,Je,1/0,te,-1,1),this.options.reduce&&ne.push(0)}let ue=this.trees[$+1]=this._createTree(ne);L&&console.timeEnd(re);for(let te=$;te>=O;te--){const de=+Date.now();ue=this.trees[te]=this._createTree(this._cluster(ue,te)),L&&console.log("z%d: %d clusters in %dms",te,ue.numItems,+Date.now()-de)}return L&&console.timeEnd("total time"),this}getClusters(M,L){let O=((M[0]+180)%360+360)%360-180;const $=Math.max(-90,Math.min(90,M[1]));let re=M[2]===180?180:((M[2]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,M[3]));if(M[2]-M[0]>=360)O=-180,re=180;else if(O>re){const _e=this.getClusters([O,$,180,ne],L),we=this.getClusters([-180,$,re,ne],L);return _e.concat(we)}const ue=this.trees[this._limitZoom(L)],te=ue.range(ji(O),Wr(ne),ji(re),Wr($)),de=ue.data,Te=[];for(const _e of te){const we=this.stride*_e;Te.push(de[we+Mt]>1?Hr(de,we,this.clusterProps):this.points[de[we+Et]])}return Te}getChildren(M){const L=this._getOriginId(M),O=this._getOriginZoom(M),$="No cluster with the specified id.",re=this.trees[O];if(!re)throw new Error($);const ne=re.data;if(L*this.stride>=ne.length)throw new Error($);const ue=this.options.radius/(this.options.extent*Math.pow(2,O-1)),te=re.within(ne[L*this.stride],ne[L*this.stride+1],ue),de=[];for(const Te of te){const _e=Te*this.stride;ne[_e+4]===M&&de.push(ne[_e+Mt]>1?Hr(ne,_e,this.clusterProps):this.points[ne[_e+Et]])}if(de.length===0)throw new Error($);return de}getLeaves(M,L,O){const $=[];return this._appendLeaves($,M,L=L||10,O=O||0,0),$}getTile(M,L,O){const $=this.trees[this._limitZoom(M)],re=Math.pow(2,M),{extent:ne,radius:ue}=this.options,te=ue/ne,de=(O-te)/re,Te=(O+1+te)/re,_e={features:[]};return this._addTileFeatures($.range((L-te)/re,de,(L+1+te)/re,Te),$.data,L,O,re,_e),L===0&&this._addTileFeatures($.range(1-te/re,de,1,Te),$.data,re,O,re,_e),L===re-1&&this._addTileFeatures($.range(0,de,te/re,Te),$.data,-1,O,re,_e),_e.features.length?_e:null}getClusterExpansionZoom(M){let L=this._getOriginZoom(M)-1;for(;L<=this.options.maxZoom;){const O=this.getChildren(M);if(L++,O.length!==1)break;M=O[0].properties.cluster_id}return L}_appendLeaves(M,L,O,$,re){const ne=this.getChildren(L);for(const ue of ne){const te=ue.properties;if(te&&te.cluster?re+te.point_count<=$?re+=te.point_count:re=this._appendLeaves(M,te.cluster_id,O,$,re):re<$?re++:M.push(ue),M.length===O)break}return re}_createTree(M){const L=new w.au(M.length/this.stride|0,this.options.nodeSize,Float32Array);for(let O=0;O<M.length;O+=this.stride)L.add(M[O],M[O+1]);return L.finish(),L.data=M,L}_addTileFeatures(M,L,O,$,re,ne){for(const ue of M){const te=ue*this.stride,de=L[te+Mt]>1;let Te,_e,we;if(de)Te=Ri(L,te,this.clusterProps),_e=L[te],we=L[te+1];else{const st=this.points[L[te+Et]];Te=st.properties;const[Ct,ut]=st.geometry.coordinates;_e=ji(Ct),we=Wr(ut)}const Je={type:1,geometry:[[Math.round(this.options.extent*(_e*re-O)),Math.round(this.options.extent*(we*re-$))]],tags:Te};let at;at=de||this.options.generateId?L[te+Et]:this.points[L[te+Et]].id,at!==void 0&&(Je.id=at),ne.features.push(Je)}}_limitZoom(M){return Math.max(this.options.minZoom,Math.min(Math.floor(+M),this.options.maxZoom+1))}_cluster(M,L){const{radius:O,extent:$,reduce:re,minPoints:ne}=this.options,ue=O/($*Math.pow(2,L)),te=M.data,de=[],Te=this.stride;for(let _e=0;_e<te.length;_e+=Te){if(te[_e+2]<=L)continue;te[_e+2]=L;const we=te[_e],Je=te[_e+1],at=M.within(te[_e],te[_e+1],ue),st=te[_e+Mt];let Ct=st;for(const ut of at){const Gt=ut*Te;te[Gt+2]>L&&(Ct+=te[Gt+Mt])}if(Ct>st&&Ct>=ne){let ut,Gt=we*st,Vt=Je*st,ci=-1;const mt=((_e/Te|0)<<5)+(L+1)+this.points.length;for(const ei of at){const Ai=ei*Te;if(te[Ai+2]<=L)continue;te[Ai+2]=L;const ar=te[Ai+Mt];Gt+=te[Ai]*ar,Vt+=te[Ai+1]*ar,te[Ai+4]=mt,re&&(ut||(ut=this._map(te,_e,!0),ci=this.clusterProps.length,this.clusterProps.push(ut)),re(ut,this._map(te,Ai)))}te[_e+4]=mt,de.push(Gt/Ct,Vt/Ct,1/0,mt,-1,Ct),re&&de.push(ci)}else{for(let ut=0;ut<Te;ut++)de.push(te[_e+ut]);if(Ct>1)for(const ut of at){const Gt=ut*Te;if(!(te[Gt+2]<=L)){te[Gt+2]=L;for(let Vt=0;Vt<Te;Vt++)de.push(te[Gt+Vt])}}}}return de}_getOriginId(M){return M-this.points.length>>5}_getOriginZoom(M){return(M-this.points.length)%32}_map(M,L,O){if(M[L+Mt]>1){const ne=this.clusterProps[M[L+Fr]];return O?Object.assign({},ne):ne}const $=this.points[M[L+Et]].properties,re=this.options.map($);return O&&re===$?Object.assign({},re):re}}function Hr(q,M,L){return{type:"Feature",id:q[M+Et],properties:Ri(q,M,L),geometry:{type:"Point",coordinates:[(O=q[M],360*(O-.5)),Vs(q[M+1])]}};var O}function Ri(q,M,L){const O=q[M+Mt],$=O>=1e4?`${Math.round(O/1e3)}k`:O>=1e3?Math.round(O/100)/10+"k":O,re=q[M+Fr],ne=re===-1?{}:Object.assign({},L[re]);return Object.assign(ne,{cluster:!0,cluster_id:q[M+Et],point_count:O,point_count_abbreviated:$})}function ji(q){return q/360+.5}function Wr(q){const M=Math.sin(q*Math.PI/180),L=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return L<0?0:L>1?1:L}function Vs(q){const M=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(M))/Math.PI-90}function $n(q,M,L,O){for(var $,re=O,ne=L-M>>1,ue=L-M,te=q[M],de=q[M+1],Te=q[L],_e=q[L+1],we=M+3;we<L;we+=3){var Je=ka(q[we],q[we+1],te,de,Te,_e);if(Je>re)$=we,re=Je;else if(Je===re){var at=Math.abs(we-ne);at<ue&&($=we,ue=at)}}re>O&&($-M>3&&$n(q,M,$,O),q[$+2]=re,L-$>3&&$n(q,$,L,O))}function ka(q,M,L,O,$,re){var ne=$-L,ue=re-O;if(ne!==0||ue!==0){var te=((q-L)*ne+(M-O)*ue)/(ne*ne+ue*ue);te>1?(L=$,O=re):te>0&&(L+=ne*te,O+=ue*te)}return(ne=q-L)*ne+(ue=M-O)*ue}function Zn(q,M,L,O){var $={id:q===void 0?null:q,type:M,geometry:L,tags:O,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(re){var ne=re.geometry,ue=re.type;if(ue==="Point"||ue==="MultiPoint"||ue==="LineString")qn(re,ne);else if(ue==="Polygon"||ue==="MultiLineString")for(var te=0;te<ne.length;te++)qn(re,ne[te]);else if(ue==="MultiPolygon")for(te=0;te<ne.length;te++)for(var de=0;de<ne[te].length;de++)qn(re,ne[te][de])}($),$}function qn(q,M){for(var L=0;L<M.length;L+=3)q.minX=Math.min(q.minX,M[L]),q.minY=Math.min(q.minY,M[L+1]),q.maxX=Math.max(q.maxX,M[L]),q.maxY=Math.max(q.maxY,M[L+1])}function Gn(q,M,L,O){if(M.geometry){var $=M.geometry.coordinates,re=M.geometry.type,ne=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),ue=[],te=M.id;if(L.promoteId?te=M.properties[L.promoteId]:L.generateId&&(te=O||0),re==="Point")bi($,ue);else if(re==="MultiPoint")for(var de=0;de<$.length;de++)bi($[de],ue);else if(re==="LineString")os($,ue,ne,!1);else if(re==="MultiLineString"){if(L.lineMetrics){for(de=0;de<$.length;de++)os($[de],ue=[],ne,!1),q.push(Zn(te,"LineString",ue,M.properties));return}ye($,ue,ne,!1)}else if(re==="Polygon")ye($,ue,ne,!0);else{if(re!=="MultiPolygon"){if(re==="GeometryCollection"){for(de=0;de<M.geometry.geometries.length;de++)Gn(q,{id:te,geometry:M.geometry.geometries[de],properties:M.properties},L,O);return}throw new Error("Input data is not a valid GeoJSON object.")}for(de=0;de<$.length;de++){var Te=[];ye($[de],Te,ne,!0),ue.push(Te)}}q.push(Zn(te,re,ue,M.properties))}}function bi(q,M){M.push(as(q[0])),M.push(jo(q[1])),M.push(0)}function os(q,M,L,O){for(var $,re,ne=0,ue=0;ue<q.length;ue++){var te=as(q[ue][0]),de=jo(q[ue][1]);M.push(te),M.push(de),M.push(0),ue>0&&(ne+=O?($*de-te*re)/2:Math.sqrt(Math.pow(te-$,2)+Math.pow(de-re,2))),$=te,re=de}var Te=M.length-3;M[2]=1,$n(M,0,Te,L),M[Te+2]=1,M.size=Math.abs(ne),M.start=0,M.end=M.size}function ye(q,M,L,O){for(var $=0;$<q.length;$++){var re=[];os(q[$],re,L,O),M.push(re)}}function as(q){return q/360+.5}function jo(q){var M=Math.sin(q*Math.PI/180),L=.5-.25*Math.log((1+M)/(1-M))/Math.PI;return L<0?0:L>1?1:L}function It(q,M,L,O,$,re,ne,ue){if(O/=M,re>=(L/=M)&&ne<O)return q;if(ne<L||re>=O)return null;for(var te=[],de=0;de<q.length;de++){var Te=q[de],_e=Te.geometry,we=Te.type,Je=$===0?Te.minX:Te.minY,at=$===0?Te.maxX:Te.maxY;if(Je>=L&&at<O)te.push(Te);else if(!(at<L||Je>=O)){var st=[];if(we==="Point"||we==="MultiPoint")Fi(_e,st,L,O,$);else if(we==="LineString")dn(_e,st,L,O,$,!1,ue.lineMetrics);else if(we==="MultiLineString")Us(_e,st,L,O,$,!1);else if(we==="Polygon")Us(_e,st,L,O,$,!0);else if(we==="MultiPolygon")for(var Ct=0;Ct<_e.length;Ct++){var ut=[];Us(_e[Ct],ut,L,O,$,!0),ut.length&&st.push(ut)}if(st.length){if(ue.lineMetrics&&we==="LineString"){for(Ct=0;Ct<st.length;Ct++)te.push(Zn(Te.id,we,st[Ct],Te.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(st.length===1?(we="LineString",st=st[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=st.length===3?"Point":"MultiPoint"),te.push(Zn(Te.id,we,st,Te.tags))}}}return te.length?te:null}function Fi(q,M,L,O,$){for(var re=0;re<q.length;re+=3){var ne=q[re+$];ne>=L&&ne<=O&&(M.push(q[re]),M.push(q[re+1]),M.push(q[re+2]))}}function dn(q,M,L,O,$,re,ne){for(var ue,te,de=js(q),Te=$===0?ls:Zs,_e=q.start,we=0;we<q.length-3;we+=3){var Je=q[we],at=q[we+1],st=q[we+2],Ct=q[we+3],ut=q[we+4],Gt=$===0?Je:at,Vt=$===0?Ct:ut,ci=!1;ne&&(ue=Math.sqrt(Math.pow(Je-Ct,2)+Math.pow(at-ut,2))),Gt<L?Vt>L&&(te=Te(de,Je,at,Ct,ut,L),ne&&(de.start=_e+ue*te)):Gt>O?Vt<O&&(te=Te(de,Je,at,Ct,ut,O),ne&&(de.start=_e+ue*te)):$s(de,Je,at,st),Vt<L&&Gt>=L&&(te=Te(de,Je,at,Ct,ut,L),ci=!0),Vt>O&&Gt<=O&&(te=Te(de,Je,at,Ct,ut,O),ci=!0),!re&&ci&&(ne&&(de.end=_e+ue*te),M.push(de),de=js(q)),ne&&(_e+=ue)}var mt=q.length-3;Je=q[mt],at=q[mt+1],st=q[mt+2],(Gt=$===0?Je:at)>=L&&Gt<=O&&$s(de,Je,at,st),mt=de.length-3,re&&mt>=3&&(de[mt]!==de[0]||de[mt+1]!==de[1])&&$s(de,de[0],de[1],de[2]),de.length&&M.push(de)}function js(q){var M=[];return M.size=q.size,M.start=q.start,M.end=q.end,M}function Us(q,M,L,O,$,re){for(var ne=0;ne<q.length;ne++)dn(q[ne],M,L,O,$,re,!1)}function $s(q,M,L,O){q.push(M),q.push(L),q.push(O)}function ls(q,M,L,O,$,re){var ne=(re-M)/(O-M);return q.push(re),q.push(L+($-L)*ne),q.push(1),ne}function Zs(q,M,L,O,$,re){var ne=(re-L)/($-L);return q.push(M+(O-M)*ne),q.push(re),q.push(1),ne}function Uo(q,M){for(var L=[],O=0;O<q.length;O++){var $,re=q[O],ne=re.type;if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")$=Le(re.geometry,M);else if(ne==="MultiLineString"||ne==="Polygon"){$=[];for(var ue=0;ue<re.geometry.length;ue++)$.push(Le(re.geometry[ue],M))}else if(ne==="MultiPolygon")for($=[],ue=0;ue<re.geometry.length;ue++){for(var te=[],de=0;de<re.geometry[ue].length;de++)te.push(Le(re.geometry[ue][de],M));$.push(te)}L.push(Zn(re.id,ne,$,re.tags))}return L}function Le(q,M){var L=[];L.size=q.size,q.start!==void 0&&(L.start=q.start,L.end=q.end);for(var O=0;O<q.length;O+=3)L.push(q[O]+M,q[O+1],q[O+2]);return L}function wr(q,M){if(q.transformed)return q;var L,O,$,re=1<<q.z,ne=q.x,ue=q.y;for(L=0;L<q.features.length;L++){var te=q.features[L],de=te.geometry,Te=te.type;if(te.geometry=[],Te===1)for(O=0;O<de.length;O+=2)te.geometry.push(or(de[O],de[O+1],M,re,ne,ue));else for(O=0;O<de.length;O++){var _e=[];for($=0;$<de[O].length;$+=2)_e.push(or(de[O][$],de[O][$+1],M,re,ne,ue));te.geometry.push(_e)}}return q.transformed=!0,q}function or(q,M,L,O,$,re){return[Math.round(L*(q*O-$)),Math.round(L*(M*O-re))]}function $o(q,M,L,O,$){for(var re=M===$.maxZoom?0:$.tolerance/((1<<M)*$.extent),ne={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:O,z:M,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ue=0;ue<q.length;ue++){ne.numFeatures++,us(ne,q[ue],re,$);var te=q[ue].minX,de=q[ue].minY,Te=q[ue].maxX,_e=q[ue].maxY;te<ne.minX&&(ne.minX=te),de<ne.minY&&(ne.minY=de),Te>ne.maxX&&(ne.maxX=Te),_e>ne.maxY&&(ne.maxY=_e)}return ne}function us(q,M,L,O){var $=M.geometry,re=M.type,ne=[];if(re==="Point"||re==="MultiPoint")for(var ue=0;ue<$.length;ue+=3)ne.push($[ue]),ne.push($[ue+1]),q.numPoints++,q.numSimplified++;else if(re==="LineString")Me(ne,$,q,L,!1,!1);else if(re==="MultiLineString"||re==="Polygon")for(ue=0;ue<$.length;ue++)Me(ne,$[ue],q,L,re==="Polygon",ue===0);else if(re==="MultiPolygon")for(var te=0;te<$.length;te++){var de=$[te];for(ue=0;ue<de.length;ue++)Me(ne,de[ue],q,L,!0,ue===0)}if(ne.length){var Te=M.tags||null;if(re==="LineString"&&O.lineMetrics){for(var _e in Te={},M.tags)Te[_e]=M.tags[_e];Te.mapbox_clip_start=$.start/$.size,Te.mapbox_clip_end=$.end/$.size}var we={geometry:ne,type:re==="Polygon"||re==="MultiPolygon"?3:re==="LineString"||re==="MultiLineString"?2:1,tags:Te};M.id!==null&&(we.id=M.id),q.features.push(we)}}function Me(q,M,L,O,$,re){var ne=O*O;if(O>0&&M.size<($?ne:O))L.numPoints+=M.length/3;else{for(var ue=[],te=0;te<M.length;te+=3)(O===0||M[te+2]>ne)&&(L.numSimplified++,ue.push(M[te]),ue.push(M[te+1])),L.numPoints++;$&&function(de,Te){for(var _e=0,we=0,Je=de.length,at=Je-2;we<Je;at=we,we+=2)_e+=(de[we]-de[at])*(de[we+1]+de[at+1]);if(_e>0===Te)for(we=0,Je=de.length;we<Je/2;we+=2){var st=de[we],Ct=de[we+1];de[we]=de[Je-2-we],de[we+1]=de[Je-1-we],de[Je-2-we]=st,de[Je-1-we]=Ct}}(ue,re),q.push(ue)}}function yt(q,M){var L=(M=this.options=function($,re){for(var ne in re)$[ne]=re[ne];return $}(Object.create(this.options),M)).debug;if(L&&console.time("preprocess data"),M.maxZoom<0||M.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(M.promoteId&&M.generateId)throw new Error("promoteId and generateId cannot be used together.");var O=function($,re){var ne=[];if($.type==="FeatureCollection")for(var ue=0;ue<$.features.length;ue++)Gn(ne,$.features[ue],re,ue);else Gn(ne,$.type==="Feature"?$:{geometry:$},re);return ne}(q,M);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",M.indexMaxZoom,M.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),O=function($,re){var ne=re.buffer/re.extent,ue=$,te=It($,1,-1-ne,ne,0,-1,2,re),de=It($,1,1-ne,2+ne,0,-1,2,re);return(te||de)&&(ue=It($,1,-ne,1+ne,0,-1,2,re)||[],te&&(ue=Uo(te,1).concat(ue)),de&&(ue=ue.concat(Uo(de,-1)))),ue}(O,M),O.length&&this.splitTile(O,0,0,0),L&&(O.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pt(q,M,L){return 32*((1<<q)*L+M)+q}function Bi(q,M){return M?q.properties[M]:q.id}function Br(q,M){if(q==null)return!0;if(q.type==="Feature")return Bi(q,M)!=null;if(q.type==="FeatureCollection"){const L=new Set;for(const O of q.features){const $=Bi(O,M);if($==null||L.has($))return!1;L.add($)}return!0}return!1}function ft(q,M){const L=new Map;if(q!=null)if(q.type==="Feature")L.set(Bi(q,M),q);else for(const O of q.features)L.set(Bi(O,M),O);return L}yt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yt.prototype.splitTile=function(q,M,L,O,$,re,ne){for(var ue=[q,M,L,O],te=this.options,de=te.debug;ue.length;){O=ue.pop(),L=ue.pop(),M=ue.pop(),q=ue.pop();var Te=1<<M,_e=pt(M,L,O),we=this.tiles[_e];if(!we&&(de>1&&console.time("creation"),we=this.tiles[_e]=$o(q,M,L,O,te),this.tileCoords.push({z:M,x:L,y:O}),de)){de>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",M,L,O,we.numFeatures,we.numPoints,we.numSimplified),console.timeEnd("creation"));var Je="z"+M;this.stats[Je]=(this.stats[Je]||0)+1,this.total++}if(we.source=q,$){if(M===te.maxZoom||M===$)continue;var at=1<<$-M;if(L!==Math.floor(re/at)||O!==Math.floor(ne/at))continue}else if(M===te.indexMaxZoom||we.numPoints<=te.indexMaxPoints)continue;if(we.source=null,q.length!==0){de>1&&console.time("clipping");var st,Ct,ut,Gt,Vt,ci,mt=.5*te.buffer/te.extent,ei=.5-mt,Ai=.5+mt,ar=1+mt;st=Ct=ut=Gt=null,Vt=It(q,Te,L-mt,L+Ai,0,we.minX,we.maxX,te),ci=It(q,Te,L+ei,L+ar,0,we.minX,we.maxX,te),q=null,Vt&&(st=It(Vt,Te,O-mt,O+Ai,1,we.minY,we.maxY,te),Ct=It(Vt,Te,O+ei,O+ar,1,we.minY,we.maxY,te),Vt=null),ci&&(ut=It(ci,Te,O-mt,O+Ai,1,we.minY,we.maxY,te),Gt=It(ci,Te,O+ei,O+ar,1,we.minY,we.maxY,te),ci=null),de>1&&console.timeEnd("clipping"),ue.push(st||[],M+1,2*L,2*O),ue.push(Ct||[],M+1,2*L,2*O+1),ue.push(ut||[],M+1,2*L+1,2*O),ue.push(Gt||[],M+1,2*L+1,2*O+1)}}},yt.prototype.getTile=function(q,M,L){var O=this.options,$=O.extent,re=O.debug;if(q<0||q>24)return null;var ne=1<<q,ue=pt(q,M=(M%ne+ne)%ne,L);if(this.tiles[ue])return wr(this.tiles[ue],$);re>1&&console.log("drilling down to z%d-%d-%d",q,M,L);for(var te,de=q,Te=M,_e=L;!te&&de>0;)de--,Te=Math.floor(Te/2),_e=Math.floor(_e/2),te=this.tiles[pt(de,Te,_e)];return te&&te.source?(re>1&&console.log("found parent tile z%d-%d-%d",de,Te,_e),re>1&&console.time("drilling down"),this.splitTile(te.source,de,Te,_e,q,M,L),re>1&&console.timeEnd("drilling down"),this.tiles[ue]?wr(this.tiles[ue],$):null):null};class Hn extends X{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(M,L){return w._(this,void 0,void 0,function*(){const O=M.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const $=this._geoJSONIndex.getTile(O.z,O.x,O.y);if(!$)return null;const re=new class{constructor(ue){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=w.W,this.length=ue.length,this._features=ue}feature(ue){return new class{constructor(te){this._feature=te,this.extent=w.W,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const de of this._feature.geometry)te.push([new w.P(de[0],de[1])]);return te}{const te=[];for(const de of this._feature.geometry){const Te=[];for(const _e of de)Te.push(new w.P(_e[0],_e[1]));te.push(Te)}return te}}toGeoJSON(te,de,Te){return Ue.call(this,te,de,Te)}}(this._features[ue])}}($.features);let ne=hn(re);return ne.byteOffset===0&&ne.byteLength===ne.buffer.byteLength||(ne=new Uint8Array(ne)),{vectorTile:re,rawData:ne.buffer}})}loadData(M){return w._(this,void 0,void 0,function*(){var L;(L=this._pendingRequest)===null||L===void 0||L.abort();const O=!!(M&&M.request&&M.request.collectResourceTiming)&&new w.bs(M.request);this._pendingRequest=new AbortController;try{let $=yield this.loadGeoJSON(M,this._pendingRequest);if(delete this._pendingRequest,typeof $!="object")throw new Error(`Input data given to '${M.source}' is not a valid GeoJSON object.`);if(Ee($,!0),M.filter){const ne=w.by(M.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(te=>`${te.key}: ${te.message}`).join(", "));$={type:"FeatureCollection",features:$.features.filter(te=>ne.value.evaluate({zoom:0},te))}}this._geoJSONIndex=M.cluster?new zi(function({superclusterOptions:ne,clusterProperties:ue}){if(!ue||!ne)return ne;const te={},de={},Te={accumulated:null,zoom:0},_e={properties:null},we=Object.keys(ue);for(const Je of we){const[at,st]=ue[Je],Ct=w.by(st),ut=w.by(typeof at=="string"?[at,["accumulated"],["get",Je]]:at);te[Je]=Ct.value,de[Je]=ut.value}return ne.map=Je=>{_e.properties=Je;const at={};for(const st of we)at[st]=te[st].evaluate(Te,_e);return at},ne.reduce=(Je,at)=>{_e.properties=at;for(const st of we)Te.accumulated=Je[st],Je[st]=de[st].evaluate(Te,_e)},ne}(M)).load($.features):function(ne,ue){return new yt(ne,ue)}($,M.geojsonVtOptions),this.loaded={};const re={};if(O){const ne=O.finish();ne&&(re.resourceTiming={},re.resourceTiming[M.source]=JSON.parse(JSON.stringify(ne)))}return re}catch($){if(delete this._pendingRequest,w.bz($))return{abandoned:!0};throw $}})}reloadTile(M){const L=this.loaded;return L&&L[M.uid]?super.reloadTile(M):this.loadTile(M)}loadGeoJSON(M,L){return w._(this,void 0,void 0,function*(){const{promoteId:O}=M;if(M.request){const $=yield w.h(M.request,L);return this._dataUpdateable=Br($.data,O)?ft($.data,O):void 0,$.data}if(typeof M.data=="string")try{const $=JSON.parse(M.data);return this._dataUpdateable=Br($,O)?ft($,O):void 0,$}catch{throw new Error(`Input data given to '${M.source}' is not a valid GeoJSON object.`)}if(!M.dataDiff)throw new Error(`Input data given to '${M.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${M.source}`);return function($,re,ne){var ue,te,de,Te;if(re.removeAll&&$.clear(),re.remove)for(const _e of re.remove)$.delete(_e);if(re.add)for(const _e of re.add){const we=Bi(_e,ne);we!=null&&$.set(we,_e)}if(re.update)for(const _e of re.update){let we=$.get(_e.id);if(we==null)continue;const Je=!_e.removeAllProperties&&(((ue=_e.removeProperties)===null||ue===void 0?void 0:ue.length)>0||((te=_e.addOrUpdateProperties)===null||te===void 0?void 0:te.length)>0);if((_e.newGeometry||_e.removeAllProperties||Je)&&(we=Object.assign({},we),$.set(_e.id,we),Je&&(we.properties=Object.assign({},we.properties))),_e.newGeometry&&(we.geometry=_e.newGeometry),_e.removeAllProperties)we.properties={};else if(((de=_e.removeProperties)===null||de===void 0?void 0:de.length)>0)for(const at of _e.removeProperties)Object.prototype.hasOwnProperty.call(we.properties,at)&&delete we.properties[at];if(((Te=_e.addOrUpdateProperties)===null||Te===void 0?void 0:Te.length)>0)for(const{key:at,value:st}of _e.addOrUpdateProperties)we.properties[at]=st}}(this._dataUpdateable,M.dataDiff,O),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(M){return w._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(M){return this._geoJSONIndex.getClusterExpansionZoom(M.clusterId)}getClusterChildren(M){return this._geoJSONIndex.getChildren(M.clusterId)}getClusterLeaves(M){return this._geoJSONIndex.getLeaves(M.clusterId,M.limit,M.offset)}}class En{constructor(M){this.self=M,this.actor=new w.C(M),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(L,O)=>{if(this.externalWorkerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.externalWorkerSourceTypes[L]=O},this.self.addProtocol=w.bf,this.self.removeProtocol=w.bg,this.self.registerRTLTextPlugin=L=>{if(w.bA.isParsed())throw new Error("RTL text plugin already registered.");w.bA.setMethods(L)},this.actor.registerMessageHandler("loadDEMTile",(L,O)=>this._getDEMWorkerSource(L,O.source).loadTile(O)),this.actor.registerMessageHandler("removeDEMTile",(L,O)=>w._(this,void 0,void 0,function*(){this._getDEMWorkerSource(L,O.source).removeTile(O)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(L,O)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(L,O.type,O.source).getClusterExpansionZoom(O)})),this.actor.registerMessageHandler("getClusterChildren",(L,O)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(L,O.type,O.source).getClusterChildren(O)})),this.actor.registerMessageHandler("getClusterLeaves",(L,O)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(L,O.type,O.source).getClusterLeaves(O)})),this.actor.registerMessageHandler("loadData",(L,O)=>this._getWorkerSource(L,O.type,O.source).loadData(O)),this.actor.registerMessageHandler("loadTile",(L,O)=>this._getWorkerSource(L,O.type,O.source).loadTile(O)),this.actor.registerMessageHandler("reloadTile",(L,O)=>this._getWorkerSource(L,O.type,O.source).reloadTile(O)),this.actor.registerMessageHandler("abortTile",(L,O)=>this._getWorkerSource(L,O.type,O.source).abortTile(O)),this.actor.registerMessageHandler("removeTile",(L,O)=>this._getWorkerSource(L,O.type,O.source).removeTile(O)),this.actor.registerMessageHandler("removeSource",(L,O)=>w._(this,void 0,void 0,function*(){if(!this.workerSources[L]||!this.workerSources[L][O.type]||!this.workerSources[L][O.type][O.source])return;const $=this.workerSources[L][O.type][O.source];delete this.workerSources[L][O.type][O.source],$.removeSource!==void 0&&$.removeSource(O)})),this.actor.registerMessageHandler("removeMap",L=>w._(this,void 0,void 0,function*(){delete this.layerIndexes[L],delete this.availableImages[L],delete this.workerSources[L],delete this.demWorkerSources[L]})),this.actor.registerMessageHandler("setReferrer",(L,O)=>w._(this,void 0,void 0,function*(){this.referrer=O})),this.actor.registerMessageHandler("syncRTLPluginState",(L,O)=>this._syncRTLPluginState(L,O)),this.actor.registerMessageHandler("importScript",(L,O)=>w._(this,void 0,void 0,function*(){this.self.importScripts(O)})),this.actor.registerMessageHandler("setImages",(L,O)=>this._setImages(L,O)),this.actor.registerMessageHandler("updateLayers",(L,O)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(L).update(O.layers,O.removedIds)})),this.actor.registerMessageHandler("setLayers",(L,O)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(L).replace(O)}))}_setImages(M,L){return w._(this,void 0,void 0,function*(){this.availableImages[M]=L;for(const O in this.workerSources[M]){const $=this.workerSources[M][O];for(const re in $)$[re].availableImages=L}})}_syncRTLPluginState(M,L){return w._(this,void 0,void 0,function*(){if(w.bA.isParsed())return w.bA.getState();if(L.pluginStatus!=="loading")return w.bA.setState(L),L;const O=L.pluginURL;if(this.self.importScripts(O),w.bA.isParsed()){const $={pluginStatus:"loaded",pluginURL:O};return w.bA.setState($),$}throw w.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${O}`)})}_getAvailableImages(M){let L=this.availableImages[M];return L||(L=[]),L}_getLayerIndex(M){let L=this.layerIndexes[M];return L||(L=this.layerIndexes[M]=new d),L}_getWorkerSource(M,L,O){if(this.workerSources[M]||(this.workerSources[M]={}),this.workerSources[M][L]||(this.workerSources[M][L]={}),!this.workerSources[M][L][O]){const $={sendAsync:(re,ne)=>(re.targetMapId=M,this.actor.sendAsync(re,ne))};switch(L){case"vector":this.workerSources[M][L][O]=new X($,this._getLayerIndex(M),this._getAvailableImages(M));break;case"geojson":this.workerSources[M][L][O]=new Hn($,this._getLayerIndex(M),this._getAvailableImages(M));break;default:this.workerSources[M][L][O]=new this.externalWorkerSourceTypes[L]($,this._getLayerIndex(M),this._getAvailableImages(M))}}return this.workerSources[M][L][O]}_getDEMWorkerSource(M,L){return this.demWorkerSources[M]||(this.demWorkerSources[M]={}),this.demWorkerSources[M][L]||(this.demWorkerSources[M][L]=new U),this.demWorkerSources[M][L]}}return w.i(self)&&(self.worker=new En(self)),En}),_("index",["exports","./shared"],function(w,d){var N="4.1.2";let J,he;const X={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:p=>new Promise((t,o)=>{const u=requestAnimationFrame(t);p.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),o(d.c())})}),getImageData(p,t=0){return this.getImageCanvasContext(p).getImageData(-t,-t,p.width+2*t,p.height+2*t)},getImageCanvasContext(p){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=p.width,t.height=p.height,o.drawImage(p,0,0,p.width,p.height),o},resolveURL:p=>(J||(J=document.createElement("a")),J.href=p,J.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(he==null&&(he=matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}};class U{static testProp(t){if(!U.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in U.docStyle)return t[o];return t[0]}static create(t,o,u){const c=window.document.createElement(t);return o!==void 0&&(c.className=o),u&&u.appendChild(c),c}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){U.docStyle&&U.selectProp&&(U.userSelect=U.docStyle[U.selectProp],U.docStyle[U.selectProp]="none")}static enableDrag(){U.docStyle&&U.selectProp&&(U.docStyle[U.selectProp]=U.userSelect)}static setTransform(t,o){t.style[U.transformProp]=o}static addEventListener(t,o,u,c={}){t.addEventListener(o,u,"passive"in c?c:c.capture)}static removeEventListener(t,o,u,c={}){t.removeEventListener(o,u,"passive"in c?c:c.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",U.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",U.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",U.suppressClickInternal,!0)},0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,u){const c=o.boundingClientRect;return new d.P((u.clientX-c.left)/o.x-t.clientLeft,(u.clientY-c.top)/o.y-t.clientTop)}static mousePos(t,o){const u=U.getScale(t);return U.getPoint(t,u,o)}static touchPos(t,o){const u=[],c=U.getScale(t);for(let m=0;m<o.length;m++)u.push(U.getPoint(t,c,o[m]));return u}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}U.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,U.selectProp=U.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),U.transformProp=U.testProp(["transform","WebkitTransform"]);const ze={supported:!1,testSupport:function(p){!Ue&&Ee&&(se?Q(p):ke=p)}};let ke,Ee,Ue=!1,se=!1;function Q(p){const t=p.createTexture();p.bindTexture(p.TEXTURE_2D,t);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,Ee),p.isContextLost())return;ze.supported=!0}catch{}p.deleteTexture(t),Ue=!0}var oe,ve;typeof document<"u"&&(Ee=document.createElement("img"),Ee.onload=function(){ke&&Q(ke),ke=null,se=!0},Ee.onerror=function(){Ue=!0,ke=null},Ee.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let t,o,u,c;p.resetRequestQueue=()=>{t=[],o=0,u=0,c={}},p.addThrottleControl=I=>{const k=u++;return c[k]=I,k},p.removeThrottleControl=I=>{delete c[I],x()},p.getImage=(I,k,z=!0)=>new Promise((A,F)=>{ze.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),d.e(I,{type:"image"}),t.push({abortController:k,requestParameters:I,supportImageRefresh:z,state:"queued",onError:G=>{F(G)},onSuccess:G=>{A(G)}}),x()});const m=I=>d._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:k,supportImageRefresh:z,onError:A,onSuccess:F,abortController:G}=I,Z=z===!1&&!d.i(self)&&!d.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((ie,pe)=>ie&&pe==="accept",!0));o++;const W=Z?b(k,G):d.m(k,G);try{const ie=yield W;delete I.abortController,I.state="completed",ie.data instanceof HTMLImageElement||d.b(ie.data)?F(ie):ie.data&&F({data:yield(V=ie.data,typeof createImageBitmap=="function"?d.d(V):d.f(V)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete I.abortController,A(ie)}finally{o--,x()}var V}),x=()=>{const I=(()=>{for(const k of Object.keys(c))if(c[k]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=o;k<I&&t.length>0;k++){const z=t.shift();z.abortController.signal.aborted?k--:m(z)}},b=(I,k)=>new Promise((z,A)=>{const F=new Image,G=I.url,Z=I.credentials;Z&&Z==="include"?F.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!d.s(G))&&(F.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{F.src="",A(d.c())}),F.fetchPriority="high",F.onload=()=>{F.onerror=F.onload=null,z({data:F})},F.onerror=()=>{F.onerror=F.onload=null,k.signal.aborted||A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},F.src=G})}(oe||(oe={})),oe.resetRequestQueue(),function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"}(ve||(ve={}));class Ne{constructor(t){this._transformRequestFn=t}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}normalizeSpriteURL(t,o,u){const c=function(m){const x=m.match(Xe);if(!x)throw new Error(`Unable to parse URL "${m}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(t);return c.path+=`${o}${u}`,function(m){const x=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${x}`}(c)}setTransformRequest(t){this._transformRequestFn=t}}const Xe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ke(p){var t=new d.A(3);return t[0]=p[0],t[1]=p[1],t[2]=p[2],t}var tt,Dt=function(p,t,o){return p[0]=t[0]-o[0],p[1]=t[1]-o[1],p[2]=t[2]-o[2],p};tt=new d.A(3),d.A!=Float32Array&&(tt[0]=0,tt[1]=0,tt[2]=0);var xt=function(p){var t=p[0],o=p[1];return t*t+o*o};function Ot(p){const t=[];if(typeof p=="string")t.push({id:"default",url:p});else if(p&&p.length>0){const o=[];for(const{id:u,url:c}of p){const m=`${u}${c}`;o.indexOf(m)===-1&&(o.push(m),t.push({id:u,url:c}))}}return t}(function(){var p=new d.A(2);d.A!=Float32Array&&(p[0]=0,p[1]=0)})();class Nt{constructor(t,o,u,c){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(o,c)}update(t,o,u){const{width:c,height:m}=t,x=!(this.size&&this.size[0]===c&&this.size[1]===m||u),{context:b}=this,{gl:I}=b;if(this.useMipmap=!!(o&&o.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[c,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||d.b(t)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,t):I.texImage2D(I.TEXTURE_2D,0,this.format,c,m,0,this.format,I.UNSIGNED_BYTE,t.data);else{const{x:k,y:z}=u||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||d.b(t)?I.texSubImage2D(I.TEXTURE_2D,0,k,z,I.RGBA,I.UNSIGNED_BYTE,t):I.texSubImage2D(I.TEXTURE_2D,0,k,z,c,m,I.RGBA,I.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(t,o,u){const{context:c}=this,{gl:m}=c;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||t),this.filter=t),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function si(p){const{userImage:t}=p;return!!(t&&t.render&&t.render())&&(p.data.replace(new Uint8Array(t.data.buffer)),!0)}class sr extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:u}of this.requestors)u(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const u=o.spriteData;o.data=new d.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let u=!0;const c=o.data||o.spriteData;return this._validateStretch(o.stretchX,c&&c.width)||(this.fire(new d.j(new Error(`Image "${t}" has invalid "stretchX" value`))),u=!1),this._validateStretch(o.stretchY,c&&c.height)||(this.fire(new d.j(new Error(`Image "${t}" has invalid "stretchY" value`))),u=!1),this._validateContent(o.content,o)||(this.fire(new d.j(new Error(`Image "${t}" has invalid "content" value`))),u=!1),u}_validateStretch(t,o){if(!t)return!0;let u=0;for(const c of t){if(c[0]<u||c[1]<c[0]||o<c[1])return!1;u=c[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const u=o.spriteData,c=u&&u.width||o.data.width,m=u&&u.height||o.data.height;return!(t[0]<0||c<t[0]||t[1]<0||m<t[1]||t[2]<0||c<t[2]||t[3]<0||m<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,u=!0){const c=this.getImage(t);if(u&&(c.data.width!==o.data.width||c.data.height!==o.data.height))throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=c.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((o,u)=>{let c=!0;if(!this.isLoaded())for(const m of t)this.images[m]||(c=!1);this.isLoaded()||c?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})})}_getImagesForIds(t){const o={};for(const u of t){let c=this.getImage(u);c||(this.fire(new d.k("styleimagemissing",{id:u})),c=this.getImage(u)),c?o[u]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:d.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],u=this.getImage(t);if(!u)return null;if(o&&o.position.version===u.version)return o.position;if(o)o.position.version=u.version;else{const c={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new d.I(c,u);this.patterns[t]={bin:c,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Nt(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:o,h:u}=d.p(t),c=this.atlasImage;c.resize({width:o||1,height:u||1});for(const m in this.patterns){const{bin:x}=this.patterns[m],b=x.x+1,I=x.y+1,k=this.getImage(m).data,z=k.width,A=k.height;d.R.copy(k,c,{x:0,y:0},{x:b,y:I},{width:z,height:A}),d.R.copy(k,c,{x:0,y:A-1},{x:b,y:I-1},{width:z,height:1}),d.R.copy(k,c,{x:0,y:0},{x:b,y:I+A},{width:z,height:1}),d.R.copy(k,c,{x:z-1,y:0},{x:b-1,y:I},{width:1,height:A}),d.R.copy(k,c,{x:0,y:0},{x:b+z,y:I},{width:1,height:A})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const u=this.getImage(o);u||d.w(`Image with ID: "${o}" was not found`),si(u)&&this.updateImage(o,u)}}}const kn=1e20;function xr(p,t,o,u,c,m,x,b,I){for(let k=t;k<t+u;k++)hn(p,o*m+k,m,c,x,b,I);for(let k=o;k<o+c;k++)hn(p,k*m+t,1,u,x,b,I)}function hn(p,t,o,u,c,m,x){m[0]=0,x[0]=-kn,x[1]=kn,c[0]=p[t];for(let b=1,I=0,k=0;b<u;b++){c[b]=p[t+b*o];const z=b*b;do{const A=m[I];k=(c[b]-c[A]+z-A*A)/(b-A)/2}while(k<=x[I]&&--I>-1);I++,m[I]=b,x[I]=k,x[I+1]=kn}for(let b=0,I=0;b<u;b++){for(;x[I+1]<b;)I++;const k=m[I],z=b-k;p[t+b*o]=c[k]+z*z}}class Ge{constructor(t,o){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return d._(this,void 0,void 0,function*(){const o=[];for(const m in t)for(const x of t[m])o.push(this._getAndCacheGlyphsPromise(m,x));const u=yield Promise.all(o),c={};for(const{stack:m,id:x,glyph:b}of u)c[m]||(c[m]={}),c[m][x]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return c})}_getAndCacheGlyphsPromise(t,o){return d._(this,void 0,void 0,function*(){let u=this.entries[t];u||(u=this.entries[t]={glyphs:{},requests:{},ranges:{}});let c=u.glyphs[o];if(c!==void 0)return{stack:t,id:o,glyph:c};if(c=this._tinySDF(u,t,o),c)return u.glyphs[o]=c,{stack:t,id:o,glyph:c};const m=Math.floor(o/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[m])return{stack:t,id:o,glyph:c};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[m]){const b=Ge.loadGlyphRange(t,m,this.url,this.requestManager);u.requests[m]=b}const x=yield u.requests[m];for(const b in x)this._doesCharSupportLocalGlyph(+b)||(u.glyphs[+b]=x[+b]);return u.ranges[m]=!0,{stack:t,id:o,glyph:x[o]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(d.u["CJK Unified Ideographs"](t)||d.u["Hangul Syllables"](t)||d.u.Hiragana(t)||d.u.Katakana(t))}_tinySDF(t,o,u){const c=this.localIdeographFontFamily;if(!c||!this._doesCharSupportLocalGlyph(u))return;let m=t.tinySDF;if(!m){let b="400";/bold/i.test(o)?b="900":/medium/i.test(o)?b="500":/light/i.test(o)&&(b="200"),m=t.tinySDF=new Ge.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:c,fontWeight:b})}const x=m.draw(String.fromCharCode(u));return{id:u,bitmap:new d.o({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ge.loadGlyphRange=function(p,t,o,u){return d._(this,void 0,void 0,function*(){const c=256*t,m=c+255,x=u.transformRequest(o.replace("{fontstack}",p).replace("{range}",`${c}-${m}`),ve.Glyphs),b=yield d.l(x,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${t}, ${c}-${m}`);const I={};for(const k of d.n(b.data))I[k.id]=k;return I})},Ge.TinySDF=class{constructor({fontSize:p=24,buffer:t=3,radius:o=8,cutoff:u=.25,fontFamily:c="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=o;const b=this.size=p+4*t,I=this._createCanvas(b),k=this.ctx=I.getContext("2d",{willReadFrequently:!0});k.font=`${x} ${m} ${p}px ${c}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(p){const t=document.createElement("canvas");return t.width=t.height=p,t}draw(p){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:c,actualBoundingBoxRight:m}=this.ctx.measureText(p),x=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-c))),I=Math.min(this.size-this.buffer,x+Math.ceil(u)),k=b+2*this.buffer,z=I+2*this.buffer,A=Math.max(k*z,0),F=new Uint8ClampedArray(A),G={data:F,width:k,height:z,glyphWidth:b,glyphHeight:I,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(b===0||I===0)return G;const{ctx:Z,buffer:W,gridInner:V,gridOuter:ie}=this;Z.clearRect(W,W,b,I),Z.fillText(p,W,W+x);const pe=Z.getImageData(W,W,b,I);ie.fill(kn,0,A),V.fill(0,0,A);for(let K=0;K<I;K++)for(let le=0;le<b;le++){const fe=pe.data[4*(K*b+le)+3]/255;if(fe===0)continue;const me=(K+W)*k+le+W;if(fe===1)ie[me]=0,V[me]=kn;else{const ge=.5-fe;ie[me]=ge>0?ge*ge:0,V[me]=ge<0?ge*ge:0}}xr(ie,0,0,k,z,k,this.f,this.v,this.z),xr(V,W,W,b,I,k,this.f,this.v,this.z);for(let K=0;K<A;K++){const le=Math.sqrt(ie[K])-Math.sqrt(V[K]);F[K]=Math.round(255-255*(le/this.radius+this.cutoff))}return G}};class ht{constructor(){this.specification=d.v.light.position}possiblyEvaluate(t,o){return d.y(t.expression.evaluate(o))}interpolate(t,o,u){return{x:d.z.number(t.x,o.x,u),y:d.z.number(t.y,o.y,u),z:d.z.number(t.z,o.z,u)}}}let dt;class Et extends d.E{constructor(t){super(),dt=dt||new d.q({anchor:new d.D(d.v.light.anchor),position:new ht,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(dt),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(d.r,t,o))for(const u in t){const c=t[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),c):this._transitionable.setValue(u,c)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,u){return(!u||u.validate!==!1)&&d.t(this,t.call(d.x,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}class Mt{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const u=t.join(",")+String(o);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(t,o)),this.dashEntry[u]}getDashRanges(t,o,u){const c=[];let m=t.length%2==1?-t[t.length-1]*u:0,x=t[0]*u,b=!0;c.push({left:m,right:x,isDash:b,zeroLength:t[0]===0});let I=t[0];for(let k=1;k<t.length;k++){b=!b;const z=t[k];m=I*u,I+=z,x=I*u,c.push({left:m,right:x,isDash:b,zeroLength:z===0})}return c}addRoundDash(t,o,u){const c=o/2;for(let m=-u;m<=u;m++){const x=this.width*(this.nextRow+u+m);let b=0,I=t[b];for(let k=0;k<this.width;k++){k/I.right>1&&(I=t[++b]);const z=Math.abs(k-I.left),A=Math.abs(k-I.right),F=Math.min(z,A);let G;const Z=m/u*(c+1);if(I.isDash){const W=c-Math.abs(Z);G=Math.sqrt(F*F+W*W)}else G=c-Math.sqrt(F*F+Z*Z);this.data[x+k]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(t){for(let b=t.length-1;b>=0;--b){const I=t[b],k=t[b+1];I.zeroLength?t.splice(b,1):k&&k.isDash===I.isDash&&(k.left=I.left,t.splice(b,1))}const o=t[0],u=t[t.length-1];o.isDash===u.isDash&&(o.left=u.left-this.width,u.right=o.right+this.width);const c=this.width*this.nextRow;let m=0,x=t[m];for(let b=0;b<this.width;b++){b/x.right>1&&(x=t[++m]);const I=Math.abs(b-x.left),k=Math.abs(b-x.right),z=Math.min(I,k);this.data[c+b]=Math.max(0,Math.min(255,(x.isDash?z:-z)+128))}}addDash(t,o){const u=o?7:0,c=2*u+1;if(this.nextRow+c>this.height)return d.w("LineAtlas out of space"),null;let m=0;for(let b=0;b<t.length;b++)m+=t[b];if(m!==0){const b=this.width/m,I=this.getDashRanges(t,this.width,b);o?this.addRoundDash(I,b,u):this.addRegularDash(I)}const x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:m};return this.nextRow+=c,this.dirty=!0,x}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const Fr="maplibre_preloaded_worker_pool";class zi{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<zi.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Fr]}numActive(){return Object.keys(this.active).length}}const Hr=Math.floor(X.hardwareConcurrency/2);let Ri,ji;function Wr(){return Ri||(Ri=new zi),Ri}zi.workerCount=d.B(globalThis)?Math.max(Math.min(Hr,3),1):1;class Vs{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const u=this.workerPool.acquire(o);for(let c=0;c<u.length;c++){const m=new d.C(u[c],o);m.name=`Worker ${c}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const u=[];for(const c of this.actors)u.push(c.sendAsync({type:t,data:o}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const u of this.actors)u.registerMessageHandler(t,o)}}function $n(){return ji||(ji=new Vs(Wr(),d.G),ji.registerMessageHandler("getResource",(p,t,o)=>d.m(t,o))),ji}function ka(p,t){const o=d.F();return d.H(o,o,[1,1,0]),d.J(o,o,[.5*p.width,.5*p.height,1]),d.K(o,o,p.calculatePosMatrix(t.toUnwrapped()))}function Zn(p,t,o,u,c,m){const x=function(A,F,G){if(A)for(const Z of A){const W=F[Z];if(W&&W.source===G&&W.type==="fill-extrusion")return!0}else for(const Z in F){const W=F[Z];if(W.source===G&&W.type==="fill-extrusion")return!0}return!1}(c&&c.layers,t,p.id),b=m.maxPitchScaleFactor(),I=p.tilesIn(u,b,x);I.sort(qn);const k=[];for(const A of I)k.push({wrappedTileID:A.tileID.wrapped().key,queryResults:A.tile.queryRenderedFeatures(t,o,p._state,A.queryGeometry,A.cameraQueryGeometry,A.scale,c,m,b,ka(p.transform,A.tileID))});const z=function(A){const F={},G={};for(const Z of A){const W=Z.queryResults,V=Z.wrappedTileID,ie=G[V]=G[V]||{};for(const pe in W){const K=W[pe],le=ie[pe]=ie[pe]||{},fe=F[pe]=F[pe]||[];for(const me of K)le[me.featureIndex]||(le[me.featureIndex]=!0,fe.push(me))}}return F}(k);for(const A in z)z[A].forEach(F=>{const G=F.feature,Z=p.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=Z});return z}function qn(p,t){const o=p.tileID,u=t.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}function Gn(p,t,o){return d._(this,void 0,void 0,function*(){let u=p;if(p.url?u=(yield d.h(t.transformRequest(p.url,ve.Source),o)).data:yield X.frameAsync(o),!u)return null;const c=d.L(d.e(u,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(c.vectorLayerIds=u.vector_layers.map(m=>m.id)),c})}class bi{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof d.M?new d.M(t.lng,t.lat):d.M.convert(t),this}setSouthWest(t){return this._sw=t instanceof d.M?new d.M(t.lng,t.lat):d.M.convert(t),this}extend(t){const o=this._sw,u=this._ne;let c,m;if(t instanceof d.M)c=t,m=t;else{if(!(t instanceof bi))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(bi.convert(t)):this.extend(d.M.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(d.M.convert(t)):this;if(c=t._sw,m=t._ne,!c||!m)return this}return o||u?(o.lng=Math.min(c.lng,o.lng),o.lat=Math.min(c.lat,o.lat),u.lng=Math.max(m.lng,u.lng),u.lat=Math.max(m.lat,u.lat)):(this._sw=new d.M(c.lng,c.lat),this._ne=new d.M(m.lng,m.lat)),this}getCenter(){return new d.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.M(this.getWest(),this.getNorth())}getSouthEast(){return new d.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:u}=d.M.convert(t);let c=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&c}static convert(t){return t instanceof bi?t:t&&new bi(t)}static fromLngLat(t,o=0){const u=360*o/40075017,c=u/Math.cos(Math.PI/180*t.lat);return new bi(new d.M(t.lng-c,t.lat-u),new d.M(t.lng+c,t.lat+u))}}class os{constructor(t,o,u){this.bounds=bi.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=u||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),u=Math.floor(d.N(this.bounds.getWest())*o),c=Math.floor(d.O(this.bounds.getNorth())*o),m=Math.ceil(d.N(this.bounds.getEast())*o),x=Math.ceil(d.O(this.bounds.getSouth())*o);return t.x>=u&&t.x<m&&t.y>=c&&t.y<x}}class ye extends d.E{constructor(t,o,u,c){if(super(),this.id=t,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.L(o,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(d.e(this,t),t.bounds&&(this.tileBounds=new os(t.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new d.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(t){return d._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(o,ve.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let c="reloadTile";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((m,x)=>{t.reloadPromise={resolve:m,reject:x}})}else t.actor=this.dispatcher.getActor(),c="loadTile";t.abortController=new AbortController;try{const m=yield t.actor.sendAsync({type:c,data:u},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,m)}catch(m){if(delete t.abortController,t.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const u=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(u.resolve).catch(u.reject)}}abortTile(t){return d._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"abortTile",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return d._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"removeTile",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class as extends d.E{constructor(t,o,u,c){super(),this.id=t,this.dispatcher=u,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},o),d.e(this,d.L(o,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(d.e(this,t),t.bounds&&(this.tileBounds=new os(t.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new d.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return d.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return d._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const u=yield oe.getImage(this.map._requestManager.transformRequest(o,ve.Tile),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&t.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const c=this.map.painter.context,m=c.gl,x=u.data;t.texture=this.map.painter.getTileTexture(x.width),t.texture?t.texture.update(x,{useMipmap:!0}):(t.texture=new Nt(c,x,m.RGBA,{useMipmap:!0}),t.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST),c.extTextureFilterAnisotropic&&m.texParameterf(m.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax)),t.state="loaded"}}catch(u){if(delete t.abortController,t.aborted)t.state="unloaded";else if(u)throw t.state="errored",u}})}abortTile(t){return d._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return d._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class jo extends as{constructor(t,o,u,c){super(t,o,u,c),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return d._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(o,ve.Tile);t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const c=yield oe.getImage(u,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){const m=c.data;this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const x=d.b(m)&&d.S()?m:yield this.readImageNow(m),b={type:this.type,uid:t.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const I=yield t.actor.sendAsync({type:"loadDEMTile",data:b});t.dem=I,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}})}readImageNow(t){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.U()){const o=t.width+2,u=t.height+2;try{return new d.R({width:o,height:u},yield d.V(t,-1,-1,o,u))}catch{}}return X.getImageData(t,1)})}_getNeighboringTiles(t){const o=t.canonical,u=Math.pow(2,o.z),c=(o.x-1+u)%u,m=o.x===0?t.wrap-1:t.wrap,x=(o.x+1+u)%u,b=o.x+1===u?t.wrap+1:t.wrap,I={};return I[new d.Q(t.overscaledZ,m,o.z,c,o.y).key]={backfilled:!1},I[new d.Q(t.overscaledZ,b,o.z,x,o.y).key]={backfilled:!1},o.y>0&&(I[new d.Q(t.overscaledZ,m,o.z,c,o.y-1).key]={backfilled:!1},I[new d.Q(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},I[new d.Q(t.overscaledZ,b,o.z,x,o.y-1).key]={backfilled:!1}),o.y+1<u&&(I[new d.Q(t.overscaledZ,m,o.z,c,o.y+1).key]={backfilled:!1},I[new d.Q(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},I[new d.Q(t.overscaledZ,b,o.z,x,o.y+1).key]={backfilled:!1}),I}unloadTile(t){return d._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class It extends d.E{constructor(t,o,u,c){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(c),this._data=o.data,this._options=d.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const m=d.W/this.tileSize;this.workerOptions=d.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*m,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*m,extent:d.W,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:d.W,radius:(o.clusterRadius||50)*m,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,u){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:u}})}_updateWorkerData(t){return d._(this,void 0,void 0,function*(){const o=d.e({type:this.type},this.workerOptions);t?o.dataDiff=t:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(X.resolveURL(this._data),ve.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"loadData",data:o});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let c=null;u.resourceTiming&&u.resourceTiming[this.id]&&(c=u.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&c&&c.length>0&&d.e(m,{resourceTiming:c}),this.fire(new d.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(t){return d._(this,void 0,void 0,function*(){const o=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const u={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const c=yield this.actor.sendAsync({type:o,data:u},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(c,this.map.painter,o==="reloadTile")})}abortTile(t){return d._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return d._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Fi=d.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class dn extends d.E{constructor(t,o,u,c){super(),this.id=t,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(c),this.options=o}load(t){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield oe.getImage(this.map._requestManager.transformRequest(this.url,ve.Image),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this.fire(new d.j(o))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(d.Y.fromLngLat);this.tileID=function(c){let m=1/0,x=1/0,b=-1/0,I=-1/0;for(const F of c)m=Math.min(m,F.x),x=Math.min(x,F.y),b=Math.max(b,F.x),I=Math.max(I,F.y);const k=Math.max(b-m,I-x),z=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),A=Math.pow(2,z);return new d.a0(z,Math.floor((m+b)/2*A),Math.floor((x+I)/2*A))}(o),this.minzoom=this.maxzoom=this.tileID.z;const u=o.map(c=>this.tileID.getTilePoint(c)._round());return this._boundsArray=new d.Z,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,d.W,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,d.W),this._boundsArray.emplaceBack(u[2].x,u[2].y,d.W,d.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Fi.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Nt(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const m=this.tiles[c];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class js extends dn{constructor(t,o,u,c){super(t,o,u,c),this.roundZoom=!0,this.type="video",this.options=o}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,ve.Source).url);try{const o=yield d.a2(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new d.j(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new d.j(new d.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Fi.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new Nt(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const m=this.tiles[c];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Us extends dn{constructor(t,o,u,c){super(t,o,u,c),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(x=>typeof x!="number"))||this.fire(new d.j(new d.a1(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a1(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new d.j(new d.a1(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a1(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a1(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,u=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Fi.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Nt(o,this.canvas,u.RGBA,{premultiply:!0});let c=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const $s={},ls=p=>{switch(p){case"geojson":return It;case"image":return dn;case"raster":return as;case"raster-dem":return jo;case"vector":return ye;case"video":return js;case"canvas":return Us}return $s[p]},Zs="RTLPluginLoaded";class Uo extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=$n()}_syncState(t){return this.status=t,this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return d._(this,arguments,void 0,function*(o,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=X.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(Zs))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Le=null;function wr(){return Le||(Le=new Uo),Le}class or{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=d.a3(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const o=t+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(c,m){const x={};if(!m)return x;for(const b of c){const I=b.layerIds.map(k=>m.getLayer(k)).filter(Boolean);if(I.length!==0){b.layers=I,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(k=>I.filter(z=>z.id===k)[0]));for(const k of I)x[k.id]=b}}return x}(t.buckets,o.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const m=this.buckets[c];if(m instanceof d.a5){if(this.hasSymbolBuckets=!0,!u)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const m=this.buckets[c];if(m instanceof d.a5&&m.hasRTLText){this.hasRTLText=!0,wr().lazyLoad();break}}this.queryPadding=0;for(const c in this.buckets){const m=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(c).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new d.a4}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const u in this.buckets){const c=this.buckets[u];c.uploadPending()&&c.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Nt(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Nt(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,u,c,m,x,b,I,k,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:z,transform:I,params:b,queryPadding:this.queryPadding*k},t,o,u):{}}querySourceFeatures(t,o){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const c=u.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",x=c._geojsonTileLayer||c[m];if(!x)return;const b=d.a6(o&&o.filter),{z:I,x:k,y:z}=this.tileID.canonical,A={z:I,x:k,y:z};for(let F=0;F<x.length;F++){const G=x.feature(F);if(b.needGeometry){const V=d.a7(G,!0);if(!b.filter(new d.a8(this.tileID.overscaledZ),V,this.tileID.canonical))continue}else if(!b.filter(new d.a8(this.tileID.overscaledZ),G))continue;const Z=u.getId(G,m),W=new d.a9(G,I,k,z,Z);W.tile=A,t.push(W)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const u=d.aa(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const u=Date.now();let c=!1;if(this.expirationTime>u)c=!1;else if(o)if(this.expirationTime<o)c=!0;else{const m=this.expirationTime-o;m?this.expirationTime=u+Math.max(m,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const c in this.buckets){if(!o.style.hasLayer(c))continue;const m=this.buckets[c],x=m.layers[0].sourceLayer||"_geojsonTileLayer",b=u[x],I=t[x];if(!b||!I||Object.keys(I).length===0)continue;m.update(I,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=o&&o.style&&o.style.getLayer(c);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<X.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=X.now()+t}setDependencies(t,o){const u={};for(const c of o)u[c]=!0;this.dependencies[t]=u}hasDependency(t,o){for(const u of t){const c=this.dependencies[u];if(c){for(const m of o)if(c[m])return!0}}return!1}}class $o{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,u){const c=t.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const m={value:o,timeout:void 0};if(u!==void 0&&(m.timeout=setTimeout(()=>{this.remove(t,m)},u)),this.data[c].push(m),this.order.push(c),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const u=t.wrapped().key,c=o===void 0?0:this.data[u].indexOf(o),m=this.data[u][c];return this.data[u].splice(c,1),m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(m.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const u in this.data)for(const c of this.data[u])t(c.value)||o.push(c);for(const u of o)this.remove(u.value.tileID,u)}}class us{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,u){const c=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][c]=this.stateChanges[t][c]||{},d.e(this.stateChanges[t][c],u),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==c&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][c]===null){this.deletedStates[t][c]={};for(const m in this.state[t][c])u[m]||(this.deletedStates[t][c][m]=null)}else for(const m in u)this.deletedStates[t]&&this.deletedStates[t][c]&&this.deletedStates[t][c][m]===null&&delete this.deletedStates[t][c][m]}removeFeatureState(t,o,u){if(this.deletedStates[t]===null)return;const c=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&o!==void 0)this.deletedStates[t][c]!==null&&(this.deletedStates[t][c]=this.deletedStates[t][c]||{},this.deletedStates[t][c][u]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][c])for(u in this.deletedStates[t][c]={},this.stateChanges[t][c])this.deletedStates[t][c][u]=null;else this.deletedStates[t][c]=null;else this.deletedStates[t]=null}getState(t,o){const u=String(o),c=d.e({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][o];if(m===null)return{};for(const x in m)delete c[x]}return c}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const u={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const m={};for(const x in this.stateChanges[c])this.state[c][x]||(this.state[c][x]={}),d.e(this.state[c][x],this.stateChanges[c][x]),m[x]=this.state[c][x];u[c]=m}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const m={};if(this.deletedStates[c]===null)for(const x in this.state[c])m[x]={},this.state[c][x]={};else for(const x in this.deletedStates[c]){if(this.deletedStates[c][x]===null)this.state[c][x]={};else for(const b of Object.keys(this.deletedStates[c][x]))delete this.state[c][x][b];m[x]=this.state[c][x]}u[c]=u[c]||{},d.e(u[c],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const c in t)t[c].setFeatureState(u,o)}}class Me extends d.E{constructor(t,o,u){super(),this.id=t,this.dispatcher=u,this.on("data",c=>{c.dataType==="source"&&c.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&c.dataType==="source"&&c.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((c,m,x,b)=>{const I=new(ls(m.type))(c,m,x,b);if(I.id!==c)throw new Error(`Expected Source id to be ${c} instead of ${I.id}`);return I})(t,o,u,this),this._tiles={},this._cache=new $o(0,c=>this._unloadTile(c)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new us,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,u){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,u)}catch(c){t.state="errored",c.status!==404?this._source.fire(new d.j(c,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new d.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const u=this._tiles[o];u.upload(t),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(yt).map(t=>t.key)}getRenderableIds(t){const o=[];for(const u in this._tiles)this._isIdRenderable(u,t)&&o.push(this._tiles[u]);return t?o.sort((u,c)=>{const m=u.tileID,x=c.tileID,b=new d.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),I=new d.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-x.overscaledZ||I.y-b.y||I.x-b.x}).map(u=>u.tileID.key):o.map(u=>u.tileID).sort(yt).map(u=>u.key)}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,o){return d._(this,void 0,void 0,function*(){const u=this._tiles[t];u&&(u.state!=="loading"&&(u.state=o),yield this._loadTile(u,t,o))})}_tileLoaded(t,o,u){t.timeAdded=X.now(),u==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const o=this.getRenderableIds();for(let c=0;c<o.length;c++){const m=o[c];if(t.neighboringTiles&&t.neighboringTiles[m]){const x=this.getTileByID(m);u(t,x),u(x,t)}}function u(c,m){c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-c.tileID.canonical.x;const b=m.tileID.canonical.y-c.tileID.canonical.y,I=Math.pow(2,c.tileID.canonical.z),k=m.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+I)===1?x+=I:Math.abs(x-I)===1&&(x-=I)),m.dem&&c.dem&&(c.dem.backfillBorder(m.dem,x,b),c.neighboringTiles&&c.neighboringTiles[k]&&(c.neighboringTiles[k].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,u,c){for(const m in this._tiles){let x=this._tiles[m];if(c[m]||!x.hasData()||x.tileID.overscaledZ<=o||x.tileID.overscaledZ>u)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>o+1;){const k=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[k.key],x&&x.hasData()&&(b=k)}let I=b;for(;I.overscaledZ>o;)if(I=I.scaledTo(I.overscaledZ-1),t[I.key]){c[b.key]=b;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const u=this._loadedParentTiles[t.key];return u&&u.tileID.overscaledZ>=o?u:null}for(let u=t.overscaledZ-1;u>=o;u--){const c=t.scaledTo(u),m=this._getLoadedTile(c);if(m)return m}}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,u=Math.ceil(t.height/this._source.tileSize)+1,c=Math.floor(o*u*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(m)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const u={};for(const c in this._tiles){const m=this._tiles[c];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),u[m.tileID.key]=m}this._tiles=u;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(c,this._tiles[c])}}update(t,o){if(this.transform=t,this.terrain=o,!this._sourceLoaded||this._paused)return;let u;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new d.Q(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(u=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(u=u.filter(z=>this._source.hasTile(z)))):u=[];const c=t.coveringZoomLevel(this._source),m=Math.max(c-Me.maxOverzooming,this._source.minzoom),x=Math.max(c+Me.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const A of u)if(A.canonical.z>this._source.minzoom){const F=A.scaledTo(A.canonical.z-1);z[F.key]=F;const G=A.scaledTo(Math.max(this._source.minzoom,Math.min(A.canonical.z,5)));z[G.key]=G}u=u.concat(Object.values(z))}const b=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(u,c);if(pt(this._source.type)){const z={},A={},F=Object.keys(I),G=X.now();for(const Z of F){const W=I[Z],V=this._tiles[Z];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=G)continue;const ie=this.findLoadedParent(W,m);ie&&(this._addTile(ie.tileID),z[ie.tileID.key]=ie.tileID),A[Z]=W}this._retainLoadedChildren(A,c,x,I);for(const Z in z)I[Z]||(this._coveredTiles[Z]=!0,I[Z]=z[Z]);if(o){const Z={},W={};for(const V of u)this._tiles[V.key].hasData()?Z[V.key]=V:W[V.key]=V;for(const V in W){const ie=W[V].children(this._source.maxzoom);this._tiles[ie[0].key]&&this._tiles[ie[1].key]&&this._tiles[ie[2].key]&&this._tiles[ie[3].key]&&(Z[ie[0].key]=I[ie[0].key]=ie[0],Z[ie[1].key]=I[ie[1].key]=ie[1],Z[ie[2].key]=I[ie[2].key]=ie[2],Z[ie[3].key]=I[ie[3].key]=ie[3],delete W[V])}for(const V in W){const ie=this.findLoadedParent(W[V],this._source.minzoom);if(ie){Z[ie.tileID.key]=I[ie.tileID.key]=ie.tileID;for(const pe in Z)Z[pe].isChildOf(ie.tileID)&&delete Z[pe]}}for(const V in this._tiles)Z[V]||(this._coveredTiles[V]=!0)}}for(const z in I)this._tiles[z].clearFadeHold();const k=d.ab(this._tiles,I);for(const z of k){const A=this._tiles[z];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){const u={},c={},m=Math.max(o-Me.maxOverzooming,this._source.minzoom),x=Math.max(o+Me.maxUnderzooming,this._source.minzoom),b={};for(const I of t){const k=this._addTile(I);u[I.key]=I,k.hasData()||o<this._source.maxzoom&&(b[I.key]=I)}this._retainLoadedChildren(b,o,x,u);for(const I of t){let k=this._tiles[I.key];if(k.hasData())continue;if(o+1>this._source.maxzoom){const A=I.children(this._source.maxzoom)[0],F=this.getTile(A);if(F&&F.hasData()){u[A.key]=A;continue}}else{const A=I.children(this._source.maxzoom);if(u[A[0].key]&&u[A[1].key]&&u[A[2].key]&&u[A[3].key])continue}let z=k.wasRequested();for(let A=I.overscaledZ-1;A>=m;--A){const F=I.scaledTo(A);if(c[F.key])break;if(c[F.key]=!0,k=this.getTile(F),!k&&z&&(k=this._addTile(F)),k){const G=k.hasData();if((z||G)&&(u[F.key]=F),z=k.wasRequested(),G)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let u,c=this._tiles[t].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){u=this._loadedParentTiles[c.key];break}o.push(c.key);const m=c.scaledTo(c.overscaledZ-1);if(u=this._getLoadedTile(m),u)break;c=m}for(const m of o)this._loadedParentTiles[m]=u}}_addTile(t){let o=this._tiles[t.key];if(o)return o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const u=o;return o||(o=new or(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._tiles[t.key]=o,u||this._source.fire(new d.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const u=o.getExpiryTimeout();u&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},u))}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,o,u){const c=[],m=this.transform;if(!m)return c;const x=u?m.getCameraQueryGeometry(t):t,b=t.map(Z=>m.pointCoordinate(Z,this.terrain)),I=x.map(Z=>m.pointCoordinate(Z,this.terrain)),k=this.getIds();let z=1/0,A=1/0,F=-1/0,G=-1/0;for(const Z of I)z=Math.min(z,Z.x),A=Math.min(A,Z.y),F=Math.max(F,Z.x),G=Math.max(G,Z.y);for(let Z=0;Z<k.length;Z++){const W=this._tiles[k[Z]];if(W.holdingForFade())continue;const V=W.tileID,ie=Math.pow(2,m.zoom-W.tileID.overscaledZ),pe=o*W.queryPadding*d.W/W.tileSize/ie,K=[V.getTilePoint(new d.Y(z,A)),V.getTilePoint(new d.Y(F,G))];if(K[0].x-pe<d.W&&K[0].y-pe<d.W&&K[1].x+pe>=0&&K[1].y+pe>=0){const le=b.map(me=>V.getTilePoint(me)),fe=I.map(me=>V.getTilePoint(me));c.push({tile:W,tileID:V,queryGeometry:le,cameraQueryGeometry:fe,scale:ie})}}return c}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map(u=>this._tiles[u].tileID);for(const u of o)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(pt(this._source.type)){const t=X.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=t)return!0}return!1}setFeatureState(t,o,u){this._state.updateState(t=t||"_geojsonTileLayer",o,u)}removeFeatureState(t,o,u){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,u)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,u){const c=this._tiles[t];c&&c.setDependencies(o,u)}reloadTilesForDependencies(t,o){for(const u in this._tiles)this._tiles[u].hasDependency(t,o)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(t,o))}}function yt(p,t){const o=Math.abs(2*p.wrap)-+(p.wrap<0),u=Math.abs(2*t.wrap)-+(t.wrap<0);return p.overscaledZ-t.overscaledZ||u-o||t.canonical.y-p.canonical.y||t.canonical.x-p.canonical.x}function pt(p){return p==="raster"||p==="image"||p==="video"}Me.maxOverzooming=10,Me.maxUnderzooming=3;class Bi{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=d.ac(t,0,1);let o=1,u=this._distances[o];const c=t*this.paddedLength+this.padding;for(;u<c&&o<this._distances.length;)u=this._distances[++o];const m=o-1,x=this._distances[m],b=u-x,I=b>0?(c-x)/b:0;return this.points[m].mult(1-I).add(this.points[o].mult(I))}}function Br(p,t){let o=!0;return p==="always"||p!=="never"&&t!=="never"||(o=!1),o}class ft{constructor(t,o,u){const c=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/u),this.yCellCount=Math.ceil(o/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)c.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,u,c,m){this._forEachCell(o,u,c,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(c),this.bboxes.push(m)}insertCircle(t,o,u,c){this._forEachCell(o-c,u-c,o+c,u+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(u),this.circles.push(c)}_insertBoxCell(t,o,u,c,m,x){this.boxCells[m].push(x)}_insertCircleCell(t,o,u,c,m,x){this.circleCells[m].push(x)}_query(t,o,u,c,m,x,b){if(u<0||t>this.width||c<0||o>this.height)return[];const I=[];if(t<=0&&o<=0&&this.width<=u&&this.height<=c){if(m)return[{key:null,x1:t,y1:o,x2:u,y2:c}];for(let k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const z=this.circles[3*k],A=this.circles[3*k+1],F=this.circles[3*k+2];I.push({key:this.circleKeys[k],x1:z-F,y1:A-F,x2:z+F,y2:A+F})}}else this._forEachCell(t,o,u,c,this._queryCell,I,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},b);return I}query(t,o,u,c){return this._query(t,o,u,c,!1,null)}hitTest(t,o,u,c,m,x){return this._query(t,o,u,c,!0,m,x).length>0}hitTestCircle(t,o,u,c,m){const x=t-u,b=t+u,I=o-u,k=o+u;if(b<0||x>this.width||k<0||I>this.height)return!1;const z=[];return this._forEachCell(x,I,b,k,this._queryCellCircle,z,{hitTest:!0,overlapMode:c,circle:{x:t,y:o,radius:u},seenUids:{box:{},circle:{}}},m),z.length>0}_queryCell(t,o,u,c,m,x,b,I){const{seenUids:k,hitTest:z,overlapMode:A}=b,F=this.boxCells[m];if(F!==null){const Z=this.bboxes;for(const W of F)if(!k.box[W]){k.box[W]=!0;const V=4*W,ie=this.boxKeys[W];if(t<=Z[V+2]&&o<=Z[V+3]&&u>=Z[V+0]&&c>=Z[V+1]&&(!I||I(ie))&&(!z||!Br(A,ie.overlapMode))&&(x.push({key:ie,x1:Z[V],y1:Z[V+1],x2:Z[V+2],y2:Z[V+3]}),z))return!0}}const G=this.circleCells[m];if(G!==null){const Z=this.circles;for(const W of G)if(!k.circle[W]){k.circle[W]=!0;const V=3*W,ie=this.circleKeys[W];if(this._circleAndRectCollide(Z[V],Z[V+1],Z[V+2],t,o,u,c)&&(!I||I(ie))&&(!z||!Br(A,ie.overlapMode))){const pe=Z[V],K=Z[V+1],le=Z[V+2];if(x.push({key:ie,x1:pe-le,y1:K-le,x2:pe+le,y2:K+le}),z)return!0}}}return!1}_queryCellCircle(t,o,u,c,m,x,b,I){const{circle:k,seenUids:z,overlapMode:A}=b,F=this.boxCells[m];if(F!==null){const Z=this.bboxes;for(const W of F)if(!z.box[W]){z.box[W]=!0;const V=4*W,ie=this.boxKeys[W];if(this._circleAndRectCollide(k.x,k.y,k.radius,Z[V+0],Z[V+1],Z[V+2],Z[V+3])&&(!I||I(ie))&&!Br(A,ie.overlapMode))return x.push(!0),!0}}const G=this.circleCells[m];if(G!==null){const Z=this.circles;for(const W of G)if(!z.circle[W]){z.circle[W]=!0;const V=3*W,ie=this.circleKeys[W];if(this._circlesCollide(Z[V],Z[V+1],Z[V+2],k.x,k.y,k.radius)&&(!I||I(ie))&&!Br(A,ie.overlapMode))return x.push(!0),!0}}}_forEachCell(t,o,u,c,m,x,b,I){const k=this._convertToXCellCoord(t),z=this._convertToYCellCoord(o),A=this._convertToXCellCoord(u),F=this._convertToYCellCoord(c);for(let G=k;G<=A;G++)for(let Z=z;Z<=F;Z++)if(m.call(this,t,o,u,c,this.xCellCount*Z+G,x,b,I))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,u,c,m,x){const b=c-t,I=m-o,k=u+x;return k*k>b*b+I*I}_circleAndRectCollide(t,o,u,c,m,x,b){const I=(x-c)/2,k=Math.abs(t-(c+I));if(k>I+u)return!1;const z=(b-m)/2,A=Math.abs(o-(m+z));if(A>z+u)return!1;if(k<=I||A<=z)return!0;const F=k-I,G=A-z;return F*F+G*G<=u*u}}function Hn(p,t,o,u,c){const m=d.F();return t?(d.J(m,m,[1/c,1/c,1]),o||d.ad(m,m,u.angle)):d.K(m,u.labelPlaneMatrix,p),m}function En(p,t,o,u,c){if(t){const m=d.ae(p);return d.J(m,m,[c,c,1]),o||d.ad(m,m,-u.angle),m}return u.glCoordMatrix}function q(p,t,o){let u;o?(u=[p.x,p.y,o(p.x,p.y),1],d.af(u,u,t)):(u=[p.x,p.y,0,1],at(u,u,t));const c=u[3];return{point:new d.P(u[0]/c,u[1]/c),signedDistanceFromCamera:c}}function M(p,t){return .5+p/t*.5}function L(p,t){const o=p[0]/p[3],u=p[1]/p[3];return o>=-t[0]&&o<=t[0]&&u>=-t[1]&&u<=t[1]}function O(p,t,o,u,c,m,x,b,I,k){const z=u?p.textSizeData:p.iconSizeData,A=d.ag(z,o.transform.zoom),F=[256/o.width*2+1,256/o.height*2+1],G=u?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;G.clear();const Z=p.lineVertexArray,W=u?p.text.placedSymbolArray:p.icon.placedSymbolArray,V=o.transform.width/o.transform.height;let ie=!1;for(let pe=0;pe<W.length;pe++){const K=W.get(pe);if(K.hidden||K.writingMode===d.ah.vertical&&!ie){Je(K.numGlyphs,G);continue}let le;if(ie=!1,k?(le=[K.anchorX,K.anchorY,k(K.anchorX,K.anchorY),1],d.af(le,le,t)):(le=[K.anchorX,K.anchorY,0,1],at(le,le,t)),!L(le,F)){Je(K.numGlyphs,G);continue}const fe=M(o.transform.cameraToCenterDistance,le[3]),me=d.ai(z,A,K),ge=x?me/fe:me*fe,Ce=new d.P(K.anchorX,K.anchorY),Se=q(Ce,c,k).point,Ie={projections:{},offsets:{}},Ze=ne(K,ge,!1,b,t,c,m,p.glyphOffsetArray,Z,G,Se,Ce,Ie,V,I,k);ie=Ze.useVertical,(Ze.notEnoughRoom||ie||Ze.needsFlipping&&ne(K,ge,!0,b,t,c,m,p.glyphOffsetArray,Z,G,Se,Ce,Ie,V,I,k).notEnoughRoom)&&Je(K.numGlyphs,G)}u?p.text.dynamicLayoutVertexBuffer.updateData(G):p.icon.dynamicLayoutVertexBuffer.updateData(G)}function $(p,t,o,u,c,m,x,b,I,k,z,A,F){const G=b.glyphStartIndex+b.numGlyphs,Z=b.lineStartIndex,W=b.lineStartIndex+b.lineLength,V=t.getoffsetX(b.glyphStartIndex),ie=t.getoffsetX(G-1),pe=_e(p*V,o,u,c,m,x,b.segment,Z,W,I,k,z,A,F);if(!pe)return null;const K=_e(p*ie,o,u,c,m,x,b.segment,Z,W,I,k,z,A,F);return K?{first:pe,last:K}:null}function re(p,t,o,u){return p===d.ah.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*u?{useVertical:!0}:(p===d.ah.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function ne(p,t,o,u,c,m,x,b,I,k,z,A,F,G,Z,W){const V=t/24,ie=p.lineOffsetX*V,pe=p.lineOffsetY*V;let K;if(p.numGlyphs>1){const le=p.glyphStartIndex+p.numGlyphs,fe=p.lineStartIndex,me=p.lineStartIndex+p.lineLength,ge=$(V,b,ie,pe,o,z,A,p,I,m,F,Z,W);if(!ge)return{notEnoughRoom:!0};const Ce=q(ge.first.point,x,W).point,Se=q(ge.last.point,x,W).point;if(u&&!o){const Ie=re(p.writingMode,Ce,Se,G);if(Ie)return Ie}K=[ge.first];for(let Ie=p.glyphStartIndex+1;Ie<le-1;Ie++)K.push(_e(V*b.getoffsetX(Ie),ie,pe,o,z,A,p.segment,fe,me,I,m,F,Z,W));K.push(ge.last)}else{if(u&&!o){const fe=q(A,c,W).point,me=p.lineStartIndex+p.segment+1,ge=new d.P(I.getx(me),I.gety(me)),Ce=q(ge,c,W),Se=Ce.signedDistanceFromCamera>0?Ce.point:ue(A,ge,fe,1,c,W),Ie=re(p.writingMode,fe,Se,G);if(Ie)return Ie}const le=_e(V*b.getoffsetX(p.glyphStartIndex),ie,pe,o,z,A,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,I,m,F,Z,W);if(!le)return{notEnoughRoom:!0};K=[le]}for(const le of K)d.aj(k,le.point,le.angle);return{}}function ue(p,t,o,u,c,m){const x=q(p.add(p.sub(t)._unit()),c,m).point,b=o.sub(x);return o.add(b._mult(u/b.mag()))}function te(p,t){const{projectionCache:o,lineVertexArray:u,labelPlaneMatrix:c,tileAnchorPoint:m,distanceFromAnchor:x,getElevation:b,previousVertex:I,direction:k,absOffsetX:z}=t;if(o.projections[p])return o.projections[p];const A=new d.P(u.getx(p),u.gety(p)),F=q(A,c,b);if(F.signedDistanceFromCamera>0)return o.projections[p]=F.point,F.point;const G=p-k;return ue(x===0?m:new d.P(u.getx(G),u.gety(G)),A,I,z-x+1,c,b)}function de(p,t,o){return p._unit()._perp()._mult(t*o)}function Te(p,t,o,u,c,m,x,b){const{projectionCache:I,direction:k}=b;if(I.offsets[p])return I.offsets[p];const z=o.add(t);if(p+k<u||p+k>=c)return I.offsets[p]=z,z;const A=te(p+k,b),F=de(A.sub(o),x,k),G=o.add(F),Z=A.add(F);return I.offsets[p]=d.ak(m,z,G,Z)||z,I.offsets[p]}function _e(p,t,o,u,c,m,x,b,I,k,z,A,F,G){const Z=u?p-t:p+t;let W=Z>0?1:-1,V=0;u&&(W*=-1,V=Math.PI),W<0&&(V+=Math.PI);let ie,pe,K=W>0?b+x:b+x+1,le=c,fe=c,me=0,ge=0;const Ce=Math.abs(Z),Se=[];let Ie;for(;me+ge<=Ce;){if(K+=W,K<b||K>=I)return null;me+=ge,fe=le,pe=ie;const Fe={projectionCache:A,lineVertexArray:k,labelPlaneMatrix:z,tileAnchorPoint:m,distanceFromAnchor:me,getElevation:G,previousVertex:fe,direction:W,absOffsetX:Ce};if(le=te(K,Fe),o===0)Se.push(fe),Ie=le.sub(fe);else{let ot;const gt=le.sub(fe);ot=gt.mag()===0?de(te(K+W,Fe).sub(le),o,W):de(gt,o,W),pe||(pe=fe.add(ot)),ie=Te(K,ot,le,b,I,pe,o,Fe),Se.push(pe),Ie=ie.sub(pe)}ge=Ie.mag()}const Ze=Ie._mult((Ce-me)/ge)._add(pe||fe),ct=V+Math.atan2(le.y-fe.y,le.x-fe.x);return Se.push(Ze),{point:Ze,angle:F?ct:0,path:Se}}const we=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Je(p,t){for(let o=0;o<p;o++){const u=t.length;t.resize(u+4),t.float32.set(we,3*u)}}function at(p,t,o){const u=t[0],c=t[1];return p[0]=o[0]*u+o[4]*c+o[12],p[1]=o[1]*u+o[5]*c+o[13],p[3]=o[3]*u+o[7]*c+o[15],p}const st=100;class Ct{constructor(t,o=new ft(t.width+200,t.height+200,25),u=new ft(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+st,this.screenBottomBoundary=t.height+st,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,u,c,m,x){const b=this.projectAndGetPerspectiveRatio(c,t.anchorPointX,t.anchorPointY,x),I=u*b.perspectiveRatio,k=t.x1*I+b.point.x,z=t.y1*I+b.point.y,A=t.x2*I+b.point.x,F=t.y2*I+b.point.y;return!this.isInsideGrid(k,z,A,F)||o!=="always"&&this.grid.hitTest(k,z,A,F,o,m)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,z,A,F],offscreen:this.isOffscreen(k,z,A,F)}}placeCollisionCircles(t,o,u,c,m,x,b,I,k,z,A,F,G,Z){const W=[],V=new d.P(o.anchorX,o.anchorY),ie=q(V,x,Z),pe=M(this.transform.cameraToCenterDistance,ie.signedDistanceFromCamera),K=(z?m/pe:m*pe)/d.ao,le=q(V,b,Z).point,fe=$(K,c,o.lineOffsetX*K,o.lineOffsetY*K,!1,le,V,o,u,b,{projections:{},offsets:{}},!1,Z);let me=!1,ge=!1,Ce=!0;if(fe){const Se=.5*F*pe+G,Ie=new d.P(-100,-100),Ze=new d.P(this.screenRightBoundary,this.screenBottomBoundary),ct=new Bi,Fe=fe.first,ot=fe.last;let gt=[];for(let _t=Fe.path.length-1;_t>=1;_t--)gt.push(Fe.path[_t]);for(let _t=1;_t<ot.path.length;_t++)gt.push(ot.path[_t]);const St=2.5*Se;if(I){const _t=gt.map(vt=>q(vt,I,Z));gt=_t.some(vt=>vt.signedDistanceFromCamera<=0)?[]:_t.map(vt=>vt.point)}let lt=[];if(gt.length>0){const _t=gt[0].clone(),vt=gt[0].clone();for(let Jt=1;Jt<gt.length;Jt++)_t.x=Math.min(_t.x,gt[Jt].x),_t.y=Math.min(_t.y,gt[Jt].y),vt.x=Math.max(vt.x,gt[Jt].x),vt.y=Math.max(vt.y,gt[Jt].y);lt=_t.x>=Ie.x&&vt.x<=Ze.x&&_t.y>=Ie.y&&vt.y<=Ze.y?[gt]:vt.x<Ie.x||_t.x>Ze.x||vt.y<Ie.y||_t.y>Ze.y?[]:d.al([gt],Ie.x,Ie.y,Ze.x,Ze.y)}for(const _t of lt){ct.reset(_t,.25*Se);let vt=0;vt=ct.length<=.5*Se?1:Math.ceil(ct.paddedLength/St)+1;for(let Jt=0;Jt<vt;Jt++){const Ut=Jt/Math.max(vt-1,1),cr=ct.lerp(Ut),_i=cr.x+st,Zt=cr.y+st;W.push(_i,Zt,Se,0);const Zi=_i-Se,Jr=Zt-Se,yn=_i+Se,xs=Zt+Se;if(Ce=Ce&&this.isOffscreen(Zi,Jr,yn,xs),ge=ge||this.isInsideGrid(Zi,Jr,yn,xs),t!=="always"&&this.grid.hitTestCircle(_i,Zt,Se,t,A)&&(me=!0,!k))return{circles:[],offscreen:!1,collisionDetected:me}}}}return{circles:!k&&me||!ge||pe<this.perspectiveRatioCutoff?[]:W,offscreen:Ce,collisionDetected:me}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let u=1/0,c=1/0,m=-1/0,x=-1/0;for(const z of t){const A=new d.P(z.x+st,z.y+st);u=Math.min(u,A.x),c=Math.min(c,A.y),m=Math.max(m,A.x),x=Math.max(x,A.y),o.push(A)}const b=this.grid.query(u,c,m,x).concat(this.ignoredGrid.query(u,c,m,x)),I={},k={};for(const z of b){const A=z.key;if(I[A.bucketInstanceId]===void 0&&(I[A.bucketInstanceId]={}),I[A.bucketInstanceId][A.featureIndex])continue;const F=[new d.P(z.x1,z.y1),new d.P(z.x2,z.y1),new d.P(z.x2,z.y2),new d.P(z.x1,z.y2)];d.am(o,F)&&(I[A.bucketInstanceId][A.featureIndex]=!0,k[A.bucketInstanceId]===void 0&&(k[A.bucketInstanceId]=[]),k[A.bucketInstanceId].push(A.featureIndex))}return k}insertCollisionBox(t,o,u,c,m,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:m,collisionGroupID:x,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,u,c,m,x){const b=u?this.ignoredGrid:this.grid,I={bucketInstanceId:c,featureIndex:m,collisionGroupID:x,overlapMode:o};for(let k=0;k<t.length;k+=4)b.insertCircle(I,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,o,u,c){let m;return c?(m=[o,u,c(o,u),1],d.af(m,m,t)):(m=[o,u,0,1],at(m,m,t)),{point:new d.P((m[0]/m[3]+1)/2*this.transform.width+st,(-m[1]/m[3]+1)/2*this.transform.height+st),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}}isOffscreen(t,o,u,c){return u<st||t>=this.screenRightBoundary||c<st||o>this.screenBottomBoundary}isInsideGrid(t,o,u,c){return u>=0&&t<this.gridRightBoundary&&c>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=d.an([]);return d.H(t,t,[-100,-100,0]),t}}function ut(p,t,o){return t*(d.W/(p.tileSize*Math.pow(2,o-p.tileID.overscaledZ)))}class Gt{constructor(t,o,u,c){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):c&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Vt{constructor(t,o,u,c,m){this.text=new Gt(t?t.text:null,o,u,m),this.icon=new Gt(t?t.icon:null,o,c,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ci{constructor(t,o,u){this.text=t,this.icon=o,this.skipFade=u}}class mt{constructor(){this.invProjMatrix=d.F(),this.viewportMatrix=d.F(),this.circles=[]}}class ei{constructor(t,o,u,c,m){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=u,this.bucketIndex=c,this.tileID=m}}class Ai{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:u=>u.collisionGroupID===o}}return this.collisionGroups[t]}}function ar(p,t,o,u,c){const{horizontalAlign:m,verticalAlign:x}=d.at(p);return new d.P(-(m-.5)*t+u[0]*c,-(x-.5)*o+u[1]*c)}function Ui(p,t,o,u,c,m){const{x1:x,x2:b,y1:I,y2:k,anchorPointX:z,anchorPointY:A}=p,F=new d.P(t,o);return u&&F._rotate(c?m:-m),{x1:x+F.x,y1:I+F.y,x2:b+F.x,y2:k+F.y,anchorPointX:z,anchorPointY:A}}class Xi{constructor(t,o,u,c,m){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new Ct(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ai(c),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,o,u,c){const m=u.getBucket(o),x=u.latestFeatureIndex;if(!m||!x||o.id!==m.layerIds[0])return;const b=u.collisionBoxArray,I=m.layers[0].layout,k=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),z=u.tileSize/d.W,A=this.transform.calculatePosMatrix(u.tileID.toUnwrapped()),F=I.get("text-pitch-alignment")==="map",G=I.get("text-rotation-alignment")==="map",Z=ut(u,1,this.transform.zoom),W=Hn(A,F,G,this.transform,Z);let V=null;if(F){const pe=En(A,F,G,this.transform,Z);V=d.K([],this.transform.labelPlaneMatrix,pe)}this.retainedQueryData[m.bucketInstanceId]=new ei(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,u.tileID);const ie={bucket:m,layout:I,posMatrix:A,textLabelPlaneMatrix:W,labelToScreenMatrix:V,scale:k,textPixelRatio:z,holdingForFade:u.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:d.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(c)for(const pe of m.sortKeyRanges){const{sortKey:K,symbolInstanceStart:le,symbolInstanceEnd:fe}=pe;t.push({sortKey:K,symbolInstanceStart:le,symbolInstanceEnd:fe,parameters:ie})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ie})}attemptAnchorPlacement(t,o,u,c,m,x,b,I,k,z,A,F,G,Z,W,V){const ie=d.ap[t.textAnchor],pe=[t.textOffset0,t.textOffset1],K=ar(ie,u,c,pe,m),le=this.collisionIndex.placeCollisionBox(Ui(o,K.x,K.y,x,b,this.transform.angle),A,I,k,z.predicate,V);if((!W||this.collisionIndex.placeCollisionBox(Ui(W,K.x,K.y,x,b,this.transform.angle),A,I,k,z.predicate,V).box.length!==0)&&le.box.length>0){let fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(fe=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:pe,width:u,height:c,anchor:ie,textBoxScale:m,prevAnchor:fe},this.markUsedJustification(G,ie,F,Z),G.allowVerticalPlacement&&(this.markUsedOrientation(G,Z,F),this.placedOrientations[F.crossTileID]=Z),{shift:K,placedGlyphBoxes:le}}}placeLayerBucketPart(t,o,u){const{bucket:c,layout:m,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:I,textPixelRatio:k,holdingForFade:z,collisionBoxArray:A,partiallyEvaluatedTextSize:F,collisionGroup:G}=t.parameters,Z=m.get("text-optional"),W=m.get("icon-optional"),V=d.aq(m,"text-overlap","text-allow-overlap"),ie=V==="always",pe=d.aq(m,"icon-overlap","icon-allow-overlap"),K=pe==="always",le=m.get("text-rotation-alignment")==="map",fe=m.get("text-pitch-alignment")==="map",me=m.get("icon-text-fit")!=="none",ge=m.get("symbol-z-order")==="viewport-y",Ce=ie&&(K||!c.hasIconData()||W),Se=K&&(ie||!c.hasTextData()||Z);!c.collisionArrays&&A&&c.deserializeCollisionBoxes(A);const Ie=this.retainedQueryData[c.bucketInstanceId].tileID,Ze=this.terrain?(Fe,ot)=>this.terrain.getElevation(Ie,Fe,ot):null,ct=(Fe,ot)=>{var gt,St;if(o[Fe.crossTileID])return;if(z)return void(this.placements[Fe.crossTileID]=new ci(!1,!1,!1));let lt=!1,_t=!1,vt=!0,Jt=null,Ut={box:null,offscreen:null},cr={box:null,offscreen:null},_i=null,Zt=null,Zi=null,Jr=0,yn=0,xs=0;ot.textFeatureIndex?Jr=ot.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Jr=Fe.featureIndex),ot.verticalTextFeatureIndex&&(yn=ot.verticalTextFeatureIndex);const ws=ot.textBox;if(ws){const ii=Xt=>{let Di=d.ah.horizontal;if(c.allowVerticalPlacement&&!Xt&&this.prevPlacement){const kr=this.prevPlacement.placedOrientations[Fe.crossTileID];kr&&(this.placedOrientations[Fe.crossTileID]=kr,Di=kr,this.markUsedOrientation(c,Di,Fe))}return Di},Wt=(Xt,Di)=>{if(c.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&ot.verticalTextBox){for(const kr of c.writingModes)if(kr===d.ah.vertical?(Ut=Di(),cr=Ut):Ut=Xt(),Ut&&Ut.box&&Ut.box.length)break}else Ut=Xt()},li=Fe.textAnchorOffsetStartIndex,co=Fe.textAnchorOffsetEndIndex;if(co===li){const Xt=(Di,kr)=>{const bt=this.collisionIndex.placeCollisionBox(Di,V,k,x,G.predicate,Ze);return bt&&bt.box&&bt.box.length&&(this.markUsedOrientation(c,kr,Fe),this.placedOrientations[Fe.crossTileID]=kr),bt};Wt(()=>Xt(ws,d.ah.horizontal),()=>{const Di=ot.verticalTextBox;return c.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&Di?Xt(Di,d.ah.vertical):{box:null,offscreen:null}}),ii(Ut&&Ut.box&&Ut.box.length)}else{let Xt=d.ap[(St=(gt=this.prevPlacement)===null||gt===void 0?void 0:gt.variableOffsets[Fe.crossTileID])===null||St===void 0?void 0:St.anchor];const Di=(bt,Mu,zh)=>{const bs=bt.x2-bt.x1,Ss=bt.y2-bt.y1,tl=Fe.textBoxScale,Du=me&&pe==="never"?Mu:null;let Ts={box:[],offscreen:!1},Ah=V==="never"?1:2,Lu="never";Xt&&Ah++;for(let Mh=0;Mh<Ah;Mh++){for(let aa=li;aa<co;aa++){const Dh=c.textAnchorOffsets.get(aa);if(Xt&&Dh.textAnchor!==Xt)continue;const la=this.attemptAnchorPlacement(Dh,bt,bs,Ss,tl,le,fe,k,x,G,Lu,Fe,c,zh,Du,Ze);if(la&&(Ts=la.placedGlyphBoxes,Ts&&Ts.box&&Ts.box.length))return lt=!0,Jt=la.shift,Ts}Xt?Xt=null:Lu=V}return Ts};Wt(()=>Di(ws,ot.iconBox,d.ah.horizontal),()=>{const bt=ot.verticalTextBox;return c.allowVerticalPlacement&&!(Ut&&Ut.box&&Ut.box.length)&&Fe.numVerticalGlyphVertices>0&&bt?Di(bt,ot.verticalIconBox,d.ah.vertical):{box:null,offscreen:null}}),Ut&&(lt=Ut.box,vt=Ut.offscreen);const kr=ii(Ut&&Ut.box);if(!lt&&this.prevPlacement){const bt=this.prevPlacement.variableOffsets[Fe.crossTileID];bt&&(this.variableOffsets[Fe.crossTileID]=bt,this.markUsedJustification(c,bt.anchor,Fe,kr))}}}if(_i=Ut,lt=_i&&_i.box&&_i.box.length>0,vt=_i&&_i.offscreen,Fe.useRuntimeCollisionCircles){const ii=c.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex),Wt=d.ai(c.textSizeData,F,ii),li=m.get("text-padding");Zt=this.collisionIndex.placeCollisionCircles(V,ii,c.lineVertexArray,c.glyphOffsetArray,Wt,x,b,I,u,fe,G.predicate,Fe.collisionCircleDiameter,li,Ze),Zt.circles.length&&Zt.collisionDetected&&!u&&d.w("Collisions detected, but collision boxes are not shown"),lt=ie||Zt.circles.length>0&&!Zt.collisionDetected,vt=vt&&Zt.offscreen}if(ot.iconFeatureIndex&&(xs=ot.iconFeatureIndex),ot.iconBox){const ii=Wt=>{const li=me&&Jt?Ui(Wt,Jt.x,Jt.y,le,fe,this.transform.angle):Wt;return this.collisionIndex.placeCollisionBox(li,pe,k,x,G.predicate,Ze)};cr&&cr.box&&cr.box.length&&ot.verticalIconBox?(Zi=ii(ot.verticalIconBox),_t=Zi.box.length>0):(Zi=ii(ot.iconBox),_t=Zi.box.length>0),vt=vt&&Zi.offscreen}const _n=Z||Fe.numHorizontalGlyphVertices===0&&Fe.numVerticalGlyphVertices===0,Qr=W||Fe.numIconVertices===0;if(_n||Qr?Qr?_n||(_t=_t&&lt):lt=_t&&lt:_t=lt=_t&&lt,lt&&_i&&_i.box&&this.collisionIndex.insertCollisionBox(_i.box,V,m.get("text-ignore-placement"),c.bucketInstanceId,cr&&cr.box&&yn?yn:Jr,G.ID),_t&&Zi&&this.collisionIndex.insertCollisionBox(Zi.box,pe,m.get("icon-ignore-placement"),c.bucketInstanceId,xs,G.ID),Zt&&(lt&&this.collisionIndex.insertCollisionCircles(Zt.circles,V,m.get("text-ignore-placement"),c.bucketInstanceId,Jr,G.ID),u)){const ii=c.bucketInstanceId;let Wt=this.collisionCircleArrays[ii];Wt===void 0&&(Wt=this.collisionCircleArrays[ii]=new mt);for(let li=0;li<Zt.circles.length;li+=4)Wt.circles.push(Zt.circles[li+0]),Wt.circles.push(Zt.circles[li+1]),Wt.circles.push(Zt.circles[li+2]),Wt.circles.push(Zt.collisionDetected?1:0)}if(Fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(c.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Fe.crossTileID]=new ci(lt||Ce,_t||Se,vt||c.justReloaded),o[Fe.crossTileID]=!0};if(ge){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Fe=c.getSortedSymbolIndexes(this.transform.angle);for(let ot=Fe.length-1;ot>=0;--ot){const gt=Fe[ot];ct(c.symbolInstances.get(gt),c.collisionArrays[gt])}}else for(let Fe=t.symbolInstanceStart;Fe<t.symbolInstanceEnd;Fe++)ct(c.symbolInstances.get(Fe),c.collisionArrays[Fe]);if(u&&c.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[c.bucketInstanceId];d.ar(Fe.invProjMatrix,x),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}c.justReloaded=!1}markUsedJustification(t,o,u,c){let m;m=c===d.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[d.as(o)];const x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const b of x)b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=m>=0&&b!==m?0:u.crossTileID)}markUsedOrientation(t,o,u){const c=o===d.ah.horizontal||o===d.ah.horizontalOnly?o:0,m=o===d.ah.vertical?o:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const b of x)t.text.placedSymbolArray.get(b).placedOrientation=c;u.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let u=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const c=o?o.symbolFadeChange(t):1,m=o?o.opacities:{},x=o?o.variableOffsets:{},b=o?o.placedOrientations:{};for(const I in this.placements){const k=this.placements[I],z=m[I];z?(this.opacities[I]=new Vt(z,c,k.text,k.icon),u=u||k.text!==z.text.placed||k.icon!==z.icon.placed):(this.opacities[I]=new Vt(null,c,k.text,k.icon,k.skipFade),u=u||k.text||k.icon)}for(const I in m){const k=m[I];if(!this.opacities[I]){const z=new Vt(k,c,!1,!1);z.isHidden()||(this.opacities[I]=z,u=u||k.text.placed||k.icon.placed)}}for(const I in x)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=x[I]);for(const I in b)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=b[I]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const u={};for(const c of o){const m=c.getBucket(t);m&&c.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,u,c.collisionBoxArray)}}updateBucketOpacities(t,o,u){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0],m=c.layout,x=new Vt(null,0,!1,!1,!0),b=m.get("text-allow-overlap"),I=m.get("icon-allow-overlap"),k=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=m.get("text-rotation-alignment")==="map",A=m.get("text-pitch-alignment")==="map",F=m.get("icon-text-fit")!=="none",G=new Vt(null,0,b&&(I||!t.hasIconData()||m.get("icon-optional")),I&&(b||!t.hasTextData()||m.get("text-optional")),!0);!t.collisionArrays&&u&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(u);const Z=(W,V,ie)=>{for(let pe=0;pe<V/4;pe++)W.opacityVertexArray.emplaceBack(ie);W.hasVisibleVertices=W.hasVisibleVertices||ie!==$i};for(let W=0;W<t.symbolInstances.length;W++){const V=t.symbolInstances.get(W),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:pe,crossTileID:K}=V;let le=this.opacities[K];o[K]?le=x:le||(le=G,this.opacities[K]=le),o[K]=!0;const fe=V.numIconVertices>0,me=this.placedOrientations[V.crossTileID],ge=me===d.ah.vertical,Ce=me===d.ah.horizontal||me===d.ah.horizontalOnly;if(ie>0||pe>0){const Se=Hc(le.text);Z(t.text,ie,ge?$i:Se),Z(t.text,pe,Ce?$i:Se);const Ie=le.text.isHidden();[V.rightJustifiedTextSymbolIndex,V.centerJustifiedTextSymbolIndex,V.leftJustifiedTextSymbolIndex].forEach(Fe=>{Fe>=0&&(t.text.placedSymbolArray.get(Fe).hidden=Ie||ge?1:0)}),V.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(V.verticalPlacedTextSymbolIndex).hidden=Ie||Ce?1:0);const Ze=this.variableOffsets[V.crossTileID];Ze&&this.markUsedJustification(t,Ze.anchor,V,me);const ct=this.placedOrientations[V.crossTileID];ct&&(this.markUsedJustification(t,"left",V,ct),this.markUsedOrientation(t,ct,V))}if(fe){const Se=Hc(le.icon),Ie=!(F&&V.verticalPlacedIconSymbolIndex&&ge);V.placedIconSymbolIndex>=0&&(Z(t.icon,V.numIconVertices,Ie?Se:$i),t.icon.placedSymbolArray.get(V.placedIconSymbolIndex).hidden=le.icon.isHidden()),V.verticalPlacedIconSymbolIndex>=0&&(Z(t.icon,V.numVerticalIconVertices,Ie?$i:Se),t.icon.placedSymbolArray.get(V.verticalPlacedIconSymbolIndex).hidden=le.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Se=t.collisionArrays[W];if(Se){let Ie=new d.P(0,0);if(Se.textBox||Se.verticalTextBox){let ct=!0;if(k){const Fe=this.variableOffsets[K];Fe?(Ie=ar(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textBoxScale),z&&Ie._rotate(A?this.transform.angle:-this.transform.angle)):ct=!1}Se.textBox&&br(t.textCollisionBox.collisionVertexArray,le.text.placed,!ct||ge,Ie.x,Ie.y),Se.verticalTextBox&&br(t.textCollisionBox.collisionVertexArray,le.text.placed,!ct||Ce,Ie.x,Ie.y)}const Ze=!!(!Ce&&Se.verticalIconBox);Se.iconBox&&br(t.iconCollisionBox.collisionVertexArray,le.icon.placed,Ze,F?Ie.x:0,F?Ie.y:0),Se.verticalIconBox&&br(t.iconCollisionBox.collisionVertexArray,le.icon.placed,!Ze,F?Ie.x:0,F?Ie.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const W=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=W.invProjMatrix,t.placementViewportMatrix=W.viewportMatrix,t.collisionCircleArray=W.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const u=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*u>t}setStale(){this.stale=!0}}function br(p,t,o,u,c){p.emplaceBack(t?1:0,o?1:0,u||0,c||0),p.emplaceBack(t?1:0,o?1:0,u||0,c||0),p.emplaceBack(t?1:0,o?1:0,u||0,c||0),p.emplaceBack(t?1:0,o?1:0,u||0,c||0)}const Gc=Math.pow(2,25),Ip=Math.pow(2,24),Ft=Math.pow(2,17),$l=Math.pow(2,16),Zl=Math.pow(2,9),Sr=Math.pow(2,8),Tr=Math.pow(2,1);function Hc(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const t=p.placed?1:0,o=Math.floor(127*p.opacity);return o*Gc+t*Ip+o*Ft+t*$l+o*Zl+t*Sr+o*Tr+t}const $i=0;class Or{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,u,c,m){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(x,c,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,I)=>b.sortKey-I.sortKey));this._currentPartIndex<x.length;)if(o.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,m())return!0;return!1}}class Wc{constructor(t,o,u,c,m,x,b,I){this.placement=new Xi(t,o,x,b,I),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,o,u){const c=X.now(),m=()=>!this._forceFullPlacement&&X.now()-c>2;for(;this._currentPlacementIndex>=0;){const x=o[t[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new Or(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Wn=512/d.W/2;class yi{constructor(t,o,u){this.tileID=t,this.bucketInstanceId=u,this._symbolsByKey={};const c=new Map;for(let m=0;m<o.length;m++){const x=o.get(m),b=x.key,I=c.get(b);I?I.push(x):c.set(b,[x])}for(const[m,x]of c){const b={positions:x.map(I=>({x:Math.floor(I.anchorX*Wn),y:Math.floor(I.anchorY*Wn)})),crossTileIDs:x.map(I=>I.crossTileID)};if(b.positions.length>128){const I=new d.au(b.positions.length,16,Uint16Array);for(const{x:k,y:z}of b.positions)I.add(k,z);I.finish(),delete b.positions,b.index=I}this._symbolsByKey[m]=b}}getScaledCoordinates(t,o){const{x:u,y:c,z:m}=this.tileID.canonical,{x,y:b,z:I}=o.canonical,k=Wn/Math.pow(2,I-m),z=(b*d.W+t.anchorY)*k,A=c*d.W*Wn;return{x:Math.floor((x*d.W+t.anchorX)*k-u*d.W*Wn),y:Math.floor(z-A)}}findMatches(t,o,u){const c=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<t.length;m++){const x=t.get(m);if(x.crossTileID)continue;const b=this._symbolsByKey[x.key];if(!b)continue;const I=this.getScaledCoordinates(x,o);if(b.index){const k=b.index.range(I.x-c,I.y-c,I.x+c,I.y+c).sort();for(const z of k){const A=b.crossTileIDs[z];if(!u[A]){u[A]=!0,x.crossTileID=A;break}}}else if(b.positions)for(let k=0;k<b.positions.length;k++){const z=b.positions[k],A=b.crossTileIDs[k];if(Math.abs(z.x-I.x)<=c&&Math.abs(z.y-I.y)<=c&&!u[A]){u[A]=!0,x.crossTileID=A;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Zo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class cs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const u in this.indexes){const c=this.indexes[u],m={};for(const x in c){const b=c[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+o),m[b.tileID.key]=b}this.indexes[u]=m}this.lng=t}addBucket(t,o,u){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const c=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const x=this.indexes[m];if(Number(m)>t.overscaledZ)for(const b in x){const I=x[b];I.tileID.isChildOf(t)&&I.findMatches(o.symbolInstances,t,c)}else{const b=x[t.scaledTo(Number(m)).key];b&&b.findMatches(o.symbolInstances,t,c)}}for(let m=0;m<o.symbolInstances.length;m++){const x=o.symbolInstances.get(m);x.crossTileID||(x.crossTileID=u.generate(),c[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new yi(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const u of o.getCrossTileIDsLists())for(const c of u)delete this.usedCrossTileIDs[t][c]}removeStaleBuckets(t){let o=!1;for(const u in this.indexes){const c=this.indexes[u];for(const m in c)t[c[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,c[m]),delete c[m],o=!0)}return o}}class oi{constructor(){this.layerIndexes={},this.crossTileIDs=new Zo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,u){let c=this.layerIndexes[t.id];c===void 0&&(c=this.layerIndexes[t.id]=new cs);let m=!1;const x={};c.handleWrapJump(u);for(const b of o){const I=b.getBucket(t);I&&t.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(b.tileID,I,this.crossTileIDs)&&(m=!0),x[I.bucketInstanceId]=!0)}return c.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(t){const o={};t.forEach(u=>{o[u]=!0});for(const u in this.layerIndexes)o[u]||delete this.layerIndexes[u]}}const hs=(p,t)=>d.t(p,t&&t.filter(o=>o.identifier!=="source.canvas")),Kr=d.av();class Ea extends d.E{constructor(t,o={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const c=this.sourceCaches[u].getSource().type;c!=="vector"&&c!=="geojson"||this.sourceCaches[u].reload()}},this.map=t,this.dispatcher=new Vs(Wr(),t._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(u,c)=>this.getGlyphs(u,c)),this.dispatcher.registerMessageHandler("getImages",(u,c)=>this.getImages(u,c)),this.imageManager=new sr,this.imageManager.setEventedParent(this),this.glyphManager=new Ge(t._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Mt(256,512),this.crossTileSymbolIndex=new oi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",d.ax()),wr().on(Zs,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const c=this.sourceCaches[u.sourceId];if(!c)return;const m=c.getSource();if(m&&m.vectorLayerIds)for(const x in this._layers){const b=this._layers[x];b.source===m.id&&this._validateLayer(b)}})}loadURL(t,o={},u){this.fire(new d.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const c=this.map._requestManager.transformRequest(t,ve.Style);this._loadStyleRequest=new AbortController,d.h(c,this._loadStyleRequest).then(m=>{this._loadStyleRequest=null,this._load(m.data,o,u)}).catch(m=>{this._loadStyleRequest=null,m&&this.fire(new d.j(m))})}loadJSON(t,o={},u){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,X.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,u)}).catch(()=>{})}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Kr,{validate:!1})}_load(t,o,u){var c;const m=o.transformStyle?o.transformStyle(u,t):t;if(!o.validate||!hs(this,d.x(m))){this._loaded=!0,this.stylesheet=m;for(const x in m.sources)this.addSource(x,m.sources[x],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new Et(this.stylesheet.light),this.map.setTerrain((c=this.stylesheet.terrain)!==null&&c!==void 0?c:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const t=d.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of t){const u=d.az(o);u.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=u}}_loadSprite(t,o=!1,u=void 0){let c;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,x,b,I){return d._(this,void 0,void 0,function*(){const k=Ot(m),z=b>1?"@2x":"",A={},F={};for(const{id:G,url:Z}of k){const W=x.transformRequest(x.normalizeSpriteURL(Z,z,".json"),ve.SpriteJSON);A[G]=d.h(W,I);const V=x.transformRequest(x.normalizeSpriteURL(Z,z,".png"),ve.SpriteImage);F[G]=oe.getImage(V,I)}return yield Promise.all([...Object.values(A),...Object.values(F)]),function(G,Z){return d._(this,void 0,void 0,function*(){const W={};for(const V in G){W[V]={};const ie=X.getImageCanvasContext((yield Z[V]).data),pe=(yield G[V]).data;for(const K in pe){const{width:le,height:fe,x:me,y:ge,sdf:Ce,pixelRatio:Se,stretchX:Ie,stretchY:Ze,content:ct}=pe[K];W[V][K]={data:null,pixelRatio:Se,sdf:Ce,stretchX:Ie,stretchY:Ze,content:ct,spriteData:{width:le,height:fe,x:me,y:ge,context:ie}}}}return W})}(A,F)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const x in m){this._spritesImagesIds[x]=[];const b=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(I=>!(I in m)):[];for(const I of b)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in m[x]){const k=x==="default"?I:`${x}:${I}`;this._spritesImagesIds[x].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,m[x][I],!1):this.imageManager.addImage(k,m[x][I]),o&&(this._changedImages[k]=!0)}}}).catch(m=>{this._spriteRequest=null,c=m,this.fire(new d.j(c))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),u&&u(c)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(t){const o=this.sourceCaches[t.source];if(!o)return;const u=t.sourceLayer;if(!u)return;const c=o.getSource();(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(u)===-1)&&this.fire(new d.j(new Error(`Source layer "${u}" does not exist on source "${c.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const o=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o);const u=[];for(const c of t)o[c]&&u.push(o[c]);return u}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const u of o){const c=this._layers[u];c.type!=="custom"&&(t[u]=c.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(this._changed){const c=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(c.length||m.length)&&this._updateWorkerLayers(c,m);for(const x in this._updatedSources){const b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const u={};for(const c in this.sourceCaches){const m=this.sourceCaches[c];u[c]=m.used,m.used=!1}for(const c of this._order){const m=this._layers[c];m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const c in u){const m=this.sourceCaches[c];u[c]!==m.used&&m.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:c}))}this.light.recalculate(t),this.z=t.zoom,o&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var u;this._checkLoaded();const c=this.serialize();if(t=o.transformStyle?o.transformStyle(c,t):t,((u=o.validate)===null||u===void 0||u)&&hs(this,d.x(t)))return!1;(t=d.aA(t)).layers=d.ay(t.layers);const m=d.aB(c,t),x=this._getOperationsToPerform(m);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const b of x.operations)b();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],u=[];for(const c of t)switch(c.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,c.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,c.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,c.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,c.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,c.args));break;case"addSource":o.push(()=>this.addSource.apply(this,c.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,c.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,c.args));break;case"setLight":o.push(()=>this.setLight.apply(this,c.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,c.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,c.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,c.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,c.args));break;case"setTransition":o.push(()=>{});break;default:u.push(c.command)}return{operations:o,unimplemented:u}}addImage(t,o){if(this.getImage(t))return this.fire(new d.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new d.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,u={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(d.x.source,`sources.${t}`,o,null,u))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const c=this.sourceCaches[t]=new Me(t,o,this.dispatcher);c.style=this,c.setEventedParent(this,()=>({isSourceLoaded:c.loaded(),source:c.serialize(),sourceId:t})),c.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new d.j(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));const o=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],o.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const u=this.sourceCaches[t].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(o),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,o,u={}){this._checkLoaded();const c=t.id;if(this.getLayer(c))return void this.fire(new d.j(new Error(`Layer "${c}" already exists on this map.`)));let m;if(t.type==="custom"){if(hs(this,d.aC(t)))return;m=d.az(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(c,t.source),t=d.aA(t),t=d.e(t,{source:c})),this._validate(d.x.layer,`layers.${c}`,t,{arrayIndex:-1},u))return;m=d.az(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:c}})}const x=o?this._order.indexOf(o):this._order.length;if(o&&x===-1)this.fire(new d.j(new Error(`Cannot add layer "${c}" before non-existing layer "${o}".`)));else{if(this._order.splice(x,0,c),this._layerOrderChanged=!0,this._layers[c]=m,this._removedLayers[c]&&m.source&&m.type!=="custom"){const b=this._removedLayers[c];delete this._removedLayers[c],b.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new d.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const u=this._order.indexOf(t);this._order.splice(u,1);const c=o?this._order.indexOf(o):this._order.length;o&&c===-1?this.fire(new d.j(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(c,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const u=this._order.indexOf(t);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,u){this._checkLoaded();const c=this.getLayer(t);c?c.minzoom===o&&c.maxzoom===u||(o!=null&&(c.minzoom=o),u!=null&&(c.maxzoom=u),this._updateLayer(c)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,u={}){this._checkLoaded();const c=this.getLayer(t);if(c){if(!d.aD(c.filter,o))return o==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(d.x.filter,`layers.${c.id}.filter`,o,null,u)||(c.filter=d.aA(o),this._updateLayer(c)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return d.aA(this.getLayer(t).filter)}setLayoutProperty(t,o,u,c={}){this._checkLoaded();const m=this.getLayer(t);m?d.aD(m.getLayoutProperty(o),u)||(m.setLayoutProperty(o,u,c),this._updateLayer(m)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const u=this.getLayer(t);if(u)return u.getLayoutProperty(o);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,u,c={}){this._checkLoaded();const m=this.getLayer(t);m?d.aD(m.getPaintProperty(o),u)||(m.setPaintProperty(o,u,c)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new d.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const u=t.source,c=t.sourceLayer,m=this.sourceCaches[u];if(m===void 0)return void this.fire(new d.j(new Error(`The source '${u}' does not exist in the map's style.`)));const x=m.getSource().type;x==="geojson"&&c?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||c?(t.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(c,t.id,o)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const u=t.source,c=this.sourceCaches[u];if(c===void 0)return void this.fire(new d.j(new Error(`The source '${u}' does not exist in the map's style.`)));const m=c.getSource().type,x=m==="vector"?t.sourceLayer:void 0;m!=="vector"||x?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):c.removeFeatureState(x,t.id,o):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,u=t.sourceLayer,c=this.sourceCaches[o];if(c!==void 0)return c.getSource().type!=="vector"||u?(t.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),c.getFeatureState(u,t.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=d.aE(this.sourceCaches,m=>m.serialize()),o=this._serializeByIds(this._order),u=this.map.getTerrain()||void 0,c=this.stylesheet;return d.aF({version:c.version,name:c.name,metadata:c.metadata,light:c.light,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,sources:t,layers:o,terrain:u},m=>m!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=x=>this._layers[x].type==="fill-extrusion",u={},c=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(o(b)){u[b]=x;for(const I of t){const k=I[b];if(k)for(const z of k)c.push(z)}}}c.sort((x,b)=>b.intersectionZ-x.intersectionZ);const m=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(o(b))for(let I=c.length-1;I>=0;I--){const k=c[I].feature;if(u[k.layer.id]<x)break;m.push(k),c.pop()}else for(const I of t){const k=I[b];if(k)for(const z of k)m.push(z.feature)}}return m}queryRenderedFeatures(t,o,u){o&&o.filter&&this._validate(d.x.filter,"queryRenderedFeatures.filter",o.filter,null,o);const c={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const b of o.layers){const I=this._layers[b];if(!I)return this.fire(new d.j(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];c[I.source]=!0}}const m=[];o.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const b in this.sourceCaches)o.layers&&!c[b]||m.push(Zn(this.sourceCaches[b],this._layers,x,t,o,u));return this.placement&&m.push(function(b,I,k,z,A,F,G){const Z={},W=F.queryRenderedSymbols(z),V=[];for(const ie of Object.keys(W).map(Number))V.push(G[ie]);V.sort(qn);for(const ie of V){const pe=ie.featureIndex.lookupSymbolFeatures(W[ie.bucketInstanceId],I,ie.bucketIndex,ie.sourceLayerIndex,A.filter,A.layers,A.availableImages,b);for(const K in pe){const le=Z[K]=Z[K]||[],fe=pe[K];fe.sort((me,ge)=>{const Ce=ie.featureSortOrder;if(Ce){const Se=Ce.indexOf(me.featureIndex);return Ce.indexOf(ge.featureIndex)-Se}return ge.featureIndex-me.featureIndex});for(const me of fe)le.push(me)}}for(const ie in Z)Z[ie].forEach(pe=>{const K=pe.feature,le=k[b[ie].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=le});return Z}(this._layers,x,this.sourceCaches,t,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,o){o&&o.filter&&this._validate(d.x.filter,"querySourceFeatures.filter",o.filter,null,o);const u=this.sourceCaches[t];return u?function(c,m){const x=c.getRenderableIds().map(k=>c.getTileByID(k)),b=[],I={};for(let k=0;k<x.length;k++){const z=x[k],A=z.tileID.canonical.key;I[A]||(I[A]=!0,z.querySourceFeatures(b,m))}return b}(u,o):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const u=this.light.getLight();let c=!1;for(const x in t)if(!d.aD(t[x],u[x])){c=!0;break}if(!c)return;const m={now:X.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(m)}_validate(t,o,u,c,m={}){return(!m||m.validate!==!1)&&hs(this,t.call(d.x,d.e({key:o,style:this.serialize(),value:u,styleSpec:d.v},c)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),wr().off(Zs,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const u=this.sourceCaches[o];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const o in this.sourceCaches)this.sourceCaches[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,o,u,c,m=!1){let x=!1,b=!1;const I={};for(const k of this._order){const z=this._layers[k];if(z.type!=="symbol")continue;if(!I[z.source]){const F=this.sourceCaches[z.source];I[z.source]=F.getRenderableIds(!0).map(G=>F.getTileByID(G)).sort((G,Z)=>Z.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(Z.tileID)?-1:1))}const A=this.crossTileSymbolIndex.addLayer(z,I[z.source],t.center.lng);x=x||A}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(X.now(),t.zoom))&&(this.pauseablePlacement=new Wc(t,this.map.terrain,this._order,m,o,u,c,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(X.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(const k of this._order){const z=this._layers[k];z.type==="symbol"&&this.placement.updateLayerOpacities(z,I[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(X.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o){return d._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const c=this.sourceCaches[o.source];return c&&c.setDependencies(o.tileID.key,o.type,o.icons),u})}getGlyphs(t,o){return d._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(o.stacks),c=this.sourceCaches[o.source];return c&&c.setDependencies(o.tileID.key,o.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(d.x.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,o,u={},c){this._checkLoaded();const m=[{id:t,url:o}],x=[...Ot(this.stylesheet.sprite),...m];this._validate(d.x.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,c))}removeSprite(t){this._checkLoaded();const o=Ot(this.stylesheet.sprite);if(o.find(u=>u.id===t)){if(this._spritesImagesIds[t])for(const u of this._spritesImagesIds[t])this.imageManager.removeImage(u),this._changedImages[u]=!0;o.splice(o.findIndex(u=>u.id===t),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ot(this.stylesheet.sprite)}setSprite(t,o={},u){this._checkLoaded(),t&&this._validate(d.x.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,u):(this._unloadSprite(),u&&u(null)))}}var pn=d.X([{name:"a_pos",type:"Int16",components:2}]),ql="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const qs={prelude:Lt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Lt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Lt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Lt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Lt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Lt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Lt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Lt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Lt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Lt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Lt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Lt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Lt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Lt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Lt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Lt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Lt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Lt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Lt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Lt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Lt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Lt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Lt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Lt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ql),terrainDepth:Lt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ql),terrainCoords:Lt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ql)};function Lt(p,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=t.match(/attribute ([\w]+) ([\w]+)/g),c=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(c):c,b={};return{fragmentSource:p=p.replace(o,(I,k,z,A,F)=>(b[F]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${z} ${A} ${F};
#else
uniform ${z} ${A} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${z} ${A} ${F} = u_${F};
#endif
`)),vertexSource:t=t.replace(o,(I,k,z,A,F)=>{const G=A==="float"?"vec2":"vec4",Z=F.match(/color/)?"color":G;return b[F]?k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${z} ${G} a_${F};
varying ${z} ${A} ${F};
#else
uniform ${z} ${A} u_${F};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${z} ${A} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${Z}(a_${F}, u_${F}_t);
#else
    ${z} ${A} ${F} = u_${F};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${z} ${G} a_${F};
#else
uniform ${z} ${A} u_${F};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${z} ${A} ${F} = a_${F};
#else
    ${z} ${A} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${z} ${A} ${F} = unpack_mix_${Z}(a_${F}, u_${F}_t);
#else
    ${z} ${A} ${F} = u_${F};
#endif
`}),staticAttributes:u,staticUniforms:x}}class Pa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,u,c,m,x,b,I,k){this.context=t;let z=this.boundPaintVertexBuffers.length!==c.length;for(let A=0;!z&&A<c.length;A++)this.boundPaintVertexBuffers[A]!==c[A]&&(z=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==u||z||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==k?this.freshBind(o,u,c,m,x,b,I,k):(t.bindVertexArray.set(this.vao),b&&b.bind(),m&&m.dynamicDraw&&m.bind(),I&&I.bind(),k&&k.bind())}freshBind(t,o,u,c,m,x,b,I){const k=t.numAttributes,z=this.context,A=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=c,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=I,o.enableAttributes(A,t);for(const F of u)F.enableAttributes(A,t);x&&x.enableAttributes(A,t),b&&b.enableAttributes(A,t),I&&I.enableAttributes(A,t),o.bind(),o.setVertexAttribPointers(A,t,m);for(const F of u)F.bind(),F.setVertexAttribPointers(A,t,m);x&&(x.bind(),x.setVertexAttribPointers(A,t,m)),c&&c.bind(),b&&(b.bind(),b.setVertexAttribPointers(A,t,m)),I&&(I.bind(),I.setVertexAttribPointers(A,t,m)),z.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function fn(p){const t=[];for(let o=0;o<p.length;o++){if(p[o]===null)continue;const u=p[o].split(" ");t.push(u.pop())}return t}class Gl{constructor(t,o,u,c,m,x){const b=t.gl;this.program=b.createProgram();const I=fn(o.staticAttributes),k=u?u.getBinderAttributes():[],z=I.concat(k),A=qs.prelude.staticUniforms?fn(qs.prelude.staticUniforms):[],F=o.staticUniforms?fn(o.staticUniforms):[],G=u?u.getBinderUniforms():[],Z=A.concat(F).concat(G),W=[];for(const me of Z)W.indexOf(me)<0&&W.push(me);const V=u?u.defines():[];m&&V.push("#define OVERDRAW_INSPECTOR;"),x&&V.push("#define TERRAIN3D;");const ie=V.concat(qs.prelude.fragmentSource,o.fragmentSource).join(`
`),pe=V.concat(qs.prelude.vertexSource,o.vertexSource).join(`
`),K=b.createShader(b.FRAGMENT_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(K,ie),b.compileShader(K),!b.getShaderParameter(K,b.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${b.getShaderInfoLog(K)}`);b.attachShader(this.program,K);const le=b.createShader(b.VERTEX_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(le,pe),b.compileShader(le),!b.getShaderParameter(le,b.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${b.getShaderInfoLog(le)}`);b.attachShader(this.program,le),this.attributes={};const fe={};this.numAttributes=z.length;for(let me=0;me<this.numAttributes;me++)z[me]&&(b.bindAttribLocation(this.program,me,z[me]),this.attributes[z[me]]=me);if(b.linkProgram(this.program),!b.getProgramParameter(this.program,b.LINK_STATUS))throw new Error(`Program failed to link: ${b.getProgramInfoLog(this.program)}`);b.deleteShader(le),b.deleteShader(K);for(let me=0;me<W.length;me++){const ge=W[me];if(ge&&!fe[ge]){const Ce=b.getUniformLocation(this.program,ge);Ce&&(fe[ge]=Ce)}}this.fixedUniforms=c(t,fe),this.terrainUniforms=((me,ge)=>({u_depth:new d.aG(me,ge.u_depth),u_terrain:new d.aG(me,ge.u_terrain),u_terrain_dim:new d.aH(me,ge.u_terrain_dim),u_terrain_matrix:new d.aI(me,ge.u_terrain_matrix),u_terrain_unpack:new d.aJ(me,ge.u_terrain_unpack),u_terrain_exaggeration:new d.aH(me,ge.u_terrain_exaggeration)}))(t,fe),this.binderUniforms=u?u.getUniforms(t,fe):[]}draw(t,o,u,c,m,x,b,I,k,z,A,F,G,Z,W,V,ie,pe){const K=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(u),t.setStencilMode(c),t.setColorMode(m),t.setCullFace(x),I){t.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,I.depthTexture),t.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,I.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(I[fe])}for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(b[fe]);W&&W.setUniforms(t,this.binderUniforms,G,{zoom:Z});let le=0;switch(o){case K.LINES:le=2;break;case K.TRIANGLES:le=3;break;case K.LINE_STRIP:le=1}for(const fe of F.get()){const me=fe.vaos||(fe.vaos={});(me[k]||(me[k]=new Pa)).bind(t,this,z,W?W.getPaintVertexBuffers():[],A,fe.vertexOffset,V,ie,pe),K.drawElements(o,fe.primitiveLength*le,K.UNSIGNED_SHORT,fe.primitiveOffset*le*2)}}}function qo(p,t,o){const u=1/ut(o,1,t.transform.tileZoom),c=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,t.transform.tileZoom)/c,x=m*(o.tileID.canonical.x+o.tileID.wrap*c),b=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const Kc=(p,t,o,u)=>{const c=t.style.light,m=c.properties.get("position"),x=[m.x,m.y,m.z],b=function(){var k=new d.A(9);return d.A!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();c.properties.get("anchor")==="viewport"&&function(k,z){var A=Math.sin(z),F=Math.cos(z);k[0]=F,k[1]=A,k[2]=0,k[3]=-A,k[4]=F,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(b,-t.transform.angle),function(k,z,A){var F=z[0],G=z[1],Z=z[2];k[0]=F*A[0]+G*A[3]+Z*A[6],k[1]=F*A[1]+G*A[4]+Z*A[7],k[2]=F*A[2]+G*A[5]+Z*A[8]}(x,x,b);const I=c.properties.get("color");return{u_matrix:p,u_lightpos:x,u_lightintensity:c.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+o,u_opacity:u}},Cp=(p,t,o,u,c,m,x)=>d.e(Kc(p,t,o,u),qo(m,t,x),{u_height_factor:-Math.pow(2,c.overscaledZ)/x.tileSize/8}),za=p=>({u_matrix:p}),Xc=(p,t,o,u)=>d.e(za(p),qo(o,t,u)),Yc=(p,t)=>({u_matrix:p,u_world:t}),kp=(p,t,o,u,c)=>d.e(Xc(p,t,o,u),{u_world:c}),Jc=(p,t,o,u)=>{const c=p.transform;let m,x;if(u.paint.get("circle-pitch-alignment")==="map"){const b=ut(o,1,c.zoom);m=!0,x=[b,b]}else m=!1,x=c.pixelsToGLUnits;return{u_camera_to_center_distance:c.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(t.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:x}},Ep=(p,t,o)=>{const u=ut(o,1,t.zoom),c=Math.pow(2,t.zoom-o.tileID.overscaledZ),m=o.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[t.pixelsToGLUnits[0]/(u*c),t.pixelsToGLUnits[1]/(u*c)],u_overscale_factor:m}},Aa=(p,t,o=1)=>({u_matrix:p,u_color:t,u_overlay:0,u_overlay_scale:o}),Hl=p=>({u_matrix:p}),Qc=(p,t,o,u)=>({u_matrix:p,u_extrude_scale:ut(t,1,o),u_intensity:u});function eh(p,t){const o=Math.pow(2,t.canonical.z),u=t.canonical.y;return[new d.Y(0,u/o).toLngLat().lat,new d.Y(0,(u+1)/o).toLngLat().lat]}const Ma=(p,t,o,u)=>{const c=p.transform;return{u_matrix:Ho(p,t,o,u),u_ratio:1/ut(t,1,c.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},ds=(p,t,o,u,c)=>d.e(Ma(p,t,o,c),{u_image:0,u_image_height:u}),Da=(p,t,o,u,c)=>{const m=p.transform,x=Go(t,m);return{u_matrix:Ho(p,t,o,c),u_texsize:t.imageAtlasTexture.size,u_ratio:1/ut(t,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Nr=(p,t,o,u,c,m)=>{const x=p.lineAtlas,b=Go(t,p.transform),I=o.layout.get("line-cap")==="round",k=x.getDash(u.from,I),z=x.getDash(u.to,I),A=k.width*c.fromScale,F=z.width*c.toScale;return d.e(Ma(p,t,o,m),{u_patternscale_a:[b/A,-k.height/2],u_patternscale_b:[b/F,-z.height/2],u_sdfgamma:x.width/(256*Math.min(A,F)*p.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:z.y,u_mix:c.t})};function Go(p,t){return 1/ut(p,1,t.tileZoom)}function Ho(p,t,o,u){return p.translatePosMatrix(u?u.posMatrix:t.tileID.posMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Wo=(p,t,o,u,c)=>{return{u_matrix:p,u_tl_parent:t,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(x=c.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=c.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:La(c.paint.get("raster-hue-rotate"))};var m,x};function La(p){p*=Math.PI/180;const t=Math.sin(p),o=Math.cos(p);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const Ko=(p,t,o,u,c,m,x,b,I,k)=>{const z=c.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:z.cameraToCenterDistance,u_pitch:z.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:z.width/z.height,u_fade_change:c.options.fadeDuration?c.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:x,u_coord_matrix:b,u_is_text:+I,u_pitch_with_map:+u,u_texsize:k,u_texture:0}},Gs=(p,t,o,u,c,m,x,b,I,k,z)=>{const A=c.transform;return d.e(Ko(p,t,o,u,c,m,x,b,I,k),{u_gamma_scale:u?Math.cos(A._pitch)*A.cameraToCenterDistance:1,u_device_pixel_ratio:c.pixelRatio,u_is_halo:+z})},Pp=(p,t,o,u,c,m,x,b,I,k)=>d.e(Gs(p,t,o,u,c,m,x,b,!0,I,!0),{u_texsize_icon:k,u_texture_icon:1}),zp=(p,t,o)=>({u_matrix:p,u_opacity:t,u_color:o}),th=(p,t,o,u,c,m)=>d.e(function(x,b,I,k){const z=I.imageManager.getPattern(x.from.toString()),A=I.imageManager.getPattern(x.to.toString()),{width:F,height:G}=I.imageManager.getPixelSize(),Z=Math.pow(2,k.tileID.overscaledZ),W=k.tileSize*Math.pow(2,I.transform.tileZoom)/Z,V=W*(k.tileID.canonical.x+k.tileID.wrap*Z),ie=W*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:A.tl,u_pattern_br_b:A.br,u_texsize:[F,G],u_mix:b.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:A.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/ut(k,1,I.transform.tileZoom),u_pixel_coord_upper:[V>>16,ie>>16],u_pixel_coord_lower:[65535&V,65535&ie]}}(u,m,o,c),{u_matrix:p,u_opacity:t}),Ap={fillExtrusion:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_lightpos:new d.aK(p,t.u_lightpos),u_lightintensity:new d.aH(p,t.u_lightintensity),u_lightcolor:new d.aK(p,t.u_lightcolor),u_vertical_gradient:new d.aH(p,t.u_vertical_gradient),u_opacity:new d.aH(p,t.u_opacity)}),fillExtrusionPattern:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_lightpos:new d.aK(p,t.u_lightpos),u_lightintensity:new d.aH(p,t.u_lightintensity),u_lightcolor:new d.aK(p,t.u_lightcolor),u_vertical_gradient:new d.aH(p,t.u_vertical_gradient),u_height_factor:new d.aH(p,t.u_height_factor),u_image:new d.aG(p,t.u_image),u_texsize:new d.aL(p,t.u_texsize),u_pixel_coord_upper:new d.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new d.aL(p,t.u_pixel_coord_lower),u_scale:new d.aK(p,t.u_scale),u_fade:new d.aH(p,t.u_fade),u_opacity:new d.aH(p,t.u_opacity)}),fill:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix)}),fillPattern:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_image:new d.aG(p,t.u_image),u_texsize:new d.aL(p,t.u_texsize),u_pixel_coord_upper:new d.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new d.aL(p,t.u_pixel_coord_lower),u_scale:new d.aK(p,t.u_scale),u_fade:new d.aH(p,t.u_fade)}),fillOutline:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_world:new d.aL(p,t.u_world)}),fillOutlinePattern:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_world:new d.aL(p,t.u_world),u_image:new d.aG(p,t.u_image),u_texsize:new d.aL(p,t.u_texsize),u_pixel_coord_upper:new d.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new d.aL(p,t.u_pixel_coord_lower),u_scale:new d.aK(p,t.u_scale),u_fade:new d.aH(p,t.u_fade)}),circle:(p,t)=>({u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_scale_with_map:new d.aG(p,t.u_scale_with_map),u_pitch_with_map:new d.aG(p,t.u_pitch_with_map),u_extrude_scale:new d.aL(p,t.u_extrude_scale),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_matrix:new d.aI(p,t.u_matrix)}),collisionBox:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_pixels_to_tile_units:new d.aH(p,t.u_pixels_to_tile_units),u_extrude_scale:new d.aL(p,t.u_extrude_scale),u_overscale_factor:new d.aH(p,t.u_overscale_factor)}),collisionCircle:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_inv_matrix:new d.aI(p,t.u_inv_matrix),u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_viewport_size:new d.aL(p,t.u_viewport_size)}),debug:(p,t)=>({u_color:new d.aM(p,t.u_color),u_matrix:new d.aI(p,t.u_matrix),u_overlay:new d.aG(p,t.u_overlay),u_overlay_scale:new d.aH(p,t.u_overlay_scale)}),clippingMask:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix)}),heatmap:(p,t)=>({u_extrude_scale:new d.aH(p,t.u_extrude_scale),u_intensity:new d.aH(p,t.u_intensity),u_matrix:new d.aI(p,t.u_matrix)}),heatmapTexture:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_world:new d.aL(p,t.u_world),u_image:new d.aG(p,t.u_image),u_color_ramp:new d.aG(p,t.u_color_ramp),u_opacity:new d.aH(p,t.u_opacity)}),hillshade:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_image:new d.aG(p,t.u_image),u_latrange:new d.aL(p,t.u_latrange),u_light:new d.aL(p,t.u_light),u_shadow:new d.aM(p,t.u_shadow),u_highlight:new d.aM(p,t.u_highlight),u_accent:new d.aM(p,t.u_accent)}),hillshadePrepare:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_image:new d.aG(p,t.u_image),u_dimension:new d.aL(p,t.u_dimension),u_zoom:new d.aH(p,t.u_zoom),u_unpack:new d.aJ(p,t.u_unpack)}),line:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_ratio:new d.aH(p,t.u_ratio),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new d.aL(p,t.u_units_to_pixels)}),lineGradient:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_ratio:new d.aH(p,t.u_ratio),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new d.aL(p,t.u_units_to_pixels),u_image:new d.aG(p,t.u_image),u_image_height:new d.aH(p,t.u_image_height)}),linePattern:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_texsize:new d.aL(p,t.u_texsize),u_ratio:new d.aH(p,t.u_ratio),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_image:new d.aG(p,t.u_image),u_units_to_pixels:new d.aL(p,t.u_units_to_pixels),u_scale:new d.aK(p,t.u_scale),u_fade:new d.aH(p,t.u_fade)}),lineSDF:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_ratio:new d.aH(p,t.u_ratio),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_units_to_pixels:new d.aL(p,t.u_units_to_pixels),u_patternscale_a:new d.aL(p,t.u_patternscale_a),u_patternscale_b:new d.aL(p,t.u_patternscale_b),u_sdfgamma:new d.aH(p,t.u_sdfgamma),u_image:new d.aG(p,t.u_image),u_tex_y_a:new d.aH(p,t.u_tex_y_a),u_tex_y_b:new d.aH(p,t.u_tex_y_b),u_mix:new d.aH(p,t.u_mix)}),raster:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_tl_parent:new d.aL(p,t.u_tl_parent),u_scale_parent:new d.aH(p,t.u_scale_parent),u_buffer_scale:new d.aH(p,t.u_buffer_scale),u_fade_t:new d.aH(p,t.u_fade_t),u_opacity:new d.aH(p,t.u_opacity),u_image0:new d.aG(p,t.u_image0),u_image1:new d.aG(p,t.u_image1),u_brightness_low:new d.aH(p,t.u_brightness_low),u_brightness_high:new d.aH(p,t.u_brightness_high),u_saturation_factor:new d.aH(p,t.u_saturation_factor),u_contrast_factor:new d.aH(p,t.u_contrast_factor),u_spin_weights:new d.aK(p,t.u_spin_weights)}),symbolIcon:(p,t)=>({u_is_size_zoom_constant:new d.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aG(p,t.u_is_size_feature_constant),u_size_t:new d.aH(p,t.u_size_t),u_size:new d.aH(p,t.u_size),u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_pitch:new d.aH(p,t.u_pitch),u_rotate_symbol:new d.aG(p,t.u_rotate_symbol),u_aspect_ratio:new d.aH(p,t.u_aspect_ratio),u_fade_change:new d.aH(p,t.u_fade_change),u_matrix:new d.aI(p,t.u_matrix),u_label_plane_matrix:new d.aI(p,t.u_label_plane_matrix),u_coord_matrix:new d.aI(p,t.u_coord_matrix),u_is_text:new d.aG(p,t.u_is_text),u_pitch_with_map:new d.aG(p,t.u_pitch_with_map),u_texsize:new d.aL(p,t.u_texsize),u_texture:new d.aG(p,t.u_texture)}),symbolSDF:(p,t)=>({u_is_size_zoom_constant:new d.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aG(p,t.u_is_size_feature_constant),u_size_t:new d.aH(p,t.u_size_t),u_size:new d.aH(p,t.u_size),u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_pitch:new d.aH(p,t.u_pitch),u_rotate_symbol:new d.aG(p,t.u_rotate_symbol),u_aspect_ratio:new d.aH(p,t.u_aspect_ratio),u_fade_change:new d.aH(p,t.u_fade_change),u_matrix:new d.aI(p,t.u_matrix),u_label_plane_matrix:new d.aI(p,t.u_label_plane_matrix),u_coord_matrix:new d.aI(p,t.u_coord_matrix),u_is_text:new d.aG(p,t.u_is_text),u_pitch_with_map:new d.aG(p,t.u_pitch_with_map),u_texsize:new d.aL(p,t.u_texsize),u_texture:new d.aG(p,t.u_texture),u_gamma_scale:new d.aH(p,t.u_gamma_scale),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_is_halo:new d.aG(p,t.u_is_halo)}),symbolTextAndIcon:(p,t)=>({u_is_size_zoom_constant:new d.aG(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aG(p,t.u_is_size_feature_constant),u_size_t:new d.aH(p,t.u_size_t),u_size:new d.aH(p,t.u_size),u_camera_to_center_distance:new d.aH(p,t.u_camera_to_center_distance),u_pitch:new d.aH(p,t.u_pitch),u_rotate_symbol:new d.aG(p,t.u_rotate_symbol),u_aspect_ratio:new d.aH(p,t.u_aspect_ratio),u_fade_change:new d.aH(p,t.u_fade_change),u_matrix:new d.aI(p,t.u_matrix),u_label_plane_matrix:new d.aI(p,t.u_label_plane_matrix),u_coord_matrix:new d.aI(p,t.u_coord_matrix),u_is_text:new d.aG(p,t.u_is_text),u_pitch_with_map:new d.aG(p,t.u_pitch_with_map),u_texsize:new d.aL(p,t.u_texsize),u_texsize_icon:new d.aL(p,t.u_texsize_icon),u_texture:new d.aG(p,t.u_texture),u_texture_icon:new d.aG(p,t.u_texture_icon),u_gamma_scale:new d.aH(p,t.u_gamma_scale),u_device_pixel_ratio:new d.aH(p,t.u_device_pixel_ratio),u_is_halo:new d.aG(p,t.u_is_halo)}),background:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_opacity:new d.aH(p,t.u_opacity),u_color:new d.aM(p,t.u_color)}),backgroundPattern:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_opacity:new d.aH(p,t.u_opacity),u_image:new d.aG(p,t.u_image),u_pattern_tl_a:new d.aL(p,t.u_pattern_tl_a),u_pattern_br_a:new d.aL(p,t.u_pattern_br_a),u_pattern_tl_b:new d.aL(p,t.u_pattern_tl_b),u_pattern_br_b:new d.aL(p,t.u_pattern_br_b),u_texsize:new d.aL(p,t.u_texsize),u_mix:new d.aH(p,t.u_mix),u_pattern_size_a:new d.aL(p,t.u_pattern_size_a),u_pattern_size_b:new d.aL(p,t.u_pattern_size_b),u_scale_a:new d.aH(p,t.u_scale_a),u_scale_b:new d.aH(p,t.u_scale_b),u_pixel_coord_upper:new d.aL(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new d.aL(p,t.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aH(p,t.u_tile_units_to_pixels)}),terrain:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_texture:new d.aG(p,t.u_texture),u_ele_delta:new d.aH(p,t.u_ele_delta)}),terrainDepth:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_ele_delta:new d.aH(p,t.u_ele_delta)}),terrainCoords:(p,t)=>({u_matrix:new d.aI(p,t.u_matrix),u_texture:new d.aG(p,t.u_texture),u_terrain_coords_id:new d.aH(p,t.u_terrain_coords_id),u_ele_delta:new d.aH(p,t.u_ele_delta)})};class ps{constructor(t,o,u){this.context=t;const c=t.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ra={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ir{constructor(t,o,u,c){this.length=o.length,this.attributes=u,this.itemSize=o.bytesPerElement,this.dynamicDraw=c,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let u=0;u<this.attributes.length;u++){const c=o.attributes[this.attributes[u].name];c!==void 0&&t.enableVertexAttribArray(c)}}setVertexAttribPointers(t,o,u){for(let c=0;c<this.attributes.length;c++){const m=this.attributes[c],x=o.attributes[m.name];x!==void 0&&t.vertexAttribPointer(x,m.components,t[Ra[m.type]],!1,this.itemSize,m.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yi=new WeakMap;function Hs(p){var t;if(Yi.has(p))return Yi.get(p);{const o=(t=p.getParameter(p.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Yi.set(p,o),o}}class Pt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fa extends Pt{getDefault(){return d.aO.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Wl extends Pt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Kl extends Pt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ba extends Pt{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Xl extends Pt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Yl extends Pt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Oa extends Pt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ih extends Pt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class rh extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ws extends Pt{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Mp extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class Dp extends Pt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Lp extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class Rp extends Pt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Fp extends Pt{getDefault(){return d.aO.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Bp extends Pt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Jl extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class Na extends Pt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ql extends Pt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class eu extends Pt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Ks extends Pt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class nh extends Pt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class sh extends Pt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class tu extends Pt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class fs extends Pt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class oh extends Pt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Xs extends Pt{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ys extends Pt{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const u=this.gl;Hs(u)?u.bindVertexArray(t):(o=u.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class ah extends Pt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class iu extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class zt extends Pt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Js extends Pt{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class Op extends Js{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class lh extends Js{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Xo extends Js{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Np{constructor(t,o,u,c,m){this.context=t,this.width=o,this.height=u;const x=t.gl,b=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Op(t,b),c)this.depthAttachment=m?new Xo(t,b):new lh(t,b);else if(m)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const u=this.depthAttachment.get();u&&t.deleteRenderbuffer(u)}t.deleteFramebuffer(this.framebuffer)}}class hi{constructor(t,o,u){this.blendFunction=t,this.blendColor=o,this.mask=u}}hi.Replace=[1,0],hi.disabled=new hi(hi.Replace,d.aO.transparent,[!1,!1,!1,!1]),hi.unblended=new hi(hi.Replace,d.aO.transparent,[!0,!0,!0,!0]),hi.alphaBlended=new hi([1,771],d.aO.transparent,[!0,!0,!0,!0]);class uh{constructor(t){var o,u;if(this.gl=t,this.clearColor=new Fa(this),this.clearDepth=new Wl(this),this.clearStencil=new Kl(this),this.colorMask=new Ba(this),this.depthMask=new Xl(this),this.stencilMask=new Yl(this),this.stencilFunc=new Oa(this),this.stencilOp=new ih(this),this.stencilTest=new rh(this),this.depthRange=new Ws(this),this.depthTest=new Mp(this),this.depthFunc=new Dp(this),this.blend=new Lp(this),this.blendFunc=new Rp(this),this.blendColor=new Fp(this),this.blendEquation=new Bp(this),this.cullFace=new Jl(this),this.cullFaceSide=new Na(this),this.frontFace=new Ql(this),this.program=new eu(this),this.activeTexture=new Ks(this),this.viewport=new nh(this),this.bindFramebuffer=new sh(this),this.bindRenderbuffer=new tu(this),this.bindTexture=new fs(this),this.bindVertexBuffer=new oh(this),this.bindElementBuffer=new Xs(this),this.bindVertexArray=new Ys(this),this.pixelStoreUnpack=new ah(this),this.pixelStoreUnpackPremultiplyAlpha=new iu(this),this.pixelStoreUnpackFlipY=new zt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),Hs(t)){this.HALF_FLOAT=t.HALF_FLOAT;const c=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:c==null?void 0:c.RGBA16F_EXT,this.RGB16F=(u=t.RGB16F)!==null&&u!==void 0?u:c==null?void 0:c.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const c=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=c==null?void 0:c.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new ps(this,t,o)}createVertexBuffer(t,o,u){return new Ir(this,t,o,u)}createRenderbuffer(t,o,u){const c=this.gl,m=c.createRenderbuffer();return this.bindRenderbuffer.set(m),c.renderbufferStorage(c.RENDERBUFFER,t,o,u),this.bindRenderbuffer.set(null),m}createFramebuffer(t,o,u,c){return new Np(this,t,o,u,c)}clear({color:t,depth:o,stencil:u}){const c=this.gl;let m=0;t&&(m|=c.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u!==void 0&&(m|=c.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),c.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){d.aD(t.blendFunction,hi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return Hs(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return Hs(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class kt{constructor(t,o,u){this.func=t,this.mask=o,this.range=u}}kt.ReadOnly=!1,kt.ReadWrite=!0,kt.disabled=new kt(519,kt.ReadOnly,[0,1]);const Yo=7680;class $t{constructor(t,o,u,c,m,x){this.test=t,this.ref=o,this.mask=u,this.fail=c,this.depthFail=m,this.pass=x}}$t.disabled=new $t({func:519,mask:0},0,0,Yo,Yo,Yo);class jt{constructor(t,o,u){this.enable=t,this.mode=o,this.frontFace=u}}let Qs;function Va(p,t,o,u,c,m,x){const b=p.context,I=b.gl,k=p.useProgram("collisionBox"),z=[];let A=0,F=0;for(let K=0;K<u.length;K++){const le=u[K],fe=t.getTile(le),me=fe.getBucket(o);if(!me)continue;let ge=le.posMatrix;c[0]===0&&c[1]===0||(ge=p.translatePosMatrix(le.posMatrix,fe,c,m));const Ce=x?me.textCollisionBox:me.iconCollisionBox,Se=me.collisionCircleArray;if(Se.length>0){const Ie=d.F(),Ze=ge;d.aP(Ie,me.placementInvProjMatrix,p.transform.glCoordMatrix),d.aP(Ie,Ie,me.placementViewportMatrix),z.push({circleArray:Se,circleOffset:F,transform:Ze,invTransform:Ie,coord:le}),A+=Se.length/4,F=A}Ce&&k.draw(b,I.LINES,kt.disabled,$t.disabled,p.colorModeForRenderPass(),jt.disabled,Ep(ge,p.transform,fe),p.style.map.terrain&&p.style.map.terrain.getTerrainData(le),o.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,p.transform.zoom,null,null,Ce.collisionVertexBuffer)}if(!x||!z.length)return;const G=p.useProgram("collisionCircle"),Z=new d.aQ;Z.resize(4*A),Z._trim();let W=0;for(const K of z)for(let le=0;le<K.circleArray.length/4;le++){const fe=4*le,me=K.circleArray[fe+0],ge=K.circleArray[fe+1],Ce=K.circleArray[fe+2],Se=K.circleArray[fe+3];Z.emplace(W++,me,ge,Ce,Se,0),Z.emplace(W++,me,ge,Ce,Se,1),Z.emplace(W++,me,ge,Ce,Se,2),Z.emplace(W++,me,ge,Ce,Se,3)}(!Qs||Qs.length<2*A)&&(Qs=function(K){const le=2*K,fe=new d.aS;fe.resize(le),fe._trim();for(let me=0;me<le;me++){const ge=6*me;fe.uint16[ge+0]=4*me+0,fe.uint16[ge+1]=4*me+1,fe.uint16[ge+2]=4*me+2,fe.uint16[ge+3]=4*me+2,fe.uint16[ge+4]=4*me+3,fe.uint16[ge+5]=4*me+0}return fe}(A));const V=b.createIndexBuffer(Qs,!0),ie=b.createVertexBuffer(Z,d.aR.members,!0);for(const K of z){const le={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(pe=p.transform).cameraToCenterDistance,u_viewport_size:[pe.width,pe.height]};G.draw(b,I.TRIANGLES,kt.disabled,$t.disabled,p.colorModeForRenderPass(),jt.disabled,le,p.style.map.terrain&&p.style.map.terrain.getTerrainData(K.coord),o.id,ie,V,d.$.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,p.transform.zoom,null,null,null)}var pe;ie.destroy(),V.destroy()}jt.disabled=new jt(!1,1029,2305),jt.backCCW=new jt(!0,1029,2305);const ch=d.an(new Float32Array(16));function ja(p,t,o,u,c,m){const{horizontalAlign:x,verticalAlign:b}=d.at(p);return new d.P((-(x-.5)*t/c+u[0])*m,(-(b-.5)*o/c+u[1])*m)}function Ua(p,t,o,u,c,m,x,b,I,k,z){const A=p.text.placedSymbolArray,F=p.text.dynamicLayoutVertexArray,G=p.icon.dynamicLayoutVertexArray,Z={};F.clear();for(let W=0;W<A.length;W++){const V=A.get(W),ie=V.hidden||!V.crossTileID||p.allowVerticalPlacement&&!V.placedOrientation?null:u[V.crossTileID];if(ie){const pe=new d.P(V.anchorX,V.anchorY),K=q(pe,o?x:m,z),le=M(c.cameraToCenterDistance,K.signedDistanceFromCamera);let fe=d.ai(p.textSizeData,I,V)*le/d.ao;o&&(fe*=p.tilePixelRatio/b);const{width:me,height:ge,anchor:Ce,textOffset:Se,textBoxScale:Ie}=ie,Ze=ja(Ce,me,ge,Se,Ie,fe),ct=o?q(pe.add(Ze),m,z).point:K.point.add(t?Ze.rotate(-c.angle):Ze),Fe=p.allowVerticalPlacement&&V.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let ot=0;ot<V.numGlyphs;ot++)d.aj(F,ct,Fe);k&&V.associatedIconIndex>=0&&(Z[V.associatedIconIndex]={shiftedAnchor:ct,angle:Fe})}else Je(V.numGlyphs,F)}if(k){G.clear();const W=p.icon.placedSymbolArray;for(let V=0;V<W.length;V++){const ie=W.get(V);if(ie.hidden)Je(ie.numGlyphs,G);else{const pe=Z[V];if(pe)for(let K=0;K<ie.numGlyphs;K++)d.aj(G,pe.shiftedAnchor,pe.angle);else Je(ie.numGlyphs,G)}}p.icon.dynamicLayoutVertexBuffer.updateData(G)}p.text.dynamicLayoutVertexBuffer.updateData(F)}function ru(p,t,o){return o.iconsInText&&t?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function hh(p,t,o,u,c,m,x,b,I,k,z,A){const F=p.context,G=F.gl,Z=p.transform,W=b==="map",V=I==="map",ie=b!=="viewport"&&o.layout.get("symbol-placement")!=="point",pe=W&&!V&&!ie,K=!o.layout.get("symbol-sort-key").isConstant();let le=!1;const fe=p.depthModeForSublayer(0,kt.ReadOnly),me=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ge=[];for(const Ce of u){const Se=t.getTile(Ce),Ie=Se.getBucket(o);if(!Ie)continue;const Ze=c?Ie.text:Ie.icon;if(!Ze||!Ze.segments.get().length||!Ze.hasVisibleVertices)continue;const ct=Ze.programConfigurations.get(o.id),Fe=c||Ie.sdfIcons,ot=c?Ie.textSizeData:Ie.iconSizeData,gt=V||Z.pitch!==0,St=p.useProgram(ru(Fe,c,Ie),ct),lt=d.ag(ot,Z.zoom),_t=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ce);let vt,Jt,Ut,cr,_i=[0,0],Zt=null;if(c)Jt=Se.glyphAtlasTexture,Ut=G.LINEAR,vt=Se.glyphAtlasTexture.size,Ie.iconsInText&&(_i=Se.imageAtlasTexture.size,Zt=Se.imageAtlasTexture,cr=gt||p.options.rotating||p.options.zooming||ot.kind==="composite"||ot.kind==="camera"?G.LINEAR:G.NEAREST);else{const Xt=o.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear;Jt=Se.imageAtlasTexture,Ut=Fe||p.options.rotating||p.options.zooming||Xt||gt?G.LINEAR:G.NEAREST,vt=Se.imageAtlasTexture.size}const Zi=ut(Se,1,p.transform.zoom),Jr=Hn(Ce.posMatrix,V,W,p.transform,Zi),yn=En(Ce.posMatrix,V,W,p.transform,Zi),xs=me&&Ie.hasTextData(),ws=o.layout.get("icon-text-fit")!=="none"&&xs&&Ie.hasIconData();if(ie){const Xt=p.style.map.terrain?(kr,bt)=>p.style.map.terrain.getElevation(Ce,kr,bt):null,Di=o.layout.get("text-rotation-alignment")==="map";O(Ie,Ce.posMatrix,p,c,Jr,yn,V,k,Di,Xt)}const _n=p.translatePosMatrix(Ce.posMatrix,Se,m,x),Qr=ie||c&&me||ws?ch:Jr,ii=p.translatePosMatrix(yn,Se,m,x,!0),Wt=Fe&&o.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let li;li=Fe?Ie.iconsInText?Pp(ot.kind,lt,pe,V,p,_n,Qr,ii,vt,_i):Gs(ot.kind,lt,pe,V,p,_n,Qr,ii,c,vt,!0):Ko(ot.kind,lt,pe,V,p,_n,Qr,ii,c,vt);const co={program:St,buffers:Ze,uniformValues:li,atlasTexture:Jt,atlasTextureIcon:Zt,atlasInterpolation:Ut,atlasInterpolationIcon:cr,isSDF:Fe,hasHalo:Wt};if(K&&Ie.canOverlap){le=!0;const Xt=Ze.segments.get();for(const Di of Xt)ge.push({segments:new d.$([Di]),sortKey:Di.sortKey,state:co,terrainData:_t})}else ge.push({segments:Ze.segments,sortKey:0,state:co,terrainData:_t})}le&&ge.sort((Ce,Se)=>Ce.sortKey-Se.sortKey);for(const Ce of ge){const Se=Ce.state;if(F.activeTexture.set(G.TEXTURE0),Se.atlasTexture.bind(Se.atlasInterpolation,G.CLAMP_TO_EDGE),Se.atlasTextureIcon&&(F.activeTexture.set(G.TEXTURE1),Se.atlasTextureIcon&&Se.atlasTextureIcon.bind(Se.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),Se.isSDF){const Ie=Se.uniformValues;Se.hasHalo&&(Ie.u_is_halo=1,$a(Se.buffers,Ce.segments,o,p,Se.program,fe,z,A,Ie,Ce.terrainData)),Ie.u_is_halo=0}$a(Se.buffers,Ce.segments,o,p,Se.program,fe,z,A,Se.uniformValues,Ce.terrainData)}}function $a(p,t,o,u,c,m,x,b,I,k){const z=u.context;c.draw(z,z.gl.TRIANGLES,m,x,b,jt.disabled,I,k,o.id,p.layoutVertexBuffer,p.indexBuffer,t,o.paint,u.transform.zoom,p.programConfigurations.get(o.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function dh(p,t,o,u,c){if(!o||!u||!u.imageAtlas)return;const m=u.imageAtlas.patternPositions;let x=m[o.to.toString()],b=m[o.from.toString()];if(!x&&b&&(x=b),!b&&x&&(b=x),!x||!b){const I=c.getPaintProperty(t);x=m[I],b=m[I]}x&&b&&p.setConstantPatternPositions(x,b)}function nu(p,t,o,u,c,m,x){const b=p.context.gl,I="fill-pattern",k=o.paint.get(I),z=k&&k.constantOr(1),A=o.getCrossfadeParameters();let F,G,Z,W,V;x?(G=z&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=b.LINES):(G=z?"fillPattern":"fill",F=b.TRIANGLES);const ie=k.constantOr(null);for(const pe of u){const K=t.getTile(pe);if(z&&!K.patternsLoaded())continue;const le=K.getBucket(o);if(!le)continue;const fe=le.programConfigurations.get(o.id),me=p.useProgram(G,fe),ge=p.style.map.terrain&&p.style.map.terrain.getTerrainData(pe);z&&(p.context.activeTexture.set(b.TEXTURE0),K.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),fe.updatePaintBuffers(A)),dh(fe,I,ie,K,o);const Ce=ge?pe:null,Se=p.translatePosMatrix(Ce?Ce.posMatrix:pe.posMatrix,K,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){W=le.indexBuffer2,V=le.segments2;const Ie=[b.drawingBufferWidth,b.drawingBufferHeight];Z=G==="fillOutlinePattern"&&z?kp(Se,p,A,K,Ie):Yc(Se,Ie)}else W=le.indexBuffer,V=le.segments,Z=z?Xc(Se,p,A,K):za(Se);me.draw(p.context,F,c,p.stencilModeForClipping(pe),m,jt.disabled,Z,ge,o.id,le.layoutVertexBuffer,W,V,o.paint,p.transform.zoom,fe)}}function eo(p,t,o,u,c,m,x){const b=p.context,I=b.gl,k="fill-extrusion-pattern",z=o.paint.get(k),A=z.constantOr(1),F=o.getCrossfadeParameters(),G=o.paint.get("fill-extrusion-opacity"),Z=z.constantOr(null);for(const W of u){const V=t.getTile(W),ie=V.getBucket(o);if(!ie)continue;const pe=p.style.map.terrain&&p.style.map.terrain.getTerrainData(W),K=ie.programConfigurations.get(o.id),le=p.useProgram(A?"fillExtrusionPattern":"fillExtrusion",K);A&&(p.context.activeTexture.set(I.TEXTURE0),V.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),K.updatePaintBuffers(F)),dh(K,k,Z,V,o);const fe=p.translatePosMatrix(W.posMatrix,V,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),me=o.paint.get("fill-extrusion-vertical-gradient"),ge=A?Cp(fe,p,me,G,W,F,V):Kc(fe,p,me,G);le.draw(b,b.gl.TRIANGLES,c,m,x,jt.backCCW,ge,pe,o.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,o.paint,p.transform.zoom,K,p.style.map.terrain&&ie.centroidVertexBuffer)}}function su(p,t,o,u,c,m,x){const b=p.context,I=b.gl,k=o.fbo;if(!k)return;const z=p.useProgram("hillshade"),A=p.style.map.terrain&&p.style.map.terrain.getTerrainData(t);b.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,k.colorAttachment.get()),z.draw(b,I.TRIANGLES,c,m,x,jt.disabled,((F,G,Z,W)=>{const V=Z.paint.get("hillshade-shadow-color"),ie=Z.paint.get("hillshade-highlight-color"),pe=Z.paint.get("hillshade-accent-color");let K=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=F.transform.angle);const le=!F.options.moving;return{u_matrix:W?W.posMatrix:F.transform.calculatePosMatrix(G.tileID.toUnwrapped(),le),u_image:0,u_latrange:eh(0,G.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),K],u_shadow:V,u_highlight:ie,u_accent:pe}})(p,o,u,A?t:null),A,u.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function ph(p,t,o,u,c,m){const x=p.context,b=x.gl,I=t.dem;if(I&&I.data){const k=I.dim,z=I.stride,A=I.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||p.getTileTexture(z),t.demTexture){const G=t.demTexture;G.update(A,{premultiply:!1}),G.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else t.demTexture=new Nt(x,A,b.RGBA,{premultiply:!1}),t.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let F=t.fbo;if(!F){const G=new Nt(x,{width:k,height:k,data:null},b.RGBA);G.bind(b.LINEAR,b.CLAMP_TO_EDGE),F=t.fbo=x.createFramebuffer(k,k,!0,!1),F.colorAttachment.set(G.texture)}x.bindFramebuffer.set(F.framebuffer),x.viewport.set([0,0,k,k]),p.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,u,c,m,jt.disabled,((G,Z)=>{const W=Z.stride,V=d.F();return d.aN(V,0,d.W,-d.W,0,0,1),d.H(V,V,[0,-d.W,0]),{u_matrix:V,u_image:1,u_dimension:[W,W],u_zoom:G.overscaledZ,u_unpack:Z.getUnpackVector()}})(t.tileID,I),null,o.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function fh(p,t,o,u,c,m){const x=u.paint.get("raster-fade-duration");if(!m&&x>0){const b=X.now(),I=(b-p.timeAdded)/x,k=t?(b-t.timeAdded)/x:-1,z=o.getSource(),A=c.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),F=!t||Math.abs(t.tileID.overscaledZ-A)>Math.abs(p.tileID.overscaledZ-A),G=F&&p.refreshedUponExpiration?1:d.ac(F?I:1-k,0,1);return p.refreshedUponExpiration&&I>=1&&(p.refreshedUponExpiration=!1),t?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const Za=new d.aO(1,0,0,1),ou=new d.aO(0,1,0,1),Vp=new d.aO(0,0,1,1),mh=new d.aO(1,0,1,1),ai=new d.aO(0,1,1,1);function Kn(p,t,o,u){to(p,0,t+o/2,p.transform.width,o,u)}function Cr(p,t,o,u){to(p,t-o/2,0,o,p.transform.height,u)}function to(p,t,o,u,c,m){const x=p.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(t*p.pixelRatio,o*p.pixelRatio,u*p.pixelRatio,c*p.pixelRatio),x.clear({color:m}),b.disable(b.SCISSOR_TEST)}function au(p,t,o){const u=p.context,c=u.gl,m=o.posMatrix,x=p.useProgram("debug"),b=kt.disabled,I=$t.disabled,k=p.colorModeForRenderPass(),z="$debug",A=p.style.map.terrain&&p.style.map.terrain.getTerrainData(o);u.activeTexture.set(c.TEXTURE0);const F=t.getTileByID(o.key).latestRawTileData,G=Math.floor((F&&F.byteLength||0)/1024),Z=t.getTile(o).tileSize,W=512/Math.min(Z,512)*(o.overscaledZ/p.transform.zoom)*.5;let V=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(V+=` => ${o.overscaledZ}`),function(ie,pe){ie.initDebugOverlayCanvas();const K=ie.debugOverlayCanvas,le=ie.context.gl,fe=ie.debugOverlayCanvas.getContext("2d");fe.clearRect(0,0,K.width,K.height),fe.shadowColor="white",fe.shadowBlur=2,fe.lineWidth=1.5,fe.strokeStyle="white",fe.textBaseline="top",fe.font="bold 36px Open Sans, sans-serif",fe.fillText(pe,5,5),fe.strokeText(pe,5,5),ie.debugOverlayTexture.update(K),ie.debugOverlayTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE)}(p,`${V} ${G}kB`),x.draw(u,c.TRIANGLES,b,I,hi.alphaBlended,jt.disabled,Aa(m,d.aO.transparent,W),null,z,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),x.draw(u,c.LINE_STRIP,b,I,k,jt.disabled,Aa(m,d.aO.red),A,z,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function lu(p,t,o){const u=p.context,c=u.gl,m=p.colorModeForRenderPass(),x=new kt(c.LEQUAL,kt.ReadWrite,p.depthRangeFor3D),b=p.useProgram("terrain"),I=t.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,p.width,p.height]);for(const k of o){const z=p.renderToTexture.getTexture(k),A=t.getTerrainData(k.tileID);u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,z.texture);const F={u_matrix:p.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(p.transform.zoom)};b.draw(u,c.TRIANGLES,x,$t.disabled,m,jt.backCCW,F,A,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}class io{constructor(t,o){this.context=new uh(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Me.maxUnderzooming+Me.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oi}resize(t,o,u){if(this.width=Math.floor(t*u),this.height=Math.floor(o*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style._order)this.style._layers[c].resize()}setup(){const t=this.context,o=new d.aV;o.emplaceBack(0,0),o.emplaceBack(d.W,0),o.emplaceBack(0,d.W),o.emplaceBack(d.W,d.W),this.tileExtentBuffer=t.createVertexBuffer(o,pn.members),this.tileExtentSegments=d.$.simpleSegment(0,0,4,2);const u=new d.aV;u.emplaceBack(0,0),u.emplaceBack(d.W,0),u.emplaceBack(0,d.W),u.emplaceBack(d.W,d.W),this.debugBuffer=t.createVertexBuffer(u,pn.members),this.debugSegments=d.$.simpleSegment(0,0,4,5);const c=new d.Z;c.emplaceBack(0,0,0,0),c.emplaceBack(d.W,0,d.W,0),c.emplaceBack(0,d.W,0,d.W),c.emplaceBack(d.W,d.W,d.W,d.W),this.rasterBoundsBuffer=t.createVertexBuffer(c,Fi.members),this.rasterBoundsSegments=d.$.simpleSegment(0,0,4,2);const m=new d.aV;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,pn.members),this.viewportSegments=d.$.simpleSegment(0,0,4,2);const x=new d.aW;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(x);const b=new d.aX;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(b);const I=this.context.gl;this.stencilClearMode=new $t({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=d.F();d.aN(u,0,this.width,this.height,0,0,1),d.J(u,u,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,o.TRIANGLES,kt.disabled,this.stencilClearMode,hi.disabled,jt.disabled,Hl(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source;const u=this.context,c=u.gl;this.nextStencilID+o.length>256&&this.clearStencil(),u.setColorMode(hi.disabled),u.setDepthMode(kt.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of o){const b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);m.draw(u,c.TRIANGLES,kt.disabled,new $t({func:c.ALWAYS,mask:0},b,255,c.KEEP,c.KEEP,c.REPLACE),hi.disabled,jt.disabled,Hl(x.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new $t({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new $t({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,u=t.sort((x,b)=>b.overscaledZ-x.overscaledZ),c=u[u.length-1].overscaledZ,m=u[0].overscaledZ-c+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const x={};for(let b=0;b<m;b++)x[b+c]=new $t({func:o.GEQUAL,mask:255},b+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[x,u]}return[{[c]:$t.disabled},u]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new hi([t.CONSTANT_COLOR,t.ONE],new d.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?hi.unblended:hi.alphaBlended}depthModeForSublayer(t,o,u){if(!this.opaquePassEnabledForLayer())return kt.disabled;const c=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new kt(u||this.context.gl.LEQUAL,o,[c,c])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(X.now()),this.imageManager.beginFrame();const u=this.style._order,c=this.style.sourceCaches,m={},x={},b={};for(const I in c){const k=c[I];k.used&&k.prepare(this.context),m[I]=k.getVisibleCoordinates(),x[I]=m[I].slice().reverse(),b[I]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<u.length;I++)if(this.style._layers[u[I]].is3D()){this.opaquePassCutoff=I;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const I of u){const k=this.style._layers[I];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const z=x[k.source];(k.type==="custom"||z.length)&&this.renderLayer(this,c[k.source],k,z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?d.aO.black:d.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[u[this.currentLayer]],k=c[I.source],z=m[I.source];this._renderTileClippingMasks(I,z),this.renderLayer(this,k,I,z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const I=this.style._layers[u[this.currentLayer]],k=c[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I))continue;const z=(I.type==="symbol"?b:x)[I.source];this._renderTileClippingMasks(I,m[I.source]),this.renderLayer(this,k,I,z)}if(this.options.showTileBoundaries){const I=function(k,z){let A=null;const F=Object.values(k._layers).flatMap(V=>V.source&&!V.isHidden(z)?[k.sourceCaches[V.source]]:[]),G=F.filter(V=>V.getSource().type==="vector"),Z=F.filter(V=>V.getSource().type!=="vector"),W=V=>{(!A||A.getSource().maxzoom<V.getSource().maxzoom)&&(A=V)};return G.forEach(V=>W(V)),A||Z.forEach(V=>W(V)),A}(this.style,this.transform.zoom);I&&function(k,z,A){for(let F=0;F<A.length;F++)au(k,z,A[F])}(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const k=I.transform.padding;Kn(I,I.transform.height-(k.top||0),3,Za),Kn(I,k.bottom||0,3,ou),Cr(I,k.left||0,3,Vp),Cr(I,I.transform.width-(k.right||0),3,mh);const z=I.transform.centerPoint;(function(A,F,G,Z){to(A,F-1,G-10,2,20,Z),to(A,F-10,G-1,20,2,Z)})(I,z.x,I.transform.height-z.y,ai)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,u=this.transform.projMatrix;let c=this.terrainFacilitator.dirty;c||(c=t?!d.aY(o,u):!d.aZ(o,u)),c||(c=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),c&&(d.a_(o,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,x){const b=m.context,I=b.gl,k=hi.unblended,z=new kt(I.LEQUAL,kt.ReadWrite,[0,1]),A=x.getTerrainMesh(),F=x.sourceCache.getRenderableTiles(),G=m.useProgram("terrainDepth");b.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.aO.transparent,depth:1});for(const Z of F){const W=x.getTerrainData(Z.tileID),V={u_matrix:m.transform.calculatePosMatrix(Z.tileID.toUnwrapped()),u_ele_delta:x.getMeshFrameDelta(m.transform.zoom)};G.draw(b,I.TRIANGLES,z,$t.disabled,k,jt.backCCW,V,W,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,x){const b=m.context,I=b.gl,k=hi.unblended,z=new kt(I.LEQUAL,kt.ReadWrite,[0,1]),A=x.getTerrainMesh(),F=x.getCoordsTexture(),G=x.sourceCache.getRenderableTiles(),Z=m.useProgram("terrainCoords");b.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.aO.transparent,depth:1}),x.coordsIndex=[];for(const W of G){const V=x.getTerrainData(W.tileID);b.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,F.texture);const ie={u_matrix:m.transform.calculatePosMatrix(W.tileID.toUnwrapped()),u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(m.transform.zoom)};Z.draw(b,I.TRIANGLES,z,$t.disabled,k,jt.backCCW,ie,V,"terrain",A.vertexBuffer,A.indexBuffer,A.segments),x.coordsIndex.push(W.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(t,o,u,c){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(c||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(m,x,b,I,k){if(m.renderPass!=="translucent")return;const z=$t.disabled,A=m.colorModeForRenderPass();(b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,G,Z,W,V,ie,pe){const K=G.transform,le=V==="map",fe=ie==="map";for(const me of F){const ge=W.getTile(me),Ce=ge.getBucket(Z);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const Se=d.ag(Ce.textSizeData,K.zoom),Ie=ut(ge,1,G.transform.zoom),Ze=Hn(me.posMatrix,fe,le,G.transform,Ie),ct=Z.layout.get("icon-text-fit")!=="none"&&Ce.hasIconData();if(Se){const Fe=Math.pow(2,K.zoom-ge.tileID.overscaledZ);Ua(Ce,le,fe,pe,K,Ze,me.posMatrix,Fe,Se,ct,G.style.map.terrain?(ot,gt)=>G.style.map.terrain.getElevation(me,ot,gt):null)}}}(I,m,b,x,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),k),b.paint.get("icon-opacity").constantOr(1)!==0&&hh(m,x,b,I,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),z,A),b.paint.get("text-opacity").constantOr(1)!==0&&hh(m,x,b,I,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),z,A),x.map.showCollisionBoxes&&(Va(m,x,b,I,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),!0),Va(m,x,b,I,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),!1))})(t,o,u,c,this.style.placement.variableOffsets);break;case"circle":(function(m,x,b,I){if(m.renderPass!=="translucent")return;const k=b.paint.get("circle-opacity"),z=b.paint.get("circle-stroke-width"),A=b.paint.get("circle-stroke-opacity"),F=!b.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(z.constantOr(1)===0||A.constantOr(1)===0))return;const G=m.context,Z=G.gl,W=m.depthModeForSublayer(0,kt.ReadOnly),V=$t.disabled,ie=m.colorModeForRenderPass(),pe=[];for(let K=0;K<I.length;K++){const le=I[K],fe=x.getTile(le),me=fe.getBucket(b);if(!me)continue;const ge=me.programConfigurations.get(b.id),Ce=m.useProgram("circle",ge),Se=me.layoutVertexBuffer,Ie=me.indexBuffer,Ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(le),ct={programConfiguration:ge,program:Ce,layoutVertexBuffer:Se,indexBuffer:Ie,uniformValues:Jc(m,le,fe,b),terrainData:Ze};if(F){const Fe=me.segments.get();for(const ot of Fe)pe.push({segments:new d.$([ot]),sortKey:ot.sortKey,state:ct})}else pe.push({segments:me.segments,sortKey:0,state:ct})}F&&pe.sort((K,le)=>K.sortKey-le.sortKey);for(const K of pe){const{programConfiguration:le,program:fe,layoutVertexBuffer:me,indexBuffer:ge,uniformValues:Ce,terrainData:Se}=K.state;fe.draw(G,Z.TRIANGLES,W,V,ie,jt.disabled,Ce,Se,b.id,me,ge,K.segments,b.paint,m.transform.zoom,le)}})(t,o,u,c);break;case"heatmap":(function(m,x,b,I){if(b.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const k=m.context,z=k.gl,A=$t.disabled,F=new hi([z.ONE,z.ONE],d.aO.transparent,[!0,!0,!0,!0]);(function(G,Z,W){const V=G.gl;G.activeTexture.set(V.TEXTURE1),G.viewport.set([0,0,Z.width/4,Z.height/4]);let ie=W.heatmapFbo;if(ie)V.bindTexture(V.TEXTURE_2D,ie.colorAttachment.get()),G.bindFramebuffer.set(ie.framebuffer);else{const pe=V.createTexture();V.bindTexture(V.TEXTURE_2D,pe),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),ie=W.heatmapFbo=G.createFramebuffer(Z.width/4,Z.height/4,!1,!1),function(K,le,fe,me){var ge,Ce;const Se=K.gl,Ie=(ge=K.HALF_FLOAT)!==null&&ge!==void 0?ge:Se.UNSIGNED_BYTE,Ze=(Ce=K.RGBA16F)!==null&&Ce!==void 0?Ce:Se.RGBA;Se.texImage2D(Se.TEXTURE_2D,0,Ze,le.width/4,le.height/4,0,Se.RGBA,Ie,null),me.colorAttachment.set(fe)}(G,Z,pe,ie)}})(k,m,b),k.clear({color:d.aO.transparent});for(let G=0;G<I.length;G++){const Z=I[G];if(x.hasRenderableParent(Z))continue;const W=x.getTile(Z),V=W.getBucket(b);if(!V)continue;const ie=V.programConfigurations.get(b.id),pe=m.useProgram("heatmap",ie),{zoom:K}=m.transform;pe.draw(k,z.TRIANGLES,kt.disabled,A,F,jt.disabled,Qc(Z.posMatrix,W,K,b.paint.get("heatmap-intensity")),null,b.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,b.paint,m.transform.zoom,ie)}k.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(k,z){const A=k.context,F=A.gl,G=z.heatmapFbo;if(!G)return;A.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,G.colorAttachment.get()),A.activeTexture.set(F.TEXTURE1);let Z=z.colorRampTexture;Z||(Z=z.colorRampTexture=new Nt(A,z.colorRamp,F.RGBA)),Z.bind(F.LINEAR,F.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(A,F.TRIANGLES,kt.disabled,$t.disabled,k.colorModeForRenderPass(),jt.disabled,((W,V,ie,pe)=>{const K=d.F();d.aN(K,0,W.width,W.height,0,0,1);const le=W.context.gl;return{u_matrix:K,u_world:[le.drawingBufferWidth,le.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(k,z),null,z.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,z.paint,k.transform.zoom)}(m,b))})(t,o,u,c);break;case"line":(function(m,x,b,I){if(m.renderPass!=="translucent")return;const k=b.paint.get("line-opacity"),z=b.paint.get("line-width");if(k.constantOr(1)===0||z.constantOr(1)===0)return;const A=m.depthModeForSublayer(0,kt.ReadOnly),F=m.colorModeForRenderPass(),G=b.paint.get("line-dasharray"),Z=b.paint.get("line-pattern"),W=Z.constantOr(1),V=b.paint.get("line-gradient"),ie=b.getCrossfadeParameters(),pe=W?"linePattern":G?"lineSDF":V?"lineGradient":"line",K=m.context,le=K.gl;let fe=!0;for(const me of I){const ge=x.getTile(me);if(W&&!ge.patternsLoaded())continue;const Ce=ge.getBucket(b);if(!Ce)continue;const Se=Ce.programConfigurations.get(b.id),Ie=m.context.program.get(),Ze=m.useProgram(pe,Se),ct=fe||Ze.program!==Ie,Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(me),ot=Z.constantOr(null);if(ot&&ge.imageAtlas){const lt=ge.imageAtlas,_t=lt.patternPositions[ot.to.toString()],vt=lt.patternPositions[ot.from.toString()];_t&&vt&&Se.setConstantPatternPositions(_t,vt)}const gt=Fe?me:null,St=W?Da(m,ge,b,ie,gt):G?Nr(m,ge,b,G,ie,gt):V?ds(m,ge,b,Ce.lineClipsArray.length,gt):Ma(m,ge,b,gt);if(W)K.activeTexture.set(le.TEXTURE0),ge.imageAtlasTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),Se.updatePaintBuffers(ie);else if(G&&(ct||m.lineAtlas.dirty))K.activeTexture.set(le.TEXTURE0),m.lineAtlas.bind(K);else if(V){const lt=Ce.gradients[b.id];let _t=lt.texture;if(b.gradientVersion!==lt.version){let vt=256;if(b.stepInterpolant){const Jt=x.getSource().maxzoom,Ut=me.canonical.z===Jt?Math.ceil(1<<m.transform.maxZoom-me.canonical.z):1;vt=d.ac(d.aT(Ce.maxLineLength/d.W*1024*Ut),256,K.maxTextureSize)}lt.gradient=d.aU({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:vt,image:lt.gradient||void 0,clips:Ce.lineClipsArray}),lt.texture?lt.texture.update(lt.gradient):lt.texture=new Nt(K,lt.gradient,le.RGBA),lt.version=b.gradientVersion,_t=lt.texture}K.activeTexture.set(le.TEXTURE0),_t.bind(b.stepInterpolant?le.NEAREST:le.LINEAR,le.CLAMP_TO_EDGE)}Ze.draw(K,le.TRIANGLES,A,m.stencilModeForClipping(me),F,jt.disabled,St,Fe,b.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,b.paint,m.transform.zoom,Se,Ce.layoutVertexBuffer2),fe=!1}})(t,o,u,c);break;case"fill":(function(m,x,b,I){const k=b.paint.get("fill-color"),z=b.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const A=m.colorModeForRenderPass(),F=b.paint.get("fill-pattern"),G=m.opaquePassEnabledForLayer()&&!F.constantOr(1)&&k.constantOr(d.aO.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===G){const Z=m.depthModeForSublayer(1,m.renderPass==="opaque"?kt.ReadWrite:kt.ReadOnly);nu(m,x,b,I,Z,A,!1)}if(m.renderPass==="translucent"&&b.paint.get("fill-antialias")){const Z=m.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,kt.ReadOnly);nu(m,x,b,I,Z,A,!0)}})(t,o,u,c);break;case"fill-extrusion":(function(m,x,b,I){const k=b.paint.get("fill-extrusion-opacity");if(k!==0&&m.renderPass==="translucent"){const z=new kt(m.context.gl.LEQUAL,kt.ReadWrite,m.depthRangeFor3D);if(k!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))eo(m,x,b,I,z,$t.disabled,hi.disabled),eo(m,x,b,I,z,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const A=m.colorModeForRenderPass();eo(m,x,b,I,z,$t.disabled,A)}}})(t,o,u,c);break;case"hillshade":(function(m,x,b,I){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const k=m.context,z=m.depthModeForSublayer(0,kt.ReadOnly),A=m.colorModeForRenderPass(),[F,G]=m.renderPass==="translucent"?m.stencilConfigForOverlap(I):[{},I];for(const Z of G){const W=x.getTile(Z);W.needsHillshadePrepare!==void 0&&W.needsHillshadePrepare&&m.renderPass==="offscreen"?ph(m,W,b,z,$t.disabled,A):m.renderPass==="translucent"&&su(m,Z,W,b,z,F[Z.overscaledZ],A)}k.viewport.set([0,0,m.width,m.height])})(t,o,u,c);break;case"raster":(function(m,x,b,I){if(m.renderPass!=="translucent"||b.paint.get("raster-opacity")===0||!I.length)return;const k=m.context,z=k.gl,A=x.getSource(),F=m.useProgram("raster"),G=m.colorModeForRenderPass(),[Z,W]=A instanceof dn?[{},I]:m.stencilConfigForOverlap(I),V=W[W.length-1].overscaledZ,ie=!m.options.moving;for(const pe of W){const K=m.depthModeForSublayer(pe.overscaledZ-V,b.paint.get("raster-opacity")===1?kt.ReadWrite:kt.ReadOnly,z.LESS),le=x.getTile(pe);le.registerFadeDuration(b.paint.get("raster-fade-duration"));const fe=x.findLoadedParent(pe,0),me=fh(le,fe,x,b,m.transform,m.style.map.terrain);let ge,Ce;const Se=b.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;k.activeTexture.set(z.TEXTURE0),le.texture.bind(Se,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(z.TEXTURE1),fe?(fe.texture.bind(Se,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),ge=Math.pow(2,fe.tileID.overscaledZ-le.tileID.overscaledZ),Ce=[le.tileID.canonical.x*ge%1,le.tileID.canonical.y*ge%1]):le.texture.bind(Se,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const Ie=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),Ze=Ie?pe:null,ct=Ze?Ze.posMatrix:m.transform.calculatePosMatrix(pe.toUnwrapped(),ie),Fe=Wo(ct,Ce||[0,0],ge||1,me,b);A instanceof dn?F.draw(k,z.TRIANGLES,K,$t.disabled,G,jt.disabled,Fe,Ie,b.id,A.boundsBuffer,m.quadTriangleIndexBuffer,A.boundsSegments):F.draw(k,z.TRIANGLES,K,Z[pe.overscaledZ],G,jt.disabled,Fe,Ie,b.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(t,o,u,c);break;case"background":(function(m,x,b,I){const k=b.paint.get("background-color"),z=b.paint.get("background-opacity");if(z===0)return;const A=m.context,F=A.gl,G=m.transform,Z=G.tileSize,W=b.paint.get("background-pattern");if(m.isPatternMissing(W))return;const V=!W&&k.a===1&&z===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==V)return;const ie=$t.disabled,pe=m.depthModeForSublayer(0,V==="opaque"?kt.ReadWrite:kt.ReadOnly),K=m.colorModeForRenderPass(),le=m.useProgram(W?"backgroundPattern":"background"),fe=I||G.coveringTiles({tileSize:Z,terrain:m.style.map.terrain});W&&(A.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context));const me=b.getCrossfadeParameters();for(const ge of fe){const Ce=I?ge.posMatrix:m.transform.calculatePosMatrix(ge.toUnwrapped()),Se=W?th(Ce,z,m,W,{tileID:ge,tileSize:Z},me):zp(Ce,z,k),Ie=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ge);le.draw(A,F.TRIANGLES,pe,ie,K,jt.disabled,Se,Ie,b.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(t,0,u,c);break;case"custom":(function(m,x,b){const I=m.context,k=b.implementation;if(m.renderPass==="offscreen"){const z=k.prerender;z&&(m.setCustomLayerDefaults(),I.setColorMode(m.colorModeForRenderPass()),z.call(k,I.gl,m.transform.customLayerMatrix()),I.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),I.setColorMode(m.colorModeForRenderPass()),I.setStencilMode($t.disabled);const z=k.renderingMode==="3d"?new kt(m.context.gl.LEQUAL,kt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,kt.ReadOnly);I.setDepthMode(z),k.render(I.gl,m.transform.customLayerMatrix()),I.setDirty(),m.setBaseState(),I.bindFramebuffer.set(null)}})(t,0,u)}}translatePosMatrix(t,o,u,c,m){if(!u[0]&&!u[1])return t;const x=m?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(x){const k=Math.sin(x),z=Math.cos(x);u=[u[0]*z-u[1]*k,u[0]*k+u[1]*z]}const b=[m?u[0]:ut(o,u[0],this.transform.zoom),m?u[1]:ut(o,u[1],this.transform.zoom),0],I=new Float32Array(16);return d.H(I,t,b),I}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),u=this.imageManager.getPattern(t.to.toString());return!o||!u}useProgram(t,o){this.cache=this.cache||{};const u=t+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new Gl(this.context,qs[t],o,Ap[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Nt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}class ms{constructor(t,o){this.points=t,this.planes=o}static fromInvProjectionMatrix(t,o,u){const c=Math.pow(2,u),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const I=1/(b=d.af([],b,t))[3]/o*c;return d.a$(b,b,[I,I,1/b[3],I])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const I=function(F,G){var Z=G[0],W=G[1],V=G[2],ie=Z*Z+W*W+V*V;return ie>0&&(ie=1/Math.sqrt(ie)),F[0]=G[0]*ie,F[1]=G[1]*ie,F[2]=G[2]*ie,F}([],function(F,G,Z){var W=G[0],V=G[1],ie=G[2],pe=Z[0],K=Z[1],le=Z[2];return F[0]=V*le-ie*K,F[1]=ie*pe-W*le,F[2]=W*K-V*pe,F}([],Dt([],m[b[0]],m[b[1]]),Dt([],m[b[2]],m[b[1]]))),k=-((z=I)[0]*(A=m[b[1]])[0]+z[1]*A[1]+z[2]*A[2]);var z,A;return I.concat(k)});return new ms(m,x)}}class ro{constructor(t,o){this.min=t,this.max=o,this.center=function(u,c,m){return u[0]=.5*c[0],u[1]=.5*c[1],u[2]=.5*c[2],u}([],function(u,c,m){return u[0]=c[0]+m[0],u[1]=c[1]+m[1],u[2]=c[2]+m[2],u}([],this.min,this.max))}quadrant(t){const o=[t%2==0,t<2],u=Ke(this.min),c=Ke(this.max);for(let m=0;m<o.length;m++)u[m]=o[m]?this.min[m]:this.center[m],c[m]=o[m]?this.center[m]:this.max[m];return c[2]=this.max[2],new ro(u,c)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let c=0;c<t.planes.length;c++){const m=t.planes[c];let x=0;for(let b=0;b<o.length;b++)d.b0(m,o[b])>=0&&x++;if(x===0)return 0;x!==o.length&&(u=!1)}if(u)return 2;for(let c=0;c<3;c++){let m=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<t.points.length;b++){const I=t.points[b][c]-this.min[c];m=Math.min(m,I),x=Math.max(x,I)}if(x<0||m>this.max[c]-this.min[c])return 0}return 1}}class Jo{constructor(t=0,o=0,u=0,c=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(u)||u<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=u,this.right=c}interpolate(t,o,u){return o.top!=null&&t.top!=null&&(this.top=d.z.number(t.top,o.top,u)),o.bottom!=null&&t.bottom!=null&&(this.bottom=d.z.number(t.bottom,o.bottom,u)),o.left!=null&&t.left!=null&&(this.left=d.z.number(t.left,o.left,u)),o.right!=null&&t.right!=null&&(this.right=d.z.number(t.right,o.right,u)),this}getCenter(t,o){const u=d.ac((this.left+t-this.right)/2,0,t),c=d.ac((this.top+o-this.bottom)/2,0,o);return new d.P(u,c)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Jo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const uu=85.051129;class qa{constructor(t,o,u,c,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=u??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Jo,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new qa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const o=-d.b1(t,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var u=new d.A(4);return d.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,c,m){var x=c[0],b=c[1],I=c[2],k=c[3],z=Math.sin(m),A=Math.cos(m);u[0]=x*A+I*z,u[1]=b*A+k*z,u[2]=x*-z+I*A,u[3]=b*-z+k*A}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=d.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,u){this._unmodified=!1,this._edgeInsets.interpolate(t,o,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new d.b2(0,t)];if(this._renderWorldCopies){const u=this.pointCoordinate(new d.P(0,0)),c=this.pointCoordinate(new d.P(this.width,0)),m=this.pointCoordinate(new d.P(this.width,this.height)),x=this.pointCoordinate(new d.P(0,this.height)),b=Math.floor(Math.min(u.x,c.x,m.x,x.x)),I=Math.floor(Math.max(u.x,c.x,m.x,x.x)),k=1;for(let z=b-k;z<=I+k;z++)z!==0&&o.push(new d.b2(z,t))}return o}coveringTiles(t){var o,u;let c=this.coveringZoomLevel(t);const m=c;if(t.minzoom!==void 0&&c<t.minzoom)return[];t.maxzoom!==void 0&&c>t.maxzoom&&(c=t.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),b=d.Y.fromLngLat(this.center),I=Math.pow(2,c),k=[I*x.x,I*x.y,0],z=[I*b.x,I*b.y,0],A=ms.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c);let F=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=c);const G=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,Z=K=>({aabb:new ro([K*I,0,0],[(K+1)*I,I,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),W=[],V=[],ie=c,pe=t.reparseOverscaled?m:c;if(this._renderWorldCopies)for(let K=1;K<=3;K++)W.push(Z(-K)),W.push(Z(K));for(W.push(Z(0));W.length>0;){const K=W.pop(),le=K.x,fe=K.y;let me=K.fullyVisible;if(!me){const Ze=K.aabb.intersects(A);if(Ze===0)continue;me=Ze===2}const ge=t.terrain?k:z,Ce=K.aabb.distanceX(ge),Se=K.aabb.distanceY(ge),Ie=Math.max(Math.abs(Ce),Math.abs(Se));if(K.zoom===ie||Ie>G+(1<<ie-K.zoom)-2&&K.zoom>=F){const Ze=ie-K.zoom,ct=k[0]-.5-(le<<Ze),Fe=k[1]-.5-(fe<<Ze);V.push({tileID:new d.Q(K.zoom===ie?pe:K.zoom,K.wrap,K.zoom,le,fe),distanceSq:xt([z[0]-.5-le,z[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(ct*ct+Fe*Fe)})}else for(let Ze=0;Ze<4;Ze++){const ct=(le<<1)+Ze%2,Fe=(fe<<1)+(Ze>>1),ot=K.zoom+1;let gt=K.aabb.quadrant(Ze);if(t.terrain){const St=new d.Q(ot,K.wrap,ot,ct,Fe),lt=t.terrain.getMinMaxElevation(St),_t=(o=lt.minElevation)!==null&&o!==void 0?o:this.elevation,vt=(u=lt.maxElevation)!==null&&u!==void 0?u:this.elevation;gt=new ro([gt.min[0],gt.min[1],_t],[gt.max[0],gt.max[1],vt])}W.push({aabb:gt,zoom:ot,x:ct,y:Fe,wrap:K.wrap,fullyVisible:me})}}return V.sort((K,le)=>K.distanceSq-le.distanceSq).map(K=>K.tileID)}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=d.ac(t.lat,-85.051129,uu);return new d.P(d.N(t.lng)*this.worldSize,d.O(o)*this.worldSize)}unproject(t){return new d.Y(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const o=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,c=this.pointLocation(this.centerPoint,t),m=t.getElevationForLngLatZoom(c,this.tileZoom);if(!(this.elevation-m))return;const x=u+o-m,b=Math.cos(this._pitch)*this.cameraToCenterDistance/x/d.b3(1,c.lat),I=this.scaleZoom(b/this.tileSize);this._elevation=m,this._center=c,this.zoom=I}setLocationAtPoint(t,o){const u=this.pointCoordinate(o),c=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(t),x=new d.Y(m.x-(u.x-c.x),m.y-(u.y-c.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,o){return o?this.coordinatePoint(this.locationCoordinate(t),o.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,o){return this.coordinateLocation(this.pointCoordinate(t,o))}locationCoordinate(t){return d.Y.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,o){if(o){const F=o.pointCoordinate(t);if(F!=null)return F}const u=[t.x,t.y,0,1],c=[t.x,t.y,1,1];d.af(u,u,this.pixelMatrixInverse),d.af(c,c,this.pixelMatrixInverse);const m=u[3],x=c[3],b=u[1]/m,I=c[1]/x,k=u[2]/m,z=c[2]/x,A=k===z?0:(0-k)/(z-k);return new d.Y(d.z.number(u[0]/m,c[0]/x,A)/this.worldSize,d.z.number(b,I,A)/this.worldSize)}coordinatePoint(t,o=0,u=this.pixelMatrix){const c=[t.x*this.worldSize,t.y*this.worldSize,o,1];return d.af(c,c,u),new d.P(c[0]/c[3],c[1]/c[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new bi().extend(this.pointLocation(new d.P(0,t))).extend(this.pointLocation(new d.P(this.width,t))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new bi([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,uu])}calculatePosMatrix(t,o=!1){const u=t.key,c=o?this._alignedPosMatrixCache:this._posMatrixCache;if(c[u])return c[u];const m=t.canonical,x=this.worldSize/this.zoomScale(m.z),b=m.x+Math.pow(2,m.z)*t.wrap,I=d.an(new Float64Array(16));return d.H(I,I,[b*x,m.y*x,0]),d.J(I,I,[x/d.W,x/d.W,1]),d.K(I,o?this.alignedProjMatrix:this.projMatrix,I),c[u]=new Float32Array(I),c[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,o){o=d.ac(+o,this.minZoom,this.maxZoom);const u={center:new d.M(t.lng,t.lat),zoom:o};let c=this.lngRange;if(!this._renderWorldCopies&&c===null){const K=179.9999999999;c=[-K,K]}const m=this.tileSize*this.zoomScale(u.zoom);let x=0,b=m,I=0,k=m,z=0,A=0;const{x:F,y:G}=this.size;if(this.latRange){const K=this.latRange;x=d.O(K[1])*m,b=d.O(K[0])*m,b-x<G&&(z=G/(b-x))}c&&(I=d.b1(d.N(c[0])*m,0,m),k=d.b1(d.N(c[1])*m,0,m),k<I&&(k+=m),k-I<F&&(A=F/(k-I)));const{x:Z,y:W}=this.project.call({worldSize:m},t);let V,ie;const pe=Math.max(A||0,z||0);if(pe){const K=new d.P(A?(k+I)/2:Z,z?(b+x)/2:W);return u.center=this.unproject.call({worldSize:m},K).wrap(),u.zoom+=this.scaleZoom(pe),u}if(this.latRange){const K=G/2;W-K<x&&(ie=x+K),W+K>b&&(ie=b-K)}if(c){const K=(I+k)/2;let le=Z;this._renderWorldCopies&&(le=d.b1(Z,K-m/2,K+m/2));const fe=F/2;le-fe<I&&(V=I+fe),le+fe>k&&(V=k-fe)}if(V!==void 0||ie!==void 0){const K=new d.P(V??Z,ie??W);u.center=this.unproject.call({worldSize:m},K).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=o,this.zoom=u,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,o=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b3(1,this.center.lat)*this.worldSize;let c=d.an(new Float64Array(16));d.J(c,c,[this.width/2,-this.height/2,1]),d.H(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=d.an(new Float64Array(16)),d.J(c,c,[1,-1,1]),d.H(c,c,[-1,-1,0]),d.J(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this.minElevationForCurrentTile),b=m-x*this._pixelPerMeter/Math.cos(this._pitch),I=x<0?b:m,k=Math.PI/2+this._pitch,z=this._fov*(.5+t.y/this.height),A=Math.sin(z)*I/Math.sin(d.ac(Math.PI-k-z,.01,Math.PI-.01)),F=this.getHorizon(),G=2*Math.atan(F/this.cameraToCenterDistance)*(.5+t.y/(2*F)),Z=Math.sin(G)*I/Math.sin(d.ac(Math.PI-k-G,.01,Math.PI-.01)),W=Math.min(A,Z),V=1.01*(Math.cos(Math.PI/2-this._pitch)*W+I),ie=this.height/50;c=new Float64Array(16),d.b4(c,this._fov,this.width/this.height,ie,V),c[8]=2*-t.x/this.width,c[9]=2*t.y/this.height,d.J(c,c,[1,-1,1]),d.H(c,c,[0,0,-this.cameraToCenterDistance]),d.b5(c,c,this._pitch),d.ad(c,c,this.angle),d.H(c,c,[-o,-u,0]),this.mercatorMatrix=d.J([],c,[this.worldSize,this.worldSize,this.worldSize]),d.J(c,c,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.K(new Float64Array(16),this.labelPlaneMatrix,c),d.H(c,c,[0,0,-this.elevation]),this.projMatrix=c,this.invProjMatrix=d.ar([],c),this.pixelMatrix3D=d.K(new Float64Array(16),this.labelPlaneMatrix,c);const pe=this.width%2/2,K=this.height%2/2,le=Math.cos(this.angle),fe=Math.sin(this.angle),me=o-Math.round(o)+le*pe+fe*K,ge=u-Math.round(u)+le*K+fe*pe,Ce=new Float64Array(c);if(d.H(Ce,Ce,[me>.5?me-1:me,ge>.5?ge-1:ge,0]),this.alignedProjMatrix=Ce,c=d.ar(new Float64Array(16),this.pixelMatrix),!c)throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new d.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return d.af(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,t))}getCameraQueryGeometry(t){const o=this.getCameraPoint();if(t.length===1)return[t[0],o];{let u=o.x,c=o.y,m=o.x,x=o.y;for(const b of t)u=Math.min(u,b.x),c=Math.min(c,b.y),m=Math.max(m,b.x),x=Math.max(x,b.y);return[new d.P(u,c),new d.P(m,c),new d.P(m,x),new d.P(u,x),new d.P(u,c)]}}lngLatToCameraDepth(t,o){const u=this.locationCoordinate(t),c=[u.x*this.worldSize,u.y*this.worldSize,o,1];return d.af(c,c,this.projMatrix),c[2]/c[3]}}function cu(p,t){let o,u=!1,c=null,m=null;const x=()=>{c=null,u&&(p.apply(m,o),c=setTimeout(x,t),u=!1)};return(...b)=>(u=!0,m=this,o=b,c||x(),c)}class hu{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let u;return o.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(u=c)}),(u&&u[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:u,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}},this._updateHash=cu(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const o=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,c=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,c),x=Math.round(o.lng*m)/m,b=Math.round(o.lat*m)/m,I=this._map.getBearing(),k=this._map.getPitch();let z="";if(z+=t?`/${x}/${b}/${u}`:`${u}/${b}/${x}`,(I||k)&&(z+="/"+Math.round(10*I)/10),k&&(z+=`/${Math.round(k)}`),this._hashName){const A=this._hashName;let F=!1;const G=window.location.hash.slice(1).split("&").map(Z=>{const W=Z.split("=")[0];return W===A?(F=!0,`${W}=${z}`):Z}).filter(Z=>Z);return F||G.push(`${A}=${z}`),`#${G.join("&")}`}return`#${z}`}}const mn={linearity:.3,easing:d.b6(0,0,.3,1)},gh=d.e({deceleration:2500,maxSpeed:1400},mn),yh=d.e({deceleration:20,maxSpeed:1400},mn),_h=d.e({deceleration:1e3,maxSpeed:360},mn),vh=d.e({deceleration:1e3,maxSpeed:90},mn);class xh{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:X.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=X.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(o.pan.mag()){const m=ea(o.pan.mag(),u,d.e({},gh,t||{}));c.offset=o.pan.mult(m.amount/o.pan.mag()),c.center=this._map.transform.center,Qo(c,m)}if(o.zoom){const m=ea(o.zoom,u,yh);c.zoom=this._map.transform.zoom+m.amount,Qo(c,m)}if(o.bearing){const m=ea(o.bearing,u,_h);c.bearing=this._map.transform.bearing+d.ac(m.amount,-179,179),Qo(c,m)}if(o.pitch){const m=ea(o.pitch,u,vh);c.pitch=this._map.transform.pitch+m.amount,Qo(c,m)}if(c.zoom||c.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;c.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),d.e(c,{noMoveStart:!0})}}function Qo(p,t){(!p.duration||p.duration<t.duration)&&(p.duration=t.duration,p.easing=t.easing)}function ea(p,t,o){const{maxSpeed:u,linearity:c,deceleration:m}=o,x=d.ac(p*c/(t/1e3),-u,u),b=Math.abs(x)/(m*c);return{easing:o.easing,duration:1e3*b,amount:x*(b/2)}}class Mi extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u,c={}){const m=U.mousePos(o.getCanvas(),u),x=o.unproject(m);super(t,d.e({point:m,lngLat:x,originalEvent:u},c)),this._defaultPrevented=!1,this.target=o}}class no extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u){const c=t==="touchend"?u.changedTouches:u.touches,m=U.touchPos(o.getCanvasContainer(),c),x=m.map(I=>o.unproject(I)),b=m.reduce((I,k,z,A)=>I.add(k.div(A.length)),new d.P(0,0));super(t,{points:m,point:b,lngLats:x,lngLat:o.unproject(b),originalEvent:u}),this._defaultPrevented=!1}}class Vr extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,u){super(t,{originalEvent:u}),this._defaultPrevented=!1}}class gn{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Vr(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Mi(t.type,this._map,t))}mouseup(t){this._map.fire(new Mi(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Mi(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Mi(t.type,this._map,t))}mouseover(t){this._map.fire(new Mi(t.type,this._map,t))}mouseout(t){this._map.fire(new Mi(t.type,this._map,t))}touchstart(t){return this._firePreventable(new no(t.type,this._map,t))}touchmove(t){this._map.fire(new no(t.type,this._map,t))}touchend(t){this._map.fire(new no(t.type,this._map,t))}touchcancel(t){this._map.fire(new no(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wh{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Mi(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Mi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(d.P.convert(t),this._map.terrain)}}class so{constructor(t,o){this._map=t,this._tr=new lr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(U.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const u=o;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const c=this._startPos;this._lastPos=u,this._box||(this._box=U.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(c.x,u.x),x=Math.max(c.x,u.x),b=Math.min(c.y,u.y),I=Math.max(c.y,u.y);U.setTransform(this._box,`translate(${m}px,${b}px)`),this._box.style.width=x-m+"px",this._box.style.height=I-b+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const u=this._startPos,c=o;if(this.reset(),U.suppressClick(),u.x!==c.x||u.y!==c.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(u,c,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(U.remove(this._box),this._box=null),U.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new d.k(t,{originalEvent:o}))}}function du(p,t){if(p.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${t.length}`);const o={};for(let u=0;u<p.length;u++)o[p[u].identifier]=t[u];return o}class jp{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),u.length===this.numTouches&&(this.centroid=function(c){const m=new d.P(0,0);for(const x of c)m._add(x);return m.div(c.length)}(o),this.touches=du(u,o)))}touchmove(t,o,u){if(this.aborted||!this.centroid)return;const c=du(u,o);for(const m in this.touches){const x=c[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(t,o,u){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class pu{constructor(t){this.singleTap=new jp(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,u){this.singleTap.touchstart(t,o,u)}touchmove(t,o,u){this.singleTap.touchmove(t,o,u)}touchend(t,o,u){const c=this.singleTap.touchend(t,o,u);if(c){const m=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(c)<30;if(m&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class bh{constructor(t){this._tr=new lr(t),this._zoomIn=new pu({numTouches:1,numTaps:2}),this._zoomOut=new pu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,u){this._zoomIn.touchstart(t,o,u),this._zoomOut.touchstart(t,o,u)}touchmove(t,o,u){this._zoomIn.touchmove(t,o,u),this._zoomOut.touchmove(t,o,u)}touchend(t,o,u){const c=this._zoomIn.touchend(t,o,u),m=this._zoomOut.touchend(t,o,u),x=this._tr;return c?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(c)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pn{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const c=o.length?o[0]:o;return!this._moved&&c.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=c,this._move(u,c))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&U.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Xn={0:1,2:2};class qe{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=U.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(o,u){const c=Xn[u];return o.buttons===void 0||(o.buttons&c)!==c}(t,this._eventButton)}isValidEndEvent(t){return U.mouseButton(t)===this._eventButton}}class fu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const gs=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(t){t.preventDefault()}},oo=({enable:p,clickTolerance:t,bearingDegreesPerPixelMoved:o=.8})=>{const u=new qe({checkCorrectEvent:c=>U.mouseButton(c)===0&&c.ctrlKey||U.mouseButton(c)===2});return new Pn({clickTolerance:t,move:(c,m)=>({bearingDelta:(m.x-c.x)*o}),moveStateManager:u,enable:p,assignEvents:gs})},mu=({enable:p,clickTolerance:t,pitchDegreesPerPixelMoved:o=-.5})=>{const u=new qe({checkCorrectEvent:c=>U.mouseButton(c)===0&&c.ctrlKey||U.mouseButton(c)===2});return new Pn({clickTolerance:t,move:(c,m)=>({pitchDelta:(m.y-c.y)*o}),moveStateManager:u,enable:p,assignEvents:gs})};class $e{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(t,o,u){return this._calculateTransform(t,o,u)}touchmove(t,o,u){if(this._active&&!(u.length<this.minTouchs()))return t.preventDefault(),this._calculateTransform(t,o,u)}touchend(t,o,u){this._calculateTransform(t,o,u),this._active&&u.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,u){u.length>0&&(this._active=!0);const c=du(u,o),m=new d.P(0,0),x=new d.P(0,0);let b=0;for(const k in c){const z=c[k],A=this._touches[k];A&&(m._add(z),x._add(z.sub(A)),b++,c[k]=z)}if(this._touches=c,b<this.minTouchs()||!x.mag())return;const I=x.div(b);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(b),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ta{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,u){if(!this._firstTwoTouches)return;t.preventDefault();const[c,m]=this._firstTwoTouches,x=Ga(u,o,c),b=Ga(u,o,m);if(!x||!b)return;const I=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],I,t)}touchend(t,o,u){if(!this._firstTwoTouches)return;const[c,m]=this._firstTwoTouches,x=Ga(u,o,c),b=Ga(u,o,m);x&&b||(this._active&&U.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ga(p,t,o){for(let u=0;u<p.length;u++)if(p[u].identifier===o)return t[u]}function Sh(p,t){return Math.log(p/t)/Math.LN2}class Ha extends ta{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const u=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Sh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sh(this._distance,u),pinchAround:o}}}function gu(p,t){return 180*p.angleWith(t)/Math.PI}class yu extends ta{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,u){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:gu(this._vector,c),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,u=gu(t,this._startVector);return Math.abs(u)<o}}function _u(p){return Math.abs(p.y)>Math.abs(p.x)}class Th extends ta{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,u){super.touchstart(t,o,u),this._currentTouchCount=u.length}_start(t){this._lastPoints=t,_u(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const c=t[0].sub(this._lastPoints[0]),m=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(c,m,u.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(c.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,u){if(this._valid!==void 0)return this._valid;const c=t.mag()>=2,m=o.mag()>=2;if(!c&&!m)return;if(!c||!m)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const x=t.y>0==o.y>0;return _u(t)&&_u(o)&&x}}const ys={panStep:100,bearingStep:15,pitchStep:10};class Ht{constructor(t){this._tr=new lr(t);const o=ys;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,u=0,c=0,m=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?u=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?u=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,c=0),{cameraAnimation:b=>{const I=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:Wa,zoom:o?Math.round(I.zoom)+o*(t.shiftKey?2:1):I.zoom,bearing:I.bearing+u*this._bearingStep,pitch:I.pitch+c*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:I.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Wa(p){return p*(2-p)}const Ka=4.000244140625;class vu{constructor(t,o){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=t,this._tr=new lr(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!t[this._map.cooperativeGestures._bypassKey])return;let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const u=X.now(),c=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,o!==0&&o%Ka==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(c*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=U.mousePos(this._map.getCanvas(),t),u=this._tr;this._around=o.y>u.transform.height/2-u.transform.getHorizon()?d.M.convert(this._aroundCenter?u.center:u.unproject(o)):d.M.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Ka?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&I!==0&&(I=1/I);const k=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(k*I))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,u=this._startZoom,c=this._easing;let m,x=!1;if(this._type==="wheel"&&u&&c){const b=Math.min((X.now()-this._lastWheelEventTime)/200,1),I=c(b);m=d.z.number(u,o,I),b<1?this._frameId||(this._frameId=!0):x=!0}else m=o,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=d.b7;if(this._prevEase){const u=this._prevEase,c=(X.now()-u.start)/u.duration,m=u.easing(c+.01)-u.easing(c),x=.27/Math.sqrt(m*m+1e-4)*.01,b=Math.sqrt(.0729-x*x);o=d.b6(x,b,.25,1)}return this._prevEase={start:X.now(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class xu{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ih{constructor(t){this._tr=new lr(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Up{constructor(){this._tap=new pu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,u){if(!this._swipePoint)if(this._tapTime){const c=o[0],m=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(c)<30;m&&x?u.length>0&&(this._swipePoint=c,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(t,o,u)}touchmove(t,o,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const c=o[0],m=c.y-this._swipePoint.y;return this._swipePoint=c,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,o,u)}touchend(t,o,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const c=this._tap.touchend(t,o,u);c&&(this._tapTime=t.timeStamp,this._tapPoint=c)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xr{constructor(t,o,u){this._el=t,this._mousePan=o,this._touchPan=u}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ia{constructor(t,o,u){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class et{constructor(t,o,u,c){this._el=t,this._touchZoom=o,this._touchRotate=u,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class nt{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=U.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),c=document.createElement("div");c.className="maplibregl-desktop-message",c.textContent=o,this._container.appendChild(c);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=u,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(U.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(t){this._onCooperativeGesture(t.touches.length===1)}wheel(t){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!t[this._bypassKey])}_onCooperativeGesture(t){this._enabled&&t&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const _s=p=>p.zoom||p.drag||p.pitch||p.rotate;class wu extends d.k{}function ra(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class ur{constructor(t,o){this.handleWindowEvent=c=>{this.handleEvent(c,`${c.type}Window`)},this.handleEvent=(c,m)=>{if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=c.type==="renderFrame"?void 0:c,b={needsRenderFrame:!1},I={},k={},z=c.touches,A=z?this._getMapTouches(z):void 0,F=A?U.touchPos(this._map.getCanvas(),A):U.mousePos(this._map.getCanvas(),c);for(const{handlerName:W,handler:V,allowed:ie}of this._handlers){if(!V.isEnabled())continue;let pe;this._blockedByActive(k,ie,W)?V.reset():V[m||c.type]&&(pe=V[m||c.type](c,F,A),this.mergeHandlerResult(b,I,pe,W,x),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||V.isActive())&&(k[W]=V)}const G={};for(const W in this._previousActiveHandlers)k[W]||(G[W]=x);this._previousActiveHandlers=k,(Object.keys(G).length||ra(b))&&(this._changes.push([b,I,G]),this._triggerRenderFrame()),(Object.keys(k).length||ra(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=b;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xh(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[c,m,x]of this._listeners)U.addEventListener(c,m,c===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,o,u]of this._listeners)U.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(t){const o=this._map,u=o.getCanvasContainer();this._add("mapEvent",new gn(o,t));const c=o.boxZoom=new so(o,t);this._add("boxZoom",c),t.interactive&&t.boxZoom&&c.enable();const m=o.cooperativeGestures=new nt(o,t.cooperativeGestures);this._add("cooperativeGestures",m),t.cooperativeGestures&&m.enable();const x=new bh(o),b=new Ih(o);o.doubleClickZoom=new xu(b,x),this._add("tapZoom",x),this._add("clickZoom",b),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const I=new Up;this._add("tapDragZoom",I);const k=o.touchPitch=new Th(o);this._add("touchPitch",k),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const z=oo(t),A=mu(t);o.dragRotate=new ia(t,z,A),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",A,["mouseRotate"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const F=(({enable:pe,clickTolerance:K})=>{const le=new qe({checkCorrectEvent:fe=>U.mouseButton(fe)===0&&!fe.ctrlKey});return new Pn({clickTolerance:K,move:(fe,me)=>({around:me,panDelta:me.sub(fe)}),activateOnStart:!0,moveStateManager:le,enable:pe,assignEvents:gs})})(t),G=new $e(t,o);o.dragPan=new Xr(u,F,G),this._add("mousePan",F),this._add("touchPan",G,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const Z=new yu,W=new Ha;o.touchZoomRotate=new et(u,W,Z,I),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate);const V=o.scrollZoom=new vu(o,()=>this._triggerRenderFrame());this._add("scrollZoom",V,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const ie=o.keyboard=new Ht(o);this._add("keyboard",ie),t.interactive&&t.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new wh(o))}_add(t,o,u){this._handlers.push({handlerName:t,handler:o,allowed:u}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_s(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,u){for(const c in t)if(c!==u&&(!o||o.indexOf(c)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const u of t)this._el.contains(u.target)&&o.push(u);return o}mergeHandlerResult(t,o,u,c,m){if(!u)return;d.e(t,u);const x={handlerName:c,originalEvent:u.originalEvent||m};u.zoomDelta!==void 0&&(o.zoom=x),u.panDelta!==void 0&&(o.drag=x),u.pitchDelta!==void 0&&(o.pitch=x),u.bearingDelta!==void 0&&(o.rotate=x)}_applyChanges(){const t={},o={},u={};for(const[c,m,x]of this._changes)c.panDelta&&(t.panDelta=(t.panDelta||new d.P(0,0))._add(c.panDelta)),c.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+c.pitchDelta),c.around!==void 0&&(t.around=c.around),c.pinchAround!==void 0&&(t.pinchAround=c.pinchAround),c.noInertia&&(t.noInertia=c.noInertia),d.e(o,m),d.e(u,x);this._updateMapTransform(t,o,u),this._changes=[]}_updateMapTransform(t,o,u){const c=this._map,m=c._getTransformForUpdate(),x=c.terrain;if(!(ra(t)||x&&this._terrainMovement))return this._fireEvents(o,u,!0);let{panDelta:b,zoomDelta:I,bearingDelta:k,pitchDelta:z,around:A,pinchAround:F}=t;F!==void 0&&(A=F),c._stop(!0),A=A||c.transform.centerPoint;const G=m.pointLocation(b?A.sub(b):A);k&&(m.bearing+=k),z&&(m.pitch+=z),I&&(m.zoom+=I),x?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(b)):m.setLocationAtPoint(G,A):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(G,A),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,m.recalculateZoom(c.terrain)})):m.setLocationAtPoint(G,A),c._applyUpdatedTransform(m),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,u,!0)}_fireEvents(t,o,u){const c=_s(this._eventsInProgress),m=_s(t),x={};for(const z in t){const{originalEvent:A}=t[z];this._eventsInProgress[z]||(x[`${z}start`]=A),this._eventsInProgress[z]=t[z]}!c&&m&&this._fireEvent("movestart",m.originalEvent);for(const z in x)this._fireEvent(z,x[z]);m&&this._fireEvent("move",m.originalEvent);for(const z in t){const{originalEvent:A}=t[z];this._fireEvent(z,A)}const b={};let I;for(const z in this._eventsInProgress){const{handlerName:A,originalEvent:F}=this._eventsInProgress[z];this._handlersById[A].isActive()||(delete this._eventsInProgress[z],I=o[A]||F,b[`${z}end`]=I)}for(const z in b)this._fireEvent(z,b[z]);const k=_s(this._eventsInProgress);if(u&&(c||m)&&!k){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),A=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!z||!z.essential&&X.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:I})),A(this._map.getBearing())&&this._map.resetNorth()):(A(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new d.k(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new wu("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ch extends d.E{constructor(t,o){super(),this._renderFrameCallback=()=>{const u=Math.min((X.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new d.M(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,u){return t=d.P.convert(t).mult(-1),this.panTo(this.transform.center,d.e({offset:t},o),u)}panTo(t,o,u){return this.easeTo(d.e({center:t},o),u)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,u){return this.easeTo(d.e({zoom:t},o),u)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,u){return this.easeTo(d.e({bearing:t},o),u)}resetNorth(t,o){return this.rotateTo(0,d.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=bi.convert(t);const u=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),u,o)}_cameraForBoxAndBearing(t,o,u,c){const m={top:0,bottom:0,right:0,left:0};if(typeof(c=d.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const Ze=c.padding;c.padding={top:Ze,bottom:Ze,right:Ze,left:Ze}}c.padding=d.e(m,c.padding);const x=this.transform,b=x.padding,I=new bi(t,o),k=x.project(I.getNorthWest()),z=x.project(I.getNorthEast()),A=x.project(I.getSouthEast()),F=x.project(I.getSouthWest()),G=d.b8(-u),Z=k.rotate(G),W=z.rotate(G),V=A.rotate(G),ie=F.rotate(G),pe=new d.P(Math.max(Z.x,W.x,ie.x,V.x),Math.max(Z.y,W.y,ie.y,V.y)),K=new d.P(Math.min(Z.x,W.x,ie.x,V.x),Math.min(Z.y,W.y,ie.y,V.y)),le=pe.sub(K),fe=(x.width-(b.left+b.right+c.padding.left+c.padding.right))/le.x,me=(x.height-(b.top+b.bottom+c.padding.top+c.padding.bottom))/le.y;if(me<0||fe<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ge=Math.min(x.scaleZoom(x.scale*Math.min(fe,me)),c.maxZoom),Ce=d.P.convert(c.offset),Se=new d.P((c.padding.left-c.padding.right)/2,(c.padding.top-c.padding.bottom)/2).rotate(d.b8(u)),Ie=Ce.add(Se).mult(x.scale/x.zoomScale(ge));return{center:x.unproject(k.add(A).div(2).sub(Ie)),zoom:ge,bearing:u}}fitBounds(t,o,u){return this._fitInternal(this.cameraForBounds(t,o),o,u)}fitScreenCoordinates(t,o,u,c,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(t)),this.transform.pointLocation(d.P.convert(o)),u,c),c,m)}_fitInternal(t,o,u){return t?(delete(o=d.e(t,o)).padding,o.linear?this.easeTo(o,u):this.flyTo(o,u)):this}jumpTo(t,o){this.stop();const u=this._getTransformForUpdate();let c=!1,m=!1,x=!1;return"zoom"in t&&u.zoom!==+t.zoom&&(c=!0,u.zoom=+t.zoom),t.center!==void 0&&(u.center=d.M.convert(t.center)),"bearing"in t&&u.bearing!==+t.bearing&&(m=!0,u.bearing=+t.bearing),"pitch"in t&&u.pitch!==+t.pitch&&(x=!0,u.pitch=+t.pitch),t.padding==null||u.isPaddingEqual(t.padding)||(u.padding=t.padding),this._applyUpdatedTransform(u),this.fire(new d.k("movestart",o)).fire(new d.k("move",o)),c&&this.fire(new d.k("zoomstart",o)).fire(new d.k("zoom",o)).fire(new d.k("zoomend",o)),m&&this.fire(new d.k("rotatestart",o)).fire(new d.k("rotate",o)).fire(new d.k("rotateend",o)),x&&this.fire(new d.k("pitchstart",o)).fire(new d.k("pitch",o)).fire(new d.k("pitchend",o)),this.fire(new d.k("moveend",o))}calculateCameraOptionsFromTo(t,o,u,c=0){const m=d.Y.fromLngLat(t,o),x=d.Y.fromLngLat(u,c),b=x.x-m.x,I=x.y-m.y,k=x.z-m.z,z=Math.hypot(b,I,k);if(z===0)throw new Error("Can't calculate camera options with same From and To");const A=Math.hypot(b,I),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/z/this.transform.tileSize),G=180*Math.atan2(b,-I)/Math.PI;let Z=180*Math.acos(A/z)/Math.PI;return Z=k<0?90-Z:90+Z,{center:x.toLngLat(),zoom:F,pitch:Z,bearing:G}}easeTo(t,o){var u;this._stop(!1,t.easeId),((t=d.e({offset:[0,0],duration:500,easing:d.b7},t)).animate===!1||!t.essential&&X.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),m=this.getZoom(),x=this.getBearing(),b=this.getPitch(),I=this.getPadding(),k="bearing"in t?this._normalizeBearing(t.bearing,x):x,z="pitch"in t?+t.pitch:b,A="padding"in t?t.padding:c.padding,F=d.P.convert(t.offset);let G=c.centerPoint.add(F);const Z=c.pointLocation(G),{center:W,zoom:V}=c.getConstrained(d.M.convert(t.center||Z),(u=t.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(W);const ie=c.project(Z),pe=c.project(W).sub(ie),K=c.zoomScale(V-m);let le,fe;t.around&&(le=d.M.convert(t.around),fe=c.locationPoint(le));const me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||V!==m,this._rotating=this._rotating||x!==k,this._pitching=this._pitching||z!==b,this._padding=!c.isPaddingEqual(A),this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,me),this.terrain&&this._prepareElevation(W),this._ease(ge=>{if(this._zooming&&(c.zoom=d.z.number(m,V,ge)),this._rotating&&(c.bearing=d.z.number(x,k,ge)),this._pitching&&(c.pitch=d.z.number(b,z,ge)),this._padding&&(c.interpolatePadding(I,A,ge),G=c.centerPoint.add(F)),this.terrain&&!t.freezeElevation&&this._updateElevation(ge),le)c.setLocationAtPoint(le,fe);else{const Ce=c.zoomScale(c.zoom-m),Se=V>m?Math.min(2,K):Math.max(.5,K),Ie=Math.pow(Se,1-ge),Ze=c.unproject(ie.add(pe.mult(ge*Ie)).mult(Ce));c.setLocationAtPoint(c.renderWorldCopies?Ze.wrap():Ze,G)}this._applyUpdatedTransform(c),this._fireMoveEvents(o)},ge=>{this.terrain&&this._finalizeElevation(),this._afterEase(o,ge)},t),this}_prepareEase(t,o,u={}){this._moving=!0,o||u.moving||this.fire(new d.k("movestart",t)),this._zooming&&!u.zooming&&this.fire(new d.k("zoomstart",t)),this._rotating&&!u.rotating&&this.fire(new d.k("rotatestart",t)),this._pitching&&!u.pitching&&this.fire(new d.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(u-(o-(u*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.elevation=d.z.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const o=t.clone(),{center:u,zoom:c,pitch:m,bearing:x,elevation:b}=this.transformCameraUpdate(o);u&&(o.center=u),c!==void 0&&(o.zoom=c),m!==void 0&&(o.pitch=m),x!==void 0&&(o.bearing=x),b!==void 0&&(o.elevation=b),this.transform.apply(o)}_fireMoveEvents(t){this.fire(new d.k("move",t)),this._zooming&&this.fire(new d.k("zoom",t)),this._rotating&&this.fire(new d.k("rotate",t)),this._pitching&&this.fire(new d.k("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const u=this._zooming,c=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new d.k("zoomend",t)),c&&this.fire(new d.k("rotateend",t)),m&&this.fire(new d.k("pitchend",t)),this.fire(new d.k("moveend",t))}flyTo(t,o){var u;if(!t.essential&&X.prefersReducedMotion){const St=d.L(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(St,o)}this.stop(),t=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b7},t);const c=this._getTransformForUpdate(),m=this.getZoom(),x=this.getBearing(),b=this.getPitch(),I=this.getPadding(),k="bearing"in t?this._normalizeBearing(t.bearing,x):x,z="pitch"in t?+t.pitch:b,A="padding"in t?t.padding:c.padding,F=d.P.convert(t.offset);let G=c.centerPoint.add(F);const Z=c.pointLocation(G),{center:W,zoom:V}=c.getConstrained(d.M.convert(t.center||Z),(u=t.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(W);const ie=c.zoomScale(V-m),pe=c.project(Z),K=c.project(W).sub(pe);let le=t.curve;const fe=Math.max(c.width,c.height),me=fe/ie,ge=K.mag();if("minZoom"in t){const St=d.ac(Math.min(t.minZoom,m,V),c.minZoom,c.maxZoom),lt=fe/c.zoomScale(St-m);le=Math.sqrt(lt/ge*2)}const Ce=le*le;function Se(St){const lt=(me*me-fe*fe+(St?-1:1)*Ce*Ce*ge*ge)/(2*(St?me:fe)*Ce*ge);return Math.log(Math.sqrt(lt*lt+1)-lt)}function Ie(St){return(Math.exp(St)-Math.exp(-St))/2}function Ze(St){return(Math.exp(St)+Math.exp(-St))/2}const ct=Se(!1);let Fe=function(St){return Ze(ct)/Ze(ct+le*St)},ot=function(St){return fe*((Ze(ct)*(Ie(lt=ct+le*St)/Ze(lt))-Ie(ct))/Ce)/ge;var lt},gt=(Se(!0)-ct)/le;if(Math.abs(ge)<1e-6||!isFinite(gt)){if(Math.abs(fe-me)<1e-6)return this.easeTo(t,o);const St=me<fe?-1:1;gt=Math.abs(Math.log(me/fe))/le,ot=function(){return 0},Fe=function(lt){return Math.exp(St*le*lt)}}return t.duration="duration"in t?+t.duration:1e3*gt/("screenSpeed"in t?+t.screenSpeed/le:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=x!==k,this._pitching=z!==b,this._padding=!c.isPaddingEqual(A),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(W),this._ease(St=>{const lt=St*gt,_t=1/Fe(lt);c.zoom=St===1?V:m+c.scaleZoom(_t),this._rotating&&(c.bearing=d.z.number(x,k,St)),this._pitching&&(c.pitch=d.z.number(b,z,St)),this._padding&&(c.interpolatePadding(I,A,St),G=c.centerPoint.add(F)),this.terrain&&!t.freezeElevation&&this._updateElevation(St);const vt=St===1?W:c.unproject(pe.add(K.mult(ot(lt))).mult(_t));c.setLocationAtPoint(c.renderWorldCopies?vt.wrap():vt,G),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(o)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,o)}if(!t){const u=this.handlers;u&&u.stop(!1)}return this}_ease(t,o,u){u.animate===!1||u.duration===0?(t(1),o()):(this._easeStart=X.now(),this._easeOptions=u,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=d.b1(t,-180,180);const u=Math.abs(t-o);return Math.abs(t-360-o)<u&&(t-=360),Math.abs(t+360-o)<u&&(t+=360),t}_normalizeCenter(t){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const u=t.lng-o.center.lng;t.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(d.M.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const Yr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class kh{constructor(t=Yr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=U.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=U.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=U.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){U.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const u=this._map._getUIString(`AttributionControl.${o}`);t.title=u,t.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(c=>typeof c!="string"?"":c)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const o=this._map.style.sourceCaches;for(const c in o){const m=o[c];if(m.used||m.usedForTerrain){const x=m.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(c=>String(c).trim()),t.sort((c,m)=>c.length-m.length),t=t.filter((c,m)=>{for(let x=m+1;x<t.length;x++)if(t[x].indexOf(c)>=0)return!1;return!0});const u=t.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,t.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ao{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const u=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=U.create("div","maplibregl-ctrl");const o=U.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){U.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ti{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,u=o?this._queue.concat(o):this._queue;for(const c of u)if(c.id===t)return void(c.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const u of o)if(!u.cancelled&&(u.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var di=d.X([{name:"a_pos3d",type:"Int16",components:3}]);class Eh extends d.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,o){this.sourceCache.update(t,o),this._renderableTilesKeys=[];const u={};for(const c of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))u[c.key]=!0,this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),d.aN(c.posMatrix,0,d.W,0,d.W,0,1),this._tiles[c.key]=new or(c,this.tileSize));for(const c in this._tiles)u[c]||delete this._tiles[c]}freeRtt(t){for(const o in this._tiles){const u=this._tiles[o];(!t||u.tileID.equals(t)||u.tileID.isChildOf(t)||t.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const o={};for(const u of this._renderableTilesKeys){const c=this._tiles[u].tileID;if(c.canonical.equals(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16),d.aN(m.posMatrix,0,d.W,0,d.W,0,1),o[u]=m}else if(c.canonical.isChildOf(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const x=c.canonical.z-t.canonical.z,b=c.canonical.x-(c.canonical.x>>x<<x),I=c.canonical.y-(c.canonical.y>>x<<x),k=d.W>>x;d.aN(m.posMatrix,0,k,0,k,0,1),d.H(m.posMatrix,m.posMatrix,[-b*k,-I*k,0]),o[u]=m}else if(t.canonical.isChildOf(c.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const x=t.canonical.z-c.canonical.z,b=t.canonical.x-(t.canonical.x>>x<<x),I=t.canonical.y-(t.canonical.y>>x<<x),k=d.W>>x;d.aN(m.posMatrix,0,d.W,0,d.W,0,1),d.H(m.posMatrix,m.posMatrix,[b*k,I*k,0]),d.J(m.posMatrix,m.posMatrix,[1/2**x,1/2**x,0]),o[u]=m}}return o}getSourceTile(t,o){const u=this.sourceCache._source;let c=t.overscaledZ-this.deltaZoom;if(c>u.maxzoom&&(c=u.maxzoom),c<u.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(c).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!m||!m.dem)&&o)for(;c>=u.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(t.scaledTo(c--).key);return m}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=t)}}class na{constructor(t,o,u){this.painter=t,this.sourceCache=new Eh(o),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,u,c=d.W){var m;if(!(o>=0&&o<c&&u>=0&&u<c))return 0;const x=this.getTerrainData(t),b=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!b)return 0;const I=function(Z,W,V){var ie=W[0],pe=W[1];return Z[0]=V[0]*ie+V[4]*pe+V[12],Z[1]=V[1]*ie+V[5]*pe+V[13],Z}([],[o/c*d.W,u/c*d.W],x.u_terrain_matrix),k=[I[0]*b.dim,I[1]*b.dim],z=Math.floor(k[0]),A=Math.floor(k[1]),F=k[0]-z,G=k[1]-A;return b.get(z,A)*(1-F)*(1-G)+b.get(z+1,A)*F*(1-G)+b.get(z,A+1)*(1-F)*G+b.get(z+1,A+1)*F*G}getElevationForLngLatZoom(t,o){const{tileID:u,mercatorX:c,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(u,c%d.W,m%d.W,d.W)}getElevation(t,o,u,c=d.W){return this.getDEMElevation(t,o,u,c)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const c=this.painter.context,m=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Nt(c,m,c.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Nt(c,new d.R({width:1,height:1}),c.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const o=this.sourceCache.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const c=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new Nt(c,o.dem.getPixels(),c.gl.RGBA,{premultiply:!1}),o.demTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const u=o&&o+o.tileID.key+t.key;if(u&&!this._demMatrixCache[u]){const c=this.sourceCache.sourceCache._source.maxzoom;let m=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=c?m=t.canonical.z-c:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>m<<m),b=t.canonical.y-(t.canonical.y>>m<<m),I=d.b9(new Float64Array(16),[1/(d.W<<m),1/(d.W<<m),0]);d.H(I,I,[x*d.W,b*d.W,0]),this._demMatrixCache[t.key]={matrix:I,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,u=o.width/devicePixelRatio,c=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===c||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Nt(o.context,{width:u,height:c,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Nt(o.context,{width:u,height:c,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(u,c,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,u,c))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)o[x+0]=255&b,o[x+1]=255&m,o[x+2]=b>>8<<4|m>>8,o[x+3]=0;const u=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),c=new Nt(t,u,t.gl.RGBA,{premultiply:!1});return c.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=c,c}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),u=this.painter.context,c=u.gl;u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),c.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,c.RGBA,c.UNSIGNED_BYTE,o),u.bindFramebuffer.set(null);const m=o[0]+(o[2]>>4<<8),x=o[1]+((15&o[2])<<8),b=this.coordsIndex[255-o[3]],I=b&&this.sourceCache.getTileByID(b);if(!I)return null;const k=this._coordsTextureSize,z=(1<<I.tileID.canonical.z)*k;return new d.Y((I.tileID.canonical.x*k+m)/z+I.tileID.wrap,(I.tileID.canonical.y*k+x)/z,this.getElevation(I.tileID,m,x,k))}depthAtPoint(t){const o=new Uint8Array(4),u=this.painter.context,c=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),c.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,c.RGBA,c.UNSIGNED_BYTE,o),u.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,o=new d.ba,u=new d.aX,c=this.meshSize,m=d.W/c,x=c*c;for(let A=0;A<=c;A++)for(let F=0;F<=c;F++)o.emplaceBack(F*m,A*m,0);for(let A=0;A<x;A+=c+1)for(let F=0;F<c;F++)u.emplaceBack(F+A,c+F+A+1,c+F+A+2),u.emplaceBack(F+A,c+F+A+2,F+A+1);const b=o.length,I=b+2*(c+1);for(const A of[0,1])for(let F=0;F<=c;F++)for(const G of[0,1])o.emplaceBack(F*m,A*d.W,G);for(let A=0;A<2*c;A+=2)u.emplaceBack(I+A,I+A+1,I+A+3),u.emplaceBack(I+A,I+A+3,I+A+2),u.emplaceBack(b+A,b+A+3,b+A+1),u.emplaceBack(b+A,b+A+2,b+A+3);const k=o.length,z=k+2*(c+1);for(const A of[0,1])for(let F=0;F<=c;F++)for(const G of[0,1])o.emplaceBack(A*d.W,F*m,G);for(let A=0;A<2*c;A+=2)u.emplaceBack(k+A,k+A+1,k+A+3),u.emplaceBack(k+A,k+A+3,k+A+2),u.emplaceBack(z+A,z+A+3,z+A+1),u.emplaceBack(z+A,z+A+2,z+A+3);return this._mesh={indexBuffer:t.createIndexBuffer(u),vertexBuffer:t.createVertexBuffer(o,di.members),segments:d.$.simpleSegment(0,0,o.length,u.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*d.bb/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,o){var u;const{tileID:c}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(u=this.getMinMaxElevation(c).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,u={minElevation:null,maxElevation:null};return o&&o.dem&&(u.minElevation=o.dem.min*this.exaggeration,u.maxElevation=o.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(t,o){const u=d.Y.fromLngLat(t.wrap()),c=(1<<o)*d.W,m=u.x*c,x=u.y*c,b=Math.floor(m/d.W),I=Math.floor(x/d.W);return{tileID:new d.Q(o,0,o,b,I),mercatorX:m,mercatorY:x}}}class Xa{constructor(t,o,u){this._context=t,this._size=o,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new Nt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(u.texture),{id:t,fbo:o,texture:u,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>t.id!==o),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Yn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class bu{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new Xa(t.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(u=>!t._layers[u].isHidden(o)),this._coordsDescendingInv={};for(const u in t.sourceCaches){this._coordsDescendingInv[u]={};const c=t.sourceCaches[u].getVisibleCoordinates();for(const m of c){const x=this.terrain.sourceCache.getTerrainCoords(m);for(const b in x)this._coordsDescendingInv[u][b]||(this._coordsDescendingInv[u][b]=[]),this._coordsDescendingInv[u][b].push(x[b])}}this._coordsDescendingInvStr={};for(const u of t._order){const c=t._layers[u],m=c.source;if(Yn[c.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const x in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][x]=this._coordsDescendingInv[m][x].map(b=>b.key).sort().join()}}for(const u of this._renderableTiles)for(const c in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[c][u.tileID.key];m&&m!==u.rttCoords[c]&&(u.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const o=t.type,u=this.painter,c=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Yn[o]&&(this._prevType&&Yn[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(t.id),!c))return!0;if(Yn[this._prevType]||Yn[o]&&c){this._prevType=o;const m=this._stacks.length-1,x=this._stacks[m]||[];for(const b of this._renderableTiles){if(this.pool.isFull()&&(lu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(b),b.rtt[m]){const k=this.pool.getObjectForId(b.rtt[m].id);if(k.stamp===b.rtt[m].stamp){this.pool.useObject(k);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),b.rtt[m]={id:I.id,stamp:I.stamp},u.context.bindFramebuffer.set(I.fbo.framebuffer),u.context.clear({color:d.aO.transparent,stencil:0}),u.currentStencilSource=void 0;for(let k=0;k<x.length;k++){const z=u.style._layers[x[k]],A=z.source?this._coordsDescendingInv[z.source][b.tileID.key]:[b.tileID];u.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),u._renderTileClippingMasks(z,A),u.renderLayer(u,u.style.sourceCaches[z.source],z,A),z.source&&(b.rttCoords[z.source]=this._coordsDescendingInvStr[z.source][b.tileID.key])}}return lu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Yn[o]}return!1}}const Su={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},sa=N,Tu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:Yr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Ya=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},Iu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Cu{constructor(t,o,u=!1){this.mousedown=x=>{this.startMouse(d.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),U.mousePos(this.element,x)),U.addEventListener(window,"mousemove",this.mousemove),U.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,U.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=U.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),U.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=U.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const c=t.dragRotate._mouseRotate.getClickTolerance(),m=t.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=oo({clickTolerance:c,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:b,bearingDegreesPerPixelMoved:I=.8})=>{const k=new fu;return new Pn({clickTolerance:b,move:(z,A)=>({bearingDelta:(A.x-z.x)*I}),moveStateManager:k,enable:x,assignEvents:Ya})})({clickTolerance:c,enable:!0}),this.map=t,u&&(this.mousePitch=mu({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:b,pitchDegreesPerPixelMoved:I=-.5})=>{const k=new fu;return new Pn({clickTolerance:b,move:(z,A)=>({pitchDelta:(A.y-z.y)*I}),moveStateManager:k,enable:x,assignEvents:Ya})})({clickTolerance:m,enable:!0})),U.addEventListener(o,"mousedown",this.mousedown),U.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),U.addEventListener(o,"touchcancel",this.reset)}startMouse(t,o){this.mouseRotate.dragStart(t,o),this.mousePitch&&this.mousePitch.dragStart(t,o),U.disableDrag()}startTouch(t,o){this.touchRotate.dragStart(t,o),this.touchPitch&&this.touchPitch.dragStart(t,o),U.disableDrag()}moveMouse(t,o){const u=this.map,{bearingDelta:c}=this.mouseRotate.dragMove(t,o)||{};if(c&&u.setBearing(u.getBearing()+c),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(t,o)||{};m&&u.setPitch(u.getPitch()+m)}}moveTouch(t,o){const u=this.map,{bearingDelta:c}=this.touchRotate.dragMove(t,o)||{};if(c&&u.setBearing(u.getBearing()+c),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(t,o)||{};m&&u.setPitch(u.getPitch()+m)}}off(){const t=this.element;U.removeEventListener(t,"mousedown",this.mousedown),U.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend),U.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){U.enableDrag(),U.removeEventListener(window,"mousemove",this.mousemove),U.removeEventListener(window,"mouseup",this.mouseup),U.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),U.removeEventListener(window,"touchend",this.touchend)}}let zn;function Ja(p,t,o){const u=new d.M(p.lng,p.lat);if(p=new d.M(p.lng,p.lat),t){const c=new d.M(p.lng-360,p.lat),m=new d.M(p.lng+360,p.lat),x=o.locationPoint(p).distSqr(t);o.locationPoint(c).distSqr(t)<x?p=c:o.locationPoint(m).distSqr(t)<x&&(p=m)}for(;Math.abs(p.lng-o.center.lng)>180;){const c=o.locationPoint(p);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;p.lng>o.center.lng?p.lng-=360:p.lng+=360}return p.lng!==u.lng&&o.locationPoint(p).y>o.height/2-o.getHorizon()?p:u}const oa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Qa(p,t,o){const u=p.classList;for(const c in oa)u.remove(`maplibregl-${o}-anchor-${c}`);u.add(`maplibregl-${o}-anchor-${t}`)}class lo extends d.E{constructor(t){if(super(),this._onKeyPress=o=>{const u=o.code,c=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&c!==32&&c!==13||this.togglePopup()},this._onMapClick=o=>{const u=o.originalEvent.target,c=this._element;this._popup&&(u===c||c.contains(u))&&this.togglePopup()},this._update=o=>{var u;if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ja(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),U.setTransform(this._element,`${oa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${m}`),X.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=d.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=U.create("div"),this._element.setAttribute("aria-label","Map marker");const o=U.createNS("http://www.w3.org/2000/svg","svg"),u=41,c=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${u}px`),o.setAttributeNS(null,"width",`${c}px`),o.setAttributeNS(null,"viewBox",`0 0 ${c} ${u}`);const m=U.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const x=U.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const b=U.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of I){const pe=U.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",ie.rx),pe.setAttributeNS(null,"ry",ie.ry),b.appendChild(pe)}const k=U.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const z=U.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(z);const A=U.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"opacity","0.25"),A.setAttributeNS(null,"fill","#000000");const F=U.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),A.appendChild(F);const G=U.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const Z=U.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const W=U.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#000000"),W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962");const V=U.createNS("http://www.w3.org/2000/svg","circle");V.setAttributeNS(null,"fill","#FFFFFF"),V.setAttributeNS(null,"cx","5.5"),V.setAttributeNS(null,"cy","5.5"),V.setAttributeNS(null,"r","5.4999962"),Z.appendChild(W),Z.appendChild(V),x.appendChild(b),x.appendChild(k),x.appendChild(A),x.appendChild(G),x.appendChild(Z),o.appendChild(x),o.setAttributeNS(null,"height",u*this._scale+"px"),o.setAttributeNS(null,"width",c*this._scale+"px"),this._element.appendChild(o),this._offset=d.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),Qa(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),U.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=d.M.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const c=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,u;if(!(!((o=this._map)===null||o===void 0)&&o.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const c=this._map,m=c.terrain.depthAtPoint(this._pos),x=c.terrain.getElevationForLngLatZoom(this._lngLat,c.transform.tileZoom);if(c.transform.lngLatToCameraDepth(this._lngLat,x)-m<.006)return void(this._element.style.opacity=this._opacity);const b=-this._offset.y/c.transform._pixelPerMeter,I=Math.sin(c.getPitch()*Math.PI/180)*b,k=c.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),z=c.transform.lngLatToCameraDepth(this._lngLat,x+I)-k>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=d.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return t===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const ku={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let uo=0,Jn=!1;const Eu={maxWidth:100,unit:"metric"};function el(p,t,o){const u=o&&o.maxWidth||100,c=p._container.clientHeight/2,m=p.unproject([0,c]),x=p.unproject([u,c]),b=m.distanceTo(x);if(o&&o.unit==="imperial"){const I=3.2808*b;I>5280?vs(t,u,I/5280,p._getUIString("ScaleControl.Miles")):vs(t,u,I,p._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?vs(t,u,b/1852,p._getUIString("ScaleControl.NauticalMiles")):b>=1e3?vs(t,u,b/1e3,p._getUIString("ScaleControl.Kilometers")):vs(t,u,b,p._getUIString("ScaleControl.Meters"))}function vs(p,t,o,u){const c=function(m){const x=Math.pow(10,`${Math.floor(m)}`.length-1);let b=m/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(I){const k=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*k)/k}(b),x*b}(o);p.style.width=t*(c/o)+"px",p.innerHTML=`${c}&nbsp;${u}`}const Pu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},zu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Au(p){if(p){if(typeof p=="number"){const t=Math.round(Math.abs(p)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,p),"top-left":new d.P(t,t),"top-right":new d.P(-t,t),bottom:new d.P(0,-p),"bottom-left":new d.P(t,-t),"bottom-right":new d.P(-t,-t),left:new d.P(p,0),right:new d.P(-p,0)}}if(p instanceof d.P||Array.isArray(p)){const t=d.P.convert(p);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:d.P.convert(p.center||[0,0]),top:d.P.convert(p.top||[0,0]),"top-left":d.P.convert(p["top-left"]||[0,0]),"top-right":d.P.convert(p["top-right"]||[0,0]),bottom:d.P.convert(p.bottom||[0,0]),"bottom-left":d.P.convert(p["bottom-left"]||[0,0]),"bottom-right":d.P.convert(p["bottom-right"]||[0,0]),left:d.P.convert(p.left||[0,0]),right:d.P.convert(p.right||[0,0])}}return Au(new d.P(0,0))}const Ph=N;w.AJAXError=d.be,w.Evented=d.E,w.LngLat=d.M,w.MercatorCoordinate=d.Y,w.Point=d.P,w.addProtocol=d.bf,w.config=d.a,w.removeProtocol=d.bg,w.AttributionControl=kh,w.BoxZoomHandler=so,w.CanvasSource=Us,w.CooperativeGesturesHandler=nt,w.DoubleClickZoomHandler=xu,w.DragPanHandler=Xr,w.DragRotateHandler=ia,w.EdgeInsets=Jo,w.FullscreenControl=class extends d.E{constructor(p={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o==null?void 0:o.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){U.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=U.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);U.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},w.GeoJSONSource=It,w.GeolocateControl=class extends d.E{constructor(p){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new d.M(t.coords.longitude,t.coords.latitude),u=t.coords.accuracy,c=this._map.getBearing(),m=d.e({bearing:c},this.options.fitBoundsOptions),x=bi.fromLngLat(o,u);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new d.M(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Jn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=U.create("button","maplibregl-ctrl-geolocate",this._container),U.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new lo({element:this._dotElement}),this._circleElement=U.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new lo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")))})}},this.options=d.e({},ku,p)}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return d._(this,arguments,void 0,function*(t=!1){if(zn!==void 0&&!t)return zn;if(window.navigator.permissions===void 0)return zn=!!window.navigator.geolocation,zn;try{zn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{zn=!!window.navigator.geolocation}return zn})}().then(t=>this._setupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),U.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,uo=0,Jn=!1}_isOutOfMapMaxBounds(p){const t=this._map.getMaxBounds(),o=p.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),t=p.getSouthEast(),o=p.getNorthEast(),u=t.distanceTo(o),c=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":uo--,Jn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),uo++,uo>1?(p={maximumAge:6e5,timeout:0},Jn=!0):(p=this.options.positionOptions,Jn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},w.Hash=hu,w.ImageSource=dn,w.KeyboardHandler=Ht,w.LngLatBounds=bi,w.LogoControl=ao,w.Map=class extends Ch{constructor(p){if(d.bc.mark(d.bd.create),(p=d.e({},Tu,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new qa(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._contextLost=t=>{t.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new ti,this._controls=[],this._mapId=d.a3(),this._locale=d.e({},Su,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=oe.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ne(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let t=!1;const o=cu(u=>{this._trackResize&&!this._removed&&this.resize(u)._update()},50);this._resizeObserver=new ResizeObserver(u=>{t?o(u):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ur(this,p),this._hash=p.hash&&new hu(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,d.e({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new kh(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new ao,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new d.k(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new d.k(`${t.dataType}dataloading`,t))}),this.on("dataabort",t=>{this.fire(new d.k("sourcedataabort",t))})}_getMapId(){return this._mapId}addControl(p,t){if(t===void 0&&(t=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=p.onAdd(this);this._controls.push(p);const u=this._controlPositions[t];return t.indexOf("bottom")!==-1?u.insertBefore(o,u.firstChild):u.appendChild(o),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(p);return t>-1&&this._controls.splice(t,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,t,o,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,t,o,u)}resize(p){var t;const o=this._containerDimensions(),u=o[0],c=o[1],m=this._getClampedPixelRatio(u,c);if(this._resizeCanvas(u,c,m),this.painter.resize(u,c,m),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const I=this._getClampedPixelRatio(u,c);this._resizeCanvas(u,c,I),this.painter.resize(u,c,I)}this.transform.resize(u,c),(t=this._requestedCameraState)===null||t===void 0||t.resize(u,c);const x=!this._moving;return x&&(this.stop(),this.fire(new d.k("movestart",p)).fire(new d.k("move",p))),this.fire(new d.k("resize",p)),x&&this.fire(new d.k("moveend",p)),this}_getClampedPixelRatio(p,t){const{0:o,1:u}=this._maxCanvasSize,c=this.getPixelRatio(),m=p*c,x=t*c;return Math.min(m>o?o/m:1,x>u?u/x:1)*c}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(bi.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}project(p){return this.transform.locationPoint(d.M.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(d.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,t,o){if(p==="mouseenter"||p==="mouseover"){let u=!1;return{layer:t,listener:o,delegates:{mousemove:m=>{const x=this.getLayer(t)?this.queryRenderedFeatures(m.point,{layers:[t]}):[];x.length?u||(u=!0,o.call(this,new Mi(p,this,m.originalEvent,{features:x}))):u=!1},mouseout:()=>{u=!1}}}}if(p==="mouseleave"||p==="mouseout"){let u=!1;return{layer:t,listener:o,delegates:{mousemove:x=>{(this.getLayer(t)?this.queryRenderedFeatures(x.point,{layers:[t]}):[]).length?u=!0:u&&(u=!1,o.call(this,new Mi(p,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,o.call(this,new Mi(p,this,x.originalEvent)))}}}}{const u=c=>{const m=this.getLayer(t)?this.queryRenderedFeatures(c.point,{layers:[t]}):[];m.length&&(c.features=m,o.call(this,c),delete c.features)};return{layer:t,listener:o,delegates:{[p]:u}}}}on(p,t,o){if(o===void 0)return super.on(p,t);const u=this._createDelegatedListener(p,t,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(u);for(const c in u.delegates)this.on(c,u.delegates[c]);return this}once(p,t,o){if(o===void 0)return super.once(p,t);const u=this._createDelegatedListener(p,t,o);for(const c in u.delegates)this.once(c,u.delegates[c]);return this}off(p,t,o){return o===void 0?super.off(p,t):(this._delegatedListeners&&this._delegatedListeners[p]&&(u=>{const c=this._delegatedListeners[p];for(let m=0;m<c.length;m++){const x=c[m];if(x.layer===t&&x.listener===o){for(const b in x.delegates)this.off(b,x.delegates[b]);return c.splice(m,1),this}}})(),this)}queryRenderedFeatures(p,t){if(!this.style)return[];let o;const u=p instanceof d.P||Array.isArray(p),c=u?p:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(u?{}:p)||{},c instanceof d.P||typeof c[0]=="number")o=[d.P.convert(c)];else{const m=d.P.convert(c[0]),x=d.P.convert(c[1]);o=[m,new d.P(x.x,m.y),x,new d.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(p,t){return this.style.querySourceFeatures(p,t)}setStyle(p,t){return(t=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(p,t))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const t=this._locale[p];if(t==null)throw new Error(`Missing UI string '${p}'`);return t}_updateStyle(p,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,t));const o=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Ea(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,t,o):this.style.loadJSON(p,t,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ea(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,t){if(typeof p=="string"){const o=this._requestManager.transformRequest(p,ve.Style);d.h(o,new AbortController).then(u=>{this._updateDiff(u.data,t)}).catch(u=>{u&&this.fire(new d.j(u))})}else typeof p=="object"&&this._updateDiff(p,t)}_updateDiff(p,t){try{this.style.setState(p,t)&&this._update(!0)}catch(o){d.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(p,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(p,t){return this._lazyInitEmptyStyle(),this.style.addSource(p,t),this._update(!0)}isSourceLoaded(p){const t=this.style&&this.style.sourceCaches[p];if(t!==void 0)return t.loaded();this.fire(new d.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const t=this.style.sourceCaches[p.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const u=this.style._layers[o];u.type==="hillshade"&&u.source===p.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new na(this.painter,t,p),this.painter.renderToTexture=new bu(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==p.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:p})),this}getTerrain(){var p,t;return(t=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const t in p){const o=p[t]._tiles;for(const u in o){const c=o[u];if(c.state!=="loaded"&&c.state!=="errored")return!1}}return!0}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,t,o={}){const{pixelRatio:u=1,sdf:c=!1,stretchX:m,stretchY:x,content:b}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||d.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:I,height:k,data:z}=t,A=t;return this.style.addImage(p,{data:new d.R({width:I,height:k},new Uint8Array(z)),pixelRatio:u,stretchX:m,stretchY:x,content:b,sdf:c,version:0,userImage:A}),A.onAdd&&A.onAdd(this,p),this}}{const{width:I,height:k,data:z}=X.getImageData(t);this.style.addImage(p,{data:new d.R({width:I,height:k},z),pixelRatio:u,stretchX:m,stretchY:x,content:b,sdf:c,version:0})}}updateImage(p,t){const o=this.style.getImage(p);if(!o)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=t instanceof HTMLImageElement||d.b(t)?X.getImageData(t):t,{width:c,height:m,data:x}=u;if(c===void 0||m===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(c!==o.data.width||m!==o.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(t instanceof HTMLImageElement||d.b(t));return o.data.replace(x,b),this.style.updateImage(p,o),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p){return oe.getImage(this._requestManager.transformRequest(p,ve.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(p,t){return this._lazyInitEmptyStyle(),this.style.addLayer(p,t),this._update(!0)}moveLayer(p,t){return this.style.moveLayer(p,t),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,t,o){return this.style.setLayerZoomRange(p,t,o),this._update(!0)}setFilter(p,t,o={}){return this.style.setFilter(p,t,o),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,t,o,u={}){return this.style.setPaintProperty(p,t,o,u),this._update(!0)}getPaintProperty(p,t){return this.style.getPaintProperty(p,t)}setLayoutProperty(p,t,o,u={}){return this.style.setLayoutProperty(p,t,o,u),this._update(!0)}getLayoutProperty(p,t){return this.style.getLayoutProperty(p,t)}setGlyphs(p,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,t,o,u=>{u||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,t,o=>{o||this._update(!0)}),this}setLight(p,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,t){return this.style.setFeatureState(p,t),this._update()}removeFeatureState(p,t){return this.style.removeFeatureState(p,t),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,t=0;return this._container&&(p=this._container.clientWidth||400,t=this._container.clientHeight||300),[p,t]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const t=this._canvasContainer=U.create("div","maplibregl-canvas-container",p);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=U.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),u=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],u);const c=this._controlContainer=U.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{m[x]=U.create("div",`maplibregl-ctrl-${x} `,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,t,o){this._canvas.width=Math.floor(o*p),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{t={requestedAttributes:p},u&&(t.statusMessage=u.statusMessage,t.type=u.type)},{once:!0});const o=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!o){const u="Failed to initialize WebGL";throw t?(t.message=u,new Error(JSON.stringify(t))):new Error(u)}this.painter=new io(o,this.transform),ze.testSupport(o)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const c=this.transform.zoom,m=X.now();this.style.zoomHistory.update(c,m);const x=new d.a8(c,{now:m,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),b=x.crossFadingFactor();b===1&&b===this._crossFadingFactor||(o=!0,this._crossFadingFactor=b),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bc.mark(d.bd.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,d.bc.mark(d.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),oe.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),U.remove(this._canvasContainer),U.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bc.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,X.frameAsync(this._frameRequest).then(p=>{d.bc.frame(p),this._frameRequest=null,this._render(p)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return sa}getCameraTargetElevation(){return this.transform.elevation}},w.MapMouseEvent=Mi,w.MapTouchEvent=no,w.MapWheelEvent=Vr,w.Marker=lo,w.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),u=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,o)=>{const u=this._map._getUIString(`NavigationControl.${o}`);t.title=u,t.setAttribute("aria-label",u)},this.options=d.e({},Iu,p),this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),U.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),U.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=U.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){U.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,t){const o=U.create("button",p,this._container);return o.type="button",o.addEventListener("click",t),o}},w.Popup=class extends d.E{constructor(p){super(),this.remove=()=>(this._content&&U.remove(this._content),this._container&&(U.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=U.create("div","maplibregl-popup",this._map.getContainer()),this._tip=U.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ja(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!t)return;const u=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let c=this.options.anchor;const m=Au(this.options.offset);if(!c){const b=this._container.offsetWidth,I=this._container.offsetHeight;let k;k=u.y+m.bottom.y<I?["top"]:u.y>this._map.transform.height-I?["bottom"]:[],u.x<b/2?k.push("left"):u.x>this._map.transform.width-b/2&&k.push("right"),c=k.length===0?"bottom":k.join("-")}let x=u.add(m[c]);this.options.subpixelPositioning||(x=x.round()),U.setTransform(this._container,`${oa[c]} translate(${x.x}px,${x.y}px)`),Qa(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(Pu),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=d.M.convert(p),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const t=document.createDocumentFragment(),o=document.createElement("body");let u;for(o.innerHTML=p;u=o.firstChild,u;)t.appendChild(u);return this.setDOMContent(t)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=U.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}setSubpixelPositioning(p){this.options.subpixelPositioning=p}_createCloseButton(){this.options.closeButton&&(this._closeButton=U.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(zu);p&&p.focus()}},w.RasterDEMTileSource=jo,w.RasterTileSource=as,w.ScaleControl=class{constructor(p){this._onMove=()=>{el(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,el(this._map,this._container,this.options)},this.options=d.e({},Eu,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){U.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},w.ScrollZoomHandler=vu,w.Style=Ea,w.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=p}onAdd(p){return this._map=p,this._container=U.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=U.create("button","maplibregl-ctrl-terrain",this._container),U.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){U.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},w.TwoFingersTouchPitchHandler=Th,w.TwoFingersTouchRotateHandler=yu,w.TwoFingersTouchZoomHandler=Ha,w.TwoFingersTouchZoomRotateHandler=et,w.VectorTileSource=ye,w.VideoSource=js,w.addSourceType=(p,t)=>d._(void 0,void 0,void 0,function*(){if(ls(p))throw new Error(`A source type called "${p}" already exists.`);((o,u)=>{$s[o]=u})(p,t)}),w.clearPrewarmedResources=function(){const p=Ri;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Fr),Ri=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},w.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},w.getRTLTextPluginStatus=function(){return wr().getRTLTextPluginStatus()},w.getVersion=function(){return Ph},w.getWorkerCount=function(){return zi.workerCount},w.getWorkerUrl=function(){return d.a.WORKER_URL},w.importScriptInWorkers=function(p){return $n().broadcast("importScript",p)},w.prewarm=function(){Wr().acquire(Fr)},w.setMaxParallelImageRequests=function(p){d.a.MAX_PARALLEL_IMAGE_REQUESTS=p},w.setRTLTextPlugin=function(p,t){return wr().setRTLTextPlugin(p,t)},w.setWorkerCount=function(p){zi.workerCount=p},w.setWorkerUrl=function(p){d.a.WORKER_URL=p}});var T=l;return T})})(m1);var oI=m1.exports;const _d=j0(oI);function aI(){const i=He.useRef(null),s=He.useRef(null),[l]=He.useState(0),[f]=He.useState(45),[_]=He.useState(2),[T]=He.useState("W5lV2tLMxZAza9GGxomX");return He.useEffect(()=>{s.current||(s.current=new _d.Map({container:i.current,style:`https://api.maptiler.com/maps/satellite/style.json?key=${T}`,center:[l,f],zoom:_,bearing:10,scaleControl:!0,geolocateControl:!0,attributionControl:!1,minimap:{containerStyle:{width:"200px",height:"150px"}}}),s.current.addControl(new _d.NavigationControl,"bottom-left"),s.current.addControl(new _d.FullscreenControl,"bottom-right"),new _d.Marker({color:"#FF0000"}).setLngLat([-76.552,3.379]).addTo(s.current))},[T,l,f,_]),Ae.jsx("div",{className:"map-wrap",children:Ae.jsx("div",{ref:i,className:"mapa"})})}function lI(){return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(aI,{}),Ae.jsx("main",{className:"main",children:Ae.jsxs(zT,{children:[Ae.jsx(sI,{}),Ae.jsxs(bT,{children:[Ae.jsx(cc,{path:"/",element:Ae.jsx(ZT,{})}),Ae.jsx(cc,{path:"/about",element:Ae.jsx(tI,{})}),Ae.jsx(cc,{path:"/servicios",element:Ae.jsx(rI,{})}),Ae.jsx(cc,{path:"*",element:Ae.jsx(nI,{})})]})]})})]})}rm.createRoot(document.getElementById("root")).render(Ae.jsx(Ds.StrictMode,{children:Ae.jsx(lI,{})}));
